var Ys=Object.defineProperty;var fs=L=>{throw TypeError(L)};var Ks=(L,c,G)=>c in L?Ys(L,c,{enumerable:!0,configurable:!0,writable:!0,value:G}):L[c]=G;var Kt=(L,c,G)=>Ks(L,typeof c!="symbol"?c+"":c,G),Fe=(L,c,G)=>c.has(L)||fs("Cannot "+G);var t=(L,c,G)=>(Fe(L,c,"read from private field"),G?G.call(L):c.get(L)),at=(L,c,G)=>c.has(L)?fs("Cannot add the same private member more than once"):c instanceof WeakSet?c.add(L):c.set(L,G),lt=(L,c,G,o)=>(Fe(L,c,"write to private field"),o?o.call(L,G):c.set(L,G),G),K=(L,c,G)=>(Fe(L,c,"access private method"),G);var he=(L,c,G,o)=>({set _(b){lt(L,c,b,G)},get _(){return t(L,c,o)}});import{r as reactExports,j as jsxRuntimeExports,i as doc,f as db,t as setDoc,l as getAugmentedNamespace,v as serverTimestamp,x as addDoc,e as collection,y as getAuth,G as GithubAuthProvider,z as signInWithPopup,A as signOut,g as getDocs,B as updateDoc,q as query,w as where,C as orderBy,o as onAuthStateChanged}from"./index-Bn3v1tCl.js";import{F as FontAwesomeIcon,f as faGithub}from"./index-VwM6Mdb5.js";import{i as faTimes,j as faImage,k as faPlus,l as faInfoCircle,m as faCode,n as faMicrochip,o as faBook,p as faDatabase,c as faFileAlt,q as faInfo,r as faLink,s as faTags,t as faTimesCircle,u as faExclamationTriangle}from"./index-B9RSM9E-.js";import{c as createStarryNight,g as grammars}from"./index-DmBoToys.js";var close=document.getElementsByClassName("closeTab"),tabs$1=document.getElementsByClassName("tab"),anchors=document.querySelectorAll("button.btn");Array.prototype.forEach.call(close,function(L){L.addEventListener("click",explode)});Array.prototype.forEach.call(tabs$1,function(L){L.style.width=L.offsetWidth+"px"});Array.prototype.forEach.call(anchors,function(L){L.addEventListener("click",function(c){return c.preventDefault(),!1})});function getOffset(L){var c=L.getBoundingClientRect(),G=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;return{top:c.top+o,left:c.left+G}}function explode(L){var c=L.currentTarget.parentElement,G=getOffset(c),o=G.left,b=G.top+10,q=document.createElement("canvas"),B=q.getContext("2d"),tt=window.devicePixelRatio,O=[];c.classList.add("tabClosed"),window.setTimeout(function(){document.body.appendChild(q),q.style.position="absolute",q.style.left=o-40+"px",q.style.top=b-150+"px",q.style.pointerEvents="none",q.style.width="80px",q.style.height="300px",q.width=80*tt,q.height=300*tt;function E(){B.clearRect(0,0,q.width,q.height),O.forEach(function(d,j){d.opacity-=.01,d.speed*=d.friction,d.radius*=d.friction,d.yVel+=d.gravity,d.y+=d.yVel,!(d.opacity<0)&&(d.radius<0||(B.beginPath(),B.globalAlpha=d.opacity,B.fillStyle=d.color,B.arc(d.x,d.y,d.radius,0,2*Math.PI,!1),B.fill()))})}(function d(){requestAnimationFrame(d),E()})(),setTimeout(function(){document.body.removeChild(q)},3e3)},150)}function CarouselForm({carouselSamples:L,setCarouselSamples:c,setPopupWindow:G}){const[o,b]=reactExports.useState(""),[q,B]=reactExports.useState(null),[tt,O]=reactExports.useState(null),[E,d]=reactExports.useState(""),j=f=>{const u=f.target.files[0];if(u){if(!u.type.match("image.*")){d("Please select an image file");return}if(u.size>5*1024*1024){d("Image must be less than 5MB");return}B(u);const y=new FileReader;y.onload=D=>{O(D.target.result)},y.readAsDataURL(u),d("")}},T=f=>{f.preventDefault(),f.currentTarget.classList.add("drag-over")},x=f=>{f.currentTarget.classList.remove("drag-over")},m=f=>{if(f.preventDefault(),f.currentTarget.classList.remove("drag-over"),f.dataTransfer.files&&f.dataTransfer.files[0]){const u=f.dataTransfer.files[0];if(!u.type.match("image.*")){d("Please select an image file");return}if(u.size>5*1024*1024){d("Image must be less than 5MB");return}B(u);const y=new FileReader;y.onload=D=>{O(D.target.result)},y.readAsDataURL(u),d("")}},v=()=>{if(!o){d("Please enter a title for the carousel image");return}if(!q){d("Please select an image");return}let f=[...L];f.push({title:o,img:[q]}),c(f),G(null)};return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"carousel-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsx("h2",{className:"form-title",children:"Add Carousel Image"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"carouselTitle",children:"Image Title"}),jsxRuntimeExports.jsx("input",{type:"text",id:"carouselTitle",className:"carousel-input",value:o,onChange:f=>b(f.target.value),placeholder:"Enter a descriptive title for this image"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Image Upload"}),jsxRuntimeExports.jsxs("div",{className:`carousel-upload-area ${tt?"has-preview":""}`,onDragOver:T,onDragLeave:x,onDrop:m,children:[jsxRuntimeExports.jsx("input",{type:"file",className:"file-input",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:j,id:"carouselImage"}),tt?jsxRuntimeExports.jsxs("div",{className:"carousel-preview",children:[jsxRuntimeExports.jsx("img",{src:tt,alt:"Preview",className:"preview-image"}),jsxRuntimeExports.jsx("button",{type:"button",className:"remove-image-btn",onClick:()=>{B(null),O(null)},children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})})]}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faImage,className:"upload-icon"}),jsxRuntimeExports.jsxs("div",{className:"upload-text",children:[jsxRuntimeExports.jsx("p",{children:"Drag & drop image here"}),jsxRuntimeExports.jsx("span",{children:"or"}),jsxRuntimeExports.jsxs("label",{htmlFor:"carouselImage",className:"browse-btn",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faPlus})," Browse files"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"image-requirements",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faInfoCircle,className:"info-icon"}),jsxRuntimeExports.jsx("span",{children:"Recommended: JPG, PNG or WebP • Max 5MB • 16:9 aspect ratio"})]})]}),E&&jsxRuntimeExports.jsx("div",{className:"form-error",children:E}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",onClick:v,children:"Add to Carousel"})]})]})})}function CodeSampleForm({codeSamples:L,setCodeSamples:c,setPopupWindow:G}){const[o,b]=reactExports.useState(""),[q,B]=reactExports.useState(""),[tt,O]=reactExports.useState(""),[E,d]=reactExports.useState([]),[j,T]=reactExports.useState(""),[x,m]=reactExports.useState(!0);reactExports.useEffect(()=>{(async()=>{try{m(!0);const y=(await createStarryNight(grammars)).scopes();d(y),y.length>0&&O(y.find(D=>D.includes("javascript"))||y[0])}catch(u){console.error("Error loading syntax highlighting:",u)}finally{m(!1)}})()},[]);const v=()=>{if(!o.trim()){T("Please enter a title for the code sample");return}if(!q.trim()){T("Please enter some code");return}if(!tt){T("Please select a language");return}const f=[...L];f.push({title:o.trim(),code:q.trim(),language:tt}),c(f),G(null)};return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"code-sample-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsxs("h2",{className:"form-title",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faCode,className:"title-icon"}),"Add Code Sample"]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"codeSampleTitle",children:"Sample Title"}),jsxRuntimeExports.jsx("input",{type:"text",id:"codeSampleTitle",className:"form-control",value:o,onChange:f=>b(f.target.value),placeholder:"e.g., 'Authentication Function', 'API Request Handler'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"language",children:"Programming Language"}),jsxRuntimeExports.jsx("div",{className:"select-wrapper",children:jsxRuntimeExports.jsx("select",{id:"language",className:"form-control",value:tt,onChange:f=>O(f.target.value),disabled:x,children:x?jsxRuntimeExports.jsx("option",{value:"",children:"Loading languages..."}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select a language"}),E.map((f,u)=>jsxRuntimeExports.jsx("option",{value:f,children:f.replace(/^source\./,"").replace(/\b\w/g,y=>y.toUpperCase())},u))]})})})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"code",children:"Code"}),jsxRuntimeExports.jsx("textarea",{id:"code",className:"code-editor",value:q,onChange:f=>B(f.target.value),placeholder:"Paste your code snippet here...",rows:10,spellCheck:"false"}),jsxRuntimeExports.jsxs("div",{className:"code-helper",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faInfoCircle,className:"info-icon"}),jsxRuntimeExports.jsx("span",{children:"Use proper indentation for better readability"})]})]}),j&&jsxRuntimeExports.jsx("div",{className:"form-error",children:j}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",onClick:v,children:"Add Code Sample"})]})]})})}function TechsForm({techs:L,setTechs:c,setPopupWindow:G}){const[o,b]=reactExports.useState(""),[q,B]=reactExports.useState(""),[tt,O]=reactExports.useState(""),E=()=>{if(!o.trim()){O("Please enter a technology name");return}if(!q.trim()){O("Please enter a technology description");return}const T=[...L];T.push({title:o.trim(),description:q.trim()}),c(T),G(null)},d=[{name:"React",desc:"A JavaScript library for building user interfaces"},{name:"Node.js",desc:"JavaScript runtime built on Chrome's V8 JavaScript engine"},{name:"Python",desc:"Interpreted high-level general-purpose programming language"},{name:"Docker",desc:"Platform for developing, shipping, and running applications in containers"},{name:"MongoDB",desc:"NoSQL document database with scalability and flexibility"},{name:"Firebase",desc:"Google's platform for app development, hosting and more"}],j=T=>{b(T.name),B(T.desc)};return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"tech-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsxs("h2",{className:"form-title",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faMicrochip,className:"title-icon"}),"Add Technology"]}),jsxRuntimeExports.jsxs("div",{className:"quick-select",children:[jsxRuntimeExports.jsx("label",{children:"Quick Select:"}),jsxRuntimeExports.jsx("div",{className:"quick-select-buttons",children:d.map((T,x)=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>j(T),className:"quick-select-btn",children:T.name},x))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"techTitle",children:"Technology Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"techTitle",className:"form-control",value:o,onChange:T=>b(T.target.value),placeholder:"e.g., 'React', 'TensorFlow', 'AWS'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"techDescription",children:"Description"}),jsxRuntimeExports.jsx("textarea",{id:"techDescription",className:"form-control",value:q,onChange:T=>B(T.target.value),placeholder:"Describe how this technology was used in your project",rows:4})]}),tt&&jsxRuntimeExports.jsx("div",{className:"form-error",children:tt}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",onClick:E,children:"Add Technology"})]})]})})}function ResourcesForm({resources:L,setResources:c,setPopupWindow:G}){const[o,b]=reactExports.useState(""),[q,B]=reactExports.useState(""),[tt,O]=reactExports.useState(""),E=()=>{if(!o.trim()){O("Please enter a resource title");return}if(!q.trim()){O("Please enter a resource description");return}const j=[...L];j.push({title:o.trim(),description:q.trim()}),c(j),G(null)},d=[{type:"Book",prefix:"Book: "},{type:"Article",prefix:"Article: "},{type:"Video",prefix:"Video Tutorial: "},{type:"Documentation",prefix:"Documentation: "},{type:"Framework",prefix:"Framework: "},{type:"Library",prefix:"Library: "}];return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"resource-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsxs("h2",{className:"form-title",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faBook,className:"title-icon"}),"Add Resource"]}),jsxRuntimeExports.jsxs("div",{className:"resource-types",children:[jsxRuntimeExports.jsx("label",{children:"Resource Type:"}),jsxRuntimeExports.jsx("div",{className:"resource-type-buttons",children:d.map((j,T)=>jsxRuntimeExports.jsx("button",{type:"button",className:"resource-type-btn",onClick:()=>b(j.prefix),children:j.type},T))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"resourceTitle",children:"Resource Title"}),jsxRuntimeExports.jsx("input",{type:"text",id:"resourceTitle",className:"form-control",value:o,onChange:j=>b(j.target.value),placeholder:"e.g., 'Clean Code by Robert Martin', 'React Documentation'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"resourceDescription",children:"Description"}),jsxRuntimeExports.jsx("textarea",{id:"resourceDescription",className:"form-control",value:q,onChange:j=>B(j.target.value),placeholder:"Describe how this resource was helpful for your project",rows:4})]}),tt&&jsxRuntimeExports.jsx("div",{className:"form-error",children:tt}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsxs("button",{type:"button",className:"submit-btn",onClick:E,children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faPlus})," Add Resource"]})]})]})})}function DataSourcesForm({dataSources:L,setDataSources:c,setPopupWindow:G}){const[o,b]=reactExports.useState(""),[q,B]=reactExports.useState(""),[tt,O]=reactExports.useState(""),[E,d]=reactExports.useState(""),[j,T]=reactExports.useState(""),x=()=>{if(!o){T("Please select a data source type");return}if(!q.trim()){T("Please enter a name for the data source");return}const v=[...L];v.push({type:o,name:q.trim(),size:tt.trim(),link:E.trim()}),c(v),G(null)},m=["excel","csv","json","sql-server","mysql","mongodb","python","xml"];return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"datasource-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsxs("h2",{className:"form-title",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faDatabase,className:"title-icon"}),"Add Data Source"]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"dataSourceType",children:"Data Source Type"}),jsxRuntimeExports.jsx("div",{className:"datasource-types",children:m.map((v,f)=>jsxRuntimeExports.jsxs("div",{className:`datasource-type ${o===v?"selected":""}`,onClick:()=>b(v),children:[jsxRuntimeExports.jsx("div",{className:"datasource-icon",children:jsxRuntimeExports.jsx("img",{src:`/images/datasources/${v}.svg`,alt:v,onError:u=>{u.target.onError=null,u.target.src="/images/datasources/default.svg"}})}),jsxRuntimeExports.jsx("span",{children:v})]},f))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"dataSourceName",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faFileAlt,className:"field-icon"}),"Data Source Name"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"dataSourceName",className:"form-control",value:q,onChange:v=>B(v.target.value),placeholder:"e.g., 'Customer Records', 'Transaction Data'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"dataSourceSize",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faInfo,className:"field-icon"}),"Size/Records (optional)"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"dataSourceSize",className:"form-control",value:tt,onChange:v=>O(v.target.value),placeholder:"e.g., '2.5 GB', '10,000 records'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"dataSourceLink",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLink,className:"field-icon"}),"Source Link (optional)"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"dataSourceLink",className:"form-control",value:E,onChange:v=>d(v.target.value),placeholder:"URL to the data source if publicly available"})]}),j&&jsxRuntimeExports.jsx("div",{className:"form-error",children:j}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",onClick:x,disabled:!o||!q,children:"Add Data Source"})]})]})})}const TagInput=({tags:L,setTags:c,label:G})=>{const[o,b]=reactExports.useState(""),[q,B]=reactExports.useState(!1),tt=reactExports.useRef(null),O=x=>{b(x.target.value)},E=x=>{x.key==="Enter"||x.key===","?(x.preventDefault(),d()):x.key==="Backspace"&&o===""&&L.length>0&&j(L.length-1)},d=()=>{const x=o.trim();x&&!L.includes(x)&&(c([...L,x]),b(""))},j=x=>{c(L.filter((m,v)=>v!==x))},T=()=>{tt.current.focus()};return jsxRuntimeExports.jsxs("div",{className:`tag-input-container ${q?"focused":""}`,onClick:T,children:[jsxRuntimeExports.jsx("div",{className:"tag-input-icon",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTags})}),jsxRuntimeExports.jsx("div",{className:"tag-input-wrapper",children:jsxRuntimeExports.jsxs("div",{className:"tag-input-field",children:[L.map((x,m)=>jsxRuntimeExports.jsxs("div",{className:"tag",children:[jsxRuntimeExports.jsx("span",{className:"tag-text",children:x}),jsxRuntimeExports.jsx("span",{className:"tag-close",onClick:v=>{v.stopPropagation(),j(m)},children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimesCircle})})]},m)),jsxRuntimeExports.jsx("input",{ref:tt,type:"text",value:o,onChange:O,onKeyDown:E,onFocus:()=>B(!0),onBlur:()=>{B(!1),o&&d()},className:"tag-input",placeholder:L.length>0?"":"Type and press Enter to add tags"})]})}),jsxRuntimeExports.jsx("div",{className:"tag-input-helper",children:"Press Enter or comma to add"})]})},byteToHex=[];for(let L=0;L<256;++L)byteToHex.push((L+256).toString(16).slice(1));function unsafeStringify(L,c=0){return(byteToHex[L[c+0]]+byteToHex[L[c+1]]+byteToHex[L[c+2]]+byteToHex[L[c+3]]+"-"+byteToHex[L[c+4]]+byteToHex[L[c+5]]+"-"+byteToHex[L[c+6]]+byteToHex[L[c+7]]+"-"+byteToHex[L[c+8]]+byteToHex[L[c+9]]+"-"+byteToHex[L[c+10]]+byteToHex[L[c+11]]+byteToHex[L[c+12]]+byteToHex[L[c+13]]+byteToHex[L[c+14]]+byteToHex[L[c+15]]).toLowerCase()}let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");getRandomValues=crypto.getRandomValues.bind(crypto)}return getRandomValues(rnds8)}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(L,c,G){var b;if(native.randomUUID&&!L)return native.randomUUID();L=L||{};const o=L.random??((b=L.rng)==null?void 0:b.call(L))??rng();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,unsafeStringify(o)}const InputComponent=({type:L="text",name:c,className:G="form__input",placeholder:o="",required:b=!0,value:q,onChange:B,label:tt})=>jsxRuntimeExports.jsxs("div",{className:"input-flow",children:[jsxRuntimeExports.jsx("input",{type:L,name:c,className:G,placeholder:o,required:b,value:q,onChange:B,id:c}),jsxRuntimeExports.jsx("label",{className:"form__label",htmlFor:c,children:tt})]}),FileInputComponent=({name:L})=>jsxRuntimeExports.jsx("input",{type:"file",name:L}),CheckboxComponent=({name:L})=>jsxRuntimeExports.jsxs("div",{className:"input-flow",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",name:L}),jsxRuntimeExports.jsx("label",{className:"form__label",children:"Highlighted"})]}),ProjectDataComponent=({items:L,setItems:c,title:G,setPopupWindow:o,formComponent:b})=>{const q=(B,tt)=>{B.preventDefault();let O=[...L];O.splice(tt,1),c(O)};return jsxRuntimeExports.jsxs("div",{className:"group-container",children:[jsxRuntimeExports.jsxs("div",{className:"input-container",children:[jsxRuntimeExports.jsx("h2",{className:"title",children:G}),jsxRuntimeExports.jsx("input",{type:"button",className:"add-code-sample",value:`Add ${G}`,onClick:()=>{o(b)}})]}),L.length>0&&jsxRuntimeExports.jsx("div",{className:"code-samples h-list",children:L.map((B,tt)=>jsxRuntimeExports.jsxs("li",{className:"tab tabSelected",children:[jsxRuntimeExports.jsx("button",{className:"btn title",children:B.title}),jsxRuntimeExports.jsx("button",{className:"btn closeTab",onClick:O=>q(O,tt),children:"✕"})]},tt))})]})};function ProjectForm(){const[L,c]=reactExports.useState(null),[G,o]=reactExports.useState([]),[b,q]=reactExports.useState([]),[B,tt]=reactExports.useState([]),[O,E]=reactExports.useState([]),[d,j]=reactExports.useState([]),[T,x]=reactExports.useState([]),[m,v]=reactExports.useState("Submit"),[f,u]=reactExports.useState(!1),[y,D]=reactExports.useState(""),[_,h]=reactExports.useState(!1),e={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/projects/",token:localStorage.getItem("githubToken")||""},s=g=>new Promise((S,J)=>{const H=new FileReader;H.readAsDataURL(g),H.onload=()=>{const Y=H.result.split(",")[1];S(Y)},H.onerror=Y=>J(Y)}),l=async(g,S,J)=>{if(!g||!e.token)throw new Error("Missing file or GitHub token");try{const H=await s(g);let Y=null;try{const W=await fetch(`https://api.github.com/repos/${e.owner}/${e.repo}/contents/${S}?ref=${e.branch}`,{headers:{Authorization:`token ${e.token}`,Accept:"application/vnd.github.v3+json"}});W.status===200&&(Y=(await W.json()).sha)}catch{console.log(`File does not exist yet: ${S}`)}const $={message:J,content:H,branch:e.branch};Y&&($.sha=Y);const rt=await fetch(`https://api.github.com/repos/${e.owner}/${e.repo}/contents/${S}`,{method:"PUT",headers:{Authorization:`token ${e.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify($)}),P=await rt.json();if(rt.status===200||rt.status===201)return P;throw new Error(`GitHub API Error: ${P.message}`)}catch(H){throw console.error("Error committing to GitHub:",H),H}},a=async(g,S,J,H,Y)=>{h(!0),D("Starting to commit images to GitHub...");try{const $=e.baseImagePath+Y,rt=`${$}/carousel`;if(g){const P=`${$}/${S}`;D(`Committing main image: ${S}`),await l(g,P,`Add project main image: ${S}`)}for(let P=0;P<J.length;P++){const W=J[P];if(W.img&&W.img[0]){const Z=H[P],R=`${rt}/${Z}`;D(`Committing carousel image ${P+1}/${J.length}: ${Z}`),await l(W.img[0],R,`Add project carousel image: ${Z}`)}}return D("All images successfully committed to GitHub!"),setTimeout(()=>{D(""),h(!1)},3e3),!0}catch($){return console.error("Error committing images to GitHub:",$),D(`Error committing images: ${$.message}`),h(!1),!1}},w=async g=>{if(g.preventDefault(),!f){u(!0),v("Submitting...");try{const S=new FormData(g.target),J=S.get("image");if(J&&J.type!=="image/webp"){alert("Only .webp images are accepted for the main image."),v("Submit"),u(!1);return}if(!e.token){const n=prompt("Please enter your GitHub token to commit images:");if(!n){alert("GitHub token is required to commit images."),v("Submit"),u(!1);return}localStorage.setItem("githubToken",n),e.token=n}const H=v4().replace(/-/g,"").substring(0,24),$=`${`public/images/projects/${H}`}/carousel`,rt={_id:H,title:S.get("title"),description:S.get("description"),githubLink:S.get("githubLink"),startDate:S.get("startDate")?new Date(S.get("startDate")).toISOString():null,endDate:S.get("endDate")?new Date(S.get("endDate")).toISOString():null,durration:S.get("endDate")?"completed":"ongoing",highlighted:S.get("highlighted")==="on"?"star":"basic",tags:T,showInOverview:!1,codeSamples:G,dataSources:d,tools:{techs:B.map((n,i)=>({_id:`${H}${i}t`,title:n.title,description:n.description})),resources:O.map((n,i)=>({_id:`${H}${i}r`,title:n.title,description:n.description}))},carouselImages:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),__v:0},P=Date.now();let W=null;J&&(W=`${P}.webp`,rt.image=`/images/projects/${H}/${W}`);let Z=[];for(let n=0;n<b.length;n++){const i=b[n];if(i.img&&i.img[0]){if(i.img[0].type!=="image/webp"){alert(`Only .webp images are accepted for carousel image ${n+1}.`),v("Submit"),u(!1);return}const p=`${P}-${n}.webp`;Z.push(p),rt.carouselImages.push({_id:`${H}${n}c`,img:`/images/projects/${H}/carousel/${p}`,title:i.title})}}v("Saving to Firebase...");const R=doc(db,"projects",H);await setDoc(R,rt),v("Committing images..."),await a(J,W,b,Z,H),v("Successfully Submitted!"),setTimeout(()=>{g.target.reset(),o([]),q([]),tt([]),E([]),j([]),x([]),v("Submit"),u(!1)},3e3)}catch(S){console.error("Error submitting project:",S),v("Error: Please try again"),u(!1)}}};reactExports.useEffect(()=>{const g=()=>{v("Submit")},S=document.querySelectorAll("input, textarea");return S.forEach(J=>{J.addEventListener("input",g)}),()=>{S.forEach(J=>{J.removeEventListener("input",g)})}},[]);const r=[jsxRuntimeExports.jsx(CodeSampleForm,{codeSamples:G,setCodeSamples:o,setPopupWindow:c}),jsxRuntimeExports.jsx(CarouselForm,{carouselSamples:b,setCarouselSamples:q,setPopupWindow:c}),jsxRuntimeExports.jsx(TechsForm,{techs:B,setTechs:tt,setPopupWindow:c}),jsxRuntimeExports.jsx(ResourcesForm,{resources:O,setResources:E,setPopupWindow:c}),jsxRuntimeExports.jsx(DataSourcesForm,{dataSources:d,setDataSources:j,setPopupWindow:c})];return jsxRuntimeExports.jsxs("form",{onSubmit:w,className:"filldb-form project-form",children:[jsxRuntimeExports.jsx("h1",{className:"project-form__title",children:"Create New Project"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsxs("div",{className:"input-container",children:[jsxRuntimeExports.jsx(InputComponent,{name:"title",label:"Title"}),jsxRuntimeExports.jsx(InputComponent,{name:"githubLink",label:"Github Link"})]}),jsxRuntimeExports.jsxs("div",{className:"input-container",children:[jsxRuntimeExports.jsx(InputComponent,{type:"date",name:"startDate",label:"Start Date"}),jsxRuntimeExports.jsx(InputComponent,{type:"date",name:"endDate",required:!1,label:"End Date"})]}),jsxRuntimeExports.jsx("textarea",{className:"description",type:"text",name:"description",required:!0,placeholder:"Write a Brief Description of the Project"}),jsxRuntimeExports.jsx(FileInputComponent,{name:"image"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:G,setItems:o,title:"Code Samples",formComponent:r[0],setPopupWindow:c}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:b,setItems:q,title:"Carousels",formComponent:r[1],setPopupWindow:c}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:B,setItems:tt,title:"Technologies",formComponent:r[2],setPopupWindow:c}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:O,setItems:E,title:"Resources",formComponent:r[3],setPopupWindow:c}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:d,setItems:j,title:"Data Sources",formComponent:r[4],setPopupWindow:c}),L,jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(CheckboxComponent,{name:"highlighted"}),jsxRuntimeExports.jsx(TagInput,{tags:T,setTags:x}),jsxRuntimeExports.jsx("input",{type:"submit",value:m,disabled:f||_,className:f||_?"submitting":""}),(_||y)&&jsxRuntimeExports.jsxs("div",{className:`commit-status ${y.includes("Error")?"error":y.includes("success")?"success":"info"}`,children:[y,_&&jsxRuntimeExports.jsx("div",{className:"spinner"})]})]})}function commonjsRequire(L){throw new Error('Could not dynamically require "'+L+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(c,G){module.exports=c.pdfjsLib=G()})(globalThis,()=>(()=>{var __webpack_modules__=[,(L,c)=>{var Xt;Object.defineProperty(c,"__esModule",{value:!0}),c.VerbosityLevel=c.Util=c.UnknownErrorException=c.UnexpectedResponseException=c.TextRenderingMode=c.RenderingIntentFlag=c.PromiseCapability=c.PermissionFlag=c.PasswordResponses=c.PasswordException=c.PageActionEventType=c.OPS=c.MissingPDFException=c.MAX_IMAGE_SIZE_TO_CACHE=c.LINE_FACTOR=c.LINE_DESCENT_FACTOR=c.InvalidPDFException=c.ImageKind=c.IDENTITY_MATRIX=c.FormatError=c.FeatureTest=c.FONT_IDENTITY_MATRIX=c.DocumentActionEventType=c.CMapCompressionType=c.BaseException=c.BASELINE_FACTOR=c.AnnotationType=c.AnnotationReplyType=c.AnnotationPrefix=c.AnnotationMode=c.AnnotationFlag=c.AnnotationFieldFlag=c.AnnotationEditorType=c.AnnotationEditorPrefix=c.AnnotationEditorParamsType=c.AnnotationBorderStyleType=c.AnnotationActionEventType=c.AbortException=void 0,c.assert=P,c.bytesToString=dt,c.createValidAbsoluteUrl=Z,c.getModificationDate=St,c.getUuid=Lt,c.getVerbosityLevel=H,c.info=Y,c.isArrayBuffer=Q,c.isArrayEqual=wt,c.isNodeJS=void 0,c.normalizeUnicode=Pt,c.objectFromMap=xt,c.objectSize=yt,c.setVerbosityLevel=J,c.shadow=R,c.string32=mt,c.stringToBytes=ut,c.stringToPDFString=ft,c.stringToUTF8String=vt,c.unreachable=rt,c.utf8StringToString=At,c.warn=$;const G=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");c.isNodeJS=G;const o=[1,0,0,1,0,0];c.IDENTITY_MATRIX=o;const b=[.001,0,0,.001,0,0];c.FONT_IDENTITY_MATRIX=b;const q=1e7;c.MAX_IMAGE_SIZE_TO_CACHE=q;const B=1.35;c.LINE_FACTOR=B;const tt=.35;c.LINE_DESCENT_FACTOR=tt;const O=tt/B;c.BASELINE_FACTOR=O;const E={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};c.RenderingIntentFlag=E;const d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};c.AnnotationMode=d;const j="pdfjs_internal_editor_";c.AnnotationEditorPrefix=j;const T={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};c.AnnotationEditorType=T;const x={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};c.AnnotationEditorParamsType=x;const m={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};c.PermissionFlag=m;const v={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};c.TextRenderingMode=v;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};c.ImageKind=f;const u={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};c.AnnotationType=u;const y={GROUP:"Group",REPLY:"R"};c.AnnotationReplyType=y;const D={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};c.AnnotationFlag=D;const _={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};c.AnnotationFieldFlag=_;const h={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};c.AnnotationBorderStyleType=h;const e={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};c.AnnotationActionEventType=e;const s={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};c.DocumentActionEventType=s;const l={O:"PageOpen",C:"PageClose"};c.PageActionEventType=l;const a={ERRORS:0,WARNINGS:1,INFOS:5};c.VerbosityLevel=a;const w={NONE:0,BINARY:1};c.CMapCompressionType=w;const r={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};c.OPS=r;const g={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};c.PasswordResponses=g;let S=a.WARNINGS;function J(Et){Number.isInteger(Et)&&(S=Et)}function H(){return S}function Y(Et){S>=a.INFOS&&console.log(`Info: ${Et}`)}function $(Et){S>=a.WARNINGS&&console.log(`Warning: ${Et}`)}function rt(Et){throw new Error(Et)}function P(Et,ot){Et||rt(ot)}function W(Et){switch(Et==null?void 0:Et.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Z(Et,ot=null,ct=null){if(!Et)return null;try{if(ct&&typeof Et=="string"){if(ct.addDefaultProtocol&&Et.startsWith("www.")){const Vt=Et.match(/\./g);(Vt==null?void 0:Vt.length)>=2&&(Et=`http://${Et}`)}if(ct.tryConvertEncoding)try{Et=vt(Et)}catch{}}const Tt=ot?new URL(Et,ot):new URL(Et);if(W(Tt))return Tt}catch{}return null}function R(Et,ot,ct,Tt=!1){return Object.defineProperty(Et,ot,{value:ct,enumerable:!Tt,configurable:!0,writable:!1}),ct}const n=function(){function ot(ct,Tt){this.constructor===ot&&rt("Cannot initialize BaseException."),this.message=ct,this.name=Tt}return ot.prototype=new Error,ot.constructor=ot,ot}();c.BaseException=n;class i extends n{constructor(ot,ct){super(ot,"PasswordException"),this.code=ct}}c.PasswordException=i;class p extends n{constructor(ot,ct){super(ot,"UnknownErrorException"),this.details=ct}}c.UnknownErrorException=p;class k extends n{constructor(ot){super(ot,"InvalidPDFException")}}c.InvalidPDFException=k;class F extends n{constructor(ot){super(ot,"MissingPDFException")}}c.MissingPDFException=F;class I extends n{constructor(ot,ct){super(ot,"UnexpectedResponseException"),this.status=ct}}c.UnexpectedResponseException=I;class z extends n{constructor(ot){super(ot,"FormatError")}}c.FormatError=z;class et extends n{constructor(ot){super(ot,"AbortException")}}c.AbortException=et;function dt(Et){(typeof Et!="object"||(Et==null?void 0:Et.length)===void 0)&&rt("Invalid argument for bytesToString");const ot=Et.length,ct=8192;if(ot<ct)return String.fromCharCode.apply(null,Et);const Tt=[];for(let Vt=0;Vt<ot;Vt+=ct){const Wt=Math.min(Vt+ct,ot),U=Et.subarray(Vt,Wt);Tt.push(String.fromCharCode.apply(null,U))}return Tt.join("")}function ut(Et){typeof Et!="string"&&rt("Invalid argument for stringToBytes");const ot=Et.length,ct=new Uint8Array(ot);for(let Tt=0;Tt<ot;++Tt)ct[Tt]=Et.charCodeAt(Tt)&255;return ct}function mt(Et){return String.fromCharCode(Et>>24&255,Et>>16&255,Et>>8&255,Et&255)}function yt(Et){return Object.keys(Et).length}function xt(Et){const ot=Object.create(null);for(const[ct,Tt]of Et)ot[ct]=Tt;return ot}function st(){const Et=new Uint8Array(4);return Et[0]=1,new Uint32Array(Et.buffer,0,1)[0]===1}function it(){try{return new Function(""),!0}catch{return!1}}class A{static get isLittleEndian(){return R(this,"isLittleEndian",st())}static get isEvalSupported(){return R(this,"isEvalSupported",it())}static get isOffscreenCanvasSupported(){return R(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?R(this,"platform",{isWin:!1,isMac:!1}):R(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var ot,ct;return R(this,"isCSSRoundSupported",(ct=(ot=globalThis.CSS)==null?void 0:ot.supports)==null?void 0:ct.call(ot,"width: round(1.5px, 1px)"))}}c.FeatureTest=A;const M=[...Array(256).keys()].map(Et=>Et.toString(16).padStart(2,"0"));class V{static makeHexColor(ot,ct,Tt){return`#${M[ot]}${M[ct]}${M[Tt]}`}static scaleMinMax(ot,ct){let Tt;ot[0]?(ot[0]<0&&(Tt=ct[0],ct[0]=ct[1],ct[1]=Tt),ct[0]*=ot[0],ct[1]*=ot[0],ot[3]<0&&(Tt=ct[2],ct[2]=ct[3],ct[3]=Tt),ct[2]*=ot[3],ct[3]*=ot[3]):(Tt=ct[0],ct[0]=ct[2],ct[2]=Tt,Tt=ct[1],ct[1]=ct[3],ct[3]=Tt,ot[1]<0&&(Tt=ct[2],ct[2]=ct[3],ct[3]=Tt),ct[2]*=ot[1],ct[3]*=ot[1],ot[2]<0&&(Tt=ct[0],ct[0]=ct[1],ct[1]=Tt),ct[0]*=ot[2],ct[1]*=ot[2]),ct[0]+=ot[4],ct[1]+=ot[4],ct[2]+=ot[5],ct[3]+=ot[5]}static transform(ot,ct){return[ot[0]*ct[0]+ot[2]*ct[1],ot[1]*ct[0]+ot[3]*ct[1],ot[0]*ct[2]+ot[2]*ct[3],ot[1]*ct[2]+ot[3]*ct[3],ot[0]*ct[4]+ot[2]*ct[5]+ot[4],ot[1]*ct[4]+ot[3]*ct[5]+ot[5]]}static applyTransform(ot,ct){const Tt=ot[0]*ct[0]+ot[1]*ct[2]+ct[4],Vt=ot[0]*ct[1]+ot[1]*ct[3]+ct[5];return[Tt,Vt]}static applyInverseTransform(ot,ct){const Tt=ct[0]*ct[3]-ct[1]*ct[2],Vt=(ot[0]*ct[3]-ot[1]*ct[2]+ct[2]*ct[5]-ct[4]*ct[3])/Tt,Wt=(-ot[0]*ct[1]+ot[1]*ct[0]+ct[4]*ct[1]-ct[5]*ct[0])/Tt;return[Vt,Wt]}static getAxialAlignedBoundingBox(ot,ct){const Tt=this.applyTransform(ot,ct),Vt=this.applyTransform(ot.slice(2,4),ct),Wt=this.applyTransform([ot[0],ot[3]],ct),U=this.applyTransform([ot[2],ot[1]],ct);return[Math.min(Tt[0],Vt[0],Wt[0],U[0]),Math.min(Tt[1],Vt[1],Wt[1],U[1]),Math.max(Tt[0],Vt[0],Wt[0],U[0]),Math.max(Tt[1],Vt[1],Wt[1],U[1])]}static inverseTransform(ot){const ct=ot[0]*ot[3]-ot[1]*ot[2];return[ot[3]/ct,-ot[1]/ct,-ot[2]/ct,ot[0]/ct,(ot[2]*ot[5]-ot[4]*ot[3])/ct,(ot[4]*ot[1]-ot[5]*ot[0])/ct]}static singularValueDecompose2dScale(ot){const ct=[ot[0],ot[2],ot[1],ot[3]],Tt=ot[0]*ct[0]+ot[1]*ct[2],Vt=ot[0]*ct[1]+ot[1]*ct[3],Wt=ot[2]*ct[0]+ot[3]*ct[2],U=ot[2]*ct[1]+ot[3]*ct[3],gt=(Tt+U)/2,Rt=Math.sqrt((Tt+U)**2-4*(Tt*U-Wt*Vt))/2,Mt=gt+Rt||1,Nt=gt-Rt||1;return[Math.sqrt(Mt),Math.sqrt(Nt)]}static normalizeRect(ot){const ct=ot.slice(0);return ot[0]>ot[2]&&(ct[0]=ot[2],ct[2]=ot[0]),ot[1]>ot[3]&&(ct[1]=ot[3],ct[3]=ot[1]),ct}static intersect(ot,ct){const Tt=Math.max(Math.min(ot[0],ot[2]),Math.min(ct[0],ct[2])),Vt=Math.min(Math.max(ot[0],ot[2]),Math.max(ct[0],ct[2]));if(Tt>Vt)return null;const Wt=Math.max(Math.min(ot[1],ot[3]),Math.min(ct[1],ct[3])),U=Math.min(Math.max(ot[1],ot[3]),Math.max(ct[1],ct[3]));return Wt>U?null:[Tt,Wt,Vt,U]}static bezierBoundingBox(ot,ct,Tt,Vt,Wt,U,gt,Rt){const Mt=[],Nt=[[],[]];let jt,N,C,X,ht,pt,bt,_t;for(let Ht=0;Ht<2;++Ht){if(Ht===0?(N=6*ot-12*Tt+6*Wt,jt=-3*ot+9*Tt-9*Wt+3*gt,C=3*Tt-3*ot):(N=6*ct-12*Vt+6*U,jt=-3*ct+9*Vt-9*U+3*Rt,C=3*Vt-3*ct),Math.abs(jt)<1e-12){if(Math.abs(N)<1e-12)continue;X=-C/N,0<X&&X<1&&Mt.push(X);continue}bt=N*N-4*C*jt,_t=Math.sqrt(bt),!(bt<0)&&(ht=(-N+_t)/(2*jt),0<ht&&ht<1&&Mt.push(ht),pt=(-N-_t)/(2*jt),0<pt&&pt<1&&Mt.push(pt))}let Dt=Mt.length,kt;const Ct=Dt;for(;Dt--;)X=Mt[Dt],kt=1-X,Nt[0][Dt]=kt*kt*kt*ot+3*kt*kt*X*Tt+3*kt*X*X*Wt+X*X*X*gt,Nt[1][Dt]=kt*kt*kt*ct+3*kt*kt*X*Vt+3*kt*X*X*U+X*X*X*Rt;return Nt[0][Ct]=ot,Nt[1][Ct]=ct,Nt[0][Ct+1]=gt,Nt[1][Ct+1]=Rt,Nt[0].length=Nt[1].length=Ct+2,[Math.min(...Nt[0]),Math.min(...Nt[1]),Math.max(...Nt[0]),Math.max(...Nt[1])]}}c.Util=V;const nt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ft(Et){if(Et[0]>="ï"){let ct;if(Et[0]==="þ"&&Et[1]==="ÿ"?ct="utf-16be":Et[0]==="ÿ"&&Et[1]==="þ"?ct="utf-16le":Et[0]==="ï"&&Et[1]==="»"&&Et[2]==="¿"&&(ct="utf-8"),ct)try{const Tt=new TextDecoder(ct,{fatal:!0}),Vt=ut(Et);return Tt.decode(Vt)}catch(Tt){$(`stringToPDFString: "${Tt}".`)}}const ot=[];for(let ct=0,Tt=Et.length;ct<Tt;ct++){const Vt=nt[Et.charCodeAt(ct)];ot.push(Vt?String.fromCharCode(Vt):Et.charAt(ct))}return ot.join("")}function vt(Et){return decodeURIComponent(escape(Et))}function At(Et){return unescape(encodeURIComponent(Et))}function Q(Et){return typeof Et=="object"&&(Et==null?void 0:Et.byteLength)!==void 0}function wt(Et,ot){if(Et.length!==ot.length)return!1;for(let ct=0,Tt=Et.length;ct<Tt;ct++)if(Et[ct]!==ot[ct])return!1;return!0}function St(Et=new Date){return[Et.getUTCFullYear().toString(),(Et.getUTCMonth()+1).toString().padStart(2,"0"),Et.getUTCDate().toString().padStart(2,"0"),Et.getUTCHours().toString().padStart(2,"0"),Et.getUTCMinutes().toString().padStart(2,"0"),Et.getUTCSeconds().toString().padStart(2,"0")].join("")}class Bt{constructor(){at(this,Xt,!1);this.promise=new Promise((ot,ct)=>{this.resolve=Tt=>{lt(this,Xt,!0),ot(Tt)},this.reject=Tt=>{lt(this,Xt,!0),ct(Tt)}})}get settled(){return t(this,Xt)}}Xt=new WeakMap,c.PromiseCapability=Bt;let Ot=null,Gt=null;function Pt(Et){return Ot||(Ot=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Gt=new Map([["ﬅ","ſt"]])),Et.replaceAll(Ot,(ot,ct,Tt)=>ct?ct.normalize("NFKC"):Gt.get(Tt))}function Lt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Et=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Et);else for(let ot=0;ot<32;ot++)Et[ot]=Math.floor(Math.random()*255);return dt(Et)}const zt="pdfjs_internal_id_";c.AnnotationPrefix=zt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var L,G,o,b,re,be,tt,O,E,d,j,T,x,m,v,ye,u,y,Me,_,h;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(s){if(typeof s=="string"||s instanceof URL?s={url:s}:(0,_util.isArrayBuffer)(s)&&(s={data:s}),typeof s!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!s.url&&!s.data&&!s.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:a}=l,w=s.url?getUrlProp(s.url):null,r=s.data?getDataProp(s.data):null,g=s.httpHeaders||null,S=s.withCredentials===!0,J=s.password??null,H=s.range instanceof PDFDataRangeTransport?s.range:null,Y=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let $=s.worker instanceof PDFWorker?s.worker:null;const rt=s.verbosity,P=typeof s.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(s.docBaseUrl)?s.docBaseUrl:null,W=typeof s.cMapUrl=="string"?s.cMapUrl:null,Z=s.cMapPacked!==!1,R=s.CMapReaderFactory||DefaultCMapReaderFactory,n=typeof s.standardFontDataUrl=="string"?s.standardFontDataUrl:null,i=s.StandardFontDataFactory||DefaultStandardFontDataFactory,p=s.stopAtErrors!==!0,k=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,F=s.isEvalSupported!==!1,I=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!_util.isNodeJS,z=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,et=typeof s.disableFontFace=="boolean"?s.disableFontFace:_util.isNodeJS,dt=s.fontExtraProperties===!0,ut=s.enableXfa===!0,mt=s.ownerDocument||globalThis.document,yt=s.disableRange===!0,xt=s.disableStream===!0,st=s.disableAutoFetch===!0,it=s.pdfBug===!0,A=H?H.length:s.length??NaN,M=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!_util.isNodeJS&&!et,V=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:R===_display_utils.DOMCMapReaderFactory&&i===_display_utils.DOMStandardFontDataFactory&&W&&n&&(0,_display_utils.isValidFetchUrl)(W,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(n,document.baseURI),nt=s.canvasFactory||new DefaultCanvasFactory({ownerDocument:mt}),ft=s.filterFactory||new DefaultFilterFactory({docId:a,ownerDocument:mt}),vt=null;(0,_util.setVerbosityLevel)(rt);const At={canvasFactory:nt,filterFactory:ft};if(V||(At.cMapReaderFactory=new R({baseUrl:W,isCompressed:Z}),At.standardFontDataFactory=new i({baseUrl:n})),!$){const St={verbosity:rt,port:_worker_options.GlobalWorkerOptions.workerPort};$=St.port?PDFWorker.fromPort(St):new PDFWorker(St),l._worker=$}const Q={docId:a,apiVersion:"3.11.174",data:r,password:J,disableAutoFetch:st,rangeChunkSize:Y,length:A,docBaseUrl:P,enableXfa:ut,evaluatorOptions:{maxImageSize:k,disableFontFace:et,ignoreErrors:p,isEvalSupported:F,isOffscreenCanvasSupported:I,canvasMaxAreaInBytes:z,fontExtraProperties:dt,useSystemFonts:M,cMapUrl:V?W:null,standardFontDataUrl:V?n:null}},wt={ignoreErrors:p,isEvalSupported:F,disableFontFace:et,fontExtraProperties:dt,enableXfa:ut,ownerDocument:mt,disableAutoFetch:st,pdfBug:it,styleElement:vt};return $.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const St=_fetchDocument($,Q),Bt=new Promise(function(Ot){let Gt;H?Gt=new _transport_stream.PDFDataTransportStream({length:A,initialData:H.initialData,progressiveDone:H.progressiveDone,contentDispositionFilename:H.contentDispositionFilename,disableRange:yt,disableStream:xt},H):r||(Gt=(Lt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Lt):(0,_display_utils.isValidFetchUrl)(Lt.url)?new _displayFetch_stream.PDFFetchStream(Lt):new _displayNetwork.PDFNetworkStream(Lt))({url:w,length:A,httpHeaders:g,withCredentials:S,rangeChunkSize:Y,disableRange:yt,disableStream:xt})),Ot(Gt)});return Promise.all([St,Bt]).then(function([Ot,Gt]){if(l.destroyed)throw new Error("Loading aborted");const Pt=new _message_handler.MessageHandler(a,Ot,$.port),Lt=new WorkerTransport(Pt,l,Gt,wt,At);l._transport=Lt,Pt.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(s,l){if(s.destroyed)throw new Error("Worker was destroyed");const a=await s.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(s.destroyed)throw new Error("Worker was destroyed");return a}function getUrlProp(s){if(s instanceof URL)return s.href;try{return new URL(s,window.location).href}catch{if(_util.isNodeJS&&typeof s=="string")return s}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(s){if(_util.isNodeJS&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return(0,_util.stringToBytes)(s);if(typeof s=="object"&&!isNaN(s==null?void 0:s.length)||(0,_util.isArrayBuffer)(s))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const c=class c{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${he(c,L)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var l,a,w;this.destroyed=!0;try{(l=this._worker)!=null&&l.port&&(this._worker._pendingDestroy=!0),await((a=this._transport)==null?void 0:a.destroy())}catch(r){throw(w=this._worker)!=null&&w.port&&delete this._worker._pendingDestroy,r}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};L=new WeakMap,at(c,L,0);let PDFDocumentLoadingTask=c;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,a,w=!1,r=null){this.length=l,this.initialData=a,this.progressiveDone=w,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,a){for(const w of this._rangeListeners)w(l,a)}onDataProgress(l,a){this._readyCapability.promise.then(()=>{for(const w of this._progressListeners)w(l,a)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const a of this._progressiveReadListeners)a(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,a){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,a){this._pdfInfo=l,this._transport=a,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(w=>{if(!w)return w;const r=[];for(const g in w)r.push(...w[g]);return r}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,a,w,r=!1){at(this,b);at(this,G,null);at(this,o,!1);this._pageIndex=l,this._pageInfo=a,this._transport=w,this._stats=r?new _display_utils.StatTimer:null,this._pdfBug=r,this.commonObjs=w.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:a=this.rotate,offsetX:w=0,offsetY:r=0,dontFlip:g=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:a,offsetX:w,offsetY:r,dontFlip:g})}getAnnotations({intent:l="display"}={}){const a=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,a.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:a,intent:w="display",annotationMode:r=_util.AnnotationMode.ENABLE,transform:g=null,background:S=null,optionalContentConfigPromise:J=null,annotationCanvasMap:H=null,pageColors:Y=null,printAnnotationStorage:$=null}){var i,p;(i=this._stats)==null||i.time("Overall");const rt=this._transport.getRenderingIntent(w,r,$);lt(this,o,!1),K(this,b,be).call(this),J||(J=this._transport.getOptionalContentConfig());let P=this._intentStates.get(rt.cacheKey);P||(P=Object.create(null),this._intentStates.set(rt.cacheKey,P)),P.streamReaderCancelTimeout&&(clearTimeout(P.streamReaderCancelTimeout),P.streamReaderCancelTimeout=null);const W=!!(rt.renderingIntent&_util.RenderingIntentFlag.PRINT);P.displayReadyCapability||(P.displayReadyCapability=new _util.PromiseCapability,P.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(p=this._stats)==null||p.time("Page Request"),this._pumpOperatorList(rt));const Z=k=>{var F,I;P.renderTasks.delete(R),(this._maybeCleanupAfterRender||W)&&lt(this,o,!0),K(this,b,re).call(this,!W),k?(R.capability.reject(k),this._abortOperatorList({intentState:P,reason:k instanceof Error?k:new Error(k)})):R.capability.resolve(),(F=this._stats)==null||F.timeEnd("Rendering"),(I=this._stats)==null||I.timeEnd("Overall")},R=new InternalRenderTask({callback:Z,params:{canvasContext:l,viewport:a,transform:g,background:S},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:H,operatorList:P.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!W,pdfBug:this._pdfBug,pageColors:Y});(P.renderTasks||(P.renderTasks=new Set)).add(R);const n=R.task;return Promise.all([P.displayReadyCapability.promise,J]).then(([k,F])=>{var I;if(this.destroyed){Z();return}(I=this._stats)==null||I.time("Rendering"),R.initializeGraphics({transparency:k,optionalContentConfig:F}),R.operatorListChanged()}).catch(Z),n}getOperatorList({intent:l="display",annotationMode:a=_util.AnnotationMode.ENABLE,printAnnotationStorage:w=null}={}){var H;function r(){S.operatorList.lastChunk&&(S.opListReadCapability.resolve(S.operatorList),S.renderTasks.delete(J))}const g=this._transport.getRenderingIntent(l,a,w,!0);let S=this._intentStates.get(g.cacheKey);S||(S=Object.create(null),this._intentStates.set(g.cacheKey,S));let J;return S.opListReadCapability||(J=Object.create(null),J.operatorListChanged=r,S.opListReadCapability=new _util.PromiseCapability,(S.renderTasks||(S.renderTasks=new Set)).add(J),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(H=this._stats)==null||H.time("Page Request"),this._pumpOperatorList(g)),S.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1,disableNormalization:a=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0,disableNormalization:a===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(w=>_xfa_text.XfaText.textContent(w));const a=this.streamTextContent(l);return new Promise(function(w,r){function g(){S.read().then(function({value:H,done:Y}){if(Y){w(J);return}Object.assign(J.styles,H.styles),J.items.push(...H.items),g()},r)}const S=a.getReader(),J={items:[],styles:Object.create(null)};g()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const a of this._intentStates.values())if(this._abortOperatorList({intentState:a,reason:new Error("Page was destroyed."),force:!0}),!a.opListReadCapability)for(const w of a.renderTasks)l.push(w.completed),w.cancel();return this.objs.clear(),lt(this,o,!1),K(this,b,be).call(this),Promise.all(l)}cleanup(l=!1){lt(this,o,!0);const a=K(this,b,re).call(this,!1);return l&&a&&this._stats&&(this._stats=new _display_utils.StatTimer),a}_startRenderPage(l,a){var r,g;const w=this._intentStates.get(a);w&&((r=this._stats)==null||r.timeEnd("Page Request"),(g=w.displayReadyCapability)==null||g.resolve(l))}_renderPageChunk(l,a){for(let w=0,r=l.length;w<r;w++)a.operatorList.fnArray.push(l.fnArray[w]),a.operatorList.argsArray.push(l.argsArray[w]);a.operatorList.lastChunk=l.lastChunk,a.operatorList.separateAnnots=l.separateAnnots;for(const w of a.renderTasks)w.operatorListChanged();l.lastChunk&&K(this,b,re).call(this,!0)}_pumpOperatorList({renderingIntent:l,cacheKey:a,annotationStorageSerializable:w}){const{map:r,transfers:g}=w,J=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:a,annotationStorage:r},g).getReader(),H=this._intentStates.get(a);H.streamReader=J;const Y=()=>{J.read().then(({value:$,done:rt})=>{if(rt){H.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk($,H),Y())},$=>{if(H.streamReader=null,!this._transport.destroyed){if(H.operatorList){H.operatorList.lastChunk=!0;for(const rt of H.renderTasks)rt.operatorListChanged();K(this,b,re).call(this,!0)}if(H.displayReadyCapability)H.displayReadyCapability.reject($);else if(H.opListReadCapability)H.opListReadCapability.reject($);else throw $}})};Y()}_abortOperatorList({intentState:l,reason:a,force:w=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!w){if(l.renderTasks.size>0)return;if(a instanceof _display_utils.RenderingCancelledException){let r=RENDERING_CANCELLED_TIMEOUT;a.extraDelay>0&&a.extraDelay<1e3&&(r+=a.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:a,force:!0})},r);return}}if(l.streamReader.cancel(new _util.AbortException(a.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[r,g]of this._intentStates)if(g===l){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}G=new WeakMap,o=new WeakMap,b=new WeakSet,re=function(l=!1){if(K(this,b,be).call(this),!t(this,o)||this.destroyed)return!1;if(l)return lt(this,G,setTimeout(()=>{lt(this,G,null),K(this,b,re).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:a,operatorList:w}of this._intentStates.values())if(a.size>0||!w.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),lt(this,o,!1),!0},be=function(){t(this,G)&&(clearTimeout(t(this,G)),lt(this,G,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){at(this,tt,new Set);at(this,O,Promise.resolve())}postMessage(l,a){const w={data:structuredClone(l,a?{transfer:a}:null)};t(this,O).then(()=>{for(const r of t(this,tt))r.call(this,w)})}addEventListener(l,a){t(this,tt).add(a)}removeEventListener(l,a){t(this,tt).delete(a)}terminate(){t(this,tt).clear()}}tt=new WeakMap,O=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const s=(E=document==null?void 0:document.currentScript)==null?void 0:E.src;s&&(PDFWorkerUtil.fallbackWorkerSrc=s.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(s,l){let a;try{if(a=new URL(s),!a.origin||a.origin==="null")return!1}catch{return!1}const w=new URL(l,a);return a.origin===w.origin},PDFWorkerUtil.createCDNWrapper=function(s){const l=`importScripts("${s}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class _PDFWorker{constructor({name:s=null,port:l=null,verbosity:a=(0,_util.getVerbosityLevel)()}={}){var w;if(this.name=s,this.destroyed=!1,this.verbosity=a,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){if((w=t(_PDFWorker,d))!=null&&w.has(l))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,d)||lt(_PDFWorker,d,new WeakMap)).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new _message_handler.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:s}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,s)||(s=PDFWorkerUtil.createCDNWrapper(new URL(s,window.location).href));const l=new Worker(s),a=new _message_handler.MessageHandler("main","worker",l),w=()=>{l.removeEventListener("error",r),a.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=()=>{this._webWorker||w()};l.addEventListener("error",r),a.on("test",S=>{if(l.removeEventListener("error",r),this.destroyed){w();return}S?(this._messageHandler=a,this._port=l,this._webWorker=l,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),a.destroy(),l.terminate())}),a.on("ready",S=>{if(l.removeEventListener("error",r),this.destroyed){w();return}try{g()}catch{this._setupFakeWorker()}});const g=()=>{const S=new Uint8Array;a.send("test",S,[S.buffer])};g();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const a=`fake${PDFWorkerUtil.fakeWorkerId++}`,w=new _message_handler.MessageHandler(a+"_worker",a,l);s.setup(w,l);const r=new _message_handler.MessageHandler(a,a+"_worker",l);this._messageHandler=r,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){var s;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(s=t(_PDFWorker,d))==null||s.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){var a;if(!(s!=null&&s.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const l=(a=t(this,d))==null?void 0:a.get(s.port);if(l){if(l._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return l}return new _PDFWorker(s)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var s;try{return((s=globalThis.pdfjsWorker)==null?void 0:s.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};d=new WeakMap,at(_PDFWorker,d);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(l,a,w,r,g){at(this,v);at(this,j,new Map);at(this,T,new Map);at(this,x,new Map);at(this,m,null);this.messageHandler=l,this.loadingTask=a,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this._params=r,this.canvasFactory=g.canvasFactory,this.filterFactory=g.filterFactory,this.cMapReaderFactory=g.cMapReaderFactory,this.standardFontDataFactory=g.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=w,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,a=_util.AnnotationMode.ENABLE,w=null,r=!1){let g=_util.RenderingIntentFlag.DISPLAY,S=_annotation_storage.SerializableEmpty;switch(l){case"any":g=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":g=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(a){case _util.AnnotationMode.DISABLE:g+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:g+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:g+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,S=(g&_util.RenderingIntentFlag.PRINT&&w instanceof _annotation_storage.PrintAnnotationStorage?w:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${a}`)}return r&&(g+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:g,cacheKey:`${g}_${S.hash}`,annotationStorageSerializable:S}}destroy(){var w;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(w=t(this,m))==null||w.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const r of t(this,T).values())l.push(r._destroy());t(this,T).clear(),t(this,x).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const a=this.messageHandler.sendWithPromise("Terminate",null);return l.push(a),Promise.all(l).then(()=>{var r;this.commonObjs.clear(),this.fontLoader.clear(),t(this,j).clear(),this.filterFactory.destroy(),(r=this._networkStream)==null||r.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:a}=this;l.on("GetReader",(w,r)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=g=>{this._lastProgress={loaded:g.loaded,total:g.total}},r.onPull=()=>{this._fullReader.read().then(function({value:g,done:S}){if(S){r.close();return}(0,_util.assert)(g instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(g),1,[g])}).catch(g=>{r.error(g)})},r.onCancel=g=>{this._fullReader.cancel(g),r.ready.catch(S=>{if(!this.destroyed)throw S})}}),l.on("ReaderHeadersReady",w=>{const r=new _util.PromiseCapability,g=this._fullReader;return g.headersReady.then(()=>{var S;(!g.isStreamingSupported||!g.isRangeSupported)&&(this._lastProgress&&((S=a.onProgress)==null||S.call(a,this._lastProgress)),g.onProgress=J=>{var H;(H=a.onProgress)==null||H.call(a,{loaded:J.loaded,total:J.total})}),r.resolve({isStreamingSupported:g.isStreamingSupported,isRangeSupported:g.isRangeSupported,contentLength:g.contentLength})},r.reject),r.promise}),l.on("GetRangeReader",(w,r)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const g=this._networkStream.getRangeReader(w.begin,w.end);if(!g){r.close();return}r.onPull=()=>{g.read().then(function({value:S,done:J}){if(J){r.close();return}(0,_util.assert)(S instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(S),1,[S])}).catch(S=>{r.error(S)})},r.onCancel=S=>{g.cancel(S),r.ready.catch(J=>{if(!this.destroyed)throw J})}}),l.on("GetDoc",({pdfInfo:w})=>{this._numPages=w.numPages,this._htmlForXfa=w.htmlForXfa,delete w.htmlForXfa,a._capability.resolve(new PDFDocumentProxy(w,this))}),l.on("DocException",function(w){let r;switch(w.name){case"PasswordException":r=new _util.PasswordException(w.message,w.code);break;case"InvalidPDFException":r=new _util.InvalidPDFException(w.message);break;case"MissingPDFException":r=new _util.MissingPDFException(w.message);break;case"UnexpectedResponseException":r=new _util.UnexpectedResponseException(w.message,w.status);break;case"UnknownErrorException":r=new _util.UnknownErrorException(w.message,w.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}a._capability.reject(r)}),l.on("PasswordRequest",w=>{if(lt(this,m,new _util.PromiseCapability),a.onPassword){const r=g=>{g instanceof Error?t(this,m).reject(g):t(this,m).resolve({password:g})};try{a.onPassword(r,w.code)}catch(g){t(this,m).reject(g)}}else t(this,m).reject(new _util.PasswordException(w.message,w.code));return t(this,m).promise}),l.on("DataLoaded",w=>{var r;(r=a.onProgress)==null||r.call(a,{loaded:w.length,total:w.length}),this.downloadInfoCapability.resolve(w)}),l.on("StartRenderPage",w=>{if(this.destroyed)return;t(this,T).get(w.pageIndex)._startRenderPage(w.transparency,w.cacheKey)}),l.on("commonobj",([w,r,g])=>{var S;if(!this.destroyed&&!this.commonObjs.has(w))switch(r){case"Font":const J=this._params;if("error"in g){const $=g.error;(0,_util.warn)(`Error during font loading: ${$}`),this.commonObjs.resolve(w,$);break}const H=J.pdfBug&&((S=globalThis.FontInspector)!=null&&S.enabled)?($,rt)=>globalThis.FontInspector.fontAdded($,rt):null,Y=new _font_loader.FontFaceObject(g,{isEvalSupported:J.isEvalSupported,disableFontFace:J.disableFontFace,ignoreErrors:J.ignoreErrors,inspectFont:H});this.fontLoader.bind(Y).catch($=>l.sendWithPromise("FontFallback",{id:w})).finally(()=>{!J.fontExtraProperties&&Y.data&&(Y.data=null),this.commonObjs.resolve(w,Y)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(w,g);break;default:throw new Error(`Got unknown common object type ${r}`)}}),l.on("obj",([w,r,g,S])=>{var H;if(this.destroyed)return;const J=t(this,T).get(r);if(!J.objs.has(w))switch(g){case"Image":if(J.objs.resolve(w,S),S){let Y;if(S.bitmap){const{width:$,height:rt}=S;Y=$*rt*4}else Y=((H=S.data)==null?void 0:H.length)||0;Y>_util.MAX_IMAGE_SIZE_TO_CACHE&&(J._maybeCleanupAfterRender=!0)}break;case"Pattern":J.objs.resolve(w,S);break;default:throw new Error(`Got unknown object type ${g}`)}}),l.on("DocProgress",w=>{var r;this.destroyed||(r=a.onProgress)==null||r.call(a,{loaded:w.loaded,total:w.total})}),l.on("FetchBuiltInCMap",w=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(w):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",w=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(w):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var w;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:l,transfers:a}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:l,filename:((w=this._fullReader)==null?void 0:w.filename)??null},a).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const a=l-1,w=t(this,x).get(a);if(w)return w;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:a}).then(g=>{if(this.destroyed)throw new Error("Transport destroyed");const S=new PDFPageProxy(a,g,this,this._params.pdfBug);return t(this,T).set(a,S),S});return t(this,x).set(a,r),r}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,a){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:a})}getFieldObjects(){return K(this,v,ye).call(this,"GetFieldObjects")}hasJSActions(){return K(this,v,ye).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return K(this,v,ye).call(this,"GetDocJSActions")}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",a=t(this,j).get(l);if(a)return a;const w=this.messageHandler.sendWithPromise(l,null).then(r=>{var g,S;return{info:r[0],metadata:r[1]?new _metadata.Metadata(r[1]):null,contentDispositionFilename:((g=this._fullReader)==null?void 0:g.filename)??null,contentLength:((S=this._fullReader)==null?void 0:S.contentLength)??null}});return t(this,j).set(l,w),w}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const a of t(this,T).values())if(!a.cleanup())throw new Error(`startCleanup: Page ${a.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),t(this,j).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:a}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:a})}}j=new WeakMap,T=new WeakMap,x=new WeakMap,m=new WeakMap,v=new WeakSet,ye=function(l,a=null){const w=t(this,j).get(l);if(w)return w;const r=this.messageHandler.sendWithPromise(l,a);return t(this,j).set(l,r),r};class PDFObjects{constructor(){at(this,y);at(this,u,Object.create(null))}get(l,a=null){if(a){const r=K(this,y,Me).call(this,l);return r.capability.promise.then(()=>a(r.data)),null}const w=t(this,u)[l];if(!(w!=null&&w.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return w.data}has(l){const a=t(this,u)[l];return(a==null?void 0:a.capability.settled)||!1}resolve(l,a=null){const w=K(this,y,Me).call(this,l);w.data=a,w.capability.resolve()}clear(){var l;for(const a in t(this,u)){const{data:w}=t(this,u)[a];(l=w==null?void 0:w.bitmap)==null||l.close()}lt(this,u,Object.create(null))}}u=new WeakMap,y=new WeakSet,Me=function(l){var a;return(a=t(this,u))[l]||(a[l]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(l){at(this,_,null);lt(this,_,l),this.onContinue=null}get promise(){return t(this,_).capability.promise}cancel(l=0){t(this,_).cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=t(this,_).operatorList;if(!l)return!1;const{annotationCanvasMap:a}=t(this,_);return l.form||l.canvas&&(a==null?void 0:a.size)>0}}_=new WeakMap,exports.RenderTask=RenderTask;const e=class e{constructor({callback:l,params:a,objs:w,commonObjs:r,annotationCanvasMap:g,operatorList:S,pageIndex:J,canvasFactory:H,filterFactory:Y,useRequestAnimationFrame:$=!1,pdfBug:rt=!1,pageColors:P=null}){this.callback=l,this.params=a,this.objs=w,this.commonObjs=r,this.annotationCanvasMap=g,this.operatorListIdx=null,this.operatorList=S,this._pageIndex=J,this.canvasFactory=H,this.filterFactory=Y,this._pdfBug=rt,this.pageColors=P,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=$===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=a.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:a}){var J,H;if(this.cancelled)return;if(this._canvas){if(t(e,h).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(e,h).add(this._canvas)}this._pdfBug&&((J=globalThis.StepperManager)!=null&&J.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:w,viewport:r,transform:g,background:S}=this.params;this.gfx=new _canvas.CanvasGraphics(w,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:a},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:g,viewport:r,transparency:l,background:S}),this.operatorListIdx=0,this.graphicsReady=!0,(H=this.graphicsReadyCallback)==null||H.call(this)}cancel(l=null,a=0){var w;this.running=!1,this.cancelled=!0,(w=this.gfx)==null||w.endDrawing(),t(e,h).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,a))}operatorListChanged(){var l;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(l=this.stepper)==null||l.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(e,h).delete(this._canvas),this.callback())))}};h=new WeakMap,at(e,h,new WeakSet);let InternalRenderTask=e;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(L,c,G)=>{var E,d,j,ms,x;Object.defineProperty(c,"__esModule",{value:!0}),c.SerializableEmpty=c.PrintAnnotationStorage=c.AnnotationStorage=void 0;var o=G(1),b=G(4),q=G(8);const B=Object.freeze({map:null,hash:"",transfers:void 0});c.SerializableEmpty=B;class tt{constructor(){at(this,j);at(this,E,!1);at(this,d,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(v,f){const u=t(this,d).get(v);return u===void 0?f:Object.assign(f,u)}getRawValue(v){return t(this,d).get(v)}remove(v){if(t(this,d).delete(v),t(this,d).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of t(this,d).values())if(f instanceof b.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(v,f){const u=t(this,d).get(v);let y=!1;if(u!==void 0)for(const[D,_]of Object.entries(f))u[D]!==_&&(y=!0,u[D]=_);else y=!0,t(this,d).set(v,f);y&&K(this,j,ms).call(this),f instanceof b.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(v){return t(this,d).has(v)}getAll(){return t(this,d).size>0?(0,o.objectFromMap)(t(this,d)):null}setAll(v){for(const[f,u]of Object.entries(v))this.setValue(f,u)}get size(){return t(this,d).size}resetModified(){t(this,E)&&(lt(this,E,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new O(this)}get serializable(){if(t(this,d).size===0)return B;const v=new Map,f=new q.MurmurHash3_64,u=[],y=Object.create(null);let D=!1;for(const[_,h]of t(this,d)){const e=h instanceof b.AnnotationEditor?h.serialize(!1,y):h;e&&(v.set(_,e),f.update(`${_}:${JSON.stringify(e)}`),D||(D=!!e.bitmap))}if(D)for(const _ of v.values())_.bitmap&&u.push(_.bitmap);return v.size>0?{map:v,hash:f.hexdigest(),transfers:u}:B}}E=new WeakMap,d=new WeakMap,j=new WeakSet,ms=function(){t(this,E)||(lt(this,E,!0),typeof this.onSetModified=="function"&&this.onSetModified())},c.AnnotationStorage=tt;class O extends tt{constructor(f){super();at(this,x);const{map:u,hash:y,transfers:D}=f.serializable,_=structuredClone(u,D?{transfer:D}:null);lt(this,x,{map:_,hash:y,transfers:D})}get print(){(0,o.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,x)}}x=new WeakMap,c.PrintAnnotationStorage=O},(L,c,G)=>{var O,E,d,j,T,x,m,v,f,u,y,D,_,h,e,De,Ie,a,Ne,Le,gs,xs,bs,Oe,ys;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationEditor=void 0;var o=G(5),b=G(1),q=G(6);const $=class ${constructor(P){at(this,e);at(this,O,"");at(this,E,!1);at(this,d,null);at(this,j,null);at(this,T,null);at(this,x,!1);at(this,m,null);at(this,v,this.focusin.bind(this));at(this,f,this.focusout.bind(this));at(this,u,!1);at(this,y,!1);at(this,D,!1);Kt(this,"_initialOptions",Object.create(null));Kt(this,"_uiManager",null);Kt(this,"_focusEventsAllowed",!0);Kt(this,"_l10nPromise",null);at(this,_,!1);at(this,h,$._zIndex++);this.constructor===$&&(0,b.unreachable)("Cannot initialize AnnotationEditor."),this.parent=P.parent,this.id=P.id,this.width=this.height=null,this.pageIndex=P.parent.pageIndex,this.name=P.name,this.div=null,this._uiManager=P.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=P.isCentered,this._structTreeParentId=null;const{rotation:W,rawDims:{pageWidth:Z,pageHeight:R,pageX:n,pageY:i}}=this.parent.viewport;this.rotation=W,this.pageRotation=(360+W-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Z,R],this.pageTranslation=[n,i];const[p,k]=this.parentDimensions;this.x=P.x/p,this.y=P.y/k,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,b.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(P){const W=new tt({id:P.parent.getNextId(),parent:P.parent,uiManager:P._uiManager});W.annotationElementId=P.annotationElementId,W.deleted=!0,W._uiManager.addToAnnotationStorage(W)}static initialize(P,W=null){if($._l10nPromise||($._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(R=>[R,P.get(R)]))),W!=null&&W.strings)for(const R of W.strings)$._l10nPromise.set(R,P.get(R));if($._borderLineWidth!==-1)return;const Z=getComputedStyle(document.documentElement);$._borderLineWidth=parseFloat(Z.getPropertyValue("--outline-width"))||0}static updateDefaultParams(P,W){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(P){return!1}static paste(P,W){(0,b.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,_)}set _isDraggable(P){var W;lt(this,_,P),(W=this.div)==null||W.classList.toggle("draggable",P)}center(){const[P,W]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*W/(P*2),this.y+=this.width*P/(W*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*W/(P*2),this.y-=this.width*P/(W*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(P){this._uiManager.addCommands(P)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,h)}setParent(P){P!==null&&(this.pageIndex=P.pageIndex,this.pageDimensions=P.pageDimensions),this.parent=P}focusin(P){this._focusEventsAllowed&&(t(this,u)?lt(this,u,!1):this.parent.setSelected(this))}focusout(P){var Z;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const W=P.relatedTarget;W!=null&&W.closest(`#${this.id}`)||(P.preventDefault(),(Z=this.parent)!=null&&Z.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(P,W,Z,R){const[n,i]=this.parentDimensions;[Z,R]=this.screenToPageTranslation(Z,R),this.x=(P+Z)/n,this.y=(W+R)/i,this.fixAndSetPosition()}translate(P,W){K(this,e,De).call(this,this.parentDimensions,P,W)}translateInPage(P,W){K(this,e,De).call(this,this.pageDimensions,P,W),this.div.scrollIntoView({block:"nearest"})}drag(P,W){const[Z,R]=this.parentDimensions;if(this.x+=P/Z,this.y+=W/R,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:F,y:I}=this.div.getBoundingClientRect();this.parent.findNewParent(this,F,I)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:n,y:i}=this;const[p,k]=K(this,e,Ie).call(this);n+=p,i+=k,this.div.style.left=`${(100*n).toFixed(2)}%`,this.div.style.top=`${(100*i).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[P,W]=this.pageDimensions;let{x:Z,y:R,width:n,height:i}=this;switch(n*=P,i*=W,Z*=P,R*=W,this.rotation){case 0:Z=Math.max(0,Math.min(P-n,Z)),R=Math.max(0,Math.min(W-i,R));break;case 90:Z=Math.max(0,Math.min(P-i,Z)),R=Math.min(W,Math.max(n,R));break;case 180:Z=Math.min(P,Math.max(n,Z)),R=Math.min(W,Math.max(i,R));break;case 270:Z=Math.min(P,Math.max(i,Z)),R=Math.max(0,Math.min(W-n,R));break}this.x=Z/=P,this.y=R/=W;const[p,k]=K(this,e,Ie).call(this);Z+=p,R+=k;const{style:F}=this.div;F.left=`${(100*Z).toFixed(2)}%`,F.top=`${(100*R).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(P,W){var Z;return K(Z=$,a,Ne).call(Z,P,W,this.parentRotation)}pageTranslationToScreen(P,W){var Z;return K(Z=$,a,Ne).call(Z,P,W,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:P,pageDimensions:[W,Z]}=this,R=W*P,n=Z*P;return b.FeatureTest.isCSSRoundSupported?[Math.round(R),Math.round(n)]:[R,n]}setDims(P,W){var n;const[Z,R]=this.parentDimensions;this.div.style.width=`${(100*P/Z).toFixed(2)}%`,t(this,x)||(this.div.style.height=`${(100*W/R).toFixed(2)}%`),(n=t(this,d))==null||n.classList.toggle("small",P<$.SMALL_EDITOR_SIZE||W<$.SMALL_EDITOR_SIZE)}fixDims(){const{style:P}=this.div,{height:W,width:Z}=P,R=Z.endsWith("%"),n=!t(this,x)&&W.endsWith("%");if(R&&n)return;const[i,p]=this.parentDimensions;R||(P.width=`${(100*parseFloat(Z)/i).toFixed(2)}%`),!t(this,x)&&!n&&(P.height=`${(100*parseFloat(W)/p).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,d))return;const P=lt(this,d,document.createElement("button"));P.className="altText";const W=await $._l10nPromise.get("editor_alt_text_button_label");P.textContent=W,P.setAttribute("aria-label",W),P.tabIndex="0",P.addEventListener("contextmenu",q.noContextMenu),P.addEventListener("pointerdown",Z=>Z.stopPropagation()),P.addEventListener("click",Z=>{Z.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),P.addEventListener("keydown",Z=>{Z.target===P&&Z.key==="Enter"&&(Z.preventDefault(),this._uiManager.editAltText(this))}),K(this,e,Oe).call(this),this.div.append(P),$.SMALL_EDITOR_SIZE||($.SMALL_EDITOR_SIZE=Math.min(128,Math.round(P.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,O),decorative:t(this,E)}}set altTextData({altText:P,decorative:W}){t(this,O)===P&&t(this,E)===W||(lt(this,O,P),lt(this,E,W),K(this,e,Oe).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,v)),this.div.addEventListener("focusout",t(this,f));const[P,W]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*W/P).toFixed(2)}%`,this.div.style.maxHeight=`${(100*P/W).toFixed(2)}%`);const[Z,R]=this.getInitialTranslation();return this.translate(Z,R),(0,o.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(P){const{isMac:W}=b.FeatureTest.platform;if(P.button!==0||P.ctrlKey&&W){P.preventDefault();return}lt(this,u,!0),K(this,e,ys).call(this,P)}moveInDOM(){var P;(P=this.parent)==null||P.moveEditorInDOM(this)}_setParentAndPosition(P,W,Z){P.changeParent(this),this.x=W,this.y=Z,this.fixAndSetPosition()}getRect(P,W){const Z=this.parentScale,[R,n]=this.pageDimensions,[i,p]=this.pageTranslation,k=P/Z,F=W/Z,I=this.x*R,z=this.y*n,et=this.width*R,dt=this.height*n;switch(this.rotation){case 0:return[I+k+i,n-z-F-dt+p,I+k+et+i,n-z-F+p];case 90:return[I+F+i,n-z+k+p,I+F+dt+i,n-z+k+et+p];case 180:return[I-k-et+i,n-z+F+p,I-k+i,n-z+F+dt+p];case 270:return[I-F-dt+i,n-z-k-et+p,I-F+i,n-z-k+p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(P,W){const[Z,R,n,i]=P,p=n-Z,k=i-R;switch(this.rotation){case 0:return[Z,W-i,p,k];case 90:return[Z,W-R,k,p];case 180:return[n,W-R,p,k];case 270:return[n,W-i,k,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){lt(this,D,!0)}disableEditMode(){lt(this,D,!1)}isInEditMode(){return t(this,D)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var P,W;(P=this.div)==null||P.addEventListener("focusin",t(this,v)),(W=this.div)==null||W.addEventListener("focusout",t(this,f))}serialize(P=!1,W=null){(0,b.unreachable)("An editor must be serializable")}static deserialize(P,W,Z){const R=new this.prototype.constructor({parent:W,id:W.getNextId(),uiManager:Z});R.rotation=P.rotation;const[n,i]=R.pageDimensions,[p,k,F,I]=R.getRectInCurrentCoords(P.rect,i);return R.x=p/n,R.y=k/i,R.width=F/n,R.height=I/i,R}remove(){var P;this.div.removeEventListener("focusin",t(this,v)),this.div.removeEventListener("focusout",t(this,f)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(P=t(this,d))==null||P.remove(),lt(this,d,null),lt(this,j,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(K(this,e,gs).call(this),t(this,m).classList.remove("hidden"))}select(){var P;this.makeResizable(),(P=this.div)==null||P.classList.add("selectedEditor")}unselect(){var P,W,Z;(P=t(this,m))==null||P.classList.add("hidden"),(W=this.div)==null||W.classList.remove("selectedEditor"),(Z=this.div)!=null&&Z.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(P,W){}disableEditing(){t(this,d)&&(t(this,d).hidden=!0)}enableEditing(){t(this,d)&&(t(this,d).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,y)}set isEditing(P){lt(this,y,P),this.parent&&(P?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(P,W){lt(this,x,!0);const Z=P/W,{style:R}=this.div;R.aspectRatio=Z,R.height="auto"}static get MIN_SIZE(){return 16}};O=new WeakMap,E=new WeakMap,d=new WeakMap,j=new WeakMap,T=new WeakMap,x=new WeakMap,m=new WeakMap,v=new WeakMap,f=new WeakMap,u=new WeakMap,y=new WeakMap,D=new WeakMap,_=new WeakMap,h=new WeakMap,e=new WeakSet,De=function([P,W],Z,R){[Z,R]=this.screenToPageTranslation(Z,R),this.x+=Z/P,this.y+=R/W,this.fixAndSetPosition()},Ie=function(){const[P,W]=this.parentDimensions,{_borderLineWidth:Z}=$,R=Z/P,n=Z/W;switch(this.rotation){case 90:return[-R,n];case 180:return[R,n];case 270:return[R,-n];default:return[-R,-n]}},a=new WeakSet,Ne=function(P,W,Z){switch(Z){case 90:return[W,-P];case 180:return[-P,-W];case 270:return[-W,P];default:return[P,W]}},Le=function(P){switch(P){case 90:{const[W,Z]=this.pageDimensions;return[0,-W/Z,Z/W,0]}case 180:return[-1,0,0,-1];case 270:{const[W,Z]=this.pageDimensions;return[0,W/Z,-Z/W,0]}default:return[1,0,0,1]}},gs=function(){if(t(this,m))return;lt(this,m,document.createElement("div")),t(this,m).classList.add("resizers");const P=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||P.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const W of P){const Z=document.createElement("div");t(this,m).append(Z),Z.classList.add("resizer",W),Z.addEventListener("pointerdown",K(this,e,xs).bind(this,W)),Z.addEventListener("contextmenu",q.noContextMenu)}this.div.prepend(t(this,m))},xs=function(P,W){W.preventDefault();const{isMac:Z}=b.FeatureTest.platform;if(W.button!==0||W.ctrlKey&&Z)return;const R=K(this,e,bs).bind(this,P),n=this._isDraggable;this._isDraggable=!1;const i={passive:!0,capture:!0};window.addEventListener("pointermove",R,i);const p=this.x,k=this.y,F=this.width,I=this.height,z=this.parent.div.style.cursor,et=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(W.target).cursor;const dt=()=>{this._isDraggable=n,window.removeEventListener("pointerup",dt),window.removeEventListener("blur",dt),window.removeEventListener("pointermove",R,i),this.parent.div.style.cursor=z,this.div.style.cursor=et;const ut=this.x,mt=this.y,yt=this.width,xt=this.height;ut===p&&mt===k&&yt===F&&xt===I||this.addCommands({cmd:()=>{this.width=yt,this.height=xt,this.x=ut,this.y=mt;const[st,it]=this.parentDimensions;this.setDims(st*yt,it*xt),this.fixAndSetPosition()},undo:()=>{this.width=F,this.height=I,this.x=p,this.y=k;const[st,it]=this.parentDimensions;this.setDims(st*F,it*I),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",dt),window.addEventListener("blur",dt)},bs=function(P,W){const[Z,R]=this.parentDimensions,n=this.x,i=this.y,p=this.width,k=this.height,F=$.MIN_SIZE/Z,I=$.MIN_SIZE/R,z=Pt=>Math.round(Pt*1e4)/1e4,et=K(this,e,Le).call(this,this.rotation),dt=(Pt,Lt)=>[et[0]*Pt+et[2]*Lt,et[1]*Pt+et[3]*Lt],ut=K(this,e,Le).call(this,360-this.rotation),mt=(Pt,Lt)=>[ut[0]*Pt+ut[2]*Lt,ut[1]*Pt+ut[3]*Lt];let yt,xt,st=!1,it=!1;switch(P){case"topLeft":st=!0,yt=(Pt,Lt)=>[0,0],xt=(Pt,Lt)=>[Pt,Lt];break;case"topMiddle":yt=(Pt,Lt)=>[Pt/2,0],xt=(Pt,Lt)=>[Pt/2,Lt];break;case"topRight":st=!0,yt=(Pt,Lt)=>[Pt,0],xt=(Pt,Lt)=>[0,Lt];break;case"middleRight":it=!0,yt=(Pt,Lt)=>[Pt,Lt/2],xt=(Pt,Lt)=>[0,Lt/2];break;case"bottomRight":st=!0,yt=(Pt,Lt)=>[Pt,Lt],xt=(Pt,Lt)=>[0,0];break;case"bottomMiddle":yt=(Pt,Lt)=>[Pt/2,Lt],xt=(Pt,Lt)=>[Pt/2,0];break;case"bottomLeft":st=!0,yt=(Pt,Lt)=>[0,Lt],xt=(Pt,Lt)=>[Pt,0];break;case"middleLeft":it=!0,yt=(Pt,Lt)=>[0,Lt/2],xt=(Pt,Lt)=>[Pt,Lt/2];break}const A=yt(p,k),M=xt(p,k);let V=dt(...M);const nt=z(n+V[0]),ft=z(i+V[1]);let vt=1,At=1,[Q,wt]=this.screenToPageTranslation(W.movementX,W.movementY);if([Q,wt]=mt(Q/Z,wt/R),st){const Pt=Math.hypot(p,k);vt=At=Math.max(Math.min(Math.hypot(M[0]-A[0]-Q,M[1]-A[1]-wt)/Pt,1/p,1/k),F/p,I/k)}else it?vt=Math.max(F,Math.min(1,Math.abs(M[0]-A[0]-Q)))/p:At=Math.max(I,Math.min(1,Math.abs(M[1]-A[1]-wt)))/k;const St=z(p*vt),Bt=z(k*At);V=dt(...xt(St,Bt));const Ot=nt-V[0],Gt=ft-V[1];this.width=St,this.height=Bt,this.x=Ot,this.y=Gt,this.setDims(Z*St,R*Bt),this.fixAndSetPosition()},Oe=async function(){var Z;const P=t(this,d);if(!P)return;if(!t(this,O)&&!t(this,E)){P.classList.remove("done"),(Z=t(this,j))==null||Z.remove();return}$._l10nPromise.get("editor_alt_text_edit_button_label").then(R=>{P.setAttribute("aria-label",R)});let W=t(this,j);if(!W){lt(this,j,W=document.createElement("span")),W.className="tooltip",W.setAttribute("role","tooltip");const R=W.id=`alt-text-tooltip-${this.id}`;P.setAttribute("aria-describedby",R);const n=100;P.addEventListener("mouseenter",()=>{lt(this,T,setTimeout(()=>{lt(this,T,null),t(this,j).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},n))}),P.addEventListener("mouseleave",()=>{var i;clearTimeout(t(this,T)),lt(this,T,null),(i=t(this,j))==null||i.classList.remove("show")})}P.classList.add("done"),W.innerText=t(this,E)?await $._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,O),W.parentNode||P.append(W)},ys=function(P){if(!this._isDraggable)return;const W=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Z,R;W&&(Z={passive:!0,capture:!0},R=i=>{const[p,k]=this.screenToPageTranslation(i.movementX,i.movementY);this._uiManager.dragSelectedEditors(p,k)},window.addEventListener("pointermove",R,Z));const n=()=>{if(window.removeEventListener("pointerup",n),window.removeEventListener("blur",n),W&&window.removeEventListener("pointermove",R,Z),lt(this,u,!1),!this._uiManager.endDragSession()){const{isMac:i}=b.FeatureTest.platform;P.ctrlKey&&!i||P.shiftKey||P.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",n),window.addEventListener("blur",n)},at($,a),Kt($,"_borderLineWidth",-1),Kt($,"_colorManager",new o.ColorManager),Kt($,"_zIndex",1),Kt($,"SMALL_EDITOR_SIZE",0);let B=$;c.AnnotationEditor=B;class tt extends B{constructor(P){super(P),this.annotationElementId=P.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(L,c,G)=>{var x,m,v,f,u,Ue,_,h,e,s,l,vs,r,g,S,J,H,Y,$,rt,P,W,Z,R,n,i,p,k,F,I,z,et,dt,ut,mt,yt,xt,st,it,A,M,V,nt,ft,vt,At,Q,As,Be,He,ve,$e,We,Zt,de,Es,_s,Ge,ue,Ve;Object.defineProperty(c,"__esModule",{value:!0}),c.KeyboardManager=c.CommandManager=c.ColorManager=c.AnnotationEditorUIManager=void 0,c.bindEvents=q,c.opacityToHex=B;var o=G(1),b=G(6);function q(Wt,U,gt){for(const Rt of gt)U.addEventListener(Rt,Wt[Rt].bind(Wt))}function B(Wt){return Math.round(Math.min(255,Math.max(1,255*Wt))).toString(16).padStart(2,"0")}class tt{constructor(){at(this,x,0)}getId(){return`${o.AnnotationEditorPrefix}${he(this,x)._++}`}}x=new WeakMap;const D=class D{constructor(){at(this,u);at(this,m,(0,o.getUuid)());at(this,v,0);at(this,f,null)}static get _isSVGFittingCanvas(){const U='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Rt=new OffscreenCanvas(1,3).getContext("2d"),Mt=new Image;Mt.src=U;const Nt=Mt.decode().then(()=>(Rt.drawImage(Mt,0,0,1,1,0,0,1,3),new Uint32Array(Rt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,o.shadow)(this,"_isSVGFittingCanvas",Nt)}async getFromFile(U){const{lastModified:gt,name:Rt,size:Mt,type:Nt}=U;return K(this,u,Ue).call(this,`${gt}_${Rt}_${Mt}_${Nt}`,U)}async getFromUrl(U){return K(this,u,Ue).call(this,U,U)}async getFromId(U){t(this,f)||lt(this,f,new Map);const gt=t(this,f).get(U);return gt?gt.bitmap?(gt.refCounter+=1,gt):gt.file?this.getFromFile(gt.file):this.getFromUrl(gt.url):null}getSvgUrl(U){const gt=t(this,f).get(U);return gt!=null&&gt.isSvg?gt.svgUrl:null}deleteId(U){t(this,f)||lt(this,f,new Map);const gt=t(this,f).get(U);gt&&(gt.refCounter-=1,gt.refCounter===0&&(gt.bitmap=null))}isValidId(U){return U.startsWith(`image_${t(this,m)}_`)}};m=new WeakMap,v=new WeakMap,f=new WeakMap,u=new WeakSet,Ue=async function(U,gt){t(this,f)||lt(this,f,new Map);let Rt=t(this,f).get(U);if(Rt===null)return null;if(Rt!=null&&Rt.bitmap)return Rt.refCounter+=1,Rt;try{Rt||(Rt={bitmap:null,id:`image_${t(this,m)}_${he(this,v)._++}`,refCounter:0,isSvg:!1});let Mt;if(typeof gt=="string"){Rt.url=gt;const Nt=await fetch(gt);if(!Nt.ok)throw new Error(Nt.statusText);Mt=await Nt.blob()}else Mt=Rt.file=gt;if(Mt.type==="image/svg+xml"){const Nt=D._isSVGFittingCanvas,jt=new FileReader,N=new Image,C=new Promise((X,ht)=>{N.onload=()=>{Rt.bitmap=N,Rt.isSvg=!0,X()},jt.onload=async()=>{const pt=Rt.svgUrl=jt.result;N.src=await Nt?`${pt}#svgView(preserveAspectRatio(none))`:pt},N.onerror=jt.onerror=ht});jt.readAsDataURL(Mt),await C}else Rt.bitmap=await createImageBitmap(Mt);Rt.refCounter=1}catch(Mt){console.error(Mt),Rt=null}return t(this,f).set(U,Rt),Rt&&t(this,f).set(Rt.id,Rt),Rt};let O=D;class E{constructor(U=128){at(this,_,[]);at(this,h,!1);at(this,e);at(this,s,-1);lt(this,e,U)}add({cmd:U,undo:gt,mustExec:Rt,type:Mt=NaN,overwriteIfSameType:Nt=!1,keepUndo:jt=!1}){if(Rt&&U(),t(this,h))return;const N={cmd:U,undo:gt,type:Mt};if(t(this,s)===-1){t(this,_).length>0&&(t(this,_).length=0),lt(this,s,0),t(this,_).push(N);return}if(Nt&&t(this,_)[t(this,s)].type===Mt){jt&&(N.undo=t(this,_)[t(this,s)].undo),t(this,_)[t(this,s)]=N;return}const C=t(this,s)+1;C===t(this,e)?t(this,_).splice(0,1):(lt(this,s,C),C<t(this,_).length&&t(this,_).splice(C)),t(this,_).push(N)}undo(){t(this,s)!==-1&&(lt(this,h,!0),t(this,_)[t(this,s)].undo(),lt(this,h,!1),lt(this,s,t(this,s)-1))}redo(){t(this,s)<t(this,_).length-1&&(lt(this,s,t(this,s)+1),lt(this,h,!0),t(this,_)[t(this,s)].cmd(),lt(this,h,!1))}hasSomethingToUndo(){return t(this,s)!==-1}hasSomethingToRedo(){return t(this,s)<t(this,_).length-1}destroy(){lt(this,_,null)}}_=new WeakMap,h=new WeakMap,e=new WeakMap,s=new WeakMap,c.CommandManager=E;class d{constructor(U){at(this,l);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:gt}=o.FeatureTest.platform;for(const[Rt,Mt,Nt={}]of U)for(const jt of Rt){const N=jt.startsWith("mac+");gt&&N?(this.callbacks.set(jt.slice(4),{callback:Mt,options:Nt}),this.allKeys.add(jt.split("+").at(-1))):!gt&&!N&&(this.callbacks.set(jt,{callback:Mt,options:Nt}),this.allKeys.add(jt.split("+").at(-1)))}}exec(U,gt){if(!this.allKeys.has(gt.key))return;const Rt=this.callbacks.get(K(this,l,vs).call(this,gt));if(!Rt)return;const{callback:Mt,options:{bubbles:Nt=!1,args:jt=[],checker:N=null}}=Rt;N&&!N(U,gt)||(Mt.bind(U,...jt)(),Nt||(gt.stopPropagation(),gt.preventDefault()))}}l=new WeakSet,vs=function(U){U.altKey&&this.buffer.push("alt"),U.ctrlKey&&this.buffer.push("ctrl"),U.metaKey&&this.buffer.push("meta"),U.shiftKey&&this.buffer.push("shift"),this.buffer.push(U.key);const gt=this.buffer.join("+");return this.buffer.length=0,gt},c.KeyboardManager=d;const w=class w{get _colors(){const U=new Map([["CanvasText",null],["Canvas",null]]);return(0,b.getColorValues)(U),(0,o.shadow)(this,"_colors",U)}convert(U){const gt=(0,b.getRGB)(U);if(!window.matchMedia("(forced-colors: active)").matches)return gt;for(const[Rt,Mt]of this._colors)if(Mt.every((Nt,jt)=>Nt===gt[jt]))return w._colorsMapping.get(Rt);return gt}getHexCode(U){const gt=this._colors.get(U);return gt?o.Util.makeHexColor(...gt):U}};Kt(w,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let j=w;c.ColorManager=j;const Vt=class Vt{constructor(U,gt,Rt,Mt,Nt,jt){at(this,Q);at(this,r,null);at(this,g,new Map);at(this,S,new Map);at(this,J,null);at(this,H,null);at(this,Y,new E);at(this,$,0);at(this,rt,new Set);at(this,P,null);at(this,W,null);at(this,Z,new Set);at(this,R,null);at(this,n,new tt);at(this,i,!1);at(this,p,!1);at(this,k,null);at(this,F,o.AnnotationEditorType.NONE);at(this,I,new Set);at(this,z,null);at(this,et,this.blur.bind(this));at(this,dt,this.focus.bind(this));at(this,ut,this.copy.bind(this));at(this,mt,this.cut.bind(this));at(this,yt,this.paste.bind(this));at(this,xt,this.keydown.bind(this));at(this,st,this.onEditingAction.bind(this));at(this,it,this.onPageChanging.bind(this));at(this,A,this.onScaleChanging.bind(this));at(this,M,this.onRotationChanging.bind(this));at(this,V,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});at(this,nt,[0,0]);at(this,ft,null);at(this,vt,null);at(this,At,null);lt(this,vt,U),lt(this,At,gt),lt(this,J,Rt),this._eventBus=Mt,this._eventBus._on("editingaction",t(this,st)),this._eventBus._on("pagechanging",t(this,it)),this._eventBus._on("scalechanging",t(this,A)),this._eventBus._on("rotationchanging",t(this,M)),lt(this,H,Nt.annotationStorage),lt(this,R,Nt.filterFactory),lt(this,z,jt),this.viewParameters={realScale:b.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const U=Vt.prototype,gt=Nt=>{const{activeElement:jt}=document;return jt&&t(Nt,vt).contains(jt)&&Nt.hasSomethingToControl()},Rt=this.TRANSLATE_SMALL,Mt=this.TRANSLATE_BIG;return(0,o.shadow)(this,"_keyboardManager",new d([[["ctrl+a","mac+meta+a"],U.selectAll],[["ctrl+z","mac+meta+z"],U.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],U.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],U.delete],[["Escape","mac+Escape"],U.unselectAll],[["ArrowLeft","mac+ArrowLeft"],U.translateSelectedEditors,{args:[-Rt,0],checker:gt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],U.translateSelectedEditors,{args:[-Mt,0],checker:gt}],[["ArrowRight","mac+ArrowRight"],U.translateSelectedEditors,{args:[Rt,0],checker:gt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],U.translateSelectedEditors,{args:[Mt,0],checker:gt}],[["ArrowUp","mac+ArrowUp"],U.translateSelectedEditors,{args:[0,-Rt],checker:gt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],U.translateSelectedEditors,{args:[0,-Mt],checker:gt}],[["ArrowDown","mac+ArrowDown"],U.translateSelectedEditors,{args:[0,Rt],checker:gt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],U.translateSelectedEditors,{args:[0,Mt],checker:gt}]]))}destroy(){K(this,Q,ve).call(this),K(this,Q,Be).call(this),this._eventBus._off("editingaction",t(this,st)),this._eventBus._off("pagechanging",t(this,it)),this._eventBus._off("scalechanging",t(this,A)),this._eventBus._off("rotationchanging",t(this,M));for(const U of t(this,S).values())U.destroy();t(this,S).clear(),t(this,g).clear(),t(this,Z).clear(),lt(this,r,null),t(this,I).clear(),t(this,Y).destroy(),t(this,J).destroy()}get hcmFilter(){return(0,o.shadow)(this,"hcmFilter",t(this,z)?t(this,R).addHCMFilter(t(this,z).foreground,t(this,z).background):"none")}get direction(){return(0,o.shadow)(this,"direction",getComputedStyle(t(this,vt)).direction)}editAltText(U){var gt;(gt=t(this,J))==null||gt.editAltText(this,U)}onPageChanging({pageNumber:U}){lt(this,$,U-1)}focusMainContainer(){t(this,vt).focus()}findParent(U,gt){for(const Rt of t(this,S).values()){const{x:Mt,y:Nt,width:jt,height:N}=Rt.div.getBoundingClientRect();if(U>=Mt&&U<=Mt+jt&&gt>=Nt&&gt<=Nt+N)return Rt}return null}disableUserSelect(U=!1){t(this,At).classList.toggle("noUserSelect",U)}addShouldRescale(U){t(this,Z).add(U)}removeShouldRescale(U){t(this,Z).delete(U)}onScaleChanging({scale:U}){this.commitOrRemove(),this.viewParameters.realScale=U*b.PixelsPerInch.PDF_TO_CSS_UNITS;for(const gt of t(this,Z))gt.onScaleChanging()}onRotationChanging({pagesRotation:U}){this.commitOrRemove(),this.viewParameters.rotation=U}addToAnnotationStorage(U){!U.isEmpty()&&t(this,H)&&!t(this,H).has(U.id)&&t(this,H).setValue(U.id,U)}blur(){if(!this.hasSelection)return;const{activeElement:U}=document;for(const gt of t(this,I))if(gt.div.contains(U)){lt(this,k,[gt,U]),gt._focusEventsAllowed=!1;break}}focus(){if(!t(this,k))return;const[U,gt]=t(this,k);lt(this,k,null),gt.addEventListener("focusin",()=>{U._focusEventsAllowed=!0},{once:!0}),gt.focus()}addEditListeners(){K(this,Q,He).call(this),K(this,Q,$e).call(this)}removeEditListeners(){K(this,Q,ve).call(this),K(this,Q,We).call(this)}copy(U){var Rt;if(U.preventDefault(),(Rt=t(this,r))==null||Rt.commitOrRemove(),!this.hasSelection)return;const gt=[];for(const Mt of t(this,I)){const Nt=Mt.serialize(!0);Nt&&gt.push(Nt)}gt.length!==0&&U.clipboardData.setData("application/pdfjs",JSON.stringify(gt))}cut(U){this.copy(U),this.delete()}paste(U){U.preventDefault();const{clipboardData:gt}=U;for(const Nt of gt.items)for(const jt of t(this,W))if(jt.isHandlingMimeForPasting(Nt.type)){jt.paste(Nt,this.currentLayer);return}let Rt=gt.getData("application/pdfjs");if(!Rt)return;try{Rt=JSON.parse(Rt)}catch(Nt){(0,o.warn)(`paste: "${Nt.message}".`);return}if(!Array.isArray(Rt))return;this.unselectAll();const Mt=this.currentLayer;try{const Nt=[];for(const C of Rt){const X=Mt.deserialize(C);if(!X)return;Nt.push(X)}const jt=()=>{for(const C of Nt)K(this,Q,Ge).call(this,C);K(this,Q,Ve).call(this,Nt)},N=()=>{for(const C of Nt)C.remove()};this.addCommands({cmd:jt,undo:N,mustExec:!0})}catch(Nt){(0,o.warn)(`paste: "${Nt.message}".`)}}keydown(U){var gt;(gt=this.getActive())!=null&&gt.shouldGetKeyboardEvents()||Vt._keyboardManager.exec(this,U)}onEditingAction(U){["undo","redo","delete","selectAll"].includes(U.name)&&this[U.name]()}setEditingState(U){U?(K(this,Q,As).call(this),K(this,Q,He).call(this),K(this,Q,$e).call(this),K(this,Q,Zt).call(this,{isEditing:t(this,F)!==o.AnnotationEditorType.NONE,isEmpty:K(this,Q,ue).call(this),hasSomethingToUndo:t(this,Y).hasSomethingToUndo(),hasSomethingToRedo:t(this,Y).hasSomethingToRedo(),hasSelectedEditor:!1})):(K(this,Q,Be).call(this),K(this,Q,ve).call(this),K(this,Q,We).call(this),K(this,Q,Zt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(U){if(!t(this,W)){lt(this,W,U);for(const gt of t(this,W))K(this,Q,de).call(this,gt.defaultPropertiesToUpdate)}}getId(){return t(this,n).getId()}get currentLayer(){return t(this,S).get(t(this,$))}getLayer(U){return t(this,S).get(U)}get currentPageIndex(){return t(this,$)}addLayer(U){t(this,S).set(U.pageIndex,U),t(this,i)?U.enable():U.disable()}removeLayer(U){t(this,S).delete(U.pageIndex)}updateMode(U,gt=null){if(t(this,F)!==U){if(lt(this,F,U),U===o.AnnotationEditorType.NONE){this.setEditingState(!1),K(this,Q,_s).call(this);return}this.setEditingState(!0),K(this,Q,Es).call(this),this.unselectAll();for(const Rt of t(this,S).values())Rt.updateMode(U);if(gt){for(const Rt of t(this,g).values())if(Rt.annotationElementId===gt){this.setSelected(Rt),Rt.enterInEditMode();break}}}}updateToolbar(U){U!==t(this,F)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:U})}updateParams(U,gt){if(t(this,W)){if(U===o.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(U);return}for(const Rt of t(this,I))Rt.updateParams(U,gt);for(const Rt of t(this,W))Rt.updateDefaultParams(U,gt)}}enableWaiting(U=!1){if(t(this,p)!==U){lt(this,p,U);for(const gt of t(this,S).values())U?gt.disableClick():gt.enableClick(),gt.div.classList.toggle("waiting",U)}}getEditors(U){const gt=[];for(const Rt of t(this,g).values())Rt.pageIndex===U&&gt.push(Rt);return gt}getEditor(U){return t(this,g).get(U)}addEditor(U){t(this,g).set(U.id,U)}removeEditor(U){var gt;t(this,g).delete(U.id),this.unselect(U),(!U.annotationElementId||!t(this,rt).has(U.annotationElementId))&&((gt=t(this,H))==null||gt.remove(U.id))}addDeletedAnnotationElement(U){t(this,rt).add(U.annotationElementId),U.deleted=!0}isDeletedAnnotationElement(U){return t(this,rt).has(U)}removeDeletedAnnotationElement(U){t(this,rt).delete(U.annotationElementId),U.deleted=!1}setActiveEditor(U){t(this,r)!==U&&(lt(this,r,U),U&&K(this,Q,de).call(this,U.propertiesToUpdate))}toggleSelected(U){if(t(this,I).has(U)){t(this,I).delete(U),U.unselect(),K(this,Q,Zt).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,I).add(U),U.select(),K(this,Q,de).call(this,U.propertiesToUpdate),K(this,Q,Zt).call(this,{hasSelectedEditor:!0})}setSelected(U){for(const gt of t(this,I))gt!==U&&gt.unselect();t(this,I).clear(),t(this,I).add(U),U.select(),K(this,Q,de).call(this,U.propertiesToUpdate),K(this,Q,Zt).call(this,{hasSelectedEditor:!0})}isSelected(U){return t(this,I).has(U)}unselect(U){U.unselect(),t(this,I).delete(U),K(this,Q,Zt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,I).size!==0}undo(){t(this,Y).undo(),K(this,Q,Zt).call(this,{hasSomethingToUndo:t(this,Y).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:K(this,Q,ue).call(this)})}redo(){t(this,Y).redo(),K(this,Q,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,Y).hasSomethingToRedo(),isEmpty:K(this,Q,ue).call(this)})}addCommands(U){t(this,Y).add(U),K(this,Q,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:K(this,Q,ue).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const U=[...t(this,I)],gt=()=>{for(const Mt of U)Mt.remove()},Rt=()=>{for(const Mt of U)K(this,Q,Ge).call(this,Mt)};this.addCommands({cmd:gt,undo:Rt,mustExec:!0})}commitOrRemove(){var U;(U=t(this,r))==null||U.commitOrRemove()}hasSomethingToControl(){return t(this,r)||this.hasSelection}selectAll(){for(const U of t(this,I))U.commit();K(this,Q,Ve).call(this,t(this,g).values())}unselectAll(){if(t(this,r)){t(this,r).commitOrRemove();return}if(this.hasSelection){for(const U of t(this,I))U.unselect();t(this,I).clear(),K(this,Q,Zt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(U,gt,Rt=!1){if(Rt||this.commitOrRemove(),!this.hasSelection)return;t(this,nt)[0]+=U,t(this,nt)[1]+=gt;const[Mt,Nt]=t(this,nt),jt=[...t(this,I)],N=1e3;t(this,ft)&&clearTimeout(t(this,ft)),lt(this,ft,setTimeout(()=>{lt(this,ft,null),t(this,nt)[0]=t(this,nt)[1]=0,this.addCommands({cmd:()=>{for(const C of jt)t(this,g).has(C.id)&&C.translateInPage(Mt,Nt)},undo:()=>{for(const C of jt)t(this,g).has(C.id)&&C.translateInPage(-Mt,-Nt)},mustExec:!1})},N));for(const C of jt)C.translateInPage(U,gt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),lt(this,P,new Map);for(const U of t(this,I))t(this,P).set(U,{savedX:U.x,savedY:U.y,savedPageIndex:U.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,P))return!1;this.disableUserSelect(!1);const U=t(this,P);lt(this,P,null);let gt=!1;for(const[{x:Mt,y:Nt,pageIndex:jt},N]of U)N.newX=Mt,N.newY=Nt,N.newPageIndex=jt,gt||(gt=Mt!==N.savedX||Nt!==N.savedY||jt!==N.savedPageIndex);if(!gt)return!1;const Rt=(Mt,Nt,jt,N)=>{if(t(this,g).has(Mt.id)){const C=t(this,S).get(N);C?Mt._setParentAndPosition(C,Nt,jt):(Mt.pageIndex=N,Mt.x=Nt,Mt.y=jt)}};return this.addCommands({cmd:()=>{for(const[Mt,{newX:Nt,newY:jt,newPageIndex:N}]of U)Rt(Mt,Nt,jt,N)},undo:()=>{for(const[Mt,{savedX:Nt,savedY:jt,savedPageIndex:N}]of U)Rt(Mt,Nt,jt,N)},mustExec:!0}),!0}dragSelectedEditors(U,gt){if(t(this,P))for(const Rt of t(this,P).keys())Rt.drag(U,gt)}rebuild(U){if(U.parent===null){const gt=this.getLayer(U.pageIndex);gt?(gt.changeParent(U),gt.addOrRebuild(U)):(this.addEditor(U),this.addToAnnotationStorage(U),U.rebuild())}else U.parent.addOrRebuild(U)}isActive(U){return t(this,r)===U}getActive(){return t(this,r)}getMode(){return t(this,F)}get imageManager(){return(0,o.shadow)(this,"imageManager",new O)}};r=new WeakMap,g=new WeakMap,S=new WeakMap,J=new WeakMap,H=new WeakMap,Y=new WeakMap,$=new WeakMap,rt=new WeakMap,P=new WeakMap,W=new WeakMap,Z=new WeakMap,R=new WeakMap,n=new WeakMap,i=new WeakMap,p=new WeakMap,k=new WeakMap,F=new WeakMap,I=new WeakMap,z=new WeakMap,et=new WeakMap,dt=new WeakMap,ut=new WeakMap,mt=new WeakMap,yt=new WeakMap,xt=new WeakMap,st=new WeakMap,it=new WeakMap,A=new WeakMap,M=new WeakMap,V=new WeakMap,nt=new WeakMap,ft=new WeakMap,vt=new WeakMap,At=new WeakMap,Q=new WeakSet,As=function(){window.addEventListener("focus",t(this,dt)),window.addEventListener("blur",t(this,et))},Be=function(){window.removeEventListener("focus",t(this,dt)),window.removeEventListener("blur",t(this,et))},He=function(){window.addEventListener("keydown",t(this,xt),{capture:!0})},ve=function(){window.removeEventListener("keydown",t(this,xt),{capture:!0})},$e=function(){document.addEventListener("copy",t(this,ut)),document.addEventListener("cut",t(this,mt)),document.addEventListener("paste",t(this,yt))},We=function(){document.removeEventListener("copy",t(this,ut)),document.removeEventListener("cut",t(this,mt)),document.removeEventListener("paste",t(this,yt))},Zt=function(U){Object.entries(U).some(([Rt,Mt])=>t(this,V)[Rt]!==Mt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,V),U)})},de=function(U){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:U})},Es=function(){if(!t(this,i)){lt(this,i,!0);for(const U of t(this,S).values())U.enable()}},_s=function(){if(this.unselectAll(),t(this,i)){lt(this,i,!1);for(const U of t(this,S).values())U.disable()}},Ge=function(U){const gt=t(this,S).get(U.pageIndex);gt?gt.addOrRebuild(U):this.addEditor(U)},ue=function(){if(t(this,g).size===0)return!0;if(t(this,g).size===1)for(const U of t(this,g).values())return U.isEmpty();return!1},Ve=function(U){t(this,I).clear();for(const gt of U)gt.isEmpty()||(t(this,I).add(gt),gt.select());K(this,Q,Zt).call(this,{hasSelectedEditor:!0})},Kt(Vt,"TRANSLATE_SMALL",1),Kt(Vt,"TRANSLATE_BIG",10);let T=Vt;c.AnnotationEditorUIManager=T},(L,c,G)=>{var $,rt,P,W,Z,R,n,i,p,k,F,I,ae,oe,ze,Ae,Ee,pe,fe;Object.defineProperty(c,"__esModule",{value:!0}),c.StatTimer=c.RenderingCancelledException=c.PixelsPerInch=c.PageViewport=c.PDFDateString=c.DOMStandardFontDataFactory=c.DOMSVGFactory=c.DOMFilterFactory=c.DOMCanvasFactory=c.DOMCMapReaderFactory=void 0,c.deprecated=s,c.getColorValues=g,c.getCurrentTransform=S,c.getCurrentTransformInverse=J,c.getFilenameFromUrl=u,c.getPdfFilenameFromUrl=y,c.getRGB=r,c.getXfaPageViewport=w,c.isDataScheme=v,c.isPdfFile=f,c.isValidFetchUrl=_,c.loadScript=e,c.noContextMenu=h,c.setLayerDimensions=H;var o=G(7),b=G(1);const q="http://www.w3.org/2000/svg",Y=class Y{};Kt(Y,"CSS",96),Kt(Y,"PDF",72),Kt(Y,"PDF_TO_CSS_UNITS",Y.CSS/Y.PDF);let B=Y;c.PixelsPerInch=B;class tt extends o.BaseFilterFactory{constructor({docId:A,ownerDocument:M=globalThis.document}={}){super();at(this,I);at(this,$);at(this,rt);at(this,P);at(this,W);at(this,Z);at(this,R);at(this,n);at(this,i);at(this,p);at(this,k);at(this,F,0);lt(this,P,A),lt(this,W,M)}addFilter(A){if(!A)return"none";let M=t(this,I,ae).get(A);if(M)return M;let V,nt,ft,vt;if(A.length===1){const St=A[0],Bt=new Array(256);for(let Ot=0;Ot<256;Ot++)Bt[Ot]=St[Ot]/255;vt=V=nt=ft=Bt.join(",")}else{const[St,Bt,Ot]=A,Gt=new Array(256),Pt=new Array(256),Lt=new Array(256);for(let zt=0;zt<256;zt++)Gt[zt]=St[zt]/255,Pt[zt]=Bt[zt]/255,Lt[zt]=Ot[zt]/255;V=Gt.join(","),nt=Pt.join(","),ft=Lt.join(","),vt=`${V}${nt}${ft}`}if(M=t(this,I,ae).get(vt),M)return t(this,I,ae).set(A,M),M;const At=`g_${t(this,P)}_transfer_map_${he(this,F)._++}`,Q=`url(#${At})`;t(this,I,ae).set(A,Q),t(this,I,ae).set(vt,Q);const wt=K(this,I,Ae).call(this,At);return K(this,I,pe).call(this,V,nt,ft,wt),Q}addHCMFilter(A,M){var Bt;const V=`${A}-${M}`;if(t(this,R)===V)return t(this,n);if(lt(this,R,V),lt(this,n,"none"),(Bt=t(this,Z))==null||Bt.remove(),!A||!M)return t(this,n);const nt=K(this,I,fe).call(this,A);A=b.Util.makeHexColor(...nt);const ft=K(this,I,fe).call(this,M);if(M=b.Util.makeHexColor(...ft),t(this,I,oe).style.color="",A==="#000000"&&M==="#ffffff"||A===M)return t(this,n);const vt=new Array(256);for(let Ot=0;Ot<=255;Ot++){const Gt=Ot/255;vt[Ot]=Gt<=.03928?Gt/12.92:((Gt+.055)/1.055)**2.4}const At=vt.join(","),Q=`g_${t(this,P)}_hcm_filter`,wt=lt(this,i,K(this,I,Ae).call(this,Q));K(this,I,pe).call(this,At,At,At,wt),K(this,I,ze).call(this,wt);const St=(Ot,Gt)=>{const Pt=nt[Ot]/255,Lt=ft[Ot]/255,zt=new Array(Gt+1);for(let Xt=0;Xt<=Gt;Xt++)zt[Xt]=Pt+Xt/Gt*(Lt-Pt);return zt.join(",")};return K(this,I,pe).call(this,St(0,5),St(1,5),St(2,5),wt),lt(this,n,`url(#${Q})`),t(this,n)}addHighlightHCMFilter(A,M,V,nt){var Lt;const ft=`${A}-${M}-${V}-${nt}`;if(t(this,p)===ft)return t(this,k);if(lt(this,p,ft),lt(this,k,"none"),(Lt=t(this,i))==null||Lt.remove(),!A||!M)return t(this,k);const[vt,At]=[A,M].map(K(this,I,fe).bind(this));let Q=Math.round(.2126*vt[0]+.7152*vt[1]+.0722*vt[2]),wt=Math.round(.2126*At[0]+.7152*At[1]+.0722*At[2]),[St,Bt]=[V,nt].map(K(this,I,fe).bind(this));wt<Q&&([Q,wt,St,Bt]=[wt,Q,Bt,St]),t(this,I,oe).style.color="";const Ot=(zt,Xt,Et)=>{const ot=new Array(256),ct=(wt-Q)/Et,Tt=zt/255,Vt=(Xt-zt)/(255*Et);let Wt=0;for(let U=0;U<=Et;U++){const gt=Math.round(Q+U*ct),Rt=Tt+U*Vt;for(let Mt=Wt;Mt<=gt;Mt++)ot[Mt]=Rt;Wt=gt+1}for(let U=Wt;U<256;U++)ot[U]=ot[Wt-1];return ot.join(",")},Gt=`g_${t(this,P)}_hcm_highlight_filter`,Pt=lt(this,i,K(this,I,Ae).call(this,Gt));return K(this,I,ze).call(this,Pt),K(this,I,pe).call(this,Ot(St[0],Bt[0],5),Ot(St[1],Bt[1],5),Ot(St[2],Bt[2],5),Pt),lt(this,k,`url(#${Gt})`),t(this,k)}destroy(A=!1){A&&(t(this,n)||t(this,k))||(t(this,rt)&&(t(this,rt).parentNode.parentNode.remove(),lt(this,rt,null)),t(this,$)&&(t(this,$).clear(),lt(this,$,null)),lt(this,F,0))}}$=new WeakMap,rt=new WeakMap,P=new WeakMap,W=new WeakMap,Z=new WeakMap,R=new WeakMap,n=new WeakMap,i=new WeakMap,p=new WeakMap,k=new WeakMap,F=new WeakMap,I=new WeakSet,ae=function(){return t(this,$)||lt(this,$,new Map)},oe=function(){if(!t(this,rt)){const A=t(this,W).createElement("div"),{style:M}=A;M.visibility="hidden",M.contain="strict",M.width=M.height=0,M.position="absolute",M.top=M.left=0,M.zIndex=-1;const V=t(this,W).createElementNS(q,"svg");V.setAttribute("width",0),V.setAttribute("height",0),lt(this,rt,t(this,W).createElementNS(q,"defs")),A.append(V),V.append(t(this,rt)),t(this,W).body.append(A)}return t(this,rt)},ze=function(A){const M=t(this,W).createElementNS(q,"feColorMatrix");M.setAttribute("type","matrix"),M.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),A.append(M)},Ae=function(A){const M=t(this,W).createElementNS(q,"filter");return M.setAttribute("color-interpolation-filters","sRGB"),M.setAttribute("id",A),t(this,I,oe).append(M),M},Ee=function(A,M,V){const nt=t(this,W).createElementNS(q,M);nt.setAttribute("type","discrete"),nt.setAttribute("tableValues",V),A.append(nt)},pe=function(A,M,V,nt){const ft=t(this,W).createElementNS(q,"feComponentTransfer");nt.append(ft),K(this,I,Ee).call(this,ft,"feFuncR",A),K(this,I,Ee).call(this,ft,"feFuncG",M),K(this,I,Ee).call(this,ft,"feFuncB",V)},fe=function(A){return t(this,I,oe).style.color=A,r(getComputedStyle(t(this,I,oe)).getPropertyValue("color"))},c.DOMFilterFactory=tt;class O extends o.BaseCanvasFactory{constructor({ownerDocument:it=globalThis.document}={}){super(),this._document=it}_createCanvas(it,A){const M=this._document.createElement("canvas");return M.width=it,M.height=A,M}}c.DOMCanvasFactory=O;async function E(st,it=!1){if(_(st,document.baseURI)){const A=await fetch(st);if(!A.ok)throw new Error(A.statusText);return it?new Uint8Array(await A.arrayBuffer()):(0,b.stringToBytes)(await A.text())}return new Promise((A,M)=>{const V=new XMLHttpRequest;V.open("GET",st,!0),it&&(V.responseType="arraybuffer"),V.onreadystatechange=()=>{if(V.readyState===XMLHttpRequest.DONE){if(V.status===200||V.status===0){let nt;if(it&&V.response?nt=new Uint8Array(V.response):!it&&V.responseText&&(nt=(0,b.stringToBytes)(V.responseText)),nt){A(nt);return}}M(new Error(V.statusText))}},V.send(null)})}class d extends o.BaseCMapReaderFactory{_fetchData(it,A){return E(it,this.isCompressed).then(M=>({cMapData:M,compressionType:A}))}}c.DOMCMapReaderFactory=d;class j extends o.BaseStandardFontDataFactory{_fetchData(it){return E(it,!0)}}c.DOMStandardFontDataFactory=j;class T extends o.BaseSVGFactory{_createSVG(it){return document.createElementNS(q,it)}}c.DOMSVGFactory=T;class x{constructor({viewBox:it,scale:A,rotation:M,offsetX:V=0,offsetY:nt=0,dontFlip:ft=!1}){this.viewBox=it,this.scale=A,this.rotation=M,this.offsetX=V,this.offsetY=nt;const vt=(it[2]+it[0])/2,At=(it[3]+it[1])/2;let Q,wt,St,Bt;switch(M%=360,M<0&&(M+=360),M){case 180:Q=-1,wt=0,St=0,Bt=1;break;case 90:Q=0,wt=1,St=1,Bt=0;break;case 270:Q=0,wt=-1,St=-1,Bt=0;break;case 0:Q=1,wt=0,St=0,Bt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}ft&&(St=-St,Bt=-Bt);let Ot,Gt,Pt,Lt;Q===0?(Ot=Math.abs(At-it[1])*A+V,Gt=Math.abs(vt-it[0])*A+nt,Pt=(it[3]-it[1])*A,Lt=(it[2]-it[0])*A):(Ot=Math.abs(vt-it[0])*A+V,Gt=Math.abs(At-it[1])*A+nt,Pt=(it[2]-it[0])*A,Lt=(it[3]-it[1])*A),this.transform=[Q*A,wt*A,St*A,Bt*A,Ot-Q*A*vt-St*A*At,Gt-wt*A*vt-Bt*A*At],this.width=Pt,this.height=Lt}get rawDims(){const{viewBox:it}=this;return(0,b.shadow)(this,"rawDims",{pageWidth:it[2]-it[0],pageHeight:it[3]-it[1],pageX:it[0],pageY:it[1]})}clone({scale:it=this.scale,rotation:A=this.rotation,offsetX:M=this.offsetX,offsetY:V=this.offsetY,dontFlip:nt=!1}={}){return new x({viewBox:this.viewBox.slice(),scale:it,rotation:A,offsetX:M,offsetY:V,dontFlip:nt})}convertToViewportPoint(it,A){return b.Util.applyTransform([it,A],this.transform)}convertToViewportRectangle(it){const A=b.Util.applyTransform([it[0],it[1]],this.transform),M=b.Util.applyTransform([it[2],it[3]],this.transform);return[A[0],A[1],M[0],M[1]]}convertToPdfPoint(it,A){return b.Util.applyInverseTransform([it,A],this.transform)}}c.PageViewport=x;class m extends b.BaseException{constructor(it,A=0){super(it,"RenderingCancelledException"),this.extraDelay=A}}c.RenderingCancelledException=m;function v(st){const it=st.length;let A=0;for(;A<it&&st[A].trim()==="";)A++;return st.substring(A,A+5).toLowerCase()==="data:"}function f(st){return typeof st=="string"&&/\.pdf$/i.test(st)}function u(st,it=!1){return it||([st]=st.split(/[#?]/,1)),st.substring(st.lastIndexOf("/")+1)}function y(st,it="document.pdf"){if(typeof st!="string")return it;if(v(st))return(0,b.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),it;const A=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,M=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,V=A.exec(st);let nt=M.exec(V[1])||M.exec(V[2])||M.exec(V[3]);if(nt&&(nt=nt[0],nt.includes("%")))try{nt=M.exec(decodeURIComponent(nt))[0]}catch{}return nt||it}class D{constructor(){Kt(this,"started",Object.create(null));Kt(this,"times",[])}time(it){it in this.started&&(0,b.warn)(`Timer is already running for ${it}`),this.started[it]=Date.now()}timeEnd(it){it in this.started||(0,b.warn)(`Timer has not been started for ${it}`),this.times.push({name:it,start:this.started[it],end:Date.now()}),delete this.started[it]}toString(){const it=[];let A=0;for(const{name:M}of this.times)A=Math.max(M.length,A);for(const{name:M,start:V,end:nt}of this.times)it.push(`${M.padEnd(A)} ${nt-V}ms
`);return it.join("")}}c.StatTimer=D;function _(st,it){try{const{protocol:A}=it?new URL(st,it):new URL(st);return A==="http:"||A==="https:"}catch{return!1}}function h(st){st.preventDefault()}function e(st,it=!1){return new Promise((A,M)=>{const V=document.createElement("script");V.src=st,V.onload=function(nt){it&&V.remove(),A(nt)},V.onerror=function(){M(new Error(`Cannot load script at: ${V.src}`))},(document.head||document.documentElement).append(V)})}function s(st){console.log("Deprecated API usage: "+st)}let l;class a{static toDateObject(it){if(!it||typeof it!="string")return null;l||(l=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const A=l.exec(it);if(!A)return null;const M=parseInt(A[1],10);let V=parseInt(A[2],10);V=V>=1&&V<=12?V-1:0;let nt=parseInt(A[3],10);nt=nt>=1&&nt<=31?nt:1;let ft=parseInt(A[4],10);ft=ft>=0&&ft<=23?ft:0;let vt=parseInt(A[5],10);vt=vt>=0&&vt<=59?vt:0;let At=parseInt(A[6],10);At=At>=0&&At<=59?At:0;const Q=A[7]||"Z";let wt=parseInt(A[8],10);wt=wt>=0&&wt<=23?wt:0;let St=parseInt(A[9],10)||0;return St=St>=0&&St<=59?St:0,Q==="-"?(ft+=wt,vt+=St):Q==="+"&&(ft-=wt,vt-=St),new Date(Date.UTC(M,V,nt,ft,vt,At))}}c.PDFDateString=a;function w(st,{scale:it=1,rotation:A=0}){const{width:M,height:V}=st.attributes.style,nt=[0,0,parseInt(M),parseInt(V)];return new x({viewBox:nt,scale:it,rotation:A})}function r(st){if(st.startsWith("#")){const it=parseInt(st.slice(1),16);return[(it&16711680)>>16,(it&65280)>>8,it&255]}return st.startsWith("rgb(")?st.slice(4,-1).split(",").map(it=>parseInt(it)):st.startsWith("rgba(")?st.slice(5,-1).split(",").map(it=>parseInt(it)).slice(0,3):((0,b.warn)(`Not a valid color format: "${st}"`),[0,0,0])}function g(st){const it=document.createElement("span");it.style.visibility="hidden",document.body.append(it);for(const A of st.keys()){it.style.color=A;const M=window.getComputedStyle(it).color;st.set(A,r(M))}it.remove()}function S(st){const{a:it,b:A,c:M,d:V,e:nt,f:ft}=st.getTransform();return[it,A,M,V,nt,ft]}function J(st){const{a:it,b:A,c:M,d:V,e:nt,f:ft}=st.getTransform().invertSelf();return[it,A,M,V,nt,ft]}function H(st,it,A=!1,M=!0){if(it instanceof x){const{pageWidth:V,pageHeight:nt}=it.rawDims,{style:ft}=st,vt=b.FeatureTest.isCSSRoundSupported,At=`var(--scale-factor) * ${V}px`,Q=`var(--scale-factor) * ${nt}px`,wt=vt?`round(${At}, 1px)`:`calc(${At})`,St=vt?`round(${Q}, 1px)`:`calc(${Q})`;!A||it.rotation%180===0?(ft.width=wt,ft.height=St):(ft.width=St,ft.height=wt)}M&&st.setAttribute("data-main-rotation",it.rotation)}},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BaseStandardFontDataFactory=c.BaseSVGFactory=c.BaseFilterFactory=c.BaseCanvasFactory=c.BaseCMapReaderFactory=void 0;var o=G(1);class b{constructor(){this.constructor===b&&(0,o.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(d){return"none"}addHCMFilter(d,j){return"none"}addHighlightHCMFilter(d,j,T,x){return"none"}destroy(d=!1){}}c.BaseFilterFactory=b;class q{constructor(){this.constructor===q&&(0,o.unreachable)("Cannot initialize BaseCanvasFactory.")}create(d,j){if(d<=0||j<=0)throw new Error("Invalid canvas size");const T=this._createCanvas(d,j);return{canvas:T,context:T.getContext("2d")}}reset(d,j,T){if(!d.canvas)throw new Error("Canvas is not specified");if(j<=0||T<=0)throw new Error("Invalid canvas size");d.canvas.width=j,d.canvas.height=T}destroy(d){if(!d.canvas)throw new Error("Canvas is not specified");d.canvas.width=0,d.canvas.height=0,d.canvas=null,d.context=null}_createCanvas(d,j){(0,o.unreachable)("Abstract method `_createCanvas` called.")}}c.BaseCanvasFactory=q;class B{constructor({baseUrl:d=null,isCompressed:j=!0}){this.constructor===B&&(0,o.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=d,this.isCompressed=j}async fetch({name:d}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!d)throw new Error("CMap name must be specified.");const j=this.baseUrl+d+(this.isCompressed?".bcmap":""),T=this.isCompressed?o.CMapCompressionType.BINARY:o.CMapCompressionType.NONE;return this._fetchData(j,T).catch(x=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${j}`)})}_fetchData(d,j){(0,o.unreachable)("Abstract method `_fetchData` called.")}}c.BaseCMapReaderFactory=B;class tt{constructor({baseUrl:d=null}){this.constructor===tt&&(0,o.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=d}async fetch({filename:d}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!d)throw new Error("Font filename must be specified.");const j=`${this.baseUrl}${d}`;return this._fetchData(j).catch(T=>{throw new Error(`Unable to load font data at: ${j}`)})}_fetchData(d){(0,o.unreachable)("Abstract method `_fetchData` called.")}}c.BaseStandardFontDataFactory=tt;class O{constructor(){this.constructor===O&&(0,o.unreachable)("Cannot initialize BaseSVGFactory.")}create(d,j,T=!1){if(d<=0||j<=0)throw new Error("Invalid SVG dimensions");const x=this._createSVG("svg:svg");return x.setAttribute("version","1.1"),T||(x.setAttribute("width",`${d}px`),x.setAttribute("height",`${j}px`)),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("viewBox",`0 0 ${d} ${j}`),x}createElement(d){if(typeof d!="string")throw new Error("Invalid SVG element type");return this._createSVG(d)}_createSVG(d){(0,o.unreachable)("Abstract method `_createSVG` called.")}}c.BaseSVGFactory=O},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.MurmurHash3_64=void 0;var o=G(1);const b=3285377520,q=4294901760,B=65535;class tt{constructor(E){this.h1=E?E&4294967295:b,this.h2=E?E&4294967295:b}update(E){let d,j;if(typeof E=="string"){d=new Uint8Array(E.length*2),j=0;for(let s=0,l=E.length;s<l;s++){const a=E.charCodeAt(s);a<=255?d[j++]=a:(d[j++]=a>>>8,d[j++]=a&255)}}else if((0,o.isArrayBuffer)(E))d=E.slice(),j=d.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const T=j>>2,x=j-T*4,m=new Uint32Array(d.buffer,0,T);let v=0,f=0,u=this.h1,y=this.h2;const D=3432918353,_=461845907,h=D&B,e=_&B;for(let s=0;s<T;s++)s&1?(v=m[s],v=v*D&q|v*h&B,v=v<<15|v>>>17,v=v*_&q|v*e&B,u^=v,u=u<<13|u>>>19,u=u*5+3864292196):(f=m[s],f=f*D&q|f*h&B,f=f<<15|f>>>17,f=f*_&q|f*e&B,y^=f,y=y<<13|y>>>19,y=y*5+3864292196);switch(v=0,x){case 3:v^=d[T*4+2]<<16;case 2:v^=d[T*4+1]<<8;case 1:v^=d[T*4],v=v*D&q|v*h&B,v=v<<15|v>>>17,v=v*_&q|v*e&B,T&1?u^=v:y^=v}this.h1=u,this.h2=y}hexdigest(){let E=this.h1,d=this.h2;return E^=d>>>1,E=E*3981806797&q|E*36045&B,d=d*4283543511&q|((d<<16|E>>>16)*2950163797&q)>>>16,E^=d>>>1,E=E*444984403&q|E*60499&B,d=d*3301882366&q|((d<<16|E>>>16)*3120437893&q)>>>16,E^=d>>>1,(E>>>0).toString(16).padStart(8,"0")+(d>>>0).toString(16).padStart(8,"0")}}c.MurmurHash3_64=tt},(L,c,G)=>{var B;Object.defineProperty(c,"__esModule",{value:!0}),c.FontLoader=c.FontFaceObject=void 0;var o=G(1);class b{constructor({ownerDocument:O=globalThis.document,styleElement:E=null}){at(this,B,new Set);this._document=O,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(O){this.nativeFontFaces.add(O),this._document.fonts.add(O)}removeNativeFontFace(O){this.nativeFontFaces.delete(O),this._document.fonts.delete(O)}insertRule(O){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const E=this.styleElement.sheet;E.insertRule(O,E.cssRules.length)}clear(){for(const O of this.nativeFontFaces)this._document.fonts.delete(O);this.nativeFontFaces.clear(),t(this,B).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(O){if(!(!O||t(this,B).has(O.loadedName))){if((0,o.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:E,src:d,style:j}=O,T=new FontFace(E,d,j);this.addNativeFontFace(T);try{await T.load(),t(this,B).add(E)}catch{(0,o.warn)(`Cannot load system font: ${O.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(T)}return}(0,o.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(O){if(O.attached||O.missingFile&&!O.systemFontInfo)return;if(O.attached=!0,O.systemFontInfo){await this.loadSystemFont(O.systemFontInfo);return}if(this.isFontLoadingAPISupported){const d=O.createNativeFontFace();if(d){this.addNativeFontFace(d);try{await d.loaded}catch(j){throw(0,o.warn)(`Failed to load font '${d.family}': '${j}'.`),O.disableFontFace=!0,j}}return}const E=O.createFontFaceRule();if(E){if(this.insertRule(E),this.isSyncFontLoadingSupported)return;await new Promise(d=>{const j=this._queueLoadingCallback(d);this._prepareFontLoadEvent(O,j)})}}get isFontLoadingAPISupported(){var E;const O=!!((E=this._document)!=null&&E.fonts);return(0,o.shadow)(this,"isFontLoadingAPISupported",O)}get isSyncFontLoadingSupported(){let O=!1;return(o.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(O=!0),(0,o.shadow)(this,"isSyncFontLoadingSupported",O)}_queueLoadingCallback(O){function E(){for((0,o.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;d.length>0&&d[0].done;){const T=d.shift();setTimeout(T.callback,0)}}const{loadingRequests:d}=this,j={done:!1,complete:E,callback:O};return d.push(j),j}get _loadTestFont(){const O=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,o.shadow)(this,"_loadTestFont",O)}_prepareFontLoadEvent(O,E){function d(r,g){return r.charCodeAt(g)<<24|r.charCodeAt(g+1)<<16|r.charCodeAt(g+2)<<8|r.charCodeAt(g+3)&255}function j(r,g,S,J){const H=r.substring(0,g),Y=r.substring(g+S);return H+J+Y}let T,x;const m=this._document.createElement("canvas");m.width=1,m.height=1;const v=m.getContext("2d");let f=0;function u(r,g){if(++f>30){(0,o.warn)("Load test font never loaded."),g();return}if(v.font="30px "+r,v.fillText(".",0,20),v.getImageData(0,0,1,1).data[3]>0){g();return}setTimeout(u.bind(null,r,g))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let D=this._loadTestFont;D=j(D,976,y.length,y);const h=16,e=1482184792;let s=d(D,h);for(T=0,x=y.length-3;T<x;T+=4)s=s-e+d(y,T)|0;T<y.length&&(s=s-e+d(y+"XXX",T)|0),D=j(D,h,4,(0,o.string32)(s));const l=`url(data:font/opentype;base64,${btoa(D)});`,a=`@font-face {font-family:"${y}";src:${l}}`;this.insertRule(a);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const r of[O.loadedName,y]){const g=this._document.createElement("span");g.textContent="Hi",g.style.fontFamily=r,w.append(g)}this._document.body.append(w),u(y,()=>{w.remove(),E.complete()})}}B=new WeakMap,c.FontLoader=b;class q{constructor(O,{isEvalSupported:E=!0,disableFontFace:d=!1,ignoreErrors:j=!1,inspectFont:T=null}){this.compiledGlyphs=Object.create(null);for(const x in O)this[x]=O[x];this.isEvalSupported=E!==!1,this.disableFontFace=d===!0,this.ignoreErrors=j===!0,this._inspectFont=T}createNativeFontFace(){var E;if(!this.data||this.disableFontFace)return null;let O;if(!this.cssFontInfo)O=new FontFace(this.loadedName,this.data,{});else{const d={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(d.style=`oblique ${this.cssFontInfo.italicAngle}deg`),O=new FontFace(this.cssFontInfo.fontFamily,this.data,d)}return(E=this._inspectFont)==null||E.call(this,this),O}createFontFaceRule(){var j;if(!this.data||this.disableFontFace)return null;const O=(0,o.bytesToString)(this.data),E=`url(data:${this.mimetype};base64,${btoa(O)});`;let d;if(!this.cssFontInfo)d=`@font-face {font-family:"${this.loadedName}";src:${E}}`;else{let T=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(T+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),d=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${T}src:${E}}`}return(j=this._inspectFont)==null||j.call(this,this,E),d}getPathGenerator(O,E){if(this.compiledGlyphs[E]!==void 0)return this.compiledGlyphs[E];let d;try{d=O.get(this.loadedName+"_path_"+E)}catch(j){if(!this.ignoreErrors)throw j;return(0,o.warn)(`getPathGenerator - ignoring character: "${j}".`),this.compiledGlyphs[E]=function(T,x){}}if(this.isEvalSupported&&o.FeatureTest.isEvalSupported){const j=[];for(const T of d){const x=T.args!==void 0?T.args.join(","):"";j.push("c.",T.cmd,"(",x,`);
`)}return this.compiledGlyphs[E]=new Function("c","size",j.join(""))}return this.compiledGlyphs[E]=function(j,T){for(const x of d)x.cmd==="scale"&&(x.args=[T,-T]),j[x.cmd].apply(j,x.args)}}}c.FontFaceObject=q},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.NodeStandardFontDataFactory=c.NodeFilterFactory=c.NodeCanvasFactory=c.NodeCMapReaderFactory=void 0;var o=G(7);G(1);const b=function(E){return new Promise((d,j)=>{require$$5.readFile(E,(x,m)=>{if(x||!m){j(new Error(x));return}d(new Uint8Array(m))})})};class q extends o.BaseFilterFactory{}c.NodeFilterFactory=q;class B extends o.BaseCanvasFactory{_createCanvas(d,j){return require$$5.createCanvas(d,j)}}c.NodeCanvasFactory=B;class tt extends o.BaseCMapReaderFactory{_fetchData(d,j){return b(d).then(T=>({cMapData:T,compressionType:j}))}}c.NodeCMapReaderFactory=tt;class O extends o.BaseStandardFontDataFactory{_fetchData(d){return b(d)}}c.NodeStandardFontDataFactory=O},(L,c,G)=>{var rt,qe,Xe;Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasGraphics=void 0;var o=G(1),b=G(6),q=G(12),B=G(13);const tt=16,O=100,E=4096,d=15,j=10,T=1e3,x=16;function m(R,n){if(R._removeMirroring)throw new Error("Context is already forwarding operations.");R.__originalSave=R.save,R.__originalRestore=R.restore,R.__originalRotate=R.rotate,R.__originalScale=R.scale,R.__originalTranslate=R.translate,R.__originalTransform=R.transform,R.__originalSetTransform=R.setTransform,R.__originalResetTransform=R.resetTransform,R.__originalClip=R.clip,R.__originalMoveTo=R.moveTo,R.__originalLineTo=R.lineTo,R.__originalBezierCurveTo=R.bezierCurveTo,R.__originalRect=R.rect,R.__originalClosePath=R.closePath,R.__originalBeginPath=R.beginPath,R._removeMirroring=()=>{R.save=R.__originalSave,R.restore=R.__originalRestore,R.rotate=R.__originalRotate,R.scale=R.__originalScale,R.translate=R.__originalTranslate,R.transform=R.__originalTransform,R.setTransform=R.__originalSetTransform,R.resetTransform=R.__originalResetTransform,R.clip=R.__originalClip,R.moveTo=R.__originalMoveTo,R.lineTo=R.__originalLineTo,R.bezierCurveTo=R.__originalBezierCurveTo,R.rect=R.__originalRect,R.closePath=R.__originalClosePath,R.beginPath=R.__originalBeginPath,delete R._removeMirroring},R.save=function(){n.save(),this.__originalSave()},R.restore=function(){n.restore(),this.__originalRestore()},R.translate=function(p,k){n.translate(p,k),this.__originalTranslate(p,k)},R.scale=function(p,k){n.scale(p,k),this.__originalScale(p,k)},R.transform=function(p,k,F,I,z,et){n.transform(p,k,F,I,z,et),this.__originalTransform(p,k,F,I,z,et)},R.setTransform=function(p,k,F,I,z,et){n.setTransform(p,k,F,I,z,et),this.__originalSetTransform(p,k,F,I,z,et)},R.resetTransform=function(){n.resetTransform(),this.__originalResetTransform()},R.rotate=function(p){n.rotate(p),this.__originalRotate(p)},R.clip=function(p){n.clip(p),this.__originalClip(p)},R.moveTo=function(i,p){n.moveTo(i,p),this.__originalMoveTo(i,p)},R.lineTo=function(i,p){n.lineTo(i,p),this.__originalLineTo(i,p)},R.bezierCurveTo=function(i,p,k,F,I,z){n.bezierCurveTo(i,p,k,F,I,z),this.__originalBezierCurveTo(i,p,k,F,I,z)},R.rect=function(i,p,k,F){n.rect(i,p,k,F),this.__originalRect(i,p,k,F)},R.closePath=function(){n.closePath(),this.__originalClosePath()},R.beginPath=function(){n.beginPath(),this.__originalBeginPath()}}class v{constructor(n){this.canvasFactory=n,this.cache=Object.create(null)}getCanvas(n,i,p){let k;return this.cache[n]!==void 0?(k=this.cache[n],this.canvasFactory.reset(k,i,p)):(k=this.canvasFactory.create(i,p),this.cache[n]=k),k}delete(n){delete this.cache[n]}clear(){for(const n in this.cache){const i=this.cache[n];this.canvasFactory.destroy(i),delete this.cache[n]}}}function f(R,n,i,p,k,F,I,z,et,dt){const[ut,mt,yt,xt,st,it]=(0,b.getCurrentTransform)(R);if(mt===0&&yt===0){const V=I*ut+st,nt=Math.round(V),ft=z*xt+it,vt=Math.round(ft),At=(I+et)*ut+st,Q=Math.abs(Math.round(At)-nt)||1,wt=(z+dt)*xt+it,St=Math.abs(Math.round(wt)-vt)||1;return R.setTransform(Math.sign(ut),0,0,Math.sign(xt),nt,vt),R.drawImage(n,i,p,k,F,0,0,Q,St),R.setTransform(ut,mt,yt,xt,st,it),[Q,St]}if(ut===0&&xt===0){const V=z*yt+st,nt=Math.round(V),ft=I*mt+it,vt=Math.round(ft),At=(z+dt)*yt+st,Q=Math.abs(Math.round(At)-nt)||1,wt=(I+et)*mt+it,St=Math.abs(Math.round(wt)-vt)||1;return R.setTransform(0,Math.sign(mt),Math.sign(yt),0,nt,vt),R.drawImage(n,i,p,k,F,0,0,St,Q),R.setTransform(ut,mt,yt,xt,st,it),[St,Q]}R.drawImage(n,i,p,k,F,I,z,et,dt);const A=Math.hypot(ut,mt),M=Math.hypot(yt,xt);return[A*et,M*dt]}function u(R){const{width:n,height:i}=R;if(n>T||i>T)return null;const p=1e3,k=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),F=n+1;let I=new Uint8Array(F*(i+1)),z,et,dt;const ut=n+7&-8;let mt=new Uint8Array(ut*i),yt=0;for(const M of R.data){let V=128;for(;V>0;)mt[yt++]=M&V?0:255,V>>=1}let xt=0;for(yt=0,mt[yt]!==0&&(I[0]=1,++xt),et=1;et<n;et++)mt[yt]!==mt[yt+1]&&(I[et]=mt[yt]?2:1,++xt),yt++;for(mt[yt]!==0&&(I[et]=2,++xt),z=1;z<i;z++){yt=z*ut,dt=z*F,mt[yt-ut]!==mt[yt]&&(I[dt]=mt[yt]?1:8,++xt);let M=(mt[yt]?4:0)+(mt[yt-ut]?8:0);for(et=1;et<n;et++)M=(M>>2)+(mt[yt+1]?4:0)+(mt[yt-ut+1]?8:0),k[M]&&(I[dt+et]=k[M],++xt),yt++;if(mt[yt-ut]!==mt[yt]&&(I[dt+et]=mt[yt]?2:4,++xt),xt>p)return null}for(yt=ut*(i-1),dt=z*F,mt[yt]!==0&&(I[dt]=8,++xt),et=1;et<n;et++)mt[yt]!==mt[yt+1]&&(I[dt+et]=mt[yt]?4:8,++xt),yt++;if(mt[yt]!==0&&(I[dt+et]=4,++xt),xt>p)return null;const st=new Int32Array([0,F,-1,0,-F,0,0,0,1]),it=new Path2D;for(z=0;xt&&z<=i;z++){let M=z*F;const V=M+n;for(;M<V&&!I[M];)M++;if(M===V)continue;it.moveTo(M%F,z);const nt=M;let ft=I[M];do{const vt=st[ft];do M+=vt;while(!I[M]);const At=I[M];At!==5&&At!==10?(ft=At,I[M]=0):(ft=At&51*ft>>4,I[M]&=ft>>2|ft<<2),it.lineTo(M%F,M/F|0),I[M]||--xt}while(nt!==M);--z}return mt=null,I=null,function(M){M.save(),M.scale(1/n,-1/i),M.translate(0,-i),M.fill(it),M.beginPath(),M.restore()}}class y{constructor(n,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=o.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=o.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,n,i])}clone(){const n=Object.create(this);return n.clipBox=this.clipBox.slice(),n}setCurrentPoint(n,i){this.x=n,this.y=i}updatePathMinMax(n,i,p){[i,p]=o.Util.applyTransform([i,p],n),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,p),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,p)}updateRectMinMax(n,i){const p=o.Util.applyTransform(i,n),k=o.Util.applyTransform(i.slice(2),n);this.minX=Math.min(this.minX,p[0],k[0]),this.minY=Math.min(this.minY,p[1],k[1]),this.maxX=Math.max(this.maxX,p[0],k[0]),this.maxY=Math.max(this.maxY,p[1],k[1])}updateScalingPathMinMax(n,i){o.Util.scaleMinMax(n,i),this.minX=Math.min(this.minX,i[0]),this.maxX=Math.max(this.maxX,i[1]),this.minY=Math.min(this.minY,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(n,i,p,k,F,I,z,et,dt,ut){const mt=o.Util.bezierBoundingBox(i,p,k,F,I,z,et,dt);if(ut){ut[0]=Math.min(ut[0],mt[0],mt[2]),ut[1]=Math.max(ut[1],mt[0],mt[2]),ut[2]=Math.min(ut[2],mt[1],mt[3]),ut[3]=Math.max(ut[3],mt[1],mt[3]);return}this.updateRectMinMax(n,mt)}getPathBoundingBox(n=q.PathType.FILL,i=null){const p=[this.minX,this.minY,this.maxX,this.maxY];if(n===q.PathType.STROKE){i||(0,o.unreachable)("Stroke bounding box must include transform.");const k=o.Util.singularValueDecompose2dScale(i),F=k[0]*this.lineWidth/2,I=k[1]*this.lineWidth/2;p[0]-=F,p[1]-=I,p[2]+=F,p[3]+=I}return p}updateClipFromPath(){const n=o.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(n||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(n){this.clipBox=n,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(n=q.PathType.FILL,i=null){return o.Util.intersect(this.clipBox,this.getPathBoundingBox(n,i))}}function D(R,n){if(typeof ImageData<"u"&&n instanceof ImageData){R.putImageData(n,0,0);return}const i=n.height,p=n.width,k=i%x,F=(i-k)/x,I=k===0?F:F+1,z=R.createImageData(p,x);let et=0,dt;const ut=n.data,mt=z.data;let yt,xt,st,it;if(n.kind===o.ImageKind.GRAYSCALE_1BPP){const A=ut.byteLength,M=new Uint32Array(mt.buffer,0,mt.byteLength>>2),V=M.length,nt=p+7>>3,ft=4294967295,vt=o.FeatureTest.isLittleEndian?4278190080:255;for(yt=0;yt<I;yt++){for(st=yt<F?x:k,dt=0,xt=0;xt<st;xt++){const At=A-et;let Q=0;const wt=At>nt?p:At*8-7,St=wt&-8;let Bt=0,Ot=0;for(;Q<St;Q+=8)Ot=ut[et++],M[dt++]=Ot&128?ft:vt,M[dt++]=Ot&64?ft:vt,M[dt++]=Ot&32?ft:vt,M[dt++]=Ot&16?ft:vt,M[dt++]=Ot&8?ft:vt,M[dt++]=Ot&4?ft:vt,M[dt++]=Ot&2?ft:vt,M[dt++]=Ot&1?ft:vt;for(;Q<wt;Q++)Bt===0&&(Ot=ut[et++],Bt=128),M[dt++]=Ot&Bt?ft:vt,Bt>>=1}for(;dt<V;)M[dt++]=0;R.putImageData(z,0,yt*x)}}else if(n.kind===o.ImageKind.RGBA_32BPP){for(xt=0,it=p*x*4,yt=0;yt<F;yt++)mt.set(ut.subarray(et,et+it)),et+=it,R.putImageData(z,0,xt),xt+=x;yt<I&&(it=p*k*4,mt.set(ut.subarray(et,et+it)),R.putImageData(z,0,xt))}else if(n.kind===o.ImageKind.RGB_24BPP)for(st=x,it=p*st,yt=0;yt<I;yt++){for(yt>=F&&(st=k,it=p*st),dt=0,xt=it;xt--;)mt[dt++]=ut[et++],mt[dt++]=ut[et++],mt[dt++]=ut[et++],mt[dt++]=255;R.putImageData(z,0,yt*x)}else throw new Error(`bad image kind: ${n.kind}`)}function _(R,n){if(n.bitmap){R.drawImage(n.bitmap,0,0);return}const i=n.height,p=n.width,k=i%x,F=(i-k)/x,I=k===0?F:F+1,z=R.createImageData(p,x);let et=0;const dt=n.data,ut=z.data;for(let mt=0;mt<I;mt++){const yt=mt<F?x:k;({srcPos:et}=(0,B.convertBlackAndWhiteToRGBA)({src:dt,srcPos:et,dest:ut,width:p,height:yt,nonBlackColor:0})),R.putImageData(z,0,mt*x)}}function h(R,n){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const p of i)R[p]!==void 0&&(n[p]=R[p]);R.setLineDash!==void 0&&(n.setLineDash(R.getLineDash()),n.lineDashOffset=R.lineDashOffset)}function e(R){if(R.strokeStyle=R.fillStyle="#000000",R.fillRule="nonzero",R.globalAlpha=1,R.lineWidth=1,R.lineCap="butt",R.lineJoin="miter",R.miterLimit=10,R.globalCompositeOperation="source-over",R.font="10px sans-serif",R.setLineDash!==void 0&&(R.setLineDash([]),R.lineDashOffset=0),!o.isNodeJS){const{filter:n}=R;n!=="none"&&n!==""&&(R.filter="none")}}function s(R,n,i,p){const k=R.length;for(let F=3;F<k;F+=4){const I=R[F];if(I===0)R[F-3]=n,R[F-2]=i,R[F-1]=p;else if(I<255){const z=255-I;R[F-3]=R[F-3]*I+n*z>>8,R[F-2]=R[F-2]*I+i*z>>8,R[F-1]=R[F-1]*I+p*z>>8}}}function l(R,n,i){const p=R.length,k=1/255;for(let F=3;F<p;F+=4){const I=i?i[R[F]]:R[F];n[F]=n[F]*I*k|0}}function a(R,n,i){const p=R.length;for(let k=3;k<p;k+=4){const F=R[k-3]*77+R[k-2]*152+R[k-1]*28;n[k]=i?n[k]*i[F>>8]>>8:n[k]*F>>16}}function w(R,n,i,p,k,F,I,z,et,dt,ut){const mt=!!F,yt=mt?F[0]:0,xt=mt?F[1]:0,st=mt?F[2]:0,it=k==="Luminosity"?a:l,M=Math.min(p,Math.ceil(1048576/i));for(let V=0;V<p;V+=M){const nt=Math.min(M,p-V),ft=R.getImageData(z-dt,V+(et-ut),i,nt),vt=n.getImageData(z,V+et,i,nt);mt&&s(ft.data,yt,xt,st),it(ft.data,vt.data,I),n.putImageData(vt,z,V+et)}}function r(R,n,i,p){const k=p[0],F=p[1],I=p[2]-k,z=p[3]-F;I===0||z===0||(w(n.context,i,I,z,n.subtype,n.backdrop,n.transferMap,k,F,n.offsetX,n.offsetY),R.save(),R.globalAlpha=1,R.globalCompositeOperation="source-over",R.setTransform(1,0,0,1,0,0),R.drawImage(i.canvas,0,0),R.restore())}function g(R,n){const i=o.Util.singularValueDecompose2dScale(R);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const p=Math.fround((globalThis.devicePixelRatio||1)*b.PixelsPerInch.PDF_TO_CSS_UNITS);return n!==void 0?n:i[0]<=p||i[1]<=p}const S=["butt","round","square"],J=["miter","round","bevel"],H={},Y={},Z=class Z{constructor(n,i,p,k,F,{optionalContentConfig:I,markedContentStack:z=null},et,dt){at(this,rt);this.ctx=n,this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=p,this.canvasFactory=k,this.filterFactory=F,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=z||[],this.optionalContentConfig=I,this.cachedCanvases=new v(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=et,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=dt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(n,i=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):i}beginDrawing({transform:n,viewport:i,transparency:p=!1,background:k=null}){const F=this.ctx.canvas.width,I=this.ctx.canvas.height,z=this.ctx.fillStyle;if(this.ctx.fillStyle=k||"#ffffff",this.ctx.fillRect(0,0,F,I),this.ctx.fillStyle=z,p){const et=this.cachedCanvases.getCanvas("transparent",F,I);this.compositeCtx=this.ctx,this.transparentCanvas=et.canvas,this.ctx=et.context,this.ctx.save(),this.ctx.transform(...(0,b.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),e(this.ctx),n&&(this.ctx.transform(...n),this.outputScaleX=n[0],this.outputScaleY=n[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=(0,b.getCurrentTransform)(this.ctx)}executeOperatorList(n,i,p,k){const F=n.argsArray,I=n.fnArray;let z=i||0;const et=F.length;if(et===z)return z;const dt=et-z>j&&typeof p=="function",ut=dt?Date.now()+d:0;let mt=0;const yt=this.commonObjs,xt=this.objs;let st;for(;;){if(k!==void 0&&z===k.nextBreakPoint)return k.breakIt(z,p),z;if(st=I[z],st!==o.OPS.dependency)this[st].apply(this,F[z]);else for(const it of F[z]){const A=it.startsWith("g_")?yt:xt;if(!A.has(it))return A.get(it,p),z}if(z++,z===et)return z;if(dt&&++mt>j){if(Date.now()>ut)return p(),z;mt=0}}}endDrawing(){K(this,rt,qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const n of this._cachedBitmapsMap.values()){for(const i of n.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);n.clear()}this._cachedBitmapsMap.clear(),K(this,rt,Xe).call(this)}_scaleImage(n,i){const p=n.width,k=n.height;let F=Math.max(Math.hypot(i[0],i[1]),1),I=Math.max(Math.hypot(i[2],i[3]),1),z=p,et=k,dt="prescale1",ut,mt;for(;F>2&&z>1||I>2&&et>1;){let yt=z,xt=et;F>2&&z>1&&(yt=z>=16384?Math.floor(z/2)-1||1:Math.ceil(z/2),F/=z/yt),I>2&&et>1&&(xt=et>=16384?Math.floor(et/2)-1||1:Math.ceil(et)/2,I/=et/xt),ut=this.cachedCanvases.getCanvas(dt,yt,xt),mt=ut.context,mt.clearRect(0,0,yt,xt),mt.drawImage(n,0,0,z,et,0,0,yt,xt),n=ut.canvas,z=yt,et=xt,dt=dt==="prescale1"?"prescale2":"prescale1"}return{img:n,paintWidth:z,paintHeight:et}}_createMaskCanvas(n){const i=this.ctx,{width:p,height:k}=n,F=this.current.fillColor,I=this.current.patternFill,z=(0,b.getCurrentTransform)(i);let et,dt,ut,mt;if((n.bitmap||n.data)&&n.count>1){const Q=n.bitmap||n.data.buffer;dt=JSON.stringify(I?z:[z.slice(0,4),F]),et=this._cachedBitmapsMap.get(Q),et||(et=new Map,this._cachedBitmapsMap.set(Q,et));const wt=et.get(dt);if(wt&&!I){const St=Math.round(Math.min(z[0],z[2])+z[4]),Bt=Math.round(Math.min(z[1],z[3])+z[5]);return{canvas:wt,offsetX:St,offsetY:Bt}}ut=wt}ut||(mt=this.cachedCanvases.getCanvas("maskCanvas",p,k),_(mt.context,n));let yt=o.Util.transform(z,[1/p,0,0,-1/k,0,0]);yt=o.Util.transform(yt,[1,0,0,1,0,-k]);const xt=o.Util.applyTransform([0,0],yt),st=o.Util.applyTransform([p,k],yt),it=o.Util.normalizeRect([xt[0],xt[1],st[0],st[1]]),A=Math.round(it[2]-it[0])||1,M=Math.round(it[3]-it[1])||1,V=this.cachedCanvases.getCanvas("fillCanvas",A,M),nt=V.context,ft=Math.min(xt[0],st[0]),vt=Math.min(xt[1],st[1]);nt.translate(-ft,-vt),nt.transform(...yt),ut||(ut=this._scaleImage(mt.canvas,(0,b.getCurrentTransformInverse)(nt)),ut=ut.img,et&&I&&et.set(dt,ut)),nt.imageSmoothingEnabled=g((0,b.getCurrentTransform)(nt),n.interpolate),f(nt,ut,0,0,ut.width,ut.height,0,0,p,k),nt.globalCompositeOperation="source-in";const At=o.Util.transform((0,b.getCurrentTransformInverse)(nt),[1,0,0,1,-ft,-vt]);return nt.fillStyle=I?F.getPattern(i,this,At,q.PathType.FILL):F,nt.fillRect(0,0,p,k),et&&!I&&(this.cachedCanvases.delete("fillCanvas"),et.set(dt,V.canvas)),{canvas:V.canvas,offsetX:Math.round(ft),offsetY:Math.round(vt)}}setLineWidth(n){n!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=n,this.ctx.lineWidth=n}setLineCap(n){this.ctx.lineCap=S[n]}setLineJoin(n){this.ctx.lineJoin=J[n]}setMiterLimit(n){this.ctx.miterLimit=n}setDash(n,i){const p=this.ctx;p.setLineDash!==void 0&&(p.setLineDash(n),p.lineDashOffset=i)}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[i,p]of n)switch(i){case"LW":this.setLineWidth(p);break;case"LC":this.setLineCap(p);break;case"LJ":this.setLineJoin(p);break;case"ML":this.setMiterLimit(p);break;case"D":this.setDash(p[0],p[1]);break;case"RI":this.setRenderingIntent(p);break;case"FL":this.setFlatness(p);break;case"Font":this.setFont(p[0],p[1]);break;case"CA":this.current.strokeAlpha=p;break;case"ca":this.current.fillAlpha=p,this.ctx.globalAlpha=p;break;case"BM":this.ctx.globalCompositeOperation=p;break;case"SMask":this.current.activeSMask=p?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(p);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const n=this.inSMaskMode;this.current.activeSMask&&!n?this.beginSMaskMode():!this.current.activeSMask&&n&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const n=this.ctx.canvas.width,i=this.ctx.canvas.height,p="smaskGroupAt"+this.groupLevel,k=this.cachedCanvases.getCanvas(p,n,i);this.suspendedCtx=this.ctx,this.ctx=k.context;const F=this.ctx;F.setTransform(...(0,b.getCurrentTransform)(this.suspendedCtx)),h(this.suspendedCtx,F),m(F,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),h(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(n){if(!this.current.activeSMask)return;n?(n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n[2]=Math.ceil(n[2]),n[3]=Math.ceil(n[3])):n=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,p=this.suspendedCtx;r(p,i,this.ctx,n),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(h(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),h(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(n,i,p,k,F,I){this.ctx.transform(n,i,p,k,F,I),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(n,i,p){const k=this.ctx,F=this.current;let I=F.x,z=F.y,et,dt;const ut=(0,b.getCurrentTransform)(k),mt=ut[0]===0&&ut[3]===0||ut[1]===0&&ut[2]===0,yt=mt?p.slice(0):null;for(let xt=0,st=0,it=n.length;xt<it;xt++)switch(n[xt]|0){case o.OPS.rectangle:I=i[st++],z=i[st++];const A=i[st++],M=i[st++],V=I+A,nt=z+M;k.moveTo(I,z),A===0||M===0?k.lineTo(V,nt):(k.lineTo(V,z),k.lineTo(V,nt),k.lineTo(I,nt)),mt||F.updateRectMinMax(ut,[I,z,V,nt]),k.closePath();break;case o.OPS.moveTo:I=i[st++],z=i[st++],k.moveTo(I,z),mt||F.updatePathMinMax(ut,I,z);break;case o.OPS.lineTo:I=i[st++],z=i[st++],k.lineTo(I,z),mt||F.updatePathMinMax(ut,I,z);break;case o.OPS.curveTo:et=I,dt=z,I=i[st+4],z=i[st+5],k.bezierCurveTo(i[st],i[st+1],i[st+2],i[st+3],I,z),F.updateCurvePathMinMax(ut,et,dt,i[st],i[st+1],i[st+2],i[st+3],I,z,yt),st+=6;break;case o.OPS.curveTo2:et=I,dt=z,k.bezierCurveTo(I,z,i[st],i[st+1],i[st+2],i[st+3]),F.updateCurvePathMinMax(ut,et,dt,I,z,i[st],i[st+1],i[st+2],i[st+3],yt),I=i[st+2],z=i[st+3],st+=4;break;case o.OPS.curveTo3:et=I,dt=z,I=i[st+2],z=i[st+3],k.bezierCurveTo(i[st],i[st+1],I,z,I,z),F.updateCurvePathMinMax(ut,et,dt,i[st],i[st+1],I,z,I,z,yt),st+=4;break;case o.OPS.closePath:k.closePath();break}mt&&F.updateScalingPathMinMax(ut,yt),F.setCurrentPoint(I,z)}closePath(){this.ctx.closePath()}stroke(n=!0){const i=this.ctx,p=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof p=="object"&&(p!=null&&p.getPattern)?(i.save(),i.strokeStyle=p.getPattern(i,this,(0,b.getCurrentTransformInverse)(i),q.PathType.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),n&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(n=!0){const i=this.ctx,p=this.current.fillColor,k=this.current.patternFill;let F=!1;k&&(i.save(),i.fillStyle=p.getPattern(i,this,(0,b.getCurrentTransformInverse)(i),q.PathType.FILL),F=!0);const I=this.current.getClippedPathBoundingBox();this.contentVisible&&I!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),F&&i.restore(),n&&this.consumePath(I)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=H}eoClip(){this.pendingClip=Y}beginText(){this.current.textMatrix=o.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const n=this.pendingTextPaths,i=this.ctx;if(n===void 0){i.beginPath();return}i.save(),i.beginPath();for(const p of n)i.setTransform(...p.transform),i.translate(p.x,p.y),p.addToPath(i,p.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(n){this.current.charSpacing=n}setWordSpacing(n){this.current.wordSpacing=n}setHScale(n){this.current.textHScale=n/100}setLeading(n){this.current.leading=-n}setFont(n,i){var ut;const p=this.commonObjs.get(n),k=this.current;if(!p)throw new Error(`Can't find font for ${n}`);if(k.fontMatrix=p.fontMatrix||o.FONT_IDENTITY_MATRIX,(k.fontMatrix[0]===0||k.fontMatrix[3]===0)&&(0,o.warn)("Invalid font matrix for font "+n),i<0?(i=-i,k.fontDirection=-1):k.fontDirection=1,this.current.font=p,this.current.fontSize=i,p.isType3Font)return;const F=p.loadedName||"sans-serif",I=((ut=p.systemFontInfo)==null?void 0:ut.css)||`"${F}", ${p.fallbackName}`;let z="normal";p.black?z="900":p.bold&&(z="bold");const et=p.italic?"italic":"normal";let dt=i;i<tt?dt=tt:i>O&&(dt=O),this.current.fontSizeScale=i/dt,this.ctx.font=`${et} ${z} ${dt}px ${I}`}setTextRenderingMode(n){this.current.textRenderingMode=n}setTextRise(n){this.current.textRise=n}moveText(n,i){this.current.x=this.current.lineX+=n,this.current.y=this.current.lineY+=i}setLeadingMoveText(n,i){this.setLeading(-i),this.moveText(n,i)}setTextMatrix(n,i,p,k,F,I){this.current.textMatrix=[n,i,p,k,F,I],this.current.textMatrixScale=Math.hypot(n,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(n,i,p,k){const F=this.ctx,I=this.current,z=I.font,et=I.textRenderingMode,dt=I.fontSize/I.fontSizeScale,ut=et&o.TextRenderingMode.FILL_STROKE_MASK,mt=!!(et&o.TextRenderingMode.ADD_TO_PATH_FLAG),yt=I.patternFill&&!z.missingFile;let xt;(z.disableFontFace||mt||yt)&&(xt=z.getPathGenerator(this.commonObjs,n)),z.disableFontFace||yt?(F.save(),F.translate(i,p),F.beginPath(),xt(F,dt),k&&F.setTransform(...k),(ut===o.TextRenderingMode.FILL||ut===o.TextRenderingMode.FILL_STROKE)&&F.fill(),(ut===o.TextRenderingMode.STROKE||ut===o.TextRenderingMode.FILL_STROKE)&&F.stroke(),F.restore()):((ut===o.TextRenderingMode.FILL||ut===o.TextRenderingMode.FILL_STROKE)&&F.fillText(n,i,p),(ut===o.TextRenderingMode.STROKE||ut===o.TextRenderingMode.FILL_STROKE)&&F.strokeText(n,i,p)),mt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,b.getCurrentTransform)(F),x:i,y:p,fontSize:dt,addToPath:xt})}get isFontSubpixelAAEnabled(){const{context:n}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);n.scale(1.5,1),n.fillText("I",0,10);const i=n.getImageData(0,0,10,10).data;let p=!1;for(let k=3;k<i.length;k+=4)if(i[k]>0&&i[k]<255){p=!0;break}return(0,o.shadow)(this,"isFontSubpixelAAEnabled",p)}showText(n){const i=this.current,p=i.font;if(p.isType3Font)return this.showType3Text(n);const k=i.fontSize;if(k===0)return;const F=this.ctx,I=i.fontSizeScale,z=i.charSpacing,et=i.wordSpacing,dt=i.fontDirection,ut=i.textHScale*dt,mt=n.length,yt=p.vertical,xt=yt?1:-1,st=p.defaultVMetrics,it=k*i.fontMatrix[0],A=i.textRenderingMode===o.TextRenderingMode.FILL&&!p.disableFontFace&&!i.patternFill;F.save(),F.transform(...i.textMatrix),F.translate(i.x,i.y+i.textRise),dt>0?F.scale(ut,-1):F.scale(ut,1);let M;if(i.patternFill){F.save();const At=i.fillColor.getPattern(F,this,(0,b.getCurrentTransformInverse)(F),q.PathType.FILL);M=(0,b.getCurrentTransform)(F),F.restore(),F.fillStyle=At}let V=i.lineWidth;const nt=i.textMatrixScale;if(nt===0||V===0){const At=i.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;(At===o.TextRenderingMode.STROKE||At===o.TextRenderingMode.FILL_STROKE)&&(V=this.getSinglePixelWidth())}else V/=nt;if(I!==1&&(F.scale(I,I),V/=I),F.lineWidth=V,p.isInvalidPDFjsFont){const At=[];let Q=0;for(const wt of n)At.push(wt.unicode),Q+=wt.width;F.fillText(At.join(""),0,0),i.x+=Q*it*ut,F.restore(),this.compose();return}let ft=0,vt;for(vt=0;vt<mt;++vt){const At=n[vt];if(typeof At=="number"){ft+=xt*At*k/1e3;continue}let Q=!1;const wt=(At.isSpace?et:0)+z,St=At.fontChar,Bt=At.accent;let Ot,Gt,Pt=At.width;if(yt){const zt=At.vmetric||st,Xt=-(At.vmetric?zt[1]:Pt*.5)*it,Et=zt[2]*it;Pt=zt?-zt[0]:Pt,Ot=Xt/I,Gt=(ft+Et)/I}else Ot=ft/I,Gt=0;if(p.remeasure&&Pt>0){const zt=F.measureText(St).width*1e3/k*I;if(Pt<zt&&this.isFontSubpixelAAEnabled){const Xt=Pt/zt;Q=!0,F.save(),F.scale(Xt,1),Ot/=Xt}else Pt!==zt&&(Ot+=(Pt-zt)/2e3*k/I)}if(this.contentVisible&&(At.isInFont||p.missingFile)){if(A&&!Bt)F.fillText(St,Ot,Gt);else if(this.paintChar(St,Ot,Gt,M),Bt){const zt=Ot+k*Bt.offset.x/I,Xt=Gt-k*Bt.offset.y/I;this.paintChar(Bt.fontChar,zt,Xt,M)}}const Lt=yt?Pt*it-wt*dt:Pt*it+wt*dt;ft+=Lt,Q&&F.restore()}yt?i.y-=ft:i.x+=ft*ut,F.restore(),this.compose()}showType3Text(n){const i=this.ctx,p=this.current,k=p.font,F=p.fontSize,I=p.fontDirection,z=k.vertical?1:-1,et=p.charSpacing,dt=p.wordSpacing,ut=p.textHScale*I,mt=p.fontMatrix||o.FONT_IDENTITY_MATRIX,yt=n.length,xt=p.textRenderingMode===o.TextRenderingMode.INVISIBLE;let st,it,A,M;if(!(xt||F===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...p.textMatrix),i.translate(p.x,p.y),i.scale(ut,I),st=0;st<yt;++st){if(it=n[st],typeof it=="number"){M=z*it*F/1e3,this.ctx.translate(M,0),p.x+=M*ut;continue}const V=(it.isSpace?dt:0)+et,nt=k.charProcOperatorList[it.operatorListId];if(!nt){(0,o.warn)(`Type3 character "${it.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=it,this.save(),i.scale(F,F),i.transform(...mt),this.executeOperatorList(nt),this.restore()),A=o.Util.applyTransform([it.width,0],mt)[0]*F+V,i.translate(A,0),p.x+=A*ut}i.restore(),this.processingType3=null}}setCharWidth(n,i){}setCharWidthAndBounds(n,i,p,k,F,I){this.ctx.rect(p,k,F-p,I-k),this.ctx.clip(),this.endPath()}getColorN_Pattern(n){let i;if(n[0]==="TilingPattern"){const p=n[1],k=this.baseTransform||(0,b.getCurrentTransform)(this.ctx),F={createCanvasGraphics:I=>new Z(I,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new q.TilingPattern(n,p,this.ctx,F,k)}else i=this._getPattern(n[1],n[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(n,i,p){const k=o.Util.makeHexColor(n,i,p);this.ctx.strokeStyle=k,this.current.strokeColor=k}setFillRGBColor(n,i,p){const k=o.Util.makeHexColor(n,i,p);this.ctx.fillStyle=k,this.current.fillColor=k,this.current.patternFill=!1}_getPattern(n,i=null){let p;return this.cachedPatterns.has(n)?p=this.cachedPatterns.get(n):(p=(0,q.getShadingPattern)(this.getObject(n)),this.cachedPatterns.set(n,p)),i&&(p.matrix=i),p}shadingFill(n){if(!this.contentVisible)return;const i=this.ctx;this.save();const p=this._getPattern(n);i.fillStyle=p.getPattern(i,this,(0,b.getCurrentTransformInverse)(i),q.PathType.SHADING);const k=(0,b.getCurrentTransformInverse)(i);if(k){const{width:F,height:I}=i.canvas,[z,et,dt,ut]=o.Util.getAxialAlignedBoundingBox([0,0,F,I],k);this.ctx.fillRect(z,et,dt-z,ut-et)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,o.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,o.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(n,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(n)&&n.length===6&&this.transform(...n),this.baseTransform=(0,b.getCurrentTransform)(this.ctx),i)){const p=i[2]-i[0],k=i[3]-i[1];this.ctx.rect(i[0],i[1],p,k),this.current.updateRectMinMax((0,b.getCurrentTransform)(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(n){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;n.isolated||(0,o.info)("TODO: Support non-isolated groups."),n.knockout&&(0,o.warn)("Knockout groups not supported.");const p=(0,b.getCurrentTransform)(i);if(n.matrix&&i.transform(...n.matrix),!n.bbox)throw new Error("Bounding box is required.");let k=o.Util.getAxialAlignedBoundingBox(n.bbox,(0,b.getCurrentTransform)(i));const F=[0,0,i.canvas.width,i.canvas.height];k=o.Util.intersect(k,F)||[0,0,0,0];const I=Math.floor(k[0]),z=Math.floor(k[1]);let et=Math.max(Math.ceil(k[2])-I,1),dt=Math.max(Math.ceil(k[3])-z,1),ut=1,mt=1;et>E&&(ut=et/E,et=E),dt>E&&(mt=dt/E,dt=E),this.current.startNewPathAndClipBox([0,0,et,dt]);let yt="groupAt"+this.groupLevel;n.smask&&(yt+="_smask_"+this.smaskCounter++%2);const xt=this.cachedCanvases.getCanvas(yt,et,dt),st=xt.context;st.scale(1/ut,1/mt),st.translate(-I,-z),st.transform(...p),n.smask?this.smaskStack.push({canvas:xt.canvas,context:st,offsetX:I,offsetY:z,scaleX:ut,scaleY:mt,subtype:n.smask.subtype,backdrop:n.smask.backdrop,transferMap:n.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(I,z),i.scale(ut,mt),i.save()),h(i,st),this.ctx=st,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(n){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,p=this.groupStack.pop();if(this.ctx=p,this.ctx.imageSmoothingEnabled=!1,n.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const k=(0,b.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...k);const F=o.Util.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],k);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(F)}}beginAnnotation(n,i,p,k,F){if(K(this,rt,qe).call(this),e(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(i)&&i.length===4){const I=i[2]-i[0],z=i[3]-i[1];if(F&&this.annotationCanvasMap){p=p.slice(),p[4]-=i[0],p[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=I,i[3]=z;const[et,dt]=o.Util.singularValueDecompose2dScale((0,b.getCurrentTransform)(this.ctx)),{viewportScale:ut}=this,mt=Math.ceil(I*this.outputScaleX*ut),yt=Math.ceil(z*this.outputScaleY*ut);this.annotationCanvas=this.canvasFactory.create(mt,yt);const{canvas:xt,context:st}=this.annotationCanvas;this.annotationCanvasMap.set(n,xt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=st,this.ctx.save(),this.ctx.setTransform(et,0,0,-dt,0,z*dt),e(this.ctx)}else e(this.ctx),this.ctx.rect(i[0],i[1],I,z),this.ctx.clip(),this.endPath()}this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...p),this.transform(...k)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),K(this,rt,Xe).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(n){if(!this.contentVisible)return;const i=n.count;n=this.getObject(n.data,n),n.count=i;const p=this.ctx,k=this.processingType3;if(k&&(k.compiled===void 0&&(k.compiled=u(n)),k.compiled)){k.compiled(p);return}const F=this._createMaskCanvas(n),I=F.canvas;p.save(),p.setTransform(1,0,0,1,0,0),p.drawImage(I,F.offsetX,F.offsetY),p.restore(),this.compose()}paintImageMaskXObjectRepeat(n,i,p=0,k=0,F,I){if(!this.contentVisible)return;n=this.getObject(n.data,n);const z=this.ctx;z.save();const et=(0,b.getCurrentTransform)(z);z.transform(i,p,k,F,0,0);const dt=this._createMaskCanvas(n);z.setTransform(1,0,0,1,dt.offsetX-et[4],dt.offsetY-et[5]);for(let ut=0,mt=I.length;ut<mt;ut+=2){const yt=o.Util.transform(et,[i,p,k,F,I[ut],I[ut+1]]),[xt,st]=o.Util.applyTransform([0,0],yt);z.drawImage(dt.canvas,xt,st)}z.restore(),this.compose()}paintImageMaskXObjectGroup(n){if(!this.contentVisible)return;const i=this.ctx,p=this.current.fillColor,k=this.current.patternFill;for(const F of n){const{data:I,width:z,height:et,transform:dt}=F,ut=this.cachedCanvases.getCanvas("maskCanvas",z,et),mt=ut.context;mt.save();const yt=this.getObject(I,F);_(mt,yt),mt.globalCompositeOperation="source-in",mt.fillStyle=k?p.getPattern(mt,this,(0,b.getCurrentTransformInverse)(i),q.PathType.FILL):p,mt.fillRect(0,0,z,et),mt.restore(),i.save(),i.transform(...dt),i.scale(1,-1),f(i,ut.canvas,0,0,z,et,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(n){if(!this.contentVisible)return;const i=this.getObject(n);if(!i){(0,o.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(n,i,p,k){if(!this.contentVisible)return;const F=this.getObject(n);if(!F){(0,o.warn)("Dependent image isn't ready yet");return}const I=F.width,z=F.height,et=[];for(let dt=0,ut=k.length;dt<ut;dt+=2)et.push({transform:[i,0,0,p,k[dt],k[dt+1]],x:0,y:0,w:I,h:z});this.paintInlineImageXObjectGroup(F,et)}applyTransferMapsToCanvas(n){return this.current.transferMaps!=="none"&&(n.filter=this.current.transferMaps,n.drawImage(n.canvas,0,0),n.filter="none"),n.canvas}applyTransferMapsToBitmap(n){if(this.current.transferMaps==="none")return n.bitmap;const{bitmap:i,width:p,height:k}=n,F=this.cachedCanvases.getCanvas("inlineImage",p,k),I=F.context;return I.filter=this.current.transferMaps,I.drawImage(i,0,0),I.filter="none",F.canvas}paintInlineImageXObject(n){if(!this.contentVisible)return;const i=n.width,p=n.height,k=this.ctx;if(this.save(),!o.isNodeJS){const{filter:z}=k;z!=="none"&&z!==""&&(k.filter="none")}k.scale(1/i,-1/p);let F;if(n.bitmap)F=this.applyTransferMapsToBitmap(n);else if(typeof HTMLElement=="function"&&n instanceof HTMLElement||!n.data)F=n;else{const et=this.cachedCanvases.getCanvas("inlineImage",i,p).context;D(et,n),F=this.applyTransferMapsToCanvas(et)}const I=this._scaleImage(F,(0,b.getCurrentTransformInverse)(k));k.imageSmoothingEnabled=g((0,b.getCurrentTransform)(k),n.interpolate),f(k,I.img,0,0,I.paintWidth,I.paintHeight,0,-p,i,p),this.compose(),this.restore()}paintInlineImageXObjectGroup(n,i){if(!this.contentVisible)return;const p=this.ctx;let k;if(n.bitmap)k=n.bitmap;else{const F=n.width,I=n.height,et=this.cachedCanvases.getCanvas("inlineImage",F,I).context;D(et,n),k=this.applyTransferMapsToCanvas(et)}for(const F of i)p.save(),p.transform(...F.transform),p.scale(1,-1),f(p,k,F.x,F.y,F.w,F.h,0,-1,1,1),p.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(n){}markPointProps(n,i){}beginMarkedContent(n){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(n,i){n==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const p=this.ctx;this.pendingClip&&(i||(this.pendingClip===Y?p.clip("evenodd"):p.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),p.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const n=(0,b.getCurrentTransform)(this.ctx);if(n[1]===0&&n[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(n[0]),Math.abs(n[3]));else{const i=Math.abs(n[0]*n[3]-n[2]*n[1]),p=Math.hypot(n[0],n[2]),k=Math.hypot(n[1],n[3]);this._cachedGetSinglePixelWidth=Math.max(p,k)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:n}=this.current,{a:i,b:p,c:k,d:F}=this.ctx.getTransform();let I,z;if(p===0&&k===0){const et=Math.abs(i),dt=Math.abs(F);if(et===dt)if(n===0)I=z=1/et;else{const ut=et*n;I=z=ut<1?1/ut:1}else if(n===0)I=1/et,z=1/dt;else{const ut=et*n,mt=dt*n;I=ut<1?1/ut:1,z=mt<1?1/mt:1}}else{const et=Math.abs(i*F-p*k),dt=Math.hypot(i,p),ut=Math.hypot(k,F);if(n===0)I=ut/et,z=dt/et;else{const mt=n*et;I=ut>mt?ut/mt:1,z=dt>mt?dt/mt:1}}this._cachedScaleForStroking[0]=I,this._cachedScaleForStroking[1]=z}return this._cachedScaleForStroking}rescaleAndStroke(n){const{ctx:i}=this,{lineWidth:p}=this.current,[k,F]=this.getScaleForStroking();if(i.lineWidth=p||1,k===1&&F===1){i.stroke();return}const I=i.getLineDash();if(n&&i.save(),i.scale(k,F),I.length>0){const z=Math.max(k,F);i.setLineDash(I.map(et=>et/z)),i.lineDashOffset/=z}i.stroke(),n&&i.restore()}isContentVisible(){for(let n=this.markedContentStack.length-1;n>=0;n--)if(!this.markedContentStack[n].visible)return!1;return!0}};rt=new WeakSet,qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Xe=function(){if(this.pageColors){const n=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(n!=="none"){const i=this.ctx.filter;this.ctx.filter=n,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}};let $=Z;c.CanvasGraphics=$;for(const R in o.OPS)$.prototype[R]!==void 0&&($.prototype[o.OPS[R]]=$.prototype[R])},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TilingPattern=c.PathType=void 0,c.getShadingPattern=x;var o=G(1),b=G(6);const q={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};c.PathType=q;function B(u,y){if(!y)return;const D=y[2]-y[0],_=y[3]-y[1],h=new Path2D;h.rect(y[0],y[1],D,_),u.clip(h)}class tt{constructor(){this.constructor===tt&&(0,o.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,o.unreachable)("Abstract method `getPattern` called.")}}class O extends tt{constructor(y){super(),this._type=y[1],this._bbox=y[2],this._colorStops=y[3],this._p0=y[4],this._p1=y[5],this._r0=y[6],this._r1=y[7],this.matrix=null}_createGradient(y){let D;this._type==="axial"?D=y.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(D=y.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const _ of this._colorStops)D.addColorStop(_[0],_[1]);return D}getPattern(y,D,_,h){let e;if(h===q.STROKE||h===q.FILL){const s=D.current.getClippedPathBoundingBox(h,(0,b.getCurrentTransform)(y))||[0,0,0,0],l=Math.ceil(s[2]-s[0])||1,a=Math.ceil(s[3]-s[1])||1,w=D.cachedCanvases.getCanvas("pattern",l,a,!0),r=w.context;r.clearRect(0,0,r.canvas.width,r.canvas.height),r.beginPath(),r.rect(0,0,r.canvas.width,r.canvas.height),r.translate(-s[0],-s[1]),_=o.Util.transform(_,[1,0,0,1,s[0],s[1]]),r.transform(...D.baseTransform),this.matrix&&r.transform(...this.matrix),B(r,this._bbox),r.fillStyle=this._createGradient(r),r.fill(),e=y.createPattern(w.canvas,"no-repeat");const g=new DOMMatrix(_);e.setTransform(g)}else B(y,this._bbox),e=this._createGradient(y);return e}}function E(u,y,D,_,h,e,s,l){const a=y.coords,w=y.colors,r=u.data,g=u.width*4;let S;a[D+1]>a[_+1]&&(S=D,D=_,_=S,S=e,e=s,s=S),a[_+1]>a[h+1]&&(S=_,_=h,h=S,S=s,s=l,l=S),a[D+1]>a[_+1]&&(S=D,D=_,_=S,S=e,e=s,s=S);const J=(a[D]+y.offsetX)*y.scaleX,H=(a[D+1]+y.offsetY)*y.scaleY,Y=(a[_]+y.offsetX)*y.scaleX,$=(a[_+1]+y.offsetY)*y.scaleY,rt=(a[h]+y.offsetX)*y.scaleX,P=(a[h+1]+y.offsetY)*y.scaleY;if(H>=P)return;const W=w[e],Z=w[e+1],R=w[e+2],n=w[s],i=w[s+1],p=w[s+2],k=w[l],F=w[l+1],I=w[l+2],z=Math.round(H),et=Math.round(P);let dt,ut,mt,yt,xt,st,it,A;for(let M=z;M<=et;M++){if(M<$){const At=M<H?0:(H-M)/(H-$);dt=J-(J-Y)*At,ut=W-(W-n)*At,mt=Z-(Z-i)*At,yt=R-(R-p)*At}else{let At;M>P?At=1:$===P?At=0:At=($-M)/($-P),dt=Y-(Y-rt)*At,ut=n-(n-k)*At,mt=i-(i-F)*At,yt=p-(p-I)*At}let V;M<H?V=0:M>P?V=1:V=(H-M)/(H-P),xt=J-(J-rt)*V,st=W-(W-k)*V,it=Z-(Z-F)*V,A=R-(R-I)*V;const nt=Math.round(Math.min(dt,xt)),ft=Math.round(Math.max(dt,xt));let vt=g*M+nt*4;for(let At=nt;At<=ft;At++)V=(dt-At)/(dt-xt),V<0?V=0:V>1&&(V=1),r[vt++]=ut-(ut-st)*V|0,r[vt++]=mt-(mt-it)*V|0,r[vt++]=yt-(yt-A)*V|0,r[vt++]=255}}function d(u,y,D){const _=y.coords,h=y.colors;let e,s;switch(y.type){case"lattice":const l=y.verticesPerRow,a=Math.floor(_.length/l)-1,w=l-1;for(e=0;e<a;e++){let r=e*l;for(let g=0;g<w;g++,r++)E(u,D,_[r],_[r+1],_[r+l],h[r],h[r+1],h[r+l]),E(u,D,_[r+l+1],_[r+1],_[r+l],h[r+l+1],h[r+1],h[r+l])}break;case"triangles":for(e=0,s=_.length;e<s;e+=3)E(u,D,_[e],_[e+1],_[e+2],h[e],h[e+1],h[e+2]);break;default:throw new Error("illegal figure")}}class j extends tt{constructor(y){super(),this._coords=y[2],this._colors=y[3],this._figures=y[4],this._bounds=y[5],this._bbox=y[7],this._background=y[8],this.matrix=null}_createMeshCanvas(y,D,_){const l=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),w=Math.ceil(this._bounds[2])-l,r=Math.ceil(this._bounds[3])-a,g=Math.min(Math.ceil(Math.abs(w*y[0]*1.1)),3e3),S=Math.min(Math.ceil(Math.abs(r*y[1]*1.1)),3e3),J=w/g,H=r/S,Y={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-a,scaleX:1/J,scaleY:1/H},$=g+2*2,rt=S+2*2,P=_.getCanvas("mesh",$,rt,!1),W=P.context,Z=W.createImageData(g,S);if(D){const n=Z.data;for(let i=0,p=n.length;i<p;i+=4)n[i]=D[0],n[i+1]=D[1],n[i+2]=D[2],n[i+3]=255}for(const n of this._figures)d(Z,n,Y);return W.putImageData(Z,2,2),{canvas:P.canvas,offsetX:l-2*J,offsetY:a-2*H,scaleX:J,scaleY:H}}getPattern(y,D,_,h){B(y,this._bbox);let e;if(h===q.SHADING)e=o.Util.singularValueDecompose2dScale((0,b.getCurrentTransform)(y));else if(e=o.Util.singularValueDecompose2dScale(D.baseTransform),this.matrix){const l=o.Util.singularValueDecompose2dScale(this.matrix);e=[e[0]*l[0],e[1]*l[1]]}const s=this._createMeshCanvas(e,h===q.SHADING?null:this._background,D.cachedCanvases);return h!==q.SHADING&&(y.setTransform(...D.baseTransform),this.matrix&&y.transform(...this.matrix)),y.translate(s.offsetX,s.offsetY),y.scale(s.scaleX,s.scaleY),y.createPattern(s.canvas,"no-repeat")}}class T extends tt{getPattern(){return"hotpink"}}function x(u){switch(u[0]){case"RadialAxial":return new O(u);case"Mesh":return new j(u);case"Dummy":return new T}throw new Error(`Unknown IR type: ${u[0]}`)}const m={COLORED:1,UNCOLORED:2},f=class f{constructor(y,D,_,h,e){this.operatorList=y[2],this.matrix=y[3]||[1,0,0,1,0,0],this.bbox=y[4],this.xstep=y[5],this.ystep=y[6],this.paintType=y[7],this.tilingType=y[8],this.color=D,this.ctx=_,this.canvasGraphicsFactory=h,this.baseTransform=e}createPatternCanvas(y){const D=this.operatorList,_=this.bbox,h=this.xstep,e=this.ystep,s=this.paintType,l=this.tilingType,a=this.color,w=this.canvasGraphicsFactory;(0,o.info)("TilingType: "+l);const r=_[0],g=_[1],S=_[2],J=_[3],H=o.Util.singularValueDecompose2dScale(this.matrix),Y=o.Util.singularValueDecompose2dScale(this.baseTransform),$=[H[0]*Y[0],H[1]*Y[1]],rt=this.getSizeAndScale(h,this.ctx.canvas.width,$[0]),P=this.getSizeAndScale(e,this.ctx.canvas.height,$[1]),W=y.cachedCanvases.getCanvas("pattern",rt.size,P.size,!0),Z=W.context,R=w.createCanvasGraphics(Z);R.groupLevel=y.groupLevel,this.setFillAndStrokeStyleToContext(R,s,a);let n=r,i=g,p=S,k=J;return r<0&&(n=0,p+=Math.abs(r)),g<0&&(i=0,k+=Math.abs(g)),Z.translate(-(rt.scale*n),-(P.scale*i)),R.transform(rt.scale,0,0,P.scale,0,0),Z.save(),this.clipBbox(R,n,i,p,k),R.baseTransform=(0,b.getCurrentTransform)(R.ctx),R.executeOperatorList(D),R.endDrawing(),{canvas:W.canvas,scaleX:rt.scale,scaleY:P.scale,offsetX:n,offsetY:i}}getSizeAndScale(y,D,_){y=Math.abs(y);const h=Math.max(f.MAX_PATTERN_SIZE,D);let e=Math.ceil(y*_);return e>=h?e=h:_=e/y,{scale:_,size:e}}clipBbox(y,D,_,h,e){const s=h-D,l=e-_;y.ctx.rect(D,_,s,l),y.current.updateRectMinMax((0,b.getCurrentTransform)(y.ctx),[D,_,h,e]),y.clip(),y.endPath()}setFillAndStrokeStyleToContext(y,D,_){const h=y.ctx,e=y.current;switch(D){case m.COLORED:const s=this.ctx;h.fillStyle=s.fillStyle,h.strokeStyle=s.strokeStyle,e.fillColor=s.fillStyle,e.strokeColor=s.strokeStyle;break;case m.UNCOLORED:const l=o.Util.makeHexColor(_[0],_[1],_[2]);h.fillStyle=l,h.strokeStyle=l,e.fillColor=l,e.strokeColor=l;break;default:throw new o.FormatError(`Unsupported paint type: ${D}`)}}getPattern(y,D,_,h){let e=_;h!==q.SHADING&&(e=o.Util.transform(e,D.baseTransform),this.matrix&&(e=o.Util.transform(e,this.matrix)));const s=this.createPatternCanvas(D);let l=new DOMMatrix(e);l=l.translate(s.offsetX,s.offsetY),l=l.scale(1/s.scaleX,1/s.scaleY);const a=y.createPattern(s.canvas,"repeat");return a.setTransform(l),a}};Kt(f,"MAX_PATTERN_SIZE",3e3);let v=f;c.TilingPattern=v},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.convertBlackAndWhiteToRGBA=q,c.convertToRGBA=b,c.grayToRGBA=tt;var o=G(1);function b(O){switch(O.kind){case o.ImageKind.GRAYSCALE_1BPP:return q(O);case o.ImageKind.RGB_24BPP:return B(O)}return null}function q({src:O,srcPos:E=0,dest:d,width:j,height:T,nonBlackColor:x=4294967295,inverseDecode:m=!1}){const v=o.FeatureTest.isLittleEndian?4278190080:255,[f,u]=m?[x,v]:[v,x],y=j>>3,D=j&7,_=O.length;d=new Uint32Array(d.buffer);let h=0;for(let e=0;e<T;e++){for(const l=E+y;E<l;E++){const a=E<_?O[E]:255;d[h++]=a&128?u:f,d[h++]=a&64?u:f,d[h++]=a&32?u:f,d[h++]=a&16?u:f,d[h++]=a&8?u:f,d[h++]=a&4?u:f,d[h++]=a&2?u:f,d[h++]=a&1?u:f}if(D===0)continue;const s=E<_?O[E++]:255;for(let l=0;l<D;l++)d[h++]=s&1<<7-l?u:f}return{srcPos:E,destPos:h}}function B({src:O,srcPos:E=0,dest:d,destPos:j=0,width:T,height:x}){let m=0;const v=O.length>>2,f=new Uint32Array(O.buffer,E,v);if(o.FeatureTest.isLittleEndian){for(;m<v-2;m+=3,j+=4){const u=f[m],y=f[m+1],D=f[m+2];d[j]=u|4278190080,d[j+1]=u>>>24|y<<8|4278190080,d[j+2]=y>>>16|D<<16|4278190080,d[j+3]=D>>>8|4278190080}for(let u=m*4,y=O.length;u<y;u+=3)d[j++]=O[u]|O[u+1]<<8|O[u+2]<<16|4278190080}else{for(;m<v-2;m+=3,j+=4){const u=f[m],y=f[m+1],D=f[m+2];d[j]=u|255,d[j+1]=u<<24|y>>>8|255,d[j+2]=y<<16|D>>>16|255,d[j+3]=D<<8|255}for(let u=m*4,y=O.length;u<y;u+=3)d[j++]=O[u]<<24|O[u+1]<<16|O[u+2]<<8|255}return{srcPos:E,destPos:j}}function tt(O,E){if(o.FeatureTest.isLittleEndian)for(let d=0,j=O.length;d<j;d++)E[d]=O[d]*65793|4278190080;else for(let d=0,j=O.length;d<j;d++)E[d]=O[d]*16843008|255}},(L,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GlobalWorkerOptions=void 0;const G=Object.create(null);c.GlobalWorkerOptions=G,G.workerPort=null,G.workerSrc=""},(L,c,G)=>{var O,Ss,ws,_e;Object.defineProperty(c,"__esModule",{value:!0}),c.MessageHandler=void 0;var o=G(1);const b={DATA:1,ERROR:2},q={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function B(T){switch(T instanceof Error||typeof T=="object"&&T!==null||(0,o.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),T.name){case"AbortException":return new o.AbortException(T.message);case"MissingPDFException":return new o.MissingPDFException(T.message);case"PasswordException":return new o.PasswordException(T.message,T.code);case"UnexpectedResponseException":return new o.UnexpectedResponseException(T.message,T.status);case"UnknownErrorException":return new o.UnknownErrorException(T.message,T.details);default:return new o.UnknownErrorException(T.message,T.toString())}}class tt{constructor(x,m,v){at(this,O);this.sourceName=x,this.targetName=m,this.comObj=v,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=f=>{const u=f.data;if(u.targetName!==this.sourceName)return;if(u.stream){K(this,O,ws).call(this,u);return}if(u.callback){const D=u.callbackId,_=this.callbackCapabilities[D];if(!_)throw new Error(`Cannot resolve callback ${D}`);if(delete this.callbackCapabilities[D],u.callback===b.DATA)_.resolve(u.data);else if(u.callback===b.ERROR)_.reject(B(u.reason));else throw new Error("Unexpected callback case");return}const y=this.actionHandler[u.action];if(!y)throw new Error(`Unknown action from worker: ${u.action}`);if(u.callbackId){const D=this.sourceName,_=u.sourceName;new Promise(function(h){h(y(u.data))}).then(function(h){v.postMessage({sourceName:D,targetName:_,callback:b.DATA,callbackId:u.callbackId,data:h})},function(h){v.postMessage({sourceName:D,targetName:_,callback:b.ERROR,callbackId:u.callbackId,reason:B(h)})});return}if(u.streamId){K(this,O,Ss).call(this,u);return}y(u.data)},v.addEventListener("message",this._onComObjOnMessage)}on(x,m){const v=this.actionHandler;if(v[x])throw new Error(`There is already an actionName called "${x}"`);v[x]=m}send(x,m,v){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,data:m},v)}sendWithPromise(x,m,v){const f=this.callbackId++,u=new o.PromiseCapability;this.callbackCapabilities[f]=u;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,callbackId:f,data:m},v)}catch(y){u.reject(y)}return u.promise}sendWithStream(x,m,v,f){const u=this.streamId++,y=this.sourceName,D=this.targetName,_=this.comObj;return new ReadableStream({start:h=>{const e=new o.PromiseCapability;return this.streamControllers[u]={controller:h,startCall:e,pullCall:null,cancelCall:null,isClosed:!1},_.postMessage({sourceName:y,targetName:D,action:x,streamId:u,data:m,desiredSize:h.desiredSize},f),e.promise},pull:h=>{const e=new o.PromiseCapability;return this.streamControllers[u].pullCall=e,_.postMessage({sourceName:y,targetName:D,stream:q.PULL,streamId:u,desiredSize:h.desiredSize}),e.promise},cancel:h=>{(0,o.assert)(h instanceof Error,"cancel must have a valid reason");const e=new o.PromiseCapability;return this.streamControllers[u].cancelCall=e,this.streamControllers[u].isClosed=!0,_.postMessage({sourceName:y,targetName:D,stream:q.CANCEL,streamId:u,reason:B(h)}),e.promise}},v)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}O=new WeakSet,Ss=function(x){const m=x.streamId,v=this.sourceName,f=x.sourceName,u=this.comObj,y=this,D=this.actionHandler[x.action],_={enqueue(h,e=1,s){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=e,l>0&&this.desiredSize<=0&&(this.sinkCapability=new o.PromiseCapability,this.ready=this.sinkCapability.promise),u.postMessage({sourceName:v,targetName:f,stream:q.ENQUEUE,streamId:m,chunk:h},s)},close(){this.isCancelled||(this.isCancelled=!0,u.postMessage({sourceName:v,targetName:f,stream:q.CLOSE,streamId:m}),delete y.streamSinks[m])},error(h){(0,o.assert)(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,u.postMessage({sourceName:v,targetName:f,stream:q.ERROR,streamId:m,reason:B(h)}))},sinkCapability:new o.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:x.desiredSize,ready:null};_.sinkCapability.resolve(),_.ready=_.sinkCapability.promise,this.streamSinks[m]=_,new Promise(function(h){h(D(x.data,_))}).then(function(){u.postMessage({sourceName:v,targetName:f,stream:q.START_COMPLETE,streamId:m,success:!0})},function(h){u.postMessage({sourceName:v,targetName:f,stream:q.START_COMPLETE,streamId:m,reason:B(h)})})},ws=function(x){const m=x.streamId,v=this.sourceName,f=x.sourceName,u=this.comObj,y=this.streamControllers[m],D=this.streamSinks[m];switch(x.stream){case q.START_COMPLETE:x.success?y.startCall.resolve():y.startCall.reject(B(x.reason));break;case q.PULL_COMPLETE:x.success?y.pullCall.resolve():y.pullCall.reject(B(x.reason));break;case q.PULL:if(!D){u.postMessage({sourceName:v,targetName:f,stream:q.PULL_COMPLETE,streamId:m,success:!0});break}D.desiredSize<=0&&x.desiredSize>0&&D.sinkCapability.resolve(),D.desiredSize=x.desiredSize,new Promise(function(_){var h;_((h=D.onPull)==null?void 0:h.call(D))}).then(function(){u.postMessage({sourceName:v,targetName:f,stream:q.PULL_COMPLETE,streamId:m,success:!0})},function(_){u.postMessage({sourceName:v,targetName:f,stream:q.PULL_COMPLETE,streamId:m,reason:B(_)})});break;case q.ENQUEUE:if((0,o.assert)(y,"enqueue should have stream controller"),y.isClosed)break;y.controller.enqueue(x.chunk);break;case q.CLOSE:if((0,o.assert)(y,"close should have stream controller"),y.isClosed)break;y.isClosed=!0,y.controller.close(),K(this,O,_e).call(this,y,m);break;case q.ERROR:(0,o.assert)(y,"error should have stream controller"),y.controller.error(B(x.reason)),K(this,O,_e).call(this,y,m);break;case q.CANCEL_COMPLETE:x.success?y.cancelCall.resolve():y.cancelCall.reject(B(x.reason)),K(this,O,_e).call(this,y,m);break;case q.CANCEL:if(!D)break;new Promise(function(_){var h;_((h=D.onCancel)==null?void 0:h.call(D,B(x.reason)))}).then(function(){u.postMessage({sourceName:v,targetName:f,stream:q.CANCEL_COMPLETE,streamId:m,success:!0})},function(_){u.postMessage({sourceName:v,targetName:f,stream:q.CANCEL_COMPLETE,streamId:m,reason:B(_)})}),D.sinkCapability.reject(B(x.reason)),D.isCancelled=!0,delete this.streamSinks[m];break;default:throw new Error("Unexpected stream case")}},_e=async function(x,m){var v,f,u;await Promise.allSettled([(v=x.startCall)==null?void 0:v.promise,(f=x.pullCall)==null?void 0:f.promise,(u=x.cancelCall)==null?void 0:u.promise]),delete this.streamControllers[m]},c.MessageHandler=tt},(L,c,G)=>{var q,B;Object.defineProperty(c,"__esModule",{value:!0}),c.Metadata=void 0;var o=G(1);class b{constructor({parsedData:O,rawData:E}){at(this,q);at(this,B);lt(this,q,O),lt(this,B,E)}getRaw(){return t(this,B)}get(O){return t(this,q).get(O)??null}getAll(){return(0,o.objectFromMap)(t(this,q))}has(O){return t(this,q).has(O)}}q=new WeakMap,B=new WeakMap,c.Metadata=b},(L,c,G)=>{var O,E,d,j,T,x,Ye;Object.defineProperty(c,"__esModule",{value:!0}),c.OptionalContentConfig=void 0;var o=G(1),b=G(8);const q=Symbol("INTERNAL");class B{constructor(f,u){at(this,O,!0);this.name=f,this.intent=u}get visible(){return t(this,O)}_setVisible(f,u){f!==q&&(0,o.unreachable)("Internal method `_setVisible` called."),lt(this,O,u)}}O=new WeakMap;class tt{constructor(f){at(this,x);at(this,E,null);at(this,d,new Map);at(this,j,null);at(this,T,null);if(this.name=null,this.creator=null,f!==null){this.name=f.name,this.creator=f.creator,lt(this,T,f.order);for(const u of f.groups)t(this,d).set(u.id,new B(u.name,u.intent));if(f.baseState==="OFF")for(const u of t(this,d).values())u._setVisible(q,!1);for(const u of f.on)t(this,d).get(u)._setVisible(q,!0);for(const u of f.off)t(this,d).get(u)._setVisible(q,!1);lt(this,j,this.getHash())}}isVisible(f){if(t(this,d).size===0)return!0;if(!f)return(0,o.warn)("Optional content group not defined."),!0;if(f.type==="OCG")return t(this,d).has(f.id)?t(this,d).get(f.id).visible:((0,o.warn)(`Optional content group not found: ${f.id}`),!0);if(f.type==="OCMD"){if(f.expression)return K(this,x,Ye).call(this,f.expression);if(!f.policy||f.policy==="AnyOn"){for(const u of f.ids){if(!t(this,d).has(u))return(0,o.warn)(`Optional content group not found: ${u}`),!0;if(t(this,d).get(u).visible)return!0}return!1}else if(f.policy==="AllOn"){for(const u of f.ids){if(!t(this,d).has(u))return(0,o.warn)(`Optional content group not found: ${u}`),!0;if(!t(this,d).get(u).visible)return!1}return!0}else if(f.policy==="AnyOff"){for(const u of f.ids){if(!t(this,d).has(u))return(0,o.warn)(`Optional content group not found: ${u}`),!0;if(!t(this,d).get(u).visible)return!0}return!1}else if(f.policy==="AllOff"){for(const u of f.ids){if(!t(this,d).has(u))return(0,o.warn)(`Optional content group not found: ${u}`),!0;if(t(this,d).get(u).visible)return!1}return!0}return(0,o.warn)(`Unknown optional content policy ${f.policy}.`),!0}return(0,o.warn)(`Unknown group type ${f.type}.`),!0}setVisibility(f,u=!0){if(!t(this,d).has(f)){(0,o.warn)(`Optional content group not found: ${f}`);return}t(this,d).get(f)._setVisible(q,!!u),lt(this,E,null)}get hasInitialVisibility(){return t(this,j)===null||this.getHash()===t(this,j)}getOrder(){return t(this,d).size?t(this,T)?t(this,T).slice():[...t(this,d).keys()]:null}getGroups(){return t(this,d).size>0?(0,o.objectFromMap)(t(this,d)):null}getGroup(f){return t(this,d).get(f)||null}getHash(){if(t(this,E)!==null)return t(this,E);const f=new b.MurmurHash3_64;for(const[u,y]of t(this,d))f.update(`${u}:${y.visible}`);return lt(this,E,f.hexdigest())}}E=new WeakMap,d=new WeakMap,j=new WeakMap,T=new WeakMap,x=new WeakSet,Ye=function(f){const u=f.length;if(u<2)return!0;const y=f[0];for(let D=1;D<u;D++){const _=f[D];let h;if(Array.isArray(_))h=K(this,x,Ye).call(this,_);else if(t(this,d).has(_))h=t(this,d).get(_).visible;else return(0,o.warn)(`Optional content group not found: ${_}`),!0;switch(y){case"And":if(!h)return!1;break;case"Or":if(h)return!0;break;case"Not":return!h;default:return!0}}return y==="And"},c.OptionalContentConfig=tt},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFDataTransportStream=void 0;var o=G(1),b=G(6);class q{constructor({length:E,initialData:d,progressiveDone:j=!1,contentDispositionFilename:T=null,disableRange:x=!1,disableStream:m=!1},v){if((0,o.assert)(v,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=j,this._contentDispositionFilename=T,(d==null?void 0:d.length)>0){const f=d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength?d.buffer:new Uint8Array(d).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=v,this._isStreamingSupported=!m,this._isRangeSupported=!x,this._contentLength=E,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((f,u)=>{this._onReceiveData({begin:f,chunk:u})}),this._pdfDataRangeTransport.addProgressListener((f,u)=>{this._onProgress({loaded:f,total:u})}),this._pdfDataRangeTransport.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:E,chunk:d}){const j=d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength?d.buffer:new Uint8Array(d).buffer;if(E===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(j):this._queuedChunks.push(j);else{const T=this._rangeReaders.some(function(x){return x._begin!==E?!1:(x._enqueue(j),!0)});(0,o.assert)(T,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var E;return((E=this._fullRequestReader)==null?void 0:E._loaded)??0}_onProgress(E){var d,j,T,x;E.total===void 0?(j=(d=this._rangeReaders[0])==null?void 0:d.onProgress)==null||j.call(d,{loaded:E.loaded}):(x=(T=this._fullRequestReader)==null?void 0:T.onProgress)==null||x.call(T,{loaded:E.loaded,total:E.total})}_onProgressiveDone(){var E;(E=this._fullRequestReader)==null||E.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(E){const d=this._rangeReaders.indexOf(E);d>=0&&this._rangeReaders.splice(d,1)}getFullReader(){(0,o.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const E=this._queuedChunks;return this._queuedChunks=null,new B(this,E,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(E,d){if(d<=this._progressiveDataLength)return null;const j=new tt(this,E,d);return this._pdfDataRangeTransport.requestDataRange(E,d),this._rangeReaders.push(j),j}cancelAllRequests(E){var d;(d=this._fullRequestReader)==null||d.cancel(E);for(const j of this._rangeReaders.slice(0))j.cancel(E);this._pdfDataRangeTransport.abort()}}c.PDFDataTransportStream=q;class B{constructor(E,d,j=!1,T=null){this._stream=E,this._done=j||!1,this._filename=(0,b.isPdfFile)(T)?T:null,this._queuedChunks=d||[],this._loaded=0;for(const x of this._queuedChunks)this._loaded+=x.byteLength;this._requests=[],this._headersReady=Promise.resolve(),E._fullRequestReader=this,this.onProgress=null}_enqueue(E){this._done||(this._requests.length>0?this._requests.shift().resolve({value:E,done:!1}):this._queuedChunks.push(E),this._loaded+=E.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const E=new o.PromiseCapability;return this._requests.push(E),E.promise}cancel(E){this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class tt{constructor(E,d,j){this._stream=E,this._begin=d,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(E){if(!this._done){if(this._requests.length===0)this._queuedChunk=E;else{this._requests.shift().resolve({value:E,done:!1});for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const E=new o.PromiseCapability;return this._requests.push(E),E.promise}cancel(E){this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFFetchStream=void 0;var o=G(1),b=G(20);function q(j,T,x){return{method:"GET",headers:j,signal:x.signal,mode:"cors",credentials:T?"include":"same-origin",redirect:"follow"}}function B(j){const T=new Headers;for(const x in j){const m=j[x];m!==void 0&&T.append(x,m)}return T}function tt(j){return j instanceof Uint8Array?j.buffer:j instanceof ArrayBuffer?j:((0,o.warn)(`getArrayBuffer - unexpected data format: ${j}`),new Uint8Array(j).buffer)}class O{constructor(T){this.source=T,this.isHttp=/^https?:/i.test(T.url),this.httpHeaders=this.isHttp&&T.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var T;return((T=this._fullRequestReader)==null?void 0:T._loaded)??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new E(this),this._fullRequestReader}getRangeReader(T,x){if(x<=this._progressiveDataLength)return null;const m=new d(this,T,x);return this._rangeRequestReaders.push(m),m}cancelAllRequests(T){var x;(x=this._fullRequestReader)==null||x.cancel(T);for(const m of this._rangeRequestReaders.slice(0))m.cancel(T)}}c.PDFFetchStream=O;class E{constructor(T){this._stream=T,this._reader=null,this._loaded=0,this._filename=null;const x=T.source;this._withCredentials=x.withCredentials||!1,this._contentLength=x.length,this._headersCapability=new o.PromiseCapability,this._disableRange=x.disableRange||!1,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!x.disableStream,this._isRangeSupported=!x.disableRange,this._headers=B(this._stream.httpHeaders);const m=x.url;fetch(m,q(this._headers,this._withCredentials,this._abortController)).then(v=>{if(!(0,b.validateResponseStatus)(v.status))throw(0,b.createResponseStatusError)(v.status,m);this._reader=v.body.getReader(),this._headersCapability.resolve();const f=D=>v.headers.get(D),{allowRangeRequests:u,suggestedLength:y}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=y||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new o.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var m;await this._headersCapability.promise;const{value:T,done:x}=await this._reader.read();return x?{value:T,done:x}:(this._loaded+=T.byteLength,(m=this.onProgress)==null||m.call(this,{loaded:this._loaded,total:this._contentLength}),{value:tt(T),done:!1})}cancel(T){var x;(x=this._reader)==null||x.cancel(T),this._abortController.abort()}}class d{constructor(T,x,m){this._stream=T,this._reader=null,this._loaded=0;const v=T.source;this._withCredentials=v.withCredentials||!1,this._readCapability=new o.PromiseCapability,this._isStreamingSupported=!v.disableStream,this._abortController=new AbortController,this._headers=B(this._stream.httpHeaders),this._headers.append("Range",`bytes=${x}-${m-1}`);const f=v.url;fetch(f,q(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,b.validateResponseStatus)(u.status))throw(0,b.createResponseStatusError)(u.status,f);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var m;await this._readCapability.promise;const{value:T,done:x}=await this._reader.read();return x?{value:T,done:x}:(this._loaded+=T.byteLength,(m=this.onProgress)==null||m.call(this,{loaded:this._loaded}),{value:tt(T),done:!1})}cancel(T){var x;(x=this._reader)==null||x.cancel(T),this._abortController.abort()}}},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createResponseStatusError=O,c.extractFilenameFromHeader=tt,c.validateRangeRequestCapabilities=B,c.validateResponseStatus=E;var o=G(1),b=G(21),q=G(6);function B({getResponseHeader:d,isHttp:j,rangeChunkSize:T,disableRange:x}){const m={allowRangeRequests:!1,suggestedLength:void 0},v=parseInt(d("Content-Length"),10);return!Number.isInteger(v)||(m.suggestedLength=v,v<=2*T)||x||!j||d("Accept-Ranges")!=="bytes"||(d("Content-Encoding")||"identity")!=="identity"||(m.allowRangeRequests=!0),m}function tt(d){const j=d("Content-Disposition");if(j){let T=(0,b.getFilenameFromContentDispositionHeader)(j);if(T.includes("%"))try{T=decodeURIComponent(T)}catch{}if((0,q.isPdfFile)(T))return T}return null}function O(d,j){return d===404||d===0&&j.startsWith("file:")?new o.MissingPDFException('Missing PDF "'+j+'".'):new o.UnexpectedResponseException(`Unexpected server response (${d}) while retrieving PDF "${j}".`,d)}function E(d){return d===200||d===206}},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getFilenameFromContentDispositionHeader=b;var o=G(1);function b(q){let B=!0,tt=O("filename\\*","i").exec(q);if(tt){tt=tt[1];let v=T(tt);return v=unescape(v),v=x(v),v=m(v),d(v)}if(tt=j(q),tt){const v=m(tt);return d(v)}if(tt=O("filename","i").exec(q),tt){tt=tt[1];let v=T(tt);return v=m(v),d(v)}function O(v,f){return new RegExp("(?:^|;)\\s*"+v+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function E(v,f){if(v){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const u=new TextDecoder(v,{fatal:!0}),y=(0,o.stringToBytes)(f);f=u.decode(y),B=!1}catch{}}return f}function d(v){return B&&/[\x80-\xff]/.test(v)&&(v=E("utf-8",v),B&&(v=E("iso-8859-1",v))),v}function j(v){const f=[];let u;const y=O("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=y.exec(v))!==null;){let[,_,h,e]=u;if(_=parseInt(_,10),_ in f){if(_===0)break;continue}f[_]=[h,e]}const D=[];for(let _=0;_<f.length&&_ in f;++_){let[h,e]=f[_];e=T(e),h&&(e=unescape(e),_===0&&(e=x(e))),D.push(e)}return D.join("")}function T(v){if(v.startsWith('"')){const f=v.slice(1).split('\\"');for(let u=0;u<f.length;++u){const y=f[u].indexOf('"');y!==-1&&(f[u]=f[u].slice(0,y),f.length=u+1),f[u]=f[u].replaceAll(/\\(.)/g,"$1")}v=f.join('"')}return v}function x(v){const f=v.indexOf("'");if(f===-1)return v;const u=v.slice(0,f),D=v.slice(f+1).replace(/^[^']*'/,"");return E(u,D)}function m(v){return!v.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(v)?v:v.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,u,y,D){if(y==="q"||y==="Q")return D=D.replaceAll("_"," "),D=D.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,h){return String.fromCharCode(parseInt(h,16))}),E(u,D);try{D=atob(D)}catch{}return E(u,D)})}return""}},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFNetworkStream=void 0;var o=G(1),b=G(20);const q=200,B=206;function tt(T){const x=T.response;return typeof x!="string"?x:(0,o.stringToBytes)(x).buffer}class O{constructor(x,m={}){this.url=x,this.isHttp=/^https?:/i.test(x),this.httpHeaders=this.isHttp&&m.httpHeaders||Object.create(null),this.withCredentials=m.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(x,m,v){const f={begin:x,end:m};for(const u in v)f[u]=v[u];return this.request(f)}requestFull(x){return this.request(x)}request(x){const m=new XMLHttpRequest,v=this.currXhrId++,f=this.pendingRequests[v]={xhr:m};m.open("GET",this.url),m.withCredentials=this.withCredentials;for(const u in this.httpHeaders){const y=this.httpHeaders[u];y!==void 0&&m.setRequestHeader(u,y)}return this.isHttp&&"begin"in x&&"end"in x?(m.setRequestHeader("Range",`bytes=${x.begin}-${x.end-1}`),f.expectedStatus=B):f.expectedStatus=q,m.responseType="arraybuffer",x.onError&&(m.onerror=function(u){x.onError(m.status)}),m.onreadystatechange=this.onStateChange.bind(this,v),m.onprogress=this.onProgress.bind(this,v),f.onHeadersReceived=x.onHeadersReceived,f.onDone=x.onDone,f.onError=x.onError,f.onProgress=x.onProgress,m.send(null),v}onProgress(x,m){var f;const v=this.pendingRequests[x];v&&((f=v.onProgress)==null||f.call(v,m))}onStateChange(x,m){var _,h,e;const v=this.pendingRequests[x];if(!v)return;const f=v.xhr;if(f.readyState>=2&&v.onHeadersReceived&&(v.onHeadersReceived(),delete v.onHeadersReceived),f.readyState!==4||!(x in this.pendingRequests))return;if(delete this.pendingRequests[x],f.status===0&&this.isHttp){(_=v.onError)==null||_.call(v,f.status);return}const u=f.status||q;if(!(u===q&&v.expectedStatus===B)&&u!==v.expectedStatus){(h=v.onError)==null||h.call(v,f.status);return}const D=tt(f);if(u===B){const s=f.getResponseHeader("Content-Range"),l=/bytes (\d+)-(\d+)\/(\d+)/.exec(s);v.onDone({begin:parseInt(l[1],10),chunk:D})}else D?v.onDone({begin:0,chunk:D}):(e=v.onError)==null||e.call(v,f.status)}getRequestXhr(x){return this.pendingRequests[x].xhr}isPendingRequest(x){return x in this.pendingRequests}abortRequest(x){const m=this.pendingRequests[x].xhr;delete this.pendingRequests[x],m.abort()}}class E{constructor(x){this._source=x,this._manager=new O(x.url,{httpHeaders:x.httpHeaders,withCredentials:x.withCredentials}),this._rangeChunkSize=x.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(x){const m=this._rangeRequestReaders.indexOf(x);m>=0&&this._rangeRequestReaders.splice(m,1)}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new d(this._manager,this._source),this._fullRequestReader}getRangeReader(x,m){const v=new j(this._manager,x,m);return v.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(v),v}cancelAllRequests(x){var m;(m=this._fullRequestReader)==null||m.cancel(x);for(const v of this._rangeRequestReaders.slice(0))v.cancel(x)}}c.PDFNetworkStream=E;class d{constructor(x,m){this._manager=x;const v={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._fullRequestId=x.requestFull(v),this._headersReceivedCapability=new o.PromiseCapability,this._disableRange=m.disableRange||!1,this._contentLength=m.length,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const x=this._fullRequestId,m=this._manager.getRequestXhr(x),v=y=>m.getResponseHeader(y),{allowRangeRequests:f,suggestedLength:u}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});f&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(v),this._isRangeSupported&&this._manager.abortRequest(x),this._headersReceivedCapability.resolve()}_onDone(x){if(x&&(this._requests.length>0?this._requests.shift().resolve({value:x.chunk,done:!1}):this._cachedChunks.push(x.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(x){this._storedError=(0,b.createResponseStatusError)(x,this._url),this._headersReceivedCapability.reject(this._storedError);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(x){var m;(m=this.onProgress)==null||m.call(this,{loaded:x.loaded,total:x.lengthComputable?x.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const x=new o.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0,this._headersReceivedCapability.reject(x);for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(x,m,v){this._manager=x;const f={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=x.url,this._requestId=x.requestRange(m,v,f),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var x;(x=this.onClosed)==null||x.call(this,this)}_onDone(x){const m=x.chunk;this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunk=m,this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(x){this._storedError=(0,b.createResponseStatusError)(x,this._url);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(x){var m;this.isStreamingSupported||(m=this.onProgress)==null||m.call(this,{loaded:x.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const x=new o.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PDFNodeStream=void 0;var o=G(1),b=G(20);const q=/^file:\/\/\/[a-zA-Z]:\//;function B(v){const f=require$$5,u=f.parse(v);return u.protocol==="file:"||u.host?u:/^[a-z]:[/\\]/i.test(v)?f.parse(`file:///${v}`):(u.host||(u.protocol="file:"),u)}class tt{constructor(f){this.source=f,this.url=B(f.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new x(this):new j(this),this._fullRequestReader}getRangeReader(f,u){if(u<=this._progressiveDataLength)return null;const y=this.isFsUrl?new m(this,f,u):new T(this,f,u);return this._rangeRequestReaders.push(y),y}cancelAllRequests(f){var u;(u=this._fullRequestReader)==null||u.cancel(f);for(const y of this._rangeRequestReaders.slice(0))y.cancel(f)}}c.PDFNodeStream=tt;class O{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null;const u=f.source;this._contentLength=u.length,this._loaded=0,this._filename=null,this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._readableStream=null,this._readCapability=new o.PromiseCapability,this._headersCapability=new o.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new o.PromiseCapability,this.read()):(this._loaded+=f.length,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",u=>{this._error(u)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new o.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class E{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new o.PromiseCapability;const u=f.source;this._isStreamingSupported=!u.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new o.PromiseCapability,this.read()):(this._loaded+=f.length,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",u=>{this._error(u)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function d(v,f){return{protocol:v.protocol,auth:v.auth,host:v.hostname,port:v.port,path:v.path,method:"GET",headers:f}}class j extends O{constructor(f){super(f);const u=y=>{if(y.statusCode===404){const e=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=e,this._headersCapability.reject(e);return}this._headersCapability.resolve(),this._setReadableStream(y);const D=e=>this._readableStream.headers[e.toLowerCase()],{allowRangeRequests:_,suggestedLength:h}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:D,isHttp:f.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=h||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(D)};if(this._request=null,this._url.protocol==="http:"){const y=require$$5;this._request=y.request(d(this._url,f.httpHeaders),u)}else{const y=require$$5;this._request=y.request(d(this._url,f.httpHeaders),u)}this._request.on("error",y=>{this._storedError=y,this._headersCapability.reject(y)}),this._request.end()}}class T extends E{constructor(f,u,y){super(f),this._httpHeaders={};for(const _ in f.httpHeaders){const h=f.httpHeaders[_];h!==void 0&&(this._httpHeaders[_]=h)}this._httpHeaders.Range=`bytes=${u}-${y-1}`;const D=_=>{if(_.statusCode===404){const h=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=h;return}this._setReadableStream(_)};if(this._request=null,this._url.protocol==="http:"){const _=require$$5;this._request=_.request(d(this._url,this._httpHeaders),D)}else{const _=require$$5;this._request=_.request(d(this._url,this._httpHeaders),D)}this._request.on("error",_=>{this._storedError=_}),this._request.end()}}class x extends O{constructor(f){super(f);let u=decodeURIComponent(this._url.path);q.test(this._url.href)&&(u=u.replace(/^\//,""));const y=require$$5;y.lstat(u,(D,_)=>{if(D){D.code==="ENOENT"&&(D=new o.MissingPDFException(`Missing PDF "${u}".`)),this._storedError=D,this._headersCapability.reject(D);return}this._contentLength=_.size,this._setReadableStream(y.createReadStream(u)),this._headersCapability.resolve()})}}class m extends E{constructor(f,u,y){super(f);let D=decodeURIComponent(this._url.path);q.test(this._url.href)&&(D=D.replace(/^\//,""));const _=require$$5;this._setReadableStream(_.createReadStream(D,{start:u,end:y-1}))}}},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SVGGraphics=void 0;var o=G(6),b=G(1);const q={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},B="http://www.w3.org/XML/1998/namespace",tt="http://www.w3.org/1999/xlink",O=["butt","round","square"],E=["miter","round","bevel"],d=function(_,h="",e=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!e)return URL.createObjectURL(new Blob([_],{type:h}));const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let l=`data:${h};base64,`;for(let a=0,w=_.length;a<w;a+=3){const r=_[a]&255,g=_[a+1]&255,S=_[a+2]&255,J=r>>2,H=(r&3)<<4|g>>4,Y=a+1<w?(g&15)<<2|S>>6:64,$=a+2<w?S&63:64;l+=s[J]+s[H]+s[Y]+s[$]}return l},j=function(){const _=new Uint8Array([137,80,78,71,13,10,26,10]),h=12,e=new Int32Array(256);for(let S=0;S<256;S++){let J=S;for(let H=0;H<8;H++)J=J&1?3988292384^J>>1&2147483647:J>>1&2147483647;e[S]=J}function s(S,J,H){let Y=-1;for(let $=J;$<H;$++){const rt=(Y^S[$])&255,P=e[rt];Y=Y>>>8^P}return Y^-1}function l(S,J,H,Y){let $=Y;const rt=J.length;H[$]=rt>>24&255,H[$+1]=rt>>16&255,H[$+2]=rt>>8&255,H[$+3]=rt&255,$+=4,H[$]=S.charCodeAt(0)&255,H[$+1]=S.charCodeAt(1)&255,H[$+2]=S.charCodeAt(2)&255,H[$+3]=S.charCodeAt(3)&255,$+=4,H.set(J,$),$+=J.length;const P=s(H,Y+4,$);H[$]=P>>24&255,H[$+1]=P>>16&255,H[$+2]=P>>8&255,H[$+3]=P&255}function a(S,J,H){let Y=1,$=0;for(let rt=J;rt<H;++rt)Y=(Y+(S[rt]&255))%65521,$=($+Y)%65521;return $<<16|Y}function w(S){if(!b.isNodeJS)return r(S);try{const J=parseInt(process.versions.node)>=8?S:Buffer.from(S),H=require$$5.deflateSync(J,{level:9});return H instanceof Uint8Array?H:new Uint8Array(H)}catch(J){(0,b.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+J)}return r(S)}function r(S){let J=S.length;const H=65535,Y=Math.ceil(J/H),$=new Uint8Array(2+J+Y*5+4);let rt=0;$[rt++]=120,$[rt++]=156;let P=0;for(;J>H;)$[rt++]=0,$[rt++]=255,$[rt++]=255,$[rt++]=0,$[rt++]=0,$.set(S.subarray(P,P+H),rt),rt+=H,P+=H,J-=H;$[rt++]=1,$[rt++]=J&255,$[rt++]=J>>8&255,$[rt++]=~J&65535&255,$[rt++]=(~J&65535)>>8&255,$.set(S.subarray(P),rt),rt+=S.length-P;const W=a(S,0,S.length);return $[rt++]=W>>24&255,$[rt++]=W>>16&255,$[rt++]=W>>8&255,$[rt++]=W&255,$}function g(S,J,H,Y){const $=S.width,rt=S.height;let P,W,Z;const R=S.data;switch(J){case b.ImageKind.GRAYSCALE_1BPP:W=0,P=1,Z=$+7>>3;break;case b.ImageKind.RGB_24BPP:W=2,P=8,Z=$*3;break;case b.ImageKind.RGBA_32BPP:W=6,P=8,Z=$*4;break;default:throw new Error("invalid format")}const n=new Uint8Array((1+Z)*rt);let i=0,p=0;for(let dt=0;dt<rt;++dt)n[i++]=0,n.set(R.subarray(p,p+Z),i),p+=Z,i+=Z;if(J===b.ImageKind.GRAYSCALE_1BPP&&Y){i=0;for(let dt=0;dt<rt;dt++){i++;for(let ut=0;ut<Z;ut++)n[i++]^=255}}const k=new Uint8Array([$>>24&255,$>>16&255,$>>8&255,$&255,rt>>24&255,rt>>16&255,rt>>8&255,rt&255,P,W,0,0,0]),F=w(n),I=_.length+h*3+k.length+F.length,z=new Uint8Array(I);let et=0;return z.set(_,et),et+=_.length,l("IHDR",k,z,et),et+=h+k.length,l("IDATA",F,z,et),et+=h+F.length,l("IEND",new Uint8Array(0),z,et),d(z,"image/png",H)}return function(J,H,Y){const $=J.kind===void 0?b.ImageKind.GRAYSCALE_1BPP:J.kind;return g(J,$,H,Y)}}();class T{constructor(){this.fontSizeScale=1,this.fontWeight=q.fontWeight,this.fontSize=0,this.textMatrix=b.IDENTITY_MATRIX,this.fontMatrix=b.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=b.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=q.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(h,e){this.x=h,this.y=e}}function x(_){let h=[];const e=[];for(const s of _){if(s.fn==="save"){h.push({fnId:92,fn:"group",items:[]}),e.push(h),h=h.at(-1).items;continue}s.fn==="restore"?h=e.pop():h.push(s)}return h}function m(_){if(Number.isInteger(_))return _.toString();const h=_.toFixed(10);let e=h.length-1;if(h[e]!=="0")return h;do e--;while(h[e]==="0");return h.substring(0,h[e]==="."?e:e+1)}function v(_){if(_[4]===0&&_[5]===0){if(_[1]===0&&_[2]===0)return _[0]===1&&_[3]===1?"":`scale(${m(_[0])} ${m(_[3])})`;if(_[0]===_[3]&&_[1]===-_[2]){const h=Math.acos(_[0])*180/Math.PI;return`rotate(${m(h)})`}}else if(_[0]===1&&_[1]===0&&_[2]===0&&_[3]===1)return`translate(${m(_[4])} ${m(_[5])})`;return`matrix(${m(_[0])} ${m(_[1])} ${m(_[2])} ${m(_[3])} ${m(_[4])} ${m(_[5])})`}let f=0,u=0,y=0;class D{constructor(h,e,s=!1){(0,o.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new o.DOMSVGFactory,this.current=new T,this.transformMatrix=b.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=h,this.objs=e,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!s,this._operatorIdMapping=[];for(const l in b.OPS)this._operatorIdMapping[b.OPS[l]]=l}getObject(h,e=null){return typeof h=="string"?h.startsWith("g_")?this.commonObjs.get(h):this.objs.get(h):e}save(){this.transformStack.push(this.transformMatrix);const h=this.current;this.extraStack.push(h),this.current=h.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(h){this.save(),this.executeOpTree(h),this.restore()}loadDependencies(h){const e=h.fnArray,s=h.argsArray;for(let l=0,a=e.length;l<a;l++)if(e[l]===b.OPS.dependency)for(const w of s[l]){const r=w.startsWith("g_")?this.commonObjs:this.objs,g=new Promise(S=>{r.get(w,S)});this.current.dependencies.push(g)}return Promise.all(this.current.dependencies)}transform(h,e,s,l,a,w){const r=[h,e,s,l,a,w];this.transformMatrix=b.Util.transform(this.transformMatrix,r),this.tgrp=null}getSVG(h,e){this.viewport=e;const s=this._initialize(e);return this.loadDependencies(h).then(()=>(this.transformMatrix=b.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(h)),s))}convertOpList(h){const e=this._operatorIdMapping,s=h.argsArray,l=h.fnArray,a=[];for(let w=0,r=l.length;w<r;w++){const g=l[w];a.push({fnId:g,fn:e[g],args:s[w]})}return x(a)}executeOpTree(h){for(const e of h){const s=e.fn,l=e.fnId,a=e.args;switch(l|0){case b.OPS.beginText:this.beginText();break;case b.OPS.dependency:break;case b.OPS.setLeading:this.setLeading(a);break;case b.OPS.setLeadingMoveText:this.setLeadingMoveText(a[0],a[1]);break;case b.OPS.setFont:this.setFont(a);break;case b.OPS.showText:this.showText(a[0]);break;case b.OPS.showSpacedText:this.showText(a[0]);break;case b.OPS.endText:this.endText();break;case b.OPS.moveText:this.moveText(a[0],a[1]);break;case b.OPS.setCharSpacing:this.setCharSpacing(a[0]);break;case b.OPS.setWordSpacing:this.setWordSpacing(a[0]);break;case b.OPS.setHScale:this.setHScale(a[0]);break;case b.OPS.setTextMatrix:this.setTextMatrix(a[0],a[1],a[2],a[3],a[4],a[5]);break;case b.OPS.setTextRise:this.setTextRise(a[0]);break;case b.OPS.setTextRenderingMode:this.setTextRenderingMode(a[0]);break;case b.OPS.setLineWidth:this.setLineWidth(a[0]);break;case b.OPS.setLineJoin:this.setLineJoin(a[0]);break;case b.OPS.setLineCap:this.setLineCap(a[0]);break;case b.OPS.setMiterLimit:this.setMiterLimit(a[0]);break;case b.OPS.setFillRGBColor:this.setFillRGBColor(a[0],a[1],a[2]);break;case b.OPS.setStrokeRGBColor:this.setStrokeRGBColor(a[0],a[1],a[2]);break;case b.OPS.setStrokeColorN:this.setStrokeColorN(a);break;case b.OPS.setFillColorN:this.setFillColorN(a);break;case b.OPS.shadingFill:this.shadingFill(a[0]);break;case b.OPS.setDash:this.setDash(a[0],a[1]);break;case b.OPS.setRenderingIntent:this.setRenderingIntent(a[0]);break;case b.OPS.setFlatness:this.setFlatness(a[0]);break;case b.OPS.setGState:this.setGState(a[0]);break;case b.OPS.fill:this.fill();break;case b.OPS.eoFill:this.eoFill();break;case b.OPS.stroke:this.stroke();break;case b.OPS.fillStroke:this.fillStroke();break;case b.OPS.eoFillStroke:this.eoFillStroke();break;case b.OPS.clip:this.clip("nonzero");break;case b.OPS.eoClip:this.clip("evenodd");break;case b.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case b.OPS.paintImageXObject:this.paintImageXObject(a[0]);break;case b.OPS.paintInlineImageXObject:this.paintInlineImageXObject(a[0]);break;case b.OPS.paintImageMaskXObject:this.paintImageMaskXObject(a[0]);break;case b.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(a[0],a[1]);break;case b.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case b.OPS.closePath:this.closePath();break;case b.OPS.closeStroke:this.closeStroke();break;case b.OPS.closeFillStroke:this.closeFillStroke();break;case b.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case b.OPS.nextLine:this.nextLine();break;case b.OPS.transform:this.transform(a[0],a[1],a[2],a[3],a[4],a[5]);break;case b.OPS.constructPath:this.constructPath(a[0],a[1]);break;case b.OPS.endPath:this.endPath();break;case 92:this.group(e.items);break;default:(0,b.warn)(`Unimplemented operator ${s}`);break}}}setWordSpacing(h){this.current.wordSpacing=h}setCharSpacing(h){this.current.charSpacing=h}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(h,e,s,l,a,w){const r=this.current;r.textMatrix=r.lineMatrix=[h,e,s,l,a,w],r.textMatrixScale=Math.hypot(h,e),r.x=r.lineX=0,r.y=r.lineY=0,r.xcoords=[],r.ycoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${m(r.fontSize)}px`),r.tspan.setAttributeNS(null,"y",m(-r.y)),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtElement.append(r.tspan)}beginText(){const h=this.current;h.x=h.lineX=0,h.y=h.lineY=0,h.textMatrix=b.IDENTITY_MATRIX,h.lineMatrix=b.IDENTITY_MATRIX,h.textMatrixScale=1,h.tspan=this.svgFactory.createElement("svg:tspan"),h.txtElement=this.svgFactory.createElement("svg:text"),h.txtgrp=this.svgFactory.createElement("svg:g"),h.xcoords=[],h.ycoords=[]}moveText(h,e){const s=this.current;s.x=s.lineX+=h,s.y=s.lineY+=e,s.xcoords=[],s.ycoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${m(s.fontSize)}px`),s.tspan.setAttributeNS(null,"y",m(-s.y))}showText(h){const e=this.current,s=e.font,l=e.fontSize;if(l===0)return;const a=e.fontSizeScale,w=e.charSpacing,r=e.wordSpacing,g=e.fontDirection,S=e.textHScale*g,J=s.vertical,H=J?1:-1,Y=s.defaultVMetrics,$=l*e.fontMatrix[0];let rt=0;for(const Z of h){if(Z===null){rt+=g*r;continue}else if(typeof Z=="number"){rt+=H*Z*l/1e3;continue}const R=(Z.isSpace?r:0)+w,n=Z.fontChar;let i,p,k=Z.width;if(J){let I;const z=Z.vmetric||Y;I=Z.vmetric?z[1]:k*.5,I=-I*$;const et=z[2]*$;k=z?-z[0]:k,i=I/a,p=(rt+et)/a}else i=rt/a,p=0;(Z.isInFont||s.missingFile)&&(e.xcoords.push(e.x+i),J&&e.ycoords.push(-e.y+p),e.tspan.textContent+=n);const F=J?k*$-R*g:k*$+R*g;rt+=F}e.tspan.setAttributeNS(null,"x",e.xcoords.map(m).join(" ")),J?e.tspan.setAttributeNS(null,"y",e.ycoords.map(m).join(" ")):e.tspan.setAttributeNS(null,"y",m(-e.y)),J?e.y-=rt:e.x+=rt*S,e.tspan.setAttributeNS(null,"font-family",e.fontFamily),e.tspan.setAttributeNS(null,"font-size",`${m(e.fontSize)}px`),e.fontStyle!==q.fontStyle&&e.tspan.setAttributeNS(null,"font-style",e.fontStyle),e.fontWeight!==q.fontWeight&&e.tspan.setAttributeNS(null,"font-weight",e.fontWeight);const P=e.textRenderingMode&b.TextRenderingMode.FILL_STROKE_MASK;if(P===b.TextRenderingMode.FILL||P===b.TextRenderingMode.FILL_STROKE?(e.fillColor!==q.fillColor&&e.tspan.setAttributeNS(null,"fill",e.fillColor),e.fillAlpha<1&&e.tspan.setAttributeNS(null,"fill-opacity",e.fillAlpha)):e.textRenderingMode===b.TextRenderingMode.ADD_TO_PATH?e.tspan.setAttributeNS(null,"fill","transparent"):e.tspan.setAttributeNS(null,"fill","none"),P===b.TextRenderingMode.STROKE||P===b.TextRenderingMode.FILL_STROKE){const Z=1/(e.textMatrixScale||1);this._setStrokeAttributes(e.tspan,Z)}let W=e.textMatrix;e.textRise!==0&&(W=W.slice(),W[5]+=e.textRise),e.txtElement.setAttributeNS(null,"transform",`${v(W)} scale(${m(S)}, -1)`),e.txtElement.setAttributeNS(B,"xml:space","preserve"),e.txtElement.append(e.tspan),e.txtgrp.append(e.txtElement),this._ensureTransformGroup().append(e.txtElement)}setLeadingMoveText(h,e){this.setLeading(-e),this.moveText(h,e)}addFontStyle(h){if(!h.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const e=d(h.data,h.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${h.loadedName}"; src: url(${e}); }
`}setFont(h){const e=this.current,s=this.commonObjs.get(h[0]);let l=h[1];e.font=s,this.embedFonts&&!s.missingFile&&!this.embeddedFonts[s.loadedName]&&(this.addFontStyle(s),this.embeddedFonts[s.loadedName]=s),e.fontMatrix=s.fontMatrix||b.FONT_IDENTITY_MATRIX;let a="normal";s.black?a="900":s.bold&&(a="bold");const w=s.italic?"italic":"normal";l<0?(l=-l,e.fontDirection=-1):e.fontDirection=1,e.fontSize=l,e.fontFamily=s.loadedName,e.fontWeight=a,e.fontStyle=w,e.tspan=this.svgFactory.createElement("svg:tspan"),e.tspan.setAttributeNS(null,"y",m(-e.y)),e.xcoords=[],e.ycoords=[]}endText(){var e;const h=this.current;h.textRenderingMode&b.TextRenderingMode.ADD_TO_PATH_FLAG&&((e=h.txtElement)!=null&&e.hasChildNodes())&&(h.element=h.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(h){h>0&&(this.current.lineWidth=h)}setLineCap(h){this.current.lineCap=O[h]}setLineJoin(h){this.current.lineJoin=E[h]}setMiterLimit(h){this.current.miterLimit=h}setStrokeAlpha(h){this.current.strokeAlpha=h}setStrokeRGBColor(h,e,s){this.current.strokeColor=b.Util.makeHexColor(h,e,s)}setFillAlpha(h){this.current.fillAlpha=h}setFillRGBColor(h,e,s){this.current.fillColor=b.Util.makeHexColor(h,e,s),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(h){this.current.strokeColor=this._makeColorN_Pattern(h)}setFillColorN(h){this.current.fillColor=this._makeColorN_Pattern(h)}shadingFill(h){const{width:e,height:s}=this.viewport,l=b.Util.inverseTransform(this.transformMatrix),[a,w,r,g]=b.Util.getAxialAlignedBoundingBox([0,0,e,s],l),S=this.svgFactory.createElement("svg:rect");S.setAttributeNS(null,"x",a),S.setAttributeNS(null,"y",w),S.setAttributeNS(null,"width",r-a),S.setAttributeNS(null,"height",g-w),S.setAttributeNS(null,"fill",this._makeShadingPattern(h)),this.current.fillAlpha<1&&S.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(S)}_makeColorN_Pattern(h){return h[0]==="TilingPattern"?this._makeTilingPattern(h):this._makeShadingPattern(h)}_makeTilingPattern(h){const e=h[1],s=h[2],l=h[3]||b.IDENTITY_MATRIX,[a,w,r,g]=h[4],S=h[5],J=h[6],H=h[7],Y=`shading${y++}`,[$,rt,P,W]=b.Util.normalizeRect([...b.Util.applyTransform([a,w],l),...b.Util.applyTransform([r,g],l)]),[Z,R]=b.Util.singularValueDecompose2dScale(l),n=S*Z,i=J*R,p=this.svgFactory.createElement("svg:pattern");p.setAttributeNS(null,"id",Y),p.setAttributeNS(null,"patternUnits","userSpaceOnUse"),p.setAttributeNS(null,"width",n),p.setAttributeNS(null,"height",i),p.setAttributeNS(null,"x",`${$}`),p.setAttributeNS(null,"y",`${rt}`);const k=this.svg,F=this.transformMatrix,I=this.current.fillColor,z=this.current.strokeColor,et=this.svgFactory.create(P-$,W-rt);if(this.svg=et,this.transformMatrix=l,H===2){const dt=b.Util.makeHexColor(...e);this.current.fillColor=dt,this.current.strokeColor=dt}return this.executeOpTree(this.convertOpList(s)),this.svg=k,this.transformMatrix=F,this.current.fillColor=I,this.current.strokeColor=z,p.append(et.childNodes[0]),this.defs.append(p),`url(#${Y})`}_makeShadingPattern(h){switch(typeof h=="string"&&(h=this.objs.get(h)),h[0]){case"RadialAxial":const e=`shading${y++}`,s=h[3];let l;switch(h[1]){case"axial":const a=h[4],w=h[5];l=this.svgFactory.createElement("svg:linearGradient"),l.setAttributeNS(null,"id",e),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"x1",a[0]),l.setAttributeNS(null,"y1",a[1]),l.setAttributeNS(null,"x2",w[0]),l.setAttributeNS(null,"y2",w[1]);break;case"radial":const r=h[4],g=h[5],S=h[6],J=h[7];l=this.svgFactory.createElement("svg:radialGradient"),l.setAttributeNS(null,"id",e),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"cx",g[0]),l.setAttributeNS(null,"cy",g[1]),l.setAttributeNS(null,"r",J),l.setAttributeNS(null,"fx",r[0]),l.setAttributeNS(null,"fy",r[1]),l.setAttributeNS(null,"fr",S);break;default:throw new Error(`Unknown RadialAxial type: ${h[1]}`)}for(const a of s){const w=this.svgFactory.createElement("svg:stop");w.setAttributeNS(null,"offset",a[0]),w.setAttributeNS(null,"stop-color",a[1]),l.append(w)}return this.defs.append(l),`url(#${e})`;case"Mesh":return(0,b.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${h[0]}`)}}setDash(h,e){this.current.dashArray=h,this.current.dashPhase=e}constructPath(h,e){const s=this.current;let l=s.x,a=s.y,w=[],r=0;for(const g of h)switch(g|0){case b.OPS.rectangle:l=e[r++],a=e[r++];const S=e[r++],J=e[r++],H=l+S,Y=a+J;w.push("M",m(l),m(a),"L",m(H),m(a),"L",m(H),m(Y),"L",m(l),m(Y),"Z");break;case b.OPS.moveTo:l=e[r++],a=e[r++],w.push("M",m(l),m(a));break;case b.OPS.lineTo:l=e[r++],a=e[r++],w.push("L",m(l),m(a));break;case b.OPS.curveTo:l=e[r+4],a=e[r+5],w.push("C",m(e[r]),m(e[r+1]),m(e[r+2]),m(e[r+3]),m(l),m(a)),r+=6;break;case b.OPS.curveTo2:w.push("C",m(l),m(a),m(e[r]),m(e[r+1]),m(e[r+2]),m(e[r+3])),l=e[r+2],a=e[r+3],r+=4;break;case b.OPS.curveTo3:l=e[r+2],a=e[r+3],w.push("C",m(e[r]),m(e[r+1]),m(l),m(a),m(l),m(a)),r+=4;break;case b.OPS.closePath:w.push("Z");break}w=w.join(" "),s.path&&h.length>0&&h[0]!==b.OPS.rectangle&&h[0]!==b.OPS.moveTo?w=s.path.getAttributeNS(null,"d")+w:(s.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(s.path)),s.path.setAttributeNS(null,"d",w),s.path.setAttributeNS(null,"fill","none"),s.element=s.path,s.setCurrentPoint(l,a)}endPath(){const h=this.current;if(h.path=null,!this.pendingClip)return;if(!h.element){this.pendingClip=null;return}const e=`clippath${f++}`,s=this.svgFactory.createElement("svg:clipPath");s.setAttributeNS(null,"id",e),s.setAttributeNS(null,"transform",v(this.transformMatrix));const l=h.element.cloneNode(!0);if(this.pendingClip==="evenodd"?l.setAttributeNS(null,"clip-rule","evenodd"):l.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,s.append(l),this.defs.append(s),h.activeClipUrl){h.clipGroup=null;for(const a of this.extraStack)a.clipGroup=null;s.setAttributeNS(null,"clip-path",h.activeClipUrl)}h.activeClipUrl=`url(#${e})`,this.tgrp=null}clip(h){this.pendingClip=h}closePath(){const h=this.current;if(h.path){const e=`${h.path.getAttributeNS(null,"d")}Z`;h.path.setAttributeNS(null,"d",e)}}setLeading(h){this.current.leading=-h}setTextRise(h){this.current.textRise=h}setTextRenderingMode(h){this.current.textRenderingMode=h}setHScale(h){this.current.textHScale=h/100}setRenderingIntent(h){}setFlatness(h){}setGState(h){for(const[e,s]of h)switch(e){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s);break;case"CA":this.setStrokeAlpha(s);break;case"ca":this.setFillAlpha(s);break;default:(0,b.warn)(`Unimplemented graphic state operator ${e}`);break}}fill(){const h=this.current;h.element&&(h.element.setAttributeNS(null,"fill",h.fillColor),h.element.setAttributeNS(null,"fill-opacity",h.fillAlpha),this.endPath())}stroke(){const h=this.current;h.element&&(this._setStrokeAttributes(h.element),h.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(h,e=1){const s=this.current;let l=s.dashArray;e!==1&&l.length>0&&(l=l.map(function(a){return e*a})),h.setAttributeNS(null,"stroke",s.strokeColor),h.setAttributeNS(null,"stroke-opacity",s.strokeAlpha),h.setAttributeNS(null,"stroke-miterlimit",m(s.miterLimit)),h.setAttributeNS(null,"stroke-linecap",s.lineCap),h.setAttributeNS(null,"stroke-linejoin",s.lineJoin),h.setAttributeNS(null,"stroke-width",m(e*s.lineWidth)+"px"),h.setAttributeNS(null,"stroke-dasharray",l.map(m).join(" ")),h.setAttributeNS(null,"stroke-dashoffset",m(e*s.dashPhase)+"px")}eoFill(){var h;(h=this.current.element)==null||h.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var h;(h=this.current.element)==null||h.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const h=this.svgFactory.createElement("svg:rect");h.setAttributeNS(null,"x","0"),h.setAttributeNS(null,"y","0"),h.setAttributeNS(null,"width","1px"),h.setAttributeNS(null,"height","1px"),h.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(h)}paintImageXObject(h){const e=this.getObject(h);if(!e){(0,b.warn)(`Dependent image with object ID ${h} is not ready yet`);return}this.paintInlineImageXObject(e)}paintInlineImageXObject(h,e){const s=h.width,l=h.height,a=j(h,this.forceDataSchema,!!e),w=this.svgFactory.createElement("svg:rect");w.setAttributeNS(null,"x","0"),w.setAttributeNS(null,"y","0"),w.setAttributeNS(null,"width",m(s)),w.setAttributeNS(null,"height",m(l)),this.current.element=w,this.clip("nonzero");const r=this.svgFactory.createElement("svg:image");r.setAttributeNS(tt,"xlink:href",a),r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y",m(-l)),r.setAttributeNS(null,"width",m(s)+"px"),r.setAttributeNS(null,"height",m(l)+"px"),r.setAttributeNS(null,"transform",`scale(${m(1/s)} ${m(-1/l)})`),e?e.append(r):this._ensureTransformGroup().append(r)}paintImageMaskXObject(h){const e=this.getObject(h.data,h);if(e.bitmap){(0,b.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const s=this.current,l=e.width,a=e.height,w=s.fillColor;s.maskId=`mask${u++}`;const r=this.svgFactory.createElement("svg:mask");r.setAttributeNS(null,"id",s.maskId);const g=this.svgFactory.createElement("svg:rect");g.setAttributeNS(null,"x","0"),g.setAttributeNS(null,"y","0"),g.setAttributeNS(null,"width",m(l)),g.setAttributeNS(null,"height",m(a)),g.setAttributeNS(null,"fill",w),g.setAttributeNS(null,"mask",`url(#${s.maskId})`),this.defs.append(r),this._ensureTransformGroup().append(g),this.paintInlineImageXObject(e,r)}paintFormXObjectBegin(h,e){if(Array.isArray(h)&&h.length===6&&this.transform(h[0],h[1],h[2],h[3],h[4],h[5]),e){const s=e[2]-e[0],l=e[3]-e[1],a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x",e[0]),a.setAttributeNS(null,"y",e[1]),a.setAttributeNS(null,"width",m(s)),a.setAttributeNS(null,"height",m(l)),this.current.element=a,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(h){const e=this.svgFactory.create(h.width,h.height),s=this.svgFactory.createElement("svg:defs");e.append(s),this.defs=s;const l=this.svgFactory.createElement("svg:g");return l.setAttributeNS(null,"transform",v(h.transform)),e.append(l),this.svg=l,e}_ensureClipGroup(){if(!this.current.clipGroup){const h=this.svgFactory.createElement("svg:g");h.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(h),this.current.clipGroup=h}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",v(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}c.SVGGraphics=D},(L,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.XfaText=void 0;class G{static textContent(b){const q=[],B={items:q,styles:Object.create(null)};function tt(O){var j;if(!O)return;let E=null;const d=O.name;if(d==="#text")E=O.value;else if(G.shouldBuildText(d))(j=O==null?void 0:O.attributes)!=null&&j.textContent?E=O.attributes.textContent:O.value&&(E=O.value);else return;if(E!==null&&q.push({str:E}),!!O.children)for(const T of O.children)tt(T)}return tt(b),B}static shouldBuildText(b){return!(b==="textarea"||b==="input"||b==="option"||b==="select")}}c.XfaText=G},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextLayerRenderTask=void 0,c.renderTextLayer=v,c.updateTextLayer=f;var o=G(1),b=G(6);const q=1e5,B=30,tt=.8,O=new Map;function E(u,y){let D;if(y&&o.FeatureTest.isOffscreenCanvasSupported)D=new OffscreenCanvas(u,u).getContext("2d",{alpha:!1});else{const _=document.createElement("canvas");_.width=_.height=u,D=_.getContext("2d",{alpha:!1})}return D}function d(u,y){const D=O.get(u);if(D)return D;const _=E(B,y);_.font=`${B}px ${u}`;const h=_.measureText("");let e=h.fontBoundingBoxAscent,s=Math.abs(h.fontBoundingBoxDescent);if(e){const a=e/(e+s);return O.set(u,a),_.canvas.width=_.canvas.height=0,a}_.strokeStyle="red",_.clearRect(0,0,B,B),_.strokeText("g",0,0);let l=_.getImageData(0,0,B,B).data;s=0;for(let a=l.length-1-3;a>=0;a-=4)if(l[a]>0){s=Math.ceil(a/4/B);break}_.clearRect(0,0,B,B),_.strokeText("A",0,B),l=_.getImageData(0,0,B,B).data,e=0;for(let a=0,w=l.length;a<w;a+=4)if(l[a]>0){e=B-Math.floor(a/4/B);break}if(_.canvas.width=_.canvas.height=0,e){const a=e/(e+s);return O.set(u,a),a}return O.set(u,tt),tt}function j(u,y,D){const _=document.createElement("span"),h={angle:0,canvasWidth:0,hasText:y.str!=="",hasEOL:y.hasEOL,fontSize:0};u._textDivs.push(_);const e=o.Util.transform(u._transform,y.transform);let s=Math.atan2(e[1],e[0]);const l=D[y.fontName];l.vertical&&(s+=Math.PI/2);const a=Math.hypot(e[2],e[3]),w=a*d(l.fontFamily,u._isOffscreenCanvasSupported);let r,g;s===0?(r=e[4],g=e[5]-w):(r=e[4]+w*Math.sin(s),g=e[5]-w*Math.cos(s));const S="calc(var(--scale-factor)*",J=_.style;u._container===u._rootContainer?(J.left=`${(100*r/u._pageWidth).toFixed(2)}%`,J.top=`${(100*g/u._pageHeight).toFixed(2)}%`):(J.left=`${S}${r.toFixed(2)}px)`,J.top=`${S}${g.toFixed(2)}px)`),J.fontSize=`${S}${a.toFixed(2)}px)`,J.fontFamily=l.fontFamily,h.fontSize=a,_.setAttribute("role","presentation"),_.textContent=y.str,_.dir=y.dir,u._fontInspectorEnabled&&(_.dataset.fontName=y.fontName),s!==0&&(h.angle=s*(180/Math.PI));let H=!1;if(y.str.length>1)H=!0;else if(y.str!==" "&&y.transform[0]!==y.transform[3]){const Y=Math.abs(y.transform[0]),$=Math.abs(y.transform[3]);Y!==$&&Math.max(Y,$)/Math.min(Y,$)>1.5&&(H=!0)}H&&(h.canvasWidth=l.vertical?y.height:y.width),u._textDivProperties.set(_,h),u._isReadableStream&&u._layoutText(_)}function T(u){const{div:y,scale:D,properties:_,ctx:h,prevFontSize:e,prevFontFamily:s}=u,{style:l}=y;let a="";if(_.canvasWidth!==0&&_.hasText){const{fontFamily:w}=l,{canvasWidth:r,fontSize:g}=_;(e!==g||s!==w)&&(h.font=`${g*D}px ${w}`,u.prevFontSize=g,u.prevFontFamily=w);const{width:S}=h.measureText(y.textContent);S>0&&(a=`scaleX(${r*D/S})`)}_.angle!==0&&(a=`rotate(${_.angle}deg) ${a}`),a.length>0&&(l.transform=a)}function x(u){if(u._canceled)return;const y=u._textDivs,D=u._capability;if(y.length>q){D.resolve();return}if(!u._isReadableStream)for(const h of y)u._layoutText(h);D.resolve()}class m{constructor({textContentSource:y,container:D,viewport:_,textDivs:h,textDivProperties:e,textContentItemsStr:s,isOffscreenCanvasSupported:l}){var S;this._textContentSource=y,this._isReadableStream=y instanceof ReadableStream,this._container=this._rootContainer=D,this._textDivs=h||[],this._textContentItemsStr=s||[],this._isOffscreenCanvasSupported=l,this._fontInspectorEnabled=!!((S=globalThis.FontInspector)!=null&&S.enabled),this._reader=null,this._textDivProperties=e||new WeakMap,this._canceled=!1,this._capability=new o.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:_.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:E(0,l)};const{pageWidth:a,pageHeight:w,pageX:r,pageY:g}=_.rawDims;this._transform=[1,0,0,-1,-r,g+w],this._pageWidth=a,this._pageHeight=w,(0,b.setLayerDimensions)(D,_),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new o.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new o.AbortException("TextLayer task cancelled."))}_processItems(y,D){for(const _ of y){if(_.str===void 0){if(_.type==="beginMarkedContentProps"||_.type==="beginMarkedContent"){const h=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),_.id!==null&&this._container.setAttribute("id",`${_.id}`),h.append(this._container)}else _.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(_.str),j(this,_,D)}}_layoutText(y){const D=this._layoutTextParams.properties=this._textDivProperties.get(y);if(this._layoutTextParams.div=y,T(this._layoutTextParams),D.hasText&&this._container.append(y),D.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this._container.append(_)}}_render(){const y=new o.PromiseCapability;let D=Object.create(null);if(this._isReadableStream){const _=()=>{this._reader.read().then(({value:h,done:e})=>{if(e){y.resolve();return}Object.assign(D,h.styles),this._processItems(h.items,D),_()},y.reject)};this._reader=this._textContentSource.getReader(),_()}else if(this._textContentSource){const{items:_,styles:h}=this._textContentSource;this._processItems(_,h),y.resolve()}else throw new Error('No "textContentSource" parameter specified.');y.promise.then(()=>{D=null,x(this)},this._capability.reject)}}c.TextLayerRenderTask=m;function v(u){!u.textContentSource&&(u.textContent||u.textContentStream)&&((0,b.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),u.textContentSource=u.textContent||u.textContentStream);const{container:y,viewport:D}=u,_=getComputedStyle(y),h=_.getPropertyValue("visibility"),e=parseFloat(_.getPropertyValue("--scale-factor"));h==="visible"&&(!e||Math.abs(e-D.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const s=new m(u);return s._render(),s}function f({container:u,viewport:y,textDivs:D,textDivProperties:_,isOffscreenCanvasSupported:h,mustRotate:e=!0,mustRescale:s=!0}){if(e&&(0,b.setLayerDimensions)(u,{rotation:y.rotation}),s){const l=E(0,h),w={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l};for(const r of D)w.properties=_.get(r),w.div=r,T(w)}}},(L,c,G)=>{var d,j,T,x,m,v,f,u,y,D,_,Ke,Se,Je,Qe;Object.defineProperty(c,"__esModule",{value:!0}),c.AnnotationEditorLayer=void 0;var o=G(1),b=G(4),q=G(28),B=G(33),tt=G(6),O=G(34);const a=class a{constructor({uiManager:r,pageIndex:g,div:S,accessibilityManager:J,annotationLayer:H,viewport:Y,l10n:$}){at(this,_);at(this,d);at(this,j,!1);at(this,T,null);at(this,x,this.pointerup.bind(this));at(this,m,this.pointerdown.bind(this));at(this,v,new Map);at(this,f,!1);at(this,u,!1);at(this,y,!1);at(this,D);const rt=[q.FreeTextEditor,B.InkEditor,O.StampEditor];if(!a._initialized){a._initialized=!0;for(const P of rt)P.initialize($)}r.registerEditorTypes(rt),lt(this,D,r),this.pageIndex=g,this.div=S,lt(this,d,J),lt(this,T,H),this.viewport=Y,t(this,D).addLayer(this)}get isEmpty(){return t(this,v).size===0}updateToolbar(r){t(this,D).updateToolbar(r)}updateMode(r=t(this,D).getMode()){K(this,_,Qe).call(this),r===o.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),r!==o.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",r===o.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",r===o.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",r===o.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(r){if(!r&&t(this,D).getMode()!==o.AnnotationEditorType.INK)return;if(!r){for(const S of t(this,v).values())if(S.isEmpty()){S.setInBackground();return}}K(this,_,Se).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(r){t(this,D).setEditingState(r)}addCommands(r){t(this,D).addCommands(r)}enable(){this.div.style.pointerEvents="auto";const r=new Set;for(const S of t(this,v).values())S.enableEditing(),S.annotationElementId&&r.add(S.annotationElementId);if(!t(this,T))return;const g=t(this,T).getEditableAnnotations();for(const S of g){if(S.hide(),t(this,D).isDeletedAnnotationElement(S.data.id)||r.has(S.data.id))continue;const J=this.deserialize(S);J&&(this.addOrRebuild(J),J.enableEditing())}}disable(){var g;lt(this,y,!0),this.div.style.pointerEvents="none";const r=new Set;for(const S of t(this,v).values()){if(S.disableEditing(),!S.annotationElementId||S.serialize()!==null){r.add(S.annotationElementId);continue}(g=this.getEditableAnnotation(S.annotationElementId))==null||g.show(),S.remove()}if(t(this,T)){const S=t(this,T).getEditableAnnotations();for(const J of S){const{id:H}=J.data;r.has(H)||t(this,D).isDeletedAnnotationElement(H)||J.show()}}K(this,_,Qe).call(this),this.isEmpty&&(this.div.hidden=!0),lt(this,y,!1)}getEditableAnnotation(r){var g;return((g=t(this,T))==null?void 0:g.getEditableAnnotation(r))||null}setActiveEditor(r){t(this,D).getActive()!==r&&t(this,D).setActiveEditor(r)}enableClick(){this.div.addEventListener("pointerdown",t(this,m)),this.div.addEventListener("pointerup",t(this,x))}disableClick(){this.div.removeEventListener("pointerdown",t(this,m)),this.div.removeEventListener("pointerup",t(this,x))}attach(r){t(this,v).set(r.id,r);const{annotationElementId:g}=r;g&&t(this,D).isDeletedAnnotationElement(g)&&t(this,D).removeDeletedAnnotationElement(r)}detach(r){var g;t(this,v).delete(r.id),(g=t(this,d))==null||g.removePointerInTextLayer(r.contentDiv),!t(this,y)&&r.annotationElementId&&t(this,D).addDeletedAnnotationElement(r)}remove(r){this.detach(r),t(this,D).removeEditor(r),r.div.contains(document.activeElement)&&setTimeout(()=>{t(this,D).focusMainContainer()},0),r.div.remove(),r.isAttachedToDOM=!1,t(this,u)||this.addInkEditorIfNeeded(!1)}changeParent(r){var g;r.parent!==this&&(r.annotationElementId&&(t(this,D).addDeletedAnnotationElement(r.annotationElementId),b.AnnotationEditor.deleteAnnotationElement(r),r.annotationElementId=null),this.attach(r),(g=r.parent)==null||g.detach(r),r.setParent(this),r.div&&r.isAttachedToDOM&&(r.div.remove(),this.div.append(r.div)))}add(r){if(this.changeParent(r),t(this,D).addEditor(r),this.attach(r),!r.isAttachedToDOM){const g=r.render();this.div.append(g),r.isAttachedToDOM=!0}r.fixAndSetPosition(),r.onceAdded(),t(this,D).addToAnnotationStorage(r)}moveEditorInDOM(r){var S;if(!r.isAttachedToDOM)return;const{activeElement:g}=document;r.div.contains(g)&&(r._focusEventsAllowed=!1,setTimeout(()=>{r.div.contains(document.activeElement)?r._focusEventsAllowed=!0:(r.div.addEventListener("focusin",()=>{r._focusEventsAllowed=!0},{once:!0}),g.focus())},0)),r._structTreeParentId=(S=t(this,d))==null?void 0:S.moveElementInDOM(this.div,r.div,r.contentDiv,!0)}addOrRebuild(r){r.needsToBeRebuilt()?r.rebuild():this.add(r)}addUndoableEditor(r){const g=()=>r._uiManager.rebuild(r),S=()=>{r.remove()};this.addCommands({cmd:g,undo:S,mustExec:!1})}getNextId(){return t(this,D).getId()}pasteEditor(r,g){t(this,D).updateToolbar(r),t(this,D).updateMode(r);const{offsetX:S,offsetY:J}=K(this,_,Je).call(this),H=this.getNextId(),Y=K(this,_,Ke).call(this,{parent:this,id:H,x:S,y:J,uiManager:t(this,D),isCentered:!0,...g});Y&&this.add(Y)}deserialize(r){switch(r.annotationType??r.annotationEditorType){case o.AnnotationEditorType.FREETEXT:return q.FreeTextEditor.deserialize(r,this,t(this,D));case o.AnnotationEditorType.INK:return B.InkEditor.deserialize(r,this,t(this,D));case o.AnnotationEditorType.STAMP:return O.StampEditor.deserialize(r,this,t(this,D))}return null}addNewEditor(){K(this,_,Se).call(this,K(this,_,Je).call(this),!0)}setSelected(r){t(this,D).setSelected(r)}toggleSelected(r){t(this,D).toggleSelected(r)}isSelected(r){return t(this,D).isSelected(r)}unselect(r){t(this,D).unselect(r)}pointerup(r){const{isMac:g}=o.FeatureTest.platform;if(!(r.button!==0||r.ctrlKey&&g)&&r.target===this.div&&t(this,f)){if(lt(this,f,!1),!t(this,j)){lt(this,j,!0);return}if(t(this,D).getMode()===o.AnnotationEditorType.STAMP){t(this,D).unselectAll();return}K(this,_,Se).call(this,r,!1)}}pointerdown(r){if(t(this,f)){lt(this,f,!1);return}const{isMac:g}=o.FeatureTest.platform;if(r.button!==0||r.ctrlKey&&g||r.target!==this.div)return;lt(this,f,!0);const S=t(this,D).getActive();lt(this,j,!S||S.isEmpty())}findNewParent(r,g,S){const J=t(this,D).findParent(g,S);return J===null||J===this?!1:(J.changeParent(r),!0)}destroy(){var r,g;((r=t(this,D).getActive())==null?void 0:r.parent)===this&&(t(this,D).commitOrRemove(),t(this,D).setActiveEditor(null));for(const S of t(this,v).values())(g=t(this,d))==null||g.removePointerInTextLayer(S.contentDiv),S.setParent(null),S.isAttachedToDOM=!1,S.div.remove();this.div=null,t(this,v).clear(),t(this,D).removeLayer(this)}render({viewport:r}){this.viewport=r,(0,tt.setLayerDimensions)(this.div,r);for(const g of t(this,D).getEditors(this.pageIndex))this.add(g);this.updateMode()}update({viewport:r}){t(this,D).commitOrRemove(),this.viewport=r,(0,tt.setLayerDimensions)(this.div,{rotation:r.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:r,pageHeight:g}=this.viewport.rawDims;return[r,g]}};d=new WeakMap,j=new WeakMap,T=new WeakMap,x=new WeakMap,m=new WeakMap,v=new WeakMap,f=new WeakMap,u=new WeakMap,y=new WeakMap,D=new WeakMap,_=new WeakSet,Ke=function(r){switch(t(this,D).getMode()){case o.AnnotationEditorType.FREETEXT:return new q.FreeTextEditor(r);case o.AnnotationEditorType.INK:return new B.InkEditor(r);case o.AnnotationEditorType.STAMP:return new O.StampEditor(r)}return null},Se=function(r,g){const S=this.getNextId(),J=K(this,_,Ke).call(this,{parent:this,id:S,x:r.offsetX,y:r.offsetY,uiManager:t(this,D),isCentered:g});return J&&this.add(J),J},Je=function(){const{x:r,y:g,width:S,height:J}=this.div.getBoundingClientRect(),H=Math.max(0,r),Y=Math.max(0,g),$=Math.min(window.innerWidth,r+S),rt=Math.min(window.innerHeight,g+J),P=(H+$)/2-r,W=(Y+rt)/2-g,[Z,R]=this.viewport.rotation%180===0?[P,W]:[W,P];return{offsetX:Z,offsetY:R}},Qe=function(){lt(this,u,!0);for(const r of t(this,v).values())r.isEmpty()&&r.remove();lt(this,u,!1)},Kt(a,"_initialized",!1);let E=a;c.AnnotationEditorLayer=E},(L,c,G)=>{var O,E,d,j,T,x,m,v,f,u,Rs,Cs,js,me,Ze,Ts,ts;Object.defineProperty(c,"__esModule",{value:!0}),c.FreeTextEditor=void 0;var o=G(1),b=G(5),q=G(4),B=G(29);const a=class a extends q.AnnotationEditor{constructor(g){super({...g,name:"freeTextEditor"});at(this,u);at(this,O,this.editorDivBlur.bind(this));at(this,E,this.editorDivFocus.bind(this));at(this,d,this.editorDivInput.bind(this));at(this,j,this.editorDivKeydown.bind(this));at(this,T);at(this,x,"");at(this,m,`${this.id}-editor`);at(this,v);at(this,f,null);lt(this,T,g.color||a._defaultColor||q.AnnotationEditor._defaultLineColor),lt(this,v,g.fontSize||a._defaultFontSize)}static get _keyboardManager(){const g=a.prototype,S=Y=>Y.isEmpty(),J=b.AnnotationEditorUIManager.TRANSLATE_SMALL,H=b.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,o.shadow)(this,"_keyboardManager",new b.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],g.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],g.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],g._translateEmpty,{args:[-J,0],checker:S}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],g._translateEmpty,{args:[-H,0],checker:S}],[["ArrowRight","mac+ArrowRight"],g._translateEmpty,{args:[J,0],checker:S}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],g._translateEmpty,{args:[H,0],checker:S}],[["ArrowUp","mac+ArrowUp"],g._translateEmpty,{args:[0,-J],checker:S}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],g._translateEmpty,{args:[0,-H],checker:S}],[["ArrowDown","mac+ArrowDown"],g._translateEmpty,{args:[0,J],checker:S}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],g._translateEmpty,{args:[0,H],checker:S}]]))}static initialize(g){q.AnnotationEditor.initialize(g,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const S=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(S.getPropertyValue("--freetext-padding"))}static updateDefaultParams(g,S){switch(g){case o.AnnotationEditorParamsType.FREETEXT_SIZE:a._defaultFontSize=S;break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:a._defaultColor=S;break}}updateParams(g,S){switch(g){case o.AnnotationEditorParamsType.FREETEXT_SIZE:K(this,u,Rs).call(this,S);break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:K(this,u,Cs).call(this,S);break}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,a._defaultFontSize],[o.AnnotationEditorParamsType.FREETEXT_COLOR,a._defaultColor||q.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,v)],[o.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,T)]]}_translateEmpty(g,S){this._uiManager.translateSelectedEditors(g,S,!0)}getInitialTranslation(){const g=this.parentScale;return[-a._internalPadding*g,-(a._internalPadding+t(this,v))*g]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(o.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,j)),this.editorDiv.addEventListener("focus",t(this,E)),this.editorDiv.addEventListener("blur",t(this,O)),this.editorDiv.addEventListener("input",t(this,d)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,m)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,j)),this.editorDiv.removeEventListener("focus",t(this,E)),this.editorDiv.removeEventListener("blur",t(this,O)),this.editorDiv.removeEventListener("input",t(this,d)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(g){this._focusEventsAllowed&&(super.focusin(g),g.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var g;if(this.width){K(this,u,ts).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(g=this._initialOptions)!=null&&g.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const g=t(this,x),S=lt(this,x,K(this,u,js).call(this).trimEnd());if(g===S)return;const J=H=>{if(lt(this,x,H),!H){this.remove();return}K(this,u,Ze).call(this),this._uiManager.rebuild(this),K(this,u,me).call(this)};this.addCommands({cmd:()=>{J(S)},undo:()=>{J(g)},mustExec:!1}),K(this,u,me).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(g){this.enterInEditMode()}keydown(g){g.target===this.div&&g.key==="Enter"&&(this.enterInEditMode(),g.preventDefault())}editorDivKeydown(g){a._keyboardManager.exec(this,g)}editorDivFocus(g){this.isEditing=!0}editorDivBlur(g){this.isEditing=!1}editorDivInput(g){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let g,S;this.width&&(g=this.x,S=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,m)),this.enableEditing(),q.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(H=>{var Y;return(Y=this.editorDiv)==null?void 0:Y.setAttribute("aria-label",H)}),q.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(H=>{var Y;return(Y=this.editorDiv)==null?void 0:Y.setAttribute("default-content",H)}),this.editorDiv.contentEditable=!0;const{style:J}=this.editorDiv;if(J.fontSize=`calc(${t(this,v)}px * var(--scale-factor))`,J.color=t(this,T),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,b.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[H,Y]=this.parentDimensions;if(this.annotationElementId){const{position:$}=t(this,f);let[rt,P]=this.getInitialTranslation();[rt,P]=this.pageTranslationToScreen(rt,P);const[W,Z]=this.pageDimensions,[R,n]=this.pageTranslation;let i,p;switch(this.rotation){case 0:i=g+($[0]-R)/W,p=S+this.height-($[1]-n)/Z;break;case 90:i=g+($[0]-R)/W,p=S-($[1]-n)/Z,[rt,P]=[P,-rt];break;case 180:i=g-this.width+($[0]-R)/W,p=S-($[1]-n)/Z,[rt,P]=[-rt,-P];break;case 270:i=g+($[0]-R-this.height*Z)/W,p=S+($[1]-n-this.width*W)/Z,[rt,P]=[-P,rt];break}this.setAt(i*H,p*Y,rt,P)}else this.setAt(g*H,S*Y,this.width*H,this.height*Y);K(this,u,Ze).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(g,S,J){let H=null;if(g instanceof B.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:$,fontColor:rt},rect:P,rotation:W,id:Z},textContent:R,textPosition:n,parent:{page:{pageNumber:i}}}=g;if(!R||R.length===0)return null;H=g={annotationType:o.AnnotationEditorType.FREETEXT,color:Array.from(rt),fontSize:$,value:R.join(`
`),position:n,pageIndex:i-1,rect:P,rotation:W,id:Z,deleted:!1}}const Y=super.deserialize(g,S,J);return lt(Y,v,g.fontSize),lt(Y,T,o.Util.makeHexColor(...g.color)),lt(Y,x,g.value),Y.annotationElementId=g.id||null,lt(Y,f,H),Y}serialize(g=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const S=a._internalPadding*this.parentScale,J=this.getRect(S,S),H=q.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,T)),Y={annotationType:o.AnnotationEditorType.FREETEXT,color:H,fontSize:t(this,v),value:t(this,x),pageIndex:this.pageIndex,rect:J,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return g?Y:this.annotationElementId&&!K(this,u,Ts).call(this,Y)?null:(Y.id=this.annotationElementId,Y)}};O=new WeakMap,E=new WeakMap,d=new WeakMap,j=new WeakMap,T=new WeakMap,x=new WeakMap,m=new WeakMap,v=new WeakMap,f=new WeakMap,u=new WeakSet,Rs=function(g){const S=H=>{this.editorDiv.style.fontSize=`calc(${H}px * var(--scale-factor))`,this.translate(0,-(H-t(this,v))*this.parentScale),lt(this,v,H),K(this,u,me).call(this)},J=t(this,v);this.addCommands({cmd:()=>{S(g)},undo:()=>{S(J)},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Cs=function(g){const S=t(this,T);this.addCommands({cmd:()=>{lt(this,T,this.editorDiv.style.color=g)},undo:()=>{lt(this,T,this.editorDiv.style.color=S)},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},js=function(){const g=this.editorDiv.getElementsByTagName("div");if(g.length===0)return this.editorDiv.innerText;const S=[];for(const J of g)S.push(J.innerText.replace(/\r\n?|\n/,""));return S.join(`
`)},me=function(){const[g,S]=this.parentDimensions;let J;if(this.isAttachedToDOM)J=this.div.getBoundingClientRect();else{const{currentLayer:H,div:Y}=this,$=Y.style.display;Y.style.display="hidden",H.div.append(this.div),J=Y.getBoundingClientRect(),Y.remove(),Y.style.display=$}this.rotation%180===this.parentRotation%180?(this.width=J.width/g,this.height=J.height/S):(this.width=J.height/g,this.height=J.width/S),this.fixAndSetPosition()},Ze=function(){if(this.editorDiv.replaceChildren(),!!t(this,x))for(const g of t(this,x).split(`
`)){const S=document.createElement("div");S.append(g?document.createTextNode(g):document.createElement("br")),this.editorDiv.append(S)}},Ts=function(g){const{value:S,fontSize:J,color:H,rect:Y,pageIndex:$}=t(this,f);return g.value!==S||g.fontSize!==J||g.rect.some((rt,P)=>Math.abs(rt-Y[P])>=1)||g.color.some((rt,P)=>rt!==H[P])||g.pageIndex!==$},ts=function(g=!1){if(!this.annotationElementId)return;if(K(this,u,me).call(this),!g&&(this.width===0||this.height===0)){setTimeout(()=>K(this,u,ts).call(this,!0),0);return}const S=a._internalPadding*this.parentScale;t(this,f).rect=this.getRect(S,S)},Kt(a,"_freeTextDefaultContent",""),Kt(a,"_internalPadding",0),Kt(a,"_defaultColor",null),Kt(a,"_defaultFontSize",10),Kt(a,"_type","freetext");let tt=a;c.FreeTextEditor=tt},(L,c,G)=>{var p,F,ne,Ps,et,dt,ut,mt,yt,xt,st,it,A,M,V,nt,ft,vt,At,Q,wt,St,ks,we,es,ss,Lt,zt,Xt,Et,ot,ct,Tt,is,Wt,U,gt,Rt,Fs,ns;Object.defineProperty(c,"__esModule",{value:!0}),c.StampAnnotationElement=c.InkAnnotationElement=c.FreeTextAnnotationElement=c.AnnotationLayer=void 0;var o=G(1),b=G(6),q=G(3),B=G(30),tt=G(31),O=G(32);const E=1e3,d=9,j=new WeakSet;function T(jt){return{width:jt[2]-jt[0],height:jt[3]-jt[1]}}class x{static create(N){switch(N.data.annotationType){case o.AnnotationType.LINK:return new v(N);case o.AnnotationType.TEXT:return new f(N);case o.AnnotationType.WIDGET:switch(N.data.fieldType){case"Tx":return new y(N);case"Btn":return N.data.radioButton?new h(N):N.data.checkBox?new _(N):new e(N);case"Ch":return new s(N);case"Sig":return new D(N)}return new u(N);case o.AnnotationType.POPUP:return new l(N);case o.AnnotationType.FREETEXT:return new w(N);case o.AnnotationType.LINE:return new r(N);case o.AnnotationType.SQUARE:return new g(N);case o.AnnotationType.CIRCLE:return new S(N);case o.AnnotationType.POLYLINE:return new J(N);case o.AnnotationType.CARET:return new Y(N);case o.AnnotationType.INK:return new $(N);case o.AnnotationType.POLYGON:return new H(N);case o.AnnotationType.HIGHLIGHT:return new rt(N);case o.AnnotationType.UNDERLINE:return new P(N);case o.AnnotationType.SQUIGGLY:return new W(N);case o.AnnotationType.STRIKEOUT:return new Z(N);case o.AnnotationType.STAMP:return new R(N);case o.AnnotationType.FILEATTACHMENT:return new n(N);default:return new m(N)}}}const k=class k{constructor(N,{isRenderable:C=!1,ignoreBorder:X=!1,createQuadrilaterals:ht=!1}={}){at(this,p,!1);this.isRenderable=C,this.data=N.data,this.layer=N.layer,this.linkService=N.linkService,this.downloadManager=N.downloadManager,this.imageResourcesPath=N.imageResourcesPath,this.renderForms=N.renderForms,this.svgFactory=N.svgFactory,this.annotationStorage=N.annotationStorage,this.enableScripting=N.enableScripting,this.hasJSActions=N.hasJSActions,this._fieldObjects=N.fieldObjects,this.parent=N.parent,C&&(this.container=this._createContainer(X)),ht&&this._createQuadrilaterals()}static _hasPopupData({titleObj:N,contentsObj:C,richText:X}){return!!(N!=null&&N.str||C!=null&&C.str||X!=null&&X.str)}get hasPopupData(){return k._hasPopupData(this.data)}_createContainer(N){const{data:C,parent:{page:X,viewport:ht}}=this,pt=document.createElement("section");pt.setAttribute("data-annotation-id",C.id),this instanceof u||(pt.tabIndex=E),pt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&pt.setAttribute("aria-haspopup","dialog"),C.noRotate&&pt.classList.add("norotate");const{pageWidth:bt,pageHeight:_t,pageX:Dt,pageY:kt}=ht.rawDims;if(!C.rect||this instanceof l){const{rotation:Ut}=C;return!C.hasOwnCanvas&&Ut!==0&&this.setRotation(Ut,pt),pt}const{width:Ct,height:Ht}=T(C.rect),Ft=o.Util.normalizeRect([C.rect[0],X.view[3]-C.rect[1]+X.view[1],C.rect[2],X.view[3]-C.rect[3]+X.view[1]]);if(!N&&C.borderStyle.width>0){pt.style.borderWidth=`${C.borderStyle.width}px`;const Ut=C.borderStyle.horizontalCornerRadius,$t=C.borderStyle.verticalCornerRadius;if(Ut>0||$t>0){const Yt=`calc(${Ut}px * var(--scale-factor)) / calc(${$t}px * var(--scale-factor))`;pt.style.borderRadius=Yt}else if(this instanceof h){const Yt=`calc(${Ct}px * var(--scale-factor)) / calc(${Ht}px * var(--scale-factor))`;pt.style.borderRadius=Yt}switch(C.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:pt.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:pt.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:pt.style.borderBottomStyle="solid";break}const qt=C.borderColor||null;qt?(lt(this,p,!0),pt.style.borderColor=o.Util.makeHexColor(qt[0]|0,qt[1]|0,qt[2]|0)):pt.style.borderWidth=0}pt.style.left=`${100*(Ft[0]-Dt)/bt}%`,pt.style.top=`${100*(Ft[1]-kt)/_t}%`;const{rotation:It}=C;return C.hasOwnCanvas||It===0?(pt.style.width=`${100*Ct/bt}%`,pt.style.height=`${100*Ht/_t}%`):this.setRotation(It,pt),pt}setRotation(N,C=this.container){if(!this.data.rect)return;const{pageWidth:X,pageHeight:ht}=this.parent.viewport.rawDims,{width:pt,height:bt}=T(this.data.rect);let _t,Dt;N%180===0?(_t=100*pt/X,Dt=100*bt/ht):(_t=100*bt/X,Dt=100*pt/ht),C.style.width=`${_t}%`,C.style.height=`${Dt}%`,C.setAttribute("data-main-rotation",(360-N)%360)}get _commonActions(){const N=(C,X,ht)=>{const pt=ht.detail[C],bt=pt[0],_t=pt.slice(1);ht.target.style[X]=B.ColorConverters[`${bt}_HTML`](_t),this.annotationStorage.setValue(this.data.id,{[X]:B.ColorConverters[`${bt}_rgb`](_t)})};return(0,o.shadow)(this,"_commonActions",{display:C=>{const{display:X}=C.detail,ht=X%2===1;this.container.style.visibility=ht?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:ht,noPrint:X===1||X===2})},print:C=>{this.annotationStorage.setValue(this.data.id,{noPrint:!C.detail.print})},hidden:C=>{const{hidden:X}=C.detail;this.container.style.visibility=X?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:X,noView:X})},focus:C=>{setTimeout(()=>C.target.focus({preventScroll:!1}),0)},userName:C=>{C.target.title=C.detail.userName},readonly:C=>{C.target.disabled=C.detail.readonly},required:C=>{this._setRequired(C.target,C.detail.required)},bgColor:C=>{N("bgColor","backgroundColor",C)},fillColor:C=>{N("fillColor","backgroundColor",C)},fgColor:C=>{N("fgColor","color",C)},textColor:C=>{N("textColor","color",C)},borderColor:C=>{N("borderColor","borderColor",C)},strokeColor:C=>{N("strokeColor","borderColor",C)},rotation:C=>{const X=C.detail.rotation;this.setRotation(X),this.annotationStorage.setValue(this.data.id,{rotation:X})}})}_dispatchEventFromSandbox(N,C){const X=this._commonActions;for(const ht of Object.keys(C.detail)){const pt=N[ht]||X[ht];pt==null||pt(C)}}_setDefaultPropertiesFromJS(N){if(!this.enableScripting)return;const C=this.annotationStorage.getRawValue(this.data.id);if(!C)return;const X=this._commonActions;for(const[ht,pt]of Object.entries(C)){const bt=X[ht];if(bt){const _t={detail:{[ht]:pt},target:N};bt(_t),delete C[ht]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:N}=this.data;if(!N)return;const[C,X,ht,pt]=this.data.rect;if(N.length===1){const[,{x:$t,y:qt},{x:Yt,y:Qt}]=N[0];if(ht===$t&&pt===qt&&C===Yt&&X===Qt)return}const{style:bt}=this.container;let _t;if(t(this,p)){const{borderColor:$t,borderWidth:qt}=bt;bt.borderWidth=0,_t=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${$t}" stroke-width="${qt}">`],this.container.classList.add("hasBorder")}const Dt=ht-C,kt=pt-X,{svgFactory:Ct}=this,Ht=Ct.createElement("svg");Ht.classList.add("quadrilateralsContainer"),Ht.setAttribute("width",0),Ht.setAttribute("height",0);const Ft=Ct.createElement("defs");Ht.append(Ft);const It=Ct.createElement("clipPath"),Ut=`clippath_${this.data.id}`;It.setAttribute("id",Ut),It.setAttribute("clipPathUnits","objectBoundingBox"),Ft.append(It);for(const[,{x:$t,y:qt},{x:Yt,y:Qt}]of N){const Jt=Ct.createElement("rect"),te=(Yt-C)/Dt,se=(pt-qt)/kt,ie=($t-Yt)/Dt,ps=(qt-Qt)/kt;Jt.setAttribute("x",te),Jt.setAttribute("y",se),Jt.setAttribute("width",ie),Jt.setAttribute("height",ps),It.append(Jt),_t==null||_t.push(`<rect vector-effect="non-scaling-stroke" x="${te}" y="${se}" width="${ie}" height="${ps}"/>`)}t(this,p)&&(_t.push("</g></svg>')"),bt.backgroundImage=_t.join("")),this.container.append(Ht),this.container.style.clipPath=`url(#${Ut})`}_createPopup(){const{container:N,data:C}=this;N.setAttribute("aria-haspopup","dialog");const X=new l({data:{color:C.color,titleObj:C.titleObj,modificationDate:C.modificationDate,contentsObj:C.contentsObj,richText:C.richText,parentRect:C.rect,borderStyle:0,id:`popup_${C.id}`,rotation:C.rotation},parent:this.parent,elements:[this]});this.parent.div.append(X.render())}render(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(N,C=null){const X=[];if(this._fieldObjects){const ht=this._fieldObjects[N];if(ht)for(const{page:pt,id:bt,exportValues:_t}of ht){if(pt===-1||bt===C)continue;const Dt=typeof _t=="string"?_t:null,kt=document.querySelector(`[data-element-id="${bt}"]`);if(kt&&!j.has(kt)){(0,o.warn)(`_getElementsByName - element not allowed: ${bt}`);continue}X.push({id:bt,exportValue:Dt,domElement:kt})}return X}for(const ht of document.getElementsByName(N)){const{exportValue:pt}=ht,bt=ht.getAttribute("data-element-id");bt!==C&&j.has(ht)&&X.push({id:bt,exportValue:pt,domElement:ht})}return X}show(){var N;this.container&&(this.container.hidden=!1),(N=this.popup)==null||N.maybeShow()}hide(){var N;this.container&&(this.container.hidden=!0),(N=this.popup)==null||N.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const N=this.getElementsToTriggerPopup();if(Array.isArray(N))for(const C of N)C.classList.add("highlightArea");else N.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:N,data:{id:C}}=this;this.container.addEventListener("dblclick",()=>{var X;(X=this.linkService.eventBus)==null||X.dispatch("switchannotationeditormode",{source:this,mode:N,editId:C})})}};p=new WeakMap;let m=k;class v extends m{constructor(C,X=null){super(C,{isRenderable:!0,ignoreBorder:!!(X!=null&&X.ignoreBorder),createQuadrilaterals:!0});at(this,F);this.isTooltipOnly=C.data.isTooltipOnly}render(){const{data:C,linkService:X}=this,ht=document.createElement("a");ht.setAttribute("data-element-id",C.id);let pt=!1;return C.url?(X.addLinkAttributes(ht,C.url,C.newWindow),pt=!0):C.action?(this._bindNamedAction(ht,C.action),pt=!0):C.attachment?(this._bindAttachment(ht,C.attachment),pt=!0):C.setOCGState?(K(this,F,Ps).call(this,ht,C.setOCGState),pt=!0):C.dest?(this._bindLink(ht,C.dest),pt=!0):(C.actions&&(C.actions.Action||C.actions["Mouse Up"]||C.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(ht,C),pt=!0),C.resetForm?(this._bindResetFormAction(ht,C.resetForm),pt=!0):this.isTooltipOnly&&!pt&&(this._bindLink(ht,""),pt=!0)),this.container.classList.add("linkAnnotation"),pt&&this.container.append(ht),this.container}_bindLink(C,X){C.href=this.linkService.getDestinationHash(X),C.onclick=()=>(X&&this.linkService.goToDestination(X),!1),(X||X==="")&&K(this,F,ne).call(this)}_bindNamedAction(C,X){C.href=this.linkService.getAnchorUrl(""),C.onclick=()=>(this.linkService.executeNamedAction(X),!1),K(this,F,ne).call(this)}_bindAttachment(C,X){C.href=this.linkService.getAnchorUrl(""),C.onclick=()=>{var ht;return(ht=this.downloadManager)==null||ht.openOrDownloadData(this.container,X.content,X.filename),!1},K(this,F,ne).call(this)}_bindJSAction(C,X){C.href=this.linkService.getAnchorUrl("");const ht=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const pt of Object.keys(X.actions)){const bt=ht.get(pt);bt&&(C[bt]=()=>{var _t;return(_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:X.id,name:pt}}),!1})}C.onclick||(C.onclick=()=>!1),K(this,F,ne).call(this)}_bindResetFormAction(C,X){const ht=C.onclick;if(ht||(C.href=this.linkService.getAnchorUrl("")),K(this,F,ne).call(this),!this._fieldObjects){(0,o.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),ht||(C.onclick=()=>!1);return}C.onclick=()=>{var Ht;ht==null||ht();const{fields:pt,refs:bt,include:_t}=X,Dt=[];if(pt.length!==0||bt.length!==0){const Ft=new Set(bt);for(const It of pt){const Ut=this._fieldObjects[It]||[];for(const{id:$t}of Ut)Ft.add($t)}for(const It of Object.values(this._fieldObjects))for(const Ut of It)Ft.has(Ut.id)===_t&&Dt.push(Ut)}else for(const Ft of Object.values(this._fieldObjects))Dt.push(...Ft);const kt=this.annotationStorage,Ct=[];for(const Ft of Dt){const{id:It}=Ft;switch(Ct.push(It),Ft.type){case"text":{const $t=Ft.defaultValue||"";kt.setValue(It,{value:$t});break}case"checkbox":case"radiobutton":{const $t=Ft.defaultValue===Ft.exportValues;kt.setValue(It,{value:$t});break}case"combobox":case"listbox":{const $t=Ft.defaultValue||"";kt.setValue(It,{value:$t});break}default:continue}const Ut=document.querySelector(`[data-element-id="${It}"]`);if(Ut){if(!j.has(Ut)){(0,o.warn)(`_bindResetFormAction - element not allowed: ${It}`);continue}}else continue;Ut.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Ct,name:"ResetForm"}})),!1}}}F=new WeakSet,ne=function(){this.container.setAttribute("data-internal-link","")},Ps=function(C,X){C.href=this.linkService.getAnchorUrl(""),C.onclick=()=>(this.linkService.executeSetOCGState(X),!1),K(this,F,ne).call(this)};class f extends m{constructor(N){super(N,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const N=document.createElement("img");return N.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",N.alt="[{{type}} Annotation]",N.dataset.l10nId="text_annotation_type",N.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(N),this.container}}class u extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(N){var C;this.data.hasOwnCanvas&&(((C=N.previousSibling)==null?void 0:C.nodeName)==="CANVAS"&&(N.previousSibling.hidden=!0),N.hidden=!1)}_getKeyModifier(N){const{isWin:C,isMac:X}=o.FeatureTest.platform;return C&&N.ctrlKey||X&&N.metaKey}_setEventListener(N,C,X,ht,pt){X.includes("mouse")?N.addEventListener(X,bt=>{var _t;(_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ht,value:pt(bt),shift:bt.shiftKey,modifier:this._getKeyModifier(bt)}})}):N.addEventListener(X,bt=>{var _t;if(X==="blur"){if(!C.focused||!bt.relatedTarget)return;C.focused=!1}else if(X==="focus"){if(C.focused)return;C.focused=!0}pt&&((_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ht,value:pt(bt)}}))})}_setEventListeners(N,C,X,ht){var pt,bt,_t;for(const[Dt,kt]of X)(kt==="Action"||(pt=this.data.actions)!=null&&pt[kt])&&((kt==="Focus"||kt==="Blur")&&(C||(C={focused:!1})),this._setEventListener(N,C,Dt,kt,ht),kt==="Focus"&&!((bt=this.data.actions)!=null&&bt.Blur)?this._setEventListener(N,C,"blur","Blur",null):kt==="Blur"&&!((_t=this.data.actions)!=null&&_t.Focus)&&this._setEventListener(N,C,"focus","Focus",null))}_setBackgroundColor(N){const C=this.data.backgroundColor||null;N.style.backgroundColor=C===null?"transparent":o.Util.makeHexColor(C[0],C[1],C[2])}_setTextStyle(N){const C=["left","center","right"],{fontColor:X}=this.data.defaultAppearanceData,ht=this.data.defaultAppearanceData.fontSize||d,pt=N.style;let bt;const _t=2,Dt=kt=>Math.round(10*kt)/10;if(this.data.multiLine){const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-_t),Ct=Math.round(kt/(o.LINE_FACTOR*ht))||1,Ht=kt/Ct;bt=Math.min(ht,Dt(Ht/o.LINE_FACTOR))}else{const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-_t);bt=Math.min(ht,Dt(kt/o.LINE_FACTOR))}pt.fontSize=`calc(${bt}px * var(--scale-factor))`,pt.color=o.Util.makeHexColor(X[0],X[1],X[2]),this.data.textAlignment!==null&&(pt.textAlign=C[this.data.textAlignment])}_setRequired(N,C){C?N.setAttribute("required",!0):N.removeAttribute("required"),N.setAttribute("aria-required",C)}}class y extends u{constructor(N){const C=N.renderForms||!N.data.hasAppearance&&!!N.data.fieldValue;super(N,{isRenderable:C})}setPropertyOnSiblings(N,C,X,ht){const pt=this.annotationStorage;for(const bt of this._getElementsByName(N.name,N.id))bt.domElement&&(bt.domElement[C]=X),pt.setValue(bt.id,{[ht]:X})}render(){var ht,pt;const N=this.annotationStorage,C=this.data.id;this.container.classList.add("textWidgetAnnotation");let X=null;if(this.renderForms){const bt=N.getValue(C,{value:this.data.fieldValue});let _t=bt.value||"";const Dt=N.getValue(C,{charLimit:this.data.maxLen}).charLimit;Dt&&_t.length>Dt&&(_t=_t.slice(0,Dt));let kt=bt.formattedValue||((ht=this.data.textContent)==null?void 0:ht.join(`
`))||null;kt&&this.data.comb&&(kt=kt.replaceAll(/\s+/g,""));const Ct={userValue:_t,formattedValue:kt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(X=document.createElement("textarea"),X.textContent=kt??_t,this.data.doNotScroll&&(X.style.overflowY="hidden")):(X=document.createElement("input"),X.type="text",X.setAttribute("value",kt??_t),this.data.doNotScroll&&(X.style.overflowX="hidden")),this.data.hasOwnCanvas&&(X.hidden=!0),j.add(X),X.setAttribute("data-element-id",C),X.disabled=this.data.readOnly,X.name=this.data.fieldName,X.tabIndex=E,this._setRequired(X,this.data.required),Dt&&(X.maxLength=Dt),X.addEventListener("input",Ft=>{N.setValue(C,{value:Ft.target.value}),this.setPropertyOnSiblings(X,"value",Ft.target.value,"value"),Ct.formattedValue=null}),X.addEventListener("resetform",Ft=>{const It=this.data.defaultFieldValue??"";X.value=Ct.userValue=It,Ct.formattedValue=null});let Ht=Ft=>{const{formattedValue:It}=Ct;It!=null&&(Ft.target.value=It),Ft.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){X.addEventListener("focus",It=>{if(Ct.focused)return;const{target:Ut}=It;Ct.userValue&&(Ut.value=Ct.userValue),Ct.lastCommittedValue=Ut.value,Ct.commitKey=1,Ct.focused=!0}),X.addEventListener("updatefromsandbox",It=>{this.showElementAndHideCanvas(It.target);const Ut={value($t){Ct.userValue=$t.detail.value??"",N.setValue(C,{value:Ct.userValue.toString()}),$t.target.value=Ct.userValue},formattedValue($t){const{formattedValue:qt}=$t.detail;Ct.formattedValue=qt,qt!=null&&$t.target!==document.activeElement&&($t.target.value=qt),N.setValue(C,{formattedValue:qt})},selRange($t){$t.target.setSelectionRange(...$t.detail.selRange)},charLimit:$t=>{var Jt;const{charLimit:qt}=$t.detail,{target:Yt}=$t;if(qt===0){Yt.removeAttribute("maxLength");return}Yt.setAttribute("maxLength",qt);let Qt=Ct.userValue;!Qt||Qt.length<=qt||(Qt=Qt.slice(0,qt),Yt.value=Ct.userValue=Qt,N.setValue(C,{value:Qt}),(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:C,name:"Keystroke",value:Qt,willCommit:!0,commitKey:1,selStart:Yt.selectionStart,selEnd:Yt.selectionEnd}}))}};this._dispatchEventFromSandbox(Ut,It)}),X.addEventListener("keydown",It=>{var qt;Ct.commitKey=1;let Ut=-1;if(It.key==="Escape"?Ut=0:It.key==="Enter"&&!this.data.multiLine?Ut=2:It.key==="Tab"&&(Ct.commitKey=3),Ut===-1)return;const{value:$t}=It.target;Ct.lastCommittedValue!==$t&&(Ct.lastCommittedValue=$t,Ct.userValue=$t,(qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:C,name:"Keystroke",value:$t,willCommit:!0,commitKey:Ut,selStart:It.target.selectionStart,selEnd:It.target.selectionEnd}}))});const Ft=Ht;Ht=null,X.addEventListener("blur",It=>{var $t;if(!Ct.focused||!It.relatedTarget)return;Ct.focused=!1;const{value:Ut}=It.target;Ct.userValue=Ut,Ct.lastCommittedValue!==Ut&&(($t=this.linkService.eventBus)==null||$t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:C,name:"Keystroke",value:Ut,willCommit:!0,commitKey:Ct.commitKey,selStart:It.target.selectionStart,selEnd:It.target.selectionEnd}})),Ft(It)}),(pt=this.data.actions)!=null&&pt.Keystroke&&X.addEventListener("beforeinput",It=>{var se;Ct.lastCommittedValue=null;const{data:Ut,target:$t}=It,{value:qt,selectionStart:Yt,selectionEnd:Qt}=$t;let Jt=Yt,te=Qt;switch(It.inputType){case"deleteWordBackward":{const ie=qt.substring(0,Yt).match(/\w*[^\w]*$/);ie&&(Jt-=ie[0].length);break}case"deleteWordForward":{const ie=qt.substring(Yt).match(/^[^\w]*\w*/);ie&&(te+=ie[0].length);break}case"deleteContentBackward":Yt===Qt&&(Jt-=1);break;case"deleteContentForward":Yt===Qt&&(te+=1);break}It.preventDefault(),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:C,name:"Keystroke",value:qt,change:Ut||"",willCommit:!1,selStart:Jt,selEnd:te}})}),this._setEventListeners(X,Ct,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],It=>It.target.value)}if(Ht&&X.addEventListener("blur",Ht),this.data.comb){const It=(this.data.rect[2]-this.data.rect[0])/Dt;X.classList.add("comb"),X.style.letterSpacing=`calc(${It}px * var(--scale-factor) - 1ch)`}}else X=document.createElement("div"),X.textContent=this.data.fieldValue,X.style.verticalAlign="middle",X.style.display="table-cell";return this._setTextStyle(X),this._setBackgroundColor(X),this._setDefaultPropertiesFromJS(X),this.container.append(X),this.container}}class D extends u{constructor(N){super(N,{isRenderable:!!N.data.hasOwnCanvas})}}class _ extends u{constructor(N){super(N,{isRenderable:N.renderForms})}render(){const N=this.annotationStorage,C=this.data,X=C.id;let ht=N.getValue(X,{value:C.exportValue===C.fieldValue}).value;typeof ht=="string"&&(ht=ht!=="Off",N.setValue(X,{value:ht})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const pt=document.createElement("input");return j.add(pt),pt.setAttribute("data-element-id",X),pt.disabled=C.readOnly,this._setRequired(pt,this.data.required),pt.type="checkbox",pt.name=C.fieldName,ht&&pt.setAttribute("checked",!0),pt.setAttribute("exportValue",C.exportValue),pt.tabIndex=E,pt.addEventListener("change",bt=>{const{name:_t,checked:Dt}=bt.target;for(const kt of this._getElementsByName(_t,X)){const Ct=Dt&&kt.exportValue===C.exportValue;kt.domElement&&(kt.domElement.checked=Ct),N.setValue(kt.id,{value:Ct})}N.setValue(X,{value:Dt})}),pt.addEventListener("resetform",bt=>{const _t=C.defaultFieldValue||"Off";bt.target.checked=_t===C.exportValue}),this.enableScripting&&this.hasJSActions&&(pt.addEventListener("updatefromsandbox",bt=>{const _t={value(Dt){Dt.target.checked=Dt.detail.value!=="Off",N.setValue(X,{value:Dt.target.checked})}};this._dispatchEventFromSandbox(_t,bt)}),this._setEventListeners(pt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],bt=>bt.target.checked)),this._setBackgroundColor(pt),this._setDefaultPropertiesFromJS(pt),this.container.append(pt),this.container}}class h extends u{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const N=this.annotationStorage,C=this.data,X=C.id;let ht=N.getValue(X,{value:C.fieldValue===C.buttonValue}).value;typeof ht=="string"&&(ht=ht!==C.buttonValue,N.setValue(X,{value:ht}));const pt=document.createElement("input");if(j.add(pt),pt.setAttribute("data-element-id",X),pt.disabled=C.readOnly,this._setRequired(pt,this.data.required),pt.type="radio",pt.name=C.fieldName,ht&&pt.setAttribute("checked",!0),pt.tabIndex=E,pt.addEventListener("change",bt=>{const{name:_t,checked:Dt}=bt.target;for(const kt of this._getElementsByName(_t,X))N.setValue(kt.id,{value:!1});N.setValue(X,{value:Dt})}),pt.addEventListener("resetform",bt=>{const _t=C.defaultFieldValue;bt.target.checked=_t!=null&&_t===C.buttonValue}),this.enableScripting&&this.hasJSActions){const bt=C.buttonValue;pt.addEventListener("updatefromsandbox",_t=>{const Dt={value:kt=>{const Ct=bt===kt.detail.value;for(const Ht of this._getElementsByName(kt.target.name)){const Ft=Ct&&Ht.id===X;Ht.domElement&&(Ht.domElement.checked=Ft),N.setValue(Ht.id,{value:Ft})}}};this._dispatchEventFromSandbox(Dt,_t)}),this._setEventListeners(pt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_t=>_t.target.checked)}return this._setBackgroundColor(pt),this._setDefaultPropertiesFromJS(pt),this.container.append(pt),this.container}}class e extends v{constructor(N){super(N,{ignoreBorder:N.data.hasAppearance})}render(){const N=super.render();N.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(N.title=this.data.alternativeText);const C=N.lastChild;return this.enableScripting&&this.hasJSActions&&C&&(this._setDefaultPropertiesFromJS(C),C.addEventListener("updatefromsandbox",X=>{this._dispatchEventFromSandbox({},X)})),N}}class s extends u{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const N=this.annotationStorage,C=this.data.id,X=N.getValue(C,{value:this.data.fieldValue}),ht=document.createElement("select");j.add(ht),ht.setAttribute("data-element-id",C),ht.disabled=this.data.readOnly,this._setRequired(ht,this.data.required),ht.name=this.data.fieldName,ht.tabIndex=E;let pt=this.data.combo&&this.data.options.length>0;this.data.combo||(ht.size=this.data.options.length,this.data.multiSelect&&(ht.multiple=!0)),ht.addEventListener("resetform",Ct=>{const Ht=this.data.defaultFieldValue;for(const Ft of ht.options)Ft.selected=Ft.value===Ht});for(const Ct of this.data.options){const Ht=document.createElement("option");Ht.textContent=Ct.displayValue,Ht.value=Ct.exportValue,X.value.includes(Ct.exportValue)&&(Ht.setAttribute("selected",!0),pt=!1),ht.append(Ht)}let bt=null;if(pt){const Ct=document.createElement("option");Ct.value=" ",Ct.setAttribute("hidden",!0),Ct.setAttribute("selected",!0),ht.prepend(Ct),bt=()=>{Ct.remove(),ht.removeEventListener("input",bt),bt=null},ht.addEventListener("input",bt)}const _t=Ct=>{const Ht=Ct?"value":"textContent",{options:Ft,multiple:It}=ht;return It?Array.prototype.filter.call(Ft,Ut=>Ut.selected).map(Ut=>Ut[Ht]):Ft.selectedIndex===-1?null:Ft[Ft.selectedIndex][Ht]};let Dt=_t(!1);const kt=Ct=>{const Ht=Ct.target.options;return Array.prototype.map.call(Ht,Ft=>({displayValue:Ft.textContent,exportValue:Ft.value}))};return this.enableScripting&&this.hasJSActions?(ht.addEventListener("updatefromsandbox",Ct=>{const Ht={value(Ft){bt==null||bt();const It=Ft.detail.value,Ut=new Set(Array.isArray(It)?It:[It]);for(const $t of ht.options)$t.selected=Ut.has($t.value);N.setValue(C,{value:_t(!0)}),Dt=_t(!1)},multipleSelection(Ft){ht.multiple=!0},remove(Ft){const It=ht.options,Ut=Ft.detail.remove;It[Ut].selected=!1,ht.remove(Ut),It.length>0&&Array.prototype.findIndex.call(It,qt=>qt.selected)===-1&&(It[0].selected=!0),N.setValue(C,{value:_t(!0),items:kt(Ft)}),Dt=_t(!1)},clear(Ft){for(;ht.length!==0;)ht.remove(0);N.setValue(C,{value:null,items:[]}),Dt=_t(!1)},insert(Ft){const{index:It,displayValue:Ut,exportValue:$t}=Ft.detail.insert,qt=ht.children[It],Yt=document.createElement("option");Yt.textContent=Ut,Yt.value=$t,qt?qt.before(Yt):ht.append(Yt),N.setValue(C,{value:_t(!0),items:kt(Ft)}),Dt=_t(!1)},items(Ft){const{items:It}=Ft.detail;for(;ht.length!==0;)ht.remove(0);for(const Ut of It){const{displayValue:$t,exportValue:qt}=Ut,Yt=document.createElement("option");Yt.textContent=$t,Yt.value=qt,ht.append(Yt)}ht.options.length>0&&(ht.options[0].selected=!0),N.setValue(C,{value:_t(!0),items:kt(Ft)}),Dt=_t(!1)},indices(Ft){const It=new Set(Ft.detail.indices);for(const Ut of Ft.target.options)Ut.selected=It.has(Ut.index);N.setValue(C,{value:_t(!0)}),Dt=_t(!1)},editable(Ft){Ft.target.disabled=!Ft.detail.editable}};this._dispatchEventFromSandbox(Ht,Ct)}),ht.addEventListener("input",Ct=>{var Ft;const Ht=_t(!0);N.setValue(C,{value:Ht}),Ct.preventDefault(),(Ft=this.linkService.eventBus)==null||Ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:C,name:"Keystroke",value:Dt,changeEx:Ht,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(ht,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Ct=>Ct.target.value)):ht.addEventListener("input",function(Ct){N.setValue(C,{value:_t(!0)})}),this.data.combo&&this._setTextStyle(ht),this._setBackgroundColor(ht),this._setDefaultPropertiesFromJS(ht),this.container.append(ht),this.container}}class l extends m{constructor(N){const{data:C,elements:X}=N;super(N,{isRenderable:m._hasPopupData(C)}),this.elements=X}render(){this.container.classList.add("popupAnnotation");const N=new a({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),C=[];for(const X of this.elements)X.popup=N,C.push(X.data.id),X.addHighlightArea();return this.container.setAttribute("aria-controls",C.map(X=>`${o.AnnotationPrefix}${X}`).join(",")),this.container}}class a{constructor({container:N,color:C,elements:X,titleObj:ht,modificationDate:pt,contentsObj:bt,richText:_t,parent:Dt,rect:kt,parentRect:Ct,open:Ht}){at(this,St);at(this,et,null);at(this,dt,K(this,St,ks).bind(this));at(this,ut,K(this,St,ss).bind(this));at(this,mt,K(this,St,es).bind(this));at(this,yt,K(this,St,we).bind(this));at(this,xt,null);at(this,st,null);at(this,it,null);at(this,A,null);at(this,M,null);at(this,V,null);at(this,nt,!1);at(this,ft,null);at(this,vt,null);at(this,At,null);at(this,Q,null);at(this,wt,!1);var It;lt(this,st,N),lt(this,Q,ht),lt(this,it,bt),lt(this,At,_t),lt(this,M,Dt),lt(this,xt,C),lt(this,vt,kt),lt(this,V,Ct),lt(this,A,X);const Ft=b.PDFDateString.toDateObject(pt);Ft&&lt(this,et,Dt.l10n.get("annotation_date_string",{date:Ft.toLocaleDateString(),time:Ft.toLocaleTimeString()})),this.trigger=X.flatMap(Ut=>Ut.getElementsToTriggerPopup());for(const Ut of this.trigger)Ut.addEventListener("click",t(this,yt)),Ut.addEventListener("mouseenter",t(this,mt)),Ut.addEventListener("mouseleave",t(this,ut)),Ut.classList.add("popupTriggerArea");for(const Ut of X)(It=Ut.container)==null||It.addEventListener("keydown",t(this,dt));t(this,st).hidden=!0,Ht&&K(this,St,we).call(this)}render(){if(t(this,ft))return;const{page:{view:N},viewport:{rawDims:{pageWidth:C,pageHeight:X,pageX:ht,pageY:pt}}}=t(this,M),bt=lt(this,ft,document.createElement("div"));if(bt.className="popup",t(this,xt)){const Jt=bt.style.outlineColor=o.Util.makeHexColor(...t(this,xt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?bt.style.backgroundColor=`color-mix(in srgb, ${Jt} 30%, white)`:bt.style.backgroundColor=o.Util.makeHexColor(...t(this,xt).map(se=>Math.floor(.7*(255-se)+se)))}const _t=document.createElement("span");_t.className="header";const Dt=document.createElement("h1");if(_t.append(Dt),{dir:Dt.dir,str:Dt.textContent}=t(this,Q),bt.append(_t),t(this,et)){const Jt=document.createElement("span");Jt.classList.add("popupDate"),t(this,et).then(te=>{Jt.textContent=te}),_t.append(Jt)}const kt=t(this,it),Ct=t(this,At);if(Ct!=null&&Ct.str&&(!(kt!=null&&kt.str)||kt.str===Ct.str))O.XfaLayer.render({xfaHtml:Ct.html,intent:"richText",div:bt}),bt.lastChild.classList.add("richText","popupContent");else{const Jt=this._formatContents(kt);bt.append(Jt)}let Ht=!!t(this,V),Ft=Ht?t(this,V):t(this,vt);for(const Jt of t(this,A))if(!Ft||o.Util.intersect(Jt.data.rect,Ft)!==null){Ft=Jt.data.rect,Ht=!0;break}const It=o.Util.normalizeRect([Ft[0],N[3]-Ft[1]+N[1],Ft[2],N[3]-Ft[3]+N[1]]),$t=Ht?Ft[2]-Ft[0]+5:0,qt=It[0]+$t,Yt=It[1],{style:Qt}=t(this,st);Qt.left=`${100*(qt-ht)/C}%`,Qt.top=`${100*(Yt-pt)/X}%`,t(this,st).append(bt)}_formatContents({str:N,dir:C}){const X=document.createElement("p");X.classList.add("popupContent"),X.dir=C;const ht=N.split(/(?:\r\n?|\n)/);for(let pt=0,bt=ht.length;pt<bt;++pt){const _t=ht[pt];X.append(document.createTextNode(_t)),pt<bt-1&&X.append(document.createElement("br"))}return X}forceHide(){lt(this,wt,this.isVisible),t(this,wt)&&(t(this,st).hidden=!0)}maybeShow(){t(this,wt)&&(lt(this,wt,!1),t(this,st).hidden=!1)}get isVisible(){return t(this,st).hidden===!1}}et=new WeakMap,dt=new WeakMap,ut=new WeakMap,mt=new WeakMap,yt=new WeakMap,xt=new WeakMap,st=new WeakMap,it=new WeakMap,A=new WeakMap,M=new WeakMap,V=new WeakMap,nt=new WeakMap,ft=new WeakMap,vt=new WeakMap,At=new WeakMap,Q=new WeakMap,wt=new WeakMap,St=new WeakSet,ks=function(N){N.altKey||N.shiftKey||N.ctrlKey||N.metaKey||(N.key==="Enter"||N.key==="Escape"&&t(this,nt))&&K(this,St,we).call(this)},we=function(){lt(this,nt,!t(this,nt)),t(this,nt)?(K(this,St,es).call(this),t(this,st).addEventListener("click",t(this,yt)),t(this,st).addEventListener("keydown",t(this,dt))):(K(this,St,ss).call(this),t(this,st).removeEventListener("click",t(this,yt)),t(this,st).removeEventListener("keydown",t(this,dt)))},es=function(){t(this,ft)||this.render(),this.isVisible?t(this,nt)&&t(this,st).classList.add("focused"):(t(this,st).hidden=!1,t(this,st).style.zIndex=parseInt(t(this,st).style.zIndex)+1e3)},ss=function(){t(this,st).classList.remove("focused"),!(t(this,nt)||!this.isVisible)&&(t(this,st).hidden=!0,t(this,st).style.zIndex=parseInt(t(this,st).style.zIndex)-1e3)};class w extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0}),this.textContent=N.data.textContent,this.textPosition=N.data.textPosition,this.annotationEditorType=o.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const N=document.createElement("div");N.classList.add("annotationTextContent"),N.setAttribute("role","comment");for(const C of this.textContent){const X=document.createElement("span");X.textContent=C,N.append(X)}this.container.append(N)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}c.FreeTextAnnotationElement=w;class r extends m{constructor(C){super(C,{isRenderable:!0,ignoreBorder:!0});at(this,Lt,null)}render(){this.container.classList.add("lineAnnotation");const C=this.data,{width:X,height:ht}=T(C.rect),pt=this.svgFactory.create(X,ht,!0),bt=lt(this,Lt,this.svgFactory.createElement("svg:line"));return bt.setAttribute("x1",C.rect[2]-C.lineCoordinates[0]),bt.setAttribute("y1",C.rect[3]-C.lineCoordinates[1]),bt.setAttribute("x2",C.rect[2]-C.lineCoordinates[2]),bt.setAttribute("y2",C.rect[3]-C.lineCoordinates[3]),bt.setAttribute("stroke-width",C.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),pt.append(bt),this.container.append(pt),!C.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Lt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lt=new WeakMap;class g extends m{constructor(C){super(C,{isRenderable:!0,ignoreBorder:!0});at(this,zt,null)}render(){this.container.classList.add("squareAnnotation");const C=this.data,{width:X,height:ht}=T(C.rect),pt=this.svgFactory.create(X,ht,!0),bt=C.borderStyle.width,_t=lt(this,zt,this.svgFactory.createElement("svg:rect"));return _t.setAttribute("x",bt/2),_t.setAttribute("y",bt/2),_t.setAttribute("width",X-bt),_t.setAttribute("height",ht-bt),_t.setAttribute("stroke-width",bt||1),_t.setAttribute("stroke","transparent"),_t.setAttribute("fill","transparent"),pt.append(_t),this.container.append(pt),!C.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,zt)}addHighlightArea(){this.container.classList.add("highlightArea")}}zt=new WeakMap;class S extends m{constructor(C){super(C,{isRenderable:!0,ignoreBorder:!0});at(this,Xt,null)}render(){this.container.classList.add("circleAnnotation");const C=this.data,{width:X,height:ht}=T(C.rect),pt=this.svgFactory.create(X,ht,!0),bt=C.borderStyle.width,_t=lt(this,Xt,this.svgFactory.createElement("svg:ellipse"));return _t.setAttribute("cx",X/2),_t.setAttribute("cy",ht/2),_t.setAttribute("rx",X/2-bt/2),_t.setAttribute("ry",ht/2-bt/2),_t.setAttribute("stroke-width",bt||1),_t.setAttribute("stroke","transparent"),_t.setAttribute("fill","transparent"),pt.append(_t),this.container.append(pt),!C.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Xt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xt=new WeakMap;class J extends m{constructor(C){super(C,{isRenderable:!0,ignoreBorder:!0});at(this,Et,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const C=this.data,{width:X,height:ht}=T(C.rect),pt=this.svgFactory.create(X,ht,!0);let bt=[];for(const Dt of C.vertices){const kt=Dt.x-C.rect[0],Ct=C.rect[3]-Dt.y;bt.push(kt+","+Ct)}bt=bt.join(" ");const _t=lt(this,Et,this.svgFactory.createElement(this.svgElementName));return _t.setAttribute("points",bt),_t.setAttribute("stroke-width",C.borderStyle.width||1),_t.setAttribute("stroke","transparent"),_t.setAttribute("fill","transparent"),pt.append(_t),this.container.append(pt),!C.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Et)}addHighlightArea(){this.container.classList.add("highlightArea")}}Et=new WeakMap;class H extends J{constructor(N){super(N),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class $ extends m{constructor(C){super(C,{isRenderable:!0,ignoreBorder:!0});at(this,ot,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=o.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const C=this.data,{width:X,height:ht}=T(C.rect),pt=this.svgFactory.create(X,ht,!0);for(const bt of C.inkLists){let _t=[];for(const kt of bt){const Ct=kt.x-C.rect[0],Ht=C.rect[3]-kt.y;_t.push(`${Ct},${Ht}`)}_t=_t.join(" ");const Dt=this.svgFactory.createElement(this.svgElementName);t(this,ot).push(Dt),Dt.setAttribute("points",_t),Dt.setAttribute("stroke-width",C.borderStyle.width||1),Dt.setAttribute("stroke","transparent"),Dt.setAttribute("fill","transparent"),!C.popupRef&&this.hasPopupData&&this._createPopup(),pt.append(Dt)}return this.container.append(pt),this.container}getElementsToTriggerPopup(){return t(this,ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}ot=new WeakMap,c.InkAnnotationElement=$;class rt extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class P extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class W extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Z extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class R extends m{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}c.StampAnnotationElement=R;class n extends m{constructor(C){var pt;super(C,{isRenderable:!0});at(this,Tt);at(this,ct,null);const{filename:X,content:ht}=this.data.file;this.filename=(0,b.getFilenameFromUrl)(X,!0),this.content=ht,(pt=this.linkService.eventBus)==null||pt.dispatch("fileattachmentannotation",{source:this,filename:X,content:ht})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:C,data:X}=this;let ht;X.hasAppearance||X.fillAlpha===0?ht=document.createElement("div"):(ht=document.createElement("img"),ht.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(X.name)?"paperclip":"pushpin"}.svg`,X.fillAlpha&&X.fillAlpha<1&&(ht.style=`filter: opacity(${Math.round(X.fillAlpha*100)}%);`)),ht.addEventListener("dblclick",K(this,Tt,is).bind(this)),lt(this,ct,ht);const{isMac:pt}=o.FeatureTest.platform;return C.addEventListener("keydown",bt=>{bt.key==="Enter"&&(pt?bt.metaKey:bt.ctrlKey)&&K(this,Tt,is).call(this)}),!X.popupRef&&this.hasPopupData?this._createPopup():ht.classList.add("popupTriggerArea"),C.append(ht),C}getElementsToTriggerPopup(){return t(this,ct)}addHighlightArea(){this.container.classList.add("highlightArea")}}ct=new WeakMap,Tt=new WeakSet,is=function(){var C;(C=this.downloadManager)==null||C.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:N,accessibilityManager:C,annotationCanvasMap:X,l10n:ht,page:pt,viewport:bt}){at(this,Rt);at(this,Wt,null);at(this,U,null);at(this,gt,new Map);this.div=N,lt(this,Wt,C),lt(this,U,X),this.l10n=ht,this.page=pt,this.viewport=bt,this.zIndex=0,this.l10n||(this.l10n=tt.NullL10n)}async render(N){const{annotations:C}=N,X=this.div;(0,b.setLayerDimensions)(X,this.viewport);const ht=new Map,pt={data:null,layer:X,linkService:N.linkService,downloadManager:N.downloadManager,imageResourcesPath:N.imageResourcesPath||"",renderForms:N.renderForms!==!1,svgFactory:new b.DOMSVGFactory,annotationStorage:N.annotationStorage||new q.AnnotationStorage,enableScripting:N.enableScripting===!0,hasJSActions:N.hasJSActions,fieldObjects:N.fieldObjects,parent:this,elements:null};for(const bt of C){if(bt.noHTML)continue;const _t=bt.annotationType===o.AnnotationType.POPUP;if(_t){const Ct=ht.get(bt.id);if(!Ct)continue;pt.elements=Ct}else{const{width:Ct,height:Ht}=T(bt.rect);if(Ct<=0||Ht<=0)continue}pt.data=bt;const Dt=x.create(pt);if(!Dt.isRenderable)continue;if(!_t&&bt.popupRef){const Ct=ht.get(bt.popupRef);Ct?Ct.push(Dt):ht.set(bt.popupRef,[Dt])}Dt.annotationEditorType>0&&t(this,gt).set(Dt.data.id,Dt);const kt=Dt.render();bt.hidden&&(kt.style.visibility="hidden"),K(this,Rt,Fs).call(this,kt,bt.id)}K(this,Rt,ns).call(this),await this.l10n.translate(X)}update({viewport:N}){const C=this.div;this.viewport=N,(0,b.setLayerDimensions)(C,{rotation:N.rotation}),K(this,Rt,ns).call(this),C.hidden=!1}getEditableAnnotations(){return Array.from(t(this,gt).values())}getEditableAnnotation(N){return t(this,gt).get(N)}}Wt=new WeakMap,U=new WeakMap,gt=new WeakMap,Rt=new WeakSet,Fs=function(N,C){var ht;const X=N.firstChild||N;X.id=`${o.AnnotationPrefix}${C}`,this.div.append(N),(ht=t(this,Wt))==null||ht.moveElementInDOM(this.div,N,X,!1)},ns=function(){if(!t(this,U))return;const N=this.div;for(const[C,X]of t(this,U)){const ht=N.querySelector(`[data-annotation-id="${C}"]`);if(!ht)continue;const{firstChild:pt}=ht;pt?pt.nodeName==="CANVAS"?pt.replaceWith(X):pt.before(X):ht.append(X)}t(this,U).clear()},c.AnnotationLayer=i},(L,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorConverters=void 0;function G(q){return Math.floor(Math.max(0,Math.min(1,q))*255).toString(16).padStart(2,"0")}function o(q){return Math.max(0,Math.min(255,255*q))}class b{static CMYK_G([B,tt,O,E]){return["G",1-Math.min(1,.3*B+.59*O+.11*tt+E)]}static G_CMYK([B]){return["CMYK",0,0,0,1-B]}static G_RGB([B]){return["RGB",B,B,B]}static G_rgb([B]){return B=o(B),[B,B,B]}static G_HTML([B]){const tt=G(B);return`#${tt}${tt}${tt}`}static RGB_G([B,tt,O]){return["G",.3*B+.59*tt+.11*O]}static RGB_rgb(B){return B.map(o)}static RGB_HTML(B){return`#${B.map(G).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([B,tt,O,E]){return["RGB",1-Math.min(1,B+E),1-Math.min(1,O+E),1-Math.min(1,tt+E)]}static CMYK_rgb([B,tt,O,E]){return[o(1-Math.min(1,B+E)),o(1-Math.min(1,O+E)),o(1-Math.min(1,tt+E))]}static CMYK_HTML(B){const tt=this.CMYK_RGB(B).slice(1);return this.RGB_HTML(tt)}static RGB_CMYK([B,tt,O]){const E=1-B,d=1-tt,j=1-O,T=Math.min(E,d,j);return["CMYK",E,d,j,T]}}c.ColorConverters=b},(L,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.NullL10n=void 0,c.getL10nFallback=o;const G={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};G.print_progress_percent="{{progress}}%";function o(B,tt){switch(B){case"find_match_count":B=`find_match_count[${tt.total===1?"one":"other"}]`;break;case"find_match_count_limit":B=`find_match_count_limit[${tt.limit===1?"one":"other"}]`;break}return G[B]||""}function b(B,tt){return tt?B.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(O,E)=>E in tt?tt[E]:"{{"+E+"}}"):B}const q={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(B,tt=null,O=o(B,tt)){return b(O,tt)},async translate(B){}};c.NullL10n=q},(L,c,G)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.XfaLayer=void 0;var o=G(25);class b{static setupStorage(B,tt,O,E,d){const j=E.getValue(tt,{value:null});switch(O.name){case"textarea":if(j.value!==null&&(B.textContent=j.value),d==="print")break;B.addEventListener("input",T=>{E.setValue(tt,{value:T.target.value})});break;case"input":if(O.attributes.type==="radio"||O.attributes.type==="checkbox"){if(j.value===O.attributes.xfaOn?B.setAttribute("checked",!0):j.value===O.attributes.xfaOff&&B.removeAttribute("checked"),d==="print")break;B.addEventListener("change",T=>{E.setValue(tt,{value:T.target.checked?T.target.getAttribute("xfaOn"):T.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&B.setAttribute("value",j.value),d==="print")break;B.addEventListener("input",T=>{E.setValue(tt,{value:T.target.value})})}break;case"select":if(j.value!==null){B.setAttribute("value",j.value);for(const T of O.children)T.attributes.value===j.value?T.attributes.selected=!0:T.attributes.hasOwnProperty("selected")&&delete T.attributes.selected}B.addEventListener("input",T=>{const x=T.target.options,m=x.selectedIndex===-1?"":x[x.selectedIndex].value;E.setValue(tt,{value:m})});break}}static setAttributes({html:B,element:tt,storage:O=null,intent:E,linkService:d}){const{attributes:j}=tt,T=B instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${E}`);for(const[x,m]of Object.entries(j))if(m!=null)switch(x){case"class":m.length&&B.setAttribute(x,m.join(" "));break;case"dataId":break;case"id":B.setAttribute("data-element-id",m);break;case"style":Object.assign(B.style,m);break;case"textContent":B.textContent=m;break;default:(!T||x!=="href"&&x!=="newWindow")&&B.setAttribute(x,m)}T&&d.addLinkAttributes(B,j.href,j.newWindow),O&&j.dataId&&this.setupStorage(B,j.dataId,tt,O)}static render(B){var v;const tt=B.annotationStorage,O=B.linkService,E=B.xfaHtml,d=B.intent||"display",j=document.createElement(E.name);E.attributes&&this.setAttributes({html:j,element:E,intent:d,linkService:O});const T=[[E,-1,j]],x=B.div;if(x.append(j),B.viewport){const f=`matrix(${B.viewport.transform.join(",")})`;x.style.transform=f}d!=="richText"&&x.setAttribute("class","xfaLayer xfaFont");const m=[];for(;T.length>0;){const[f,u,y]=T.at(-1);if(u+1===f.children.length){T.pop();continue}const D=f.children[++T.at(-1)[1]];if(D===null)continue;const{name:_}=D;if(_==="#text"){const e=document.createTextNode(D.value);m.push(e),y.append(e);continue}const h=(v=D==null?void 0:D.attributes)!=null&&v.xmlns?document.createElementNS(D.attributes.xmlns,_):document.createElement(_);if(y.append(h),D.attributes&&this.setAttributes({html:h,element:D,storage:tt,intent:d,linkService:O}),D.children&&D.children.length>0)T.push([D,-1,h]);else if(D.value){const e=document.createTextNode(D.value);o.XfaText.shouldBuildText(_)&&m.push(e),h.append(e)}}for(const f of x.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:m}}static update(B){const tt=`matrix(${B.viewport.transform.join(",")})`;B.div.style.transform=tt,B.div.hidden=!1}}c.XfaLayer=b},(L,c,G)=>{var E,d,j,T,x,m,v,f,u,y,D,_,h,e,s,Ms,Ds,Is,Ns,rs,Ls,as,Os,Us,Bs,Hs,$s,ee,os,Re,Ce,le,ls,je,F,Ws,cs,Gs,Vs,hs,Te,ce;Object.defineProperty(c,"__esModule",{value:!0}),c.InkEditor=void 0;var o=G(1),b=G(4),q=G(29),B=G(6),tt=G(5);const xt=class xt extends b.AnnotationEditor{constructor(A){super({...A,name:"inkEditor"});at(this,s);at(this,E,0);at(this,d,0);at(this,j,this.canvasPointermove.bind(this));at(this,T,this.canvasPointerleave.bind(this));at(this,x,this.canvasPointerup.bind(this));at(this,m,this.canvasPointerdown.bind(this));at(this,v,new Path2D);at(this,f,!1);at(this,u,!1);at(this,y,!1);at(this,D,null);at(this,_,0);at(this,h,0);at(this,e,null);this.color=A.color||null,this.thickness=A.thickness||null,this.opacity=A.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(A){b.AnnotationEditor.initialize(A,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(A,M){switch(A){case o.AnnotationEditorParamsType.INK_THICKNESS:xt._defaultThickness=M;break;case o.AnnotationEditorParamsType.INK_COLOR:xt._defaultColor=M;break;case o.AnnotationEditorParamsType.INK_OPACITY:xt._defaultOpacity=M/100;break}}updateParams(A,M){switch(A){case o.AnnotationEditorParamsType.INK_THICKNESS:K(this,s,Ms).call(this,M);break;case o.AnnotationEditorParamsType.INK_COLOR:K(this,s,Ds).call(this,M);break;case o.AnnotationEditorParamsType.INK_OPACITY:K(this,s,Is).call(this,M);break}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,xt._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,xt._defaultColor||b.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(xt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||xt._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,this.color||xt._defaultColor||b.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??xt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(K(this,s,Re).call(this),K(this,s,Ce).call(this)),this.isAttachedToDOM||(this.parent.add(this),K(this,s,le).call(this)),K(this,s,ce).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,D).disconnect(),lt(this,D,null),super.remove())}setParent(A){!this.parent&&A?this._uiManager.removeShouldRescale(this):this.parent&&A===null&&this._uiManager.addShouldRescale(this),super.setParent(A)}onScaleChanging(){const[A,M]=this.parentDimensions,V=this.width*A,nt=this.height*M;this.setDimensions(V,nt)}enableEditMode(){t(this,f)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,m)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,m)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,f)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),lt(this,f,!0),this.div.classList.add("disabled"),K(this,s,ce).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(A){this._focusEventsAllowed&&(super.focusin(A),this.enableEditMode())}canvasPointerdown(A){A.button!==0||!this.isInEditMode()||t(this,f)||(this.setInForeground(),A.preventDefault(),A.type!=="mouse"&&this.div.focus(),K(this,s,Ls).call(this,A.offsetX,A.offsetY))}canvasPointermove(A){A.preventDefault(),K(this,s,as).call(this,A.offsetX,A.offsetY)}canvasPointerup(A){A.preventDefault(),K(this,s,os).call(this,A)}canvasPointerleave(A){K(this,s,os).call(this,A)}get isResizable(){return!this.isEmpty()&&t(this,f)}render(){if(this.div)return this.div;let A,M;this.width&&(A=this.x,M=this.y),super.render(),b.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(At=>{var Q;return(Q=this.div)==null?void 0:Q.setAttribute("aria-label",At)});const[V,nt,ft,vt]=K(this,s,Ns).call(this);if(this.setAt(V,nt,0,0),this.setDims(ft,vt),K(this,s,Re).call(this),this.width){const[At,Q]=this.parentDimensions;this.setAspectRatio(this.width*At,this.height*Q),this.setAt(A*At,M*Q,this.width*At,this.height*Q),lt(this,y,!0),K(this,s,le).call(this),this.setDims(this.width*At,this.height*Q),K(this,s,ee).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return K(this,s,Ce).call(this),this.div}setDimensions(A,M){const V=Math.round(A),nt=Math.round(M);if(t(this,_)===V&&t(this,h)===nt)return;lt(this,_,V),lt(this,h,nt),this.canvas.style.visibility="hidden";const[ft,vt]=this.parentDimensions;this.width=A/ft,this.height=M/vt,this.fixAndSetPosition(),t(this,f)&&K(this,s,ls).call(this,A,M),K(this,s,le).call(this),K(this,s,ee).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(A,M,V){var Lt,zt,Xt;if(A instanceof q.InkAnnotationElement)return null;const nt=super.deserialize(A,M,V);nt.thickness=A.thickness,nt.color=o.Util.makeHexColor(...A.color),nt.opacity=A.opacity;const[ft,vt]=nt.pageDimensions,At=nt.width*ft,Q=nt.height*vt,wt=nt.parentScale,St=A.thickness/2;lt(nt,f,!0),lt(nt,_,Math.round(At)),lt(nt,h,Math.round(Q));const{paths:Bt,rect:Ot,rotation:Gt}=A;for(let{bezier:Et}of Bt){Et=K(Lt=xt,F,Gs).call(Lt,Et,Ot,Gt);const ot=[];nt.paths.push(ot);let ct=wt*(Et[0]-St),Tt=wt*(Et[1]-St);for(let Wt=2,U=Et.length;Wt<U;Wt+=6){const gt=wt*(Et[Wt]-St),Rt=wt*(Et[Wt+1]-St),Mt=wt*(Et[Wt+2]-St),Nt=wt*(Et[Wt+3]-St),jt=wt*(Et[Wt+4]-St),N=wt*(Et[Wt+5]-St);ot.push([[ct,Tt],[gt,Rt],[Mt,Nt],[jt,N]]),ct=jt,Tt=N}const Vt=K(this,F,Ws).call(this,ot);nt.bezierPath2D.push(Vt)}const Pt=K(zt=nt,s,hs).call(zt);return lt(nt,d,Math.max(b.AnnotationEditor.MIN_SIZE,Pt[2]-Pt[0])),lt(nt,E,Math.max(b.AnnotationEditor.MIN_SIZE,Pt[3]-Pt[1])),K(Xt=nt,s,ls).call(Xt,At,Q),nt}serialize(){if(this.isEmpty())return null;const A=this.getRect(0,0),M=b.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:o.AnnotationEditorType.INK,color:M,thickness:this.thickness,opacity:this.opacity,paths:K(this,s,Vs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,A),pageIndex:this.pageIndex,rect:A,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};E=new WeakMap,d=new WeakMap,j=new WeakMap,T=new WeakMap,x=new WeakMap,m=new WeakMap,v=new WeakMap,f=new WeakMap,u=new WeakMap,y=new WeakMap,D=new WeakMap,_=new WeakMap,h=new WeakMap,e=new WeakMap,s=new WeakSet,Ms=function(A){const M=this.thickness;this.addCommands({cmd:()=>{this.thickness=A,K(this,s,ce).call(this)},undo:()=>{this.thickness=M,K(this,s,ce).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Ds=function(A){const M=this.color;this.addCommands({cmd:()=>{this.color=A,K(this,s,ee).call(this)},undo:()=>{this.color=M,K(this,s,ee).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Is=function(A){A/=100;const M=this.opacity;this.addCommands({cmd:()=>{this.opacity=A,K(this,s,ee).call(this)},undo:()=>{this.opacity=M,K(this,s,ee).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Ns=function(){const{parentRotation:A,parentDimensions:[M,V]}=this;switch(A){case 90:return[0,V,V,M];case 180:return[M,V,M,V];case 270:return[M,0,V,M];default:return[0,0,M,V]}},rs=function(){const{ctx:A,color:M,opacity:V,thickness:nt,parentScale:ft,scaleFactor:vt}=this;A.lineWidth=nt*ft/vt,A.lineCap="round",A.lineJoin="round",A.miterLimit=10,A.strokeStyle=`${M}${(0,tt.opacityToHex)(V)}`},Ls=function(A,M){this.canvas.addEventListener("contextmenu",B.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,T)),this.canvas.addEventListener("pointermove",t(this,j)),this.canvas.addEventListener("pointerup",t(this,x)),this.canvas.removeEventListener("pointerdown",t(this,m)),this.isEditing=!0,t(this,y)||(lt(this,y,!0),K(this,s,le).call(this),this.thickness||(this.thickness=xt._defaultThickness),this.color||(this.color=xt._defaultColor||b.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=xt._defaultOpacity)),this.currentPath.push([A,M]),lt(this,u,!1),K(this,s,rs).call(this),lt(this,e,()=>{K(this,s,Bs).call(this),t(this,e)&&window.requestAnimationFrame(t(this,e))}),window.requestAnimationFrame(t(this,e))},as=function(A,M){const[V,nt]=this.currentPath.at(-1);if(this.currentPath.length>1&&A===V&&M===nt)return;const ft=this.currentPath;let vt=t(this,v);if(ft.push([A,M]),lt(this,u,!0),ft.length<=2){vt.moveTo(...ft[0]),vt.lineTo(A,M);return}ft.length===3&&(lt(this,v,vt=new Path2D),vt.moveTo(...ft[0])),K(this,s,Hs).call(this,vt,...ft.at(-3),...ft.at(-2),A,M)},Os=function(){if(this.currentPath.length===0)return;const A=this.currentPath.at(-1);t(this,v).lineTo(...A)},Us=function(A,M){lt(this,e,null),A=Math.min(Math.max(A,0),this.canvas.width),M=Math.min(Math.max(M,0),this.canvas.height),K(this,s,as).call(this,A,M),K(this,s,Os).call(this);let V;if(this.currentPath.length!==1)V=K(this,s,$s).call(this);else{const Q=[A,M];V=[[Q,Q.slice(),Q.slice(),Q]]}const nt=t(this,v),ft=this.currentPath;this.currentPath=[],lt(this,v,new Path2D);const vt=()=>{this.allRawPaths.push(ft),this.paths.push(V),this.bezierPath2D.push(nt),this.rebuild()},At=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(K(this,s,Re).call(this),K(this,s,Ce).call(this)),K(this,s,ce).call(this))};this.addCommands({cmd:vt,undo:At,mustExec:!0})},Bs=function(){if(!t(this,u))return;lt(this,u,!1);const A=Math.ceil(this.thickness*this.parentScale),M=this.currentPath.slice(-3),V=M.map(vt=>vt[0]),nt=M.map(vt=>vt[1]);Math.min(...V)-A,Math.max(...V)+A,Math.min(...nt)-A,Math.max(...nt)+A;const{ctx:ft}=this;ft.save(),ft.clearRect(0,0,this.canvas.width,this.canvas.height);for(const vt of this.bezierPath2D)ft.stroke(vt);ft.stroke(t(this,v)),ft.restore()},Hs=function(A,M,V,nt,ft,vt,At){const Q=(M+nt)/2,wt=(V+ft)/2,St=(nt+vt)/2,Bt=(ft+At)/2;A.bezierCurveTo(Q+2*(nt-Q)/3,wt+2*(ft-wt)/3,St+2*(nt-St)/3,Bt+2*(ft-Bt)/3,St,Bt)},$s=function(){const A=this.currentPath;if(A.length<=2)return[[A[0],A[0],A.at(-1),A.at(-1)]];const M=[];let V,[nt,ft]=A[0];for(V=1;V<A.length-2;V++){const[Ot,Gt]=A[V],[Pt,Lt]=A[V+1],zt=(Ot+Pt)/2,Xt=(Gt+Lt)/2,Et=[nt+2*(Ot-nt)/3,ft+2*(Gt-ft)/3],ot=[zt+2*(Ot-zt)/3,Xt+2*(Gt-Xt)/3];M.push([[nt,ft],Et,ot,[zt,Xt]]),[nt,ft]=[zt,Xt]}const[vt,At]=A[V],[Q,wt]=A[V+1],St=[nt+2*(vt-nt)/3,ft+2*(At-ft)/3],Bt=[Q+2*(vt-Q)/3,wt+2*(At-wt)/3];return M.push([[nt,ft],St,Bt,[Q,wt]]),M},ee=function(){if(this.isEmpty()){K(this,s,je).call(this);return}K(this,s,rs).call(this);const{canvas:A,ctx:M}=this;M.setTransform(1,0,0,1,0,0),M.clearRect(0,0,A.width,A.height),K(this,s,je).call(this);for(const V of this.bezierPath2D)M.stroke(V)},os=function(A){this.canvas.removeEventListener("pointerleave",t(this,T)),this.canvas.removeEventListener("pointermove",t(this,j)),this.canvas.removeEventListener("pointerup",t(this,x)),this.canvas.addEventListener("pointerdown",t(this,m)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",B.noContextMenu)},10),K(this,s,Us).call(this,A.offsetX,A.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Re=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",b.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(A=>{var M;return(M=this.canvas)==null?void 0:M.setAttribute("aria-label",A)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Ce=function(){lt(this,D,new ResizeObserver(A=>{const M=A[0].contentRect;M.width&&M.height&&this.setDimensions(M.width,M.height)})),t(this,D).observe(this.div)},le=function(){if(!t(this,y))return;const[A,M]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*A),this.canvas.height=Math.ceil(this.height*M),K(this,s,je).call(this)},ls=function(A,M){const V=K(this,s,Te).call(this),nt=(A-V)/t(this,d),ft=(M-V)/t(this,E);this.scaleFactor=Math.min(nt,ft)},je=function(){const A=K(this,s,Te).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+A,this.translationY*this.scaleFactor+A)},F=new WeakSet,Ws=function(A){const M=new Path2D;for(let V=0,nt=A.length;V<nt;V++){const[ft,vt,At,Q]=A[V];V===0&&M.moveTo(...ft),M.bezierCurveTo(vt[0],vt[1],At[0],At[1],Q[0],Q[1])}return M},cs=function(A,M,V){const[nt,ft,vt,At]=M;switch(V){case 0:for(let Q=0,wt=A.length;Q<wt;Q+=2)A[Q]+=nt,A[Q+1]=At-A[Q+1];break;case 90:for(let Q=0,wt=A.length;Q<wt;Q+=2){const St=A[Q];A[Q]=A[Q+1]+nt,A[Q+1]=St+ft}break;case 180:for(let Q=0,wt=A.length;Q<wt;Q+=2)A[Q]=vt-A[Q],A[Q+1]+=ft;break;case 270:for(let Q=0,wt=A.length;Q<wt;Q+=2){const St=A[Q];A[Q]=vt-A[Q+1],A[Q+1]=At-St}break;default:throw new Error("Invalid rotation")}return A},Gs=function(A,M,V){const[nt,ft,vt,At]=M;switch(V){case 0:for(let Q=0,wt=A.length;Q<wt;Q+=2)A[Q]-=nt,A[Q+1]=At-A[Q+1];break;case 90:for(let Q=0,wt=A.length;Q<wt;Q+=2){const St=A[Q];A[Q]=A[Q+1]-ft,A[Q+1]=St-nt}break;case 180:for(let Q=0,wt=A.length;Q<wt;Q+=2)A[Q]=vt-A[Q],A[Q+1]-=ft;break;case 270:for(let Q=0,wt=A.length;Q<wt;Q+=2){const St=A[Q];A[Q]=At-A[Q+1],A[Q+1]=vt-St}break;default:throw new Error("Invalid rotation")}return A},Vs=function(A,M,V,nt){var wt,St;const ft=[],vt=this.thickness/2,At=A*M+vt,Q=A*V+vt;for(const Bt of this.paths){const Ot=[],Gt=[];for(let Pt=0,Lt=Bt.length;Pt<Lt;Pt++){const[zt,Xt,Et,ot]=Bt[Pt],ct=A*zt[0]+At,Tt=A*zt[1]+Q,Vt=A*Xt[0]+At,Wt=A*Xt[1]+Q,U=A*Et[0]+At,gt=A*Et[1]+Q,Rt=A*ot[0]+At,Mt=A*ot[1]+Q;Pt===0&&(Ot.push(ct,Tt),Gt.push(ct,Tt)),Ot.push(Vt,Wt,U,gt,Rt,Mt),Gt.push(Vt,Wt),Pt===Lt-1&&Gt.push(Rt,Mt)}ft.push({bezier:K(wt=xt,F,cs).call(wt,Ot,nt,this.rotation),points:K(St=xt,F,cs).call(St,Gt,nt,this.rotation)})}return ft},hs=function(){let A=1/0,M=-1/0,V=1/0,nt=-1/0;for(const ft of this.paths)for(const[vt,At,Q,wt]of ft){const St=o.Util.bezierBoundingBox(...vt,...At,...Q,...wt);A=Math.min(A,St[0]),V=Math.min(V,St[1]),M=Math.max(M,St[2]),nt=Math.max(nt,St[3])}return[A,V,M,nt]},Te=function(){return t(this,f)?Math.ceil(this.thickness*this.parentScale):0},ce=function(A=!1){if(this.isEmpty())return;if(!t(this,f)){K(this,s,ee).call(this);return}const M=K(this,s,hs).call(this),V=K(this,s,Te).call(this);lt(this,d,Math.max(b.AnnotationEditor.MIN_SIZE,M[2]-M[0])),lt(this,E,Math.max(b.AnnotationEditor.MIN_SIZE,M[3]-M[1]));const nt=Math.ceil(V+t(this,d)*this.scaleFactor),ft=Math.ceil(V+t(this,E)*this.scaleFactor),[vt,At]=this.parentDimensions;this.width=nt/vt,this.height=ft/At,this.setAspectRatio(nt,ft);const Q=this.translationX,wt=this.translationY;this.translationX=-M[0],this.translationY=-M[1],K(this,s,le).call(this),K(this,s,ee).call(this),lt(this,_,nt),lt(this,h,ft),this.setDims(nt,ft);const St=A?V/this.scaleFactor/2:0;this.translate(Q-this.translationX-St,wt-this.translationY-St)},at(xt,F),Kt(xt,"_defaultColor",null),Kt(xt,"_defaultOpacity",1),Kt(xt,"_defaultThickness",1),Kt(xt,"_type","ink");let O=xt;c.InkEditor=O},(L,c,G)=>{var O,E,d,j,T,x,m,v,f,u,y,ge,xe,Pe,ds,zs,qs,us,ke,Xs;Object.defineProperty(c,"__esModule",{value:!0}),c.StampEditor=void 0;var o=G(1),b=G(4),q=G(6),B=G(29);const g=class g extends b.AnnotationEditor{constructor(H){super({...H,name:"stampEditor"});at(this,y);at(this,O,null);at(this,E,null);at(this,d,null);at(this,j,null);at(this,T,null);at(this,x,null);at(this,m,null);at(this,v,null);at(this,f,!1);at(this,u,!1);lt(this,j,H.bitmapUrl),lt(this,T,H.bitmapFile)}static initialize(H){b.AnnotationEditor.initialize(H)}static get supportedTypes(){const H=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,o.shadow)(this,"supportedTypes",H.map(Y=>`image/${Y}`))}static get supportedTypesStr(){return(0,o.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(H){return this.supportedTypes.includes(H)}static paste(H,Y){Y.pasteEditor(o.AnnotationEditorType.STAMP,{bitmapFile:H.getAsFile()})}remove(){var H,Y;t(this,E)&&(lt(this,O,null),this._uiManager.imageManager.deleteId(t(this,E)),(H=t(this,x))==null||H.remove(),lt(this,x,null),(Y=t(this,m))==null||Y.disconnect(),lt(this,m,null)),super.remove()}rebuild(){if(!this.parent){t(this,E)&&K(this,y,Pe).call(this);return}super.rebuild(),this.div!==null&&(t(this,E)&&K(this,y,Pe).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,d)||t(this,O)||t(this,j)||t(this,T))}get isResizable(){return!0}render(){if(this.div)return this.div;let H,Y;if(this.width&&(H=this.x,Y=this.y),super.render(),this.div.hidden=!0,t(this,O)?K(this,y,ds).call(this):K(this,y,Pe).call(this),this.width){const[$,rt]=this.parentDimensions;this.setAt(H*$,Y*rt,this.width*$,this.height*rt)}return this.div}static deserialize(H,Y,$){if(H instanceof B.StampAnnotationElement)return null;const rt=super.deserialize(H,Y,$),{rect:P,bitmapUrl:W,bitmapId:Z,isSvg:R,accessibilityData:n}=H;Z&&$.imageManager.isValidId(Z)?lt(rt,E,Z):lt(rt,j,W),lt(rt,f,R);const[i,p]=rt.pageDimensions;return rt.width=(P[2]-P[0])/i,rt.height=(P[3]-P[1])/p,n&&(rt.altTextData=n),rt}serialize(H=!1,Y=null){if(this.isEmpty())return null;const $={annotationType:o.AnnotationEditorType.STAMP,bitmapId:t(this,E),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,f),structTreeParentId:this._structTreeParentId};if(H)return $.bitmapUrl=K(this,y,ke).call(this,!0),$.accessibilityData=this.altTextData,$;const{decorative:rt,altText:P}=this.altTextData;if(!rt&&P&&($.accessibilityData={type:"Figure",alt:P}),Y===null)return $;Y.stamps||(Y.stamps=new Map);const W=t(this,f)?($.rect[2]-$.rect[0])*($.rect[3]-$.rect[1]):null;if(!Y.stamps.has(t(this,E)))Y.stamps.set(t(this,E),{area:W,serialized:$}),$.bitmap=K(this,y,ke).call(this,!1);else if(t(this,f)){const Z=Y.stamps.get(t(this,E));W>Z.area&&(Z.area=W,Z.serialized.bitmap.close(),Z.serialized.bitmap=K(this,y,ke).call(this,!1))}return $}};O=new WeakMap,E=new WeakMap,d=new WeakMap,j=new WeakMap,T=new WeakMap,x=new WeakMap,m=new WeakMap,v=new WeakMap,f=new WeakMap,u=new WeakMap,y=new WeakSet,ge=function(H,Y=!1){if(!H){this.remove();return}lt(this,O,H.bitmap),Y||(lt(this,E,H.id),lt(this,f,H.isSvg)),K(this,y,ds).call(this)},xe=function(){lt(this,d,null),this._uiManager.enableWaiting(!1),t(this,x)&&this.div.focus()},Pe=function(){if(t(this,E)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,E)).then(Y=>K(this,y,ge).call(this,Y,!0)).finally(()=>K(this,y,xe).call(this));return}if(t(this,j)){const Y=t(this,j);lt(this,j,null),this._uiManager.enableWaiting(!0),lt(this,d,this._uiManager.imageManager.getFromUrl(Y).then($=>K(this,y,ge).call(this,$)).finally(()=>K(this,y,xe).call(this)));return}if(t(this,T)){const Y=t(this,T);lt(this,T,null),this._uiManager.enableWaiting(!0),lt(this,d,this._uiManager.imageManager.getFromFile(Y).then($=>K(this,y,ge).call(this,$)).finally(()=>K(this,y,xe).call(this)));return}const H=document.createElement("input");H.type="file",H.accept=g.supportedTypesStr,lt(this,d,new Promise(Y=>{H.addEventListener("change",async()=>{if(!H.files||H.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const $=await this._uiManager.imageManager.getFromFile(H.files[0]);K(this,y,ge).call(this,$)}Y()}),H.addEventListener("cancel",()=>{this.remove(),Y()})}).finally(()=>K(this,y,xe).call(this))),H.click()},ds=function(){const{div:H}=this;let{width:Y,height:$}=t(this,O);const[rt,P]=this.pageDimensions,W=.75;if(this.width)Y=this.width*rt,$=this.height*P;else if(Y>W*rt||$>W*P){const i=Math.min(W*rt/Y,W*P/$);Y*=i,$*=i}const[Z,R]=this.parentDimensions;this.setDims(Y*Z/rt,$*R/P),this._uiManager.enableWaiting(!1);const n=lt(this,x,document.createElement("canvas"));H.append(n),H.hidden=!1,K(this,y,us).call(this,Y,$),K(this,y,Xs).call(this),t(this,u)||(this.parent.addUndoableEditor(this),lt(this,u,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},zs=function(H,Y){var W;const[$,rt]=this.parentDimensions;this.width=H/$,this.height=Y/rt,this.setDims(H,Y),(W=this._initialOptions)!=null&&W.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,v)!==null&&clearTimeout(t(this,v)),lt(this,v,setTimeout(()=>{lt(this,v,null),K(this,y,us).call(this,H,Y)},200))},qs=function(H,Y){const{width:$,height:rt}=t(this,O);let P=$,W=rt,Z=t(this,O);for(;P>2*H||W>2*Y;){const R=P,n=W;P>2*H&&(P=P>=16384?Math.floor(P/2)-1:Math.ceil(P/2)),W>2*Y&&(W=W>=16384?Math.floor(W/2)-1:Math.ceil(W/2));const i=new OffscreenCanvas(P,W);i.getContext("2d").drawImage(Z,0,0,R,n,0,0,P,W),Z=i.transferToImageBitmap()}return Z},us=function(H,Y){H=Math.ceil(H),Y=Math.ceil(Y);const $=t(this,x);if(!$||$.width===H&&$.height===Y)return;$.width=H,$.height=Y;const rt=t(this,f)?t(this,O):K(this,y,qs).call(this,H,Y),P=$.getContext("2d");P.filter=this._uiManager.hcmFilter,P.drawImage(rt,0,0,rt.width,rt.height,0,0,H,Y)},ke=function(H){if(H){if(t(this,f)){const rt=this._uiManager.imageManager.getSvgUrl(t(this,E));if(rt)return rt}const Y=document.createElement("canvas");return{width:Y.width,height:Y.height}=t(this,O),Y.getContext("2d").drawImage(t(this,O),0,0),Y.toDataURL()}if(t(this,f)){const[Y,$]=this.pageDimensions,rt=Math.round(this.width*Y*q.PixelsPerInch.PDF_TO_CSS_UNITS),P=Math.round(this.height*$*q.PixelsPerInch.PDF_TO_CSS_UNITS),W=new OffscreenCanvas(rt,P);return W.getContext("2d").drawImage(t(this,O),0,0,t(this,O).width,t(this,O).height,0,0,rt,P),W.transferToImageBitmap()}return structuredClone(t(this,O))},Xs=function(){lt(this,m,new ResizeObserver(H=>{const Y=H[0].contentRect;Y.width&&Y.height&&K(this,y,zs).call(this,Y.width,Y.height)})),t(this,m).observe(this.div)},Kt(g,"_type","stamp");let tt=g;c.StampEditor=tt}],__webpack_module_cache__={};function __w_pdfjs_require__(L){var c=__webpack_module_cache__[L];if(c!==void 0)return c.exports;var G=__webpack_module_cache__[L]={exports:{}};return __webpack_modules__[L](G,G.exports,__w_pdfjs_require__),G.exports}var __webpack_exports__={};return(()=>{var L=__webpack_exports__;Object.defineProperty(L,"__esModule",{value:!0}),Object.defineProperty(L,"AbortException",{enumerable:!0,get:function(){return c.AbortException}}),Object.defineProperty(L,"AnnotationEditorLayer",{enumerable:!0,get:function(){return q.AnnotationEditorLayer}}),Object.defineProperty(L,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return c.AnnotationEditorParamsType}}),Object.defineProperty(L,"AnnotationEditorType",{enumerable:!0,get:function(){return c.AnnotationEditorType}}),Object.defineProperty(L,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return B.AnnotationEditorUIManager}}),Object.defineProperty(L,"AnnotationLayer",{enumerable:!0,get:function(){return tt.AnnotationLayer}}),Object.defineProperty(L,"AnnotationMode",{enumerable:!0,get:function(){return c.AnnotationMode}}),Object.defineProperty(L,"CMapCompressionType",{enumerable:!0,get:function(){return c.CMapCompressionType}}),Object.defineProperty(L,"DOMSVGFactory",{enumerable:!0,get:function(){return o.DOMSVGFactory}}),Object.defineProperty(L,"FeatureTest",{enumerable:!0,get:function(){return c.FeatureTest}}),Object.defineProperty(L,"GlobalWorkerOptions",{enumerable:!0,get:function(){return O.GlobalWorkerOptions}}),Object.defineProperty(L,"ImageKind",{enumerable:!0,get:function(){return c.ImageKind}}),Object.defineProperty(L,"InvalidPDFException",{enumerable:!0,get:function(){return c.InvalidPDFException}}),Object.defineProperty(L,"MissingPDFException",{enumerable:!0,get:function(){return c.MissingPDFException}}),Object.defineProperty(L,"OPS",{enumerable:!0,get:function(){return c.OPS}}),Object.defineProperty(L,"PDFDataRangeTransport",{enumerable:!0,get:function(){return G.PDFDataRangeTransport}}),Object.defineProperty(L,"PDFDateString",{enumerable:!0,get:function(){return o.PDFDateString}}),Object.defineProperty(L,"PDFWorker",{enumerable:!0,get:function(){return G.PDFWorker}}),Object.defineProperty(L,"PasswordResponses",{enumerable:!0,get:function(){return c.PasswordResponses}}),Object.defineProperty(L,"PermissionFlag",{enumerable:!0,get:function(){return c.PermissionFlag}}),Object.defineProperty(L,"PixelsPerInch",{enumerable:!0,get:function(){return o.PixelsPerInch}}),Object.defineProperty(L,"PromiseCapability",{enumerable:!0,get:function(){return c.PromiseCapability}}),Object.defineProperty(L,"RenderingCancelledException",{enumerable:!0,get:function(){return o.RenderingCancelledException}}),Object.defineProperty(L,"SVGGraphics",{enumerable:!0,get:function(){return G.SVGGraphics}}),Object.defineProperty(L,"UnexpectedResponseException",{enumerable:!0,get:function(){return c.UnexpectedResponseException}}),Object.defineProperty(L,"Util",{enumerable:!0,get:function(){return c.Util}}),Object.defineProperty(L,"VerbosityLevel",{enumerable:!0,get:function(){return c.VerbosityLevel}}),Object.defineProperty(L,"XfaLayer",{enumerable:!0,get:function(){return E.XfaLayer}}),Object.defineProperty(L,"build",{enumerable:!0,get:function(){return G.build}}),Object.defineProperty(L,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return c.createValidAbsoluteUrl}}),Object.defineProperty(L,"getDocument",{enumerable:!0,get:function(){return G.getDocument}}),Object.defineProperty(L,"getFilenameFromUrl",{enumerable:!0,get:function(){return o.getFilenameFromUrl}}),Object.defineProperty(L,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return o.getPdfFilenameFromUrl}}),Object.defineProperty(L,"getXfaPageViewport",{enumerable:!0,get:function(){return o.getXfaPageViewport}}),Object.defineProperty(L,"isDataScheme",{enumerable:!0,get:function(){return o.isDataScheme}}),Object.defineProperty(L,"isPdfFile",{enumerable:!0,get:function(){return o.isPdfFile}}),Object.defineProperty(L,"loadScript",{enumerable:!0,get:function(){return o.loadScript}}),Object.defineProperty(L,"noContextMenu",{enumerable:!0,get:function(){return o.noContextMenu}}),Object.defineProperty(L,"normalizeUnicode",{enumerable:!0,get:function(){return c.normalizeUnicode}}),Object.defineProperty(L,"renderTextLayer",{enumerable:!0,get:function(){return b.renderTextLayer}}),Object.defineProperty(L,"setLayerDimensions",{enumerable:!0,get:function(){return o.setLayerDimensions}}),Object.defineProperty(L,"shadow",{enumerable:!0,get:function(){return c.shadow}}),Object.defineProperty(L,"updateTextLayer",{enumerable:!0,get:function(){return b.updateTextLayer}}),Object.defineProperty(L,"version",{enumerable:!0,get:function(){return G.version}});var c=__w_pdfjs_require__(1),G=__w_pdfjs_require__(2),o=__w_pdfjs_require__(6),b=__w_pdfjs_require__(26),q=__w_pdfjs_require__(27),B=__w_pdfjs_require__(5),tt=__w_pdfjs_require__(29),O=__w_pdfjs_require__(14),E=__w_pdfjs_require__(32)})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();pdfExports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;function ReportForm(){const[L,c]=reactExports.useState({name:"",description:"",date:new Date().toISOString().slice(0,16)}),[G,o]=reactExports.useState(null),[b,q]=reactExports.useState(null),[B,tt]=reactExports.useState(null),[O,E]=reactExports.useState(""),[d,j]=reactExports.useState(!1),[T,x]=reactExports.useState({type:"",text:""}),[m,v]=reactExports.useState({}),[f,u]=reactExports.useState(!1),[y,D]=reactExports.useState(!1),_=reactExports.useRef(null),h=reactExports.useRef(null),[e,s]=reactExports.useState(""),[l,a]=reactExports.useState(!1),w={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/reports/",basePdfPath:"public/reports/",token:localStorage.getItem("githubToken")||""},r=i=>{const{name:p,value:k}=i.target;c({...L,[p]:k}),m[p]&&v({...m,[p]:""})},[g,S]=reactExports.useState(!1),J=async i=>{try{x({type:"",text:""});const p=await i.arrayBuffer();try{const F=await pdfExports.getDocument({data:p}).promise;if(F.numPages===0)throw new Error("PDF has no pages");const I=await F.getPage(1),z=I.getViewport({scale:3}),et=document.createElement("canvas"),dt=et.getContext("2d");et.height=z.height,et.width=z.width;const ut={canvasContext:dt,viewport:z};await I.render(ut).promise;const mt=document.createElement("canvas"),yt=mt.getContext("2d");mt.width=175,mt.height=250,yt.drawImage(et,0,0,et.width,et.height,0,0,175,250);const xt=await new Promise(A=>{mt.toBlob(M=>A(M),"image/webp",.99)});if(!xt)throw new Error("Failed to create webp image");const st=new File([xt],`${i.name.split(".")[0]}_cover.webp`,{type:"image/webp"}),it=URL.createObjectURL(xt);return{coverImageFile:st,previewUrl:it}}catch(k){throw console.error("PDF.js error:",k),new Error("Failed to process PDF. Please upload a cover image manually.")}}catch(p){return console.error("Error generating cover from PDF:",p),x({type:"error",text:"Failed to generate cover image from PDF. Please upload a cover image manually."}),D(!0),S(!0),null}},H=i=>{if(!g)return;const p=i.target.files[0];if(p){q(p),D(!0),u(!1);const k=new FileReader;k.onload=()=>{tt(k.result)},k.readAsDataURL(p),m.coverImage&&v({...m,coverImage:""})}},Y=async i=>{const p=i.target.files[0];if(p)if(o(p),E(p.name),S(!0),c({...L,name:p.name.replace(".pdf","")}),m.pdf&&v({...m,pdf:""}),p.type==="application/pdf")try{j(!0),x({type:"",text:""});const k=await J(p);k?(q(k.coverImageFile),tt(k.previewUrl),u(!0),D(!1),m.coverImage&&v({...m,coverImage:""})):(D(!0),u(!1))}catch(k){console.error("Failed to generate cover image:",k),D(!0),u(!1)}finally{j(!1)}else D(!0),u(!1),x({type:"info",text:"Non-PDF file detected. Please upload a cover image manually."})},$=()=>{const i={};return L.name.trim()||(i.name="Report name is required"),L.description.trim()||(i.description="Description is required"),b||(i.coverImage="Cover image is required"),G||(i.pdf="PDF file is required"),v(i),Object.keys(i).length===0},rt=()=>{D(!0),f&&B&&URL.revokeObjectURL(B)},P=i=>new Promise((p,k)=>{const F=new FileReader;F.readAsDataURL(i),F.onload=()=>{const I=F.result.split(",")[1];p(I)},F.onerror=I=>k(I)}),W=async(i,p,k)=>{if(!i||!w.token)throw new Error("Missing file or GitHub token");try{const F=await P(i);let I=null;try{const ut=await fetch(`https://api.github.com/repos/${w.owner}/${w.repo}/contents/${p}?ref=${w.branch}`,{headers:{Authorization:`token ${w.token}`,Accept:"application/vnd.github.v3+json"}});ut.status===200&&(I=(await ut.json()).sha)}catch{console.log(`File does not exist yet: ${p}`)}const z={message:k,content:F,branch:w.branch};I&&(z.sha=I);const et=await fetch(`https://api.github.com/repos/${w.owner}/${w.repo}/contents/${p}`,{method:"PUT",headers:{Authorization:`token ${w.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(z)}),dt=await et.json();if(et.status===200||et.status===201)return dt;throw new Error(`GitHub API Error: ${dt.message}`)}catch(F){throw console.error("Error committing to GitHub:",F),F}},Z=async i=>{if(i.preventDefault(),!!$())try{if(j(!0),!w.token){const mt=prompt("Please enter your GitHub token to commit files:");if(!mt){x({type:"error",text:"GitHub token is required to commit files."}),j(!1);return}localStorage.setItem("githubToken",mt),w.token=mt}const p=v4().replace(/-/g,"").substring(0,24),k=Date.now(),F=G.name.replace(/[^a-zA-Z0-9.]/g,"_"),I=`${w.basePdfPath}${p}_${F}`,z=b.name.split(".").pop(),et=`${p}-cover.${z}`,dt=f?`public/reports/${et}`:`${w.baseImagePath}${et}`;a(!0);try{s("Committing cover image to GitHub..."),await W(b,dt,`Add report cover image for: ${L.name}`),s("Committing PDF file to GitHub..."),await W(G,I,`Add report PDF: ${L.name}`),s("Files successfully committed to GitHub!")}catch(mt){throw s(`Error committing files: ${mt.message}`),mt}const ut={_id:p,name:L.name,description:L.description,date:L.date,coverImage:f?`/reports/${et}`:`/images/reports/${et}`,pdfPath:`/reports/${p}_${F}`,createdAt:serverTimestamp(),updatedAt:serverTimestamp()};await addDoc(collection(db,"reports"),ut),c({name:"",description:"",date:new Date().toISOString().slice(0,16)}),o(null),E(""),q(null),tt(null),u(!1),D(!1),_.current&&(_.current.value=""),h.current&&(h.current.value=""),x({type:"success",text:"Report added successfully!"}),setTimeout(()=>{s(""),a(!1)},3e3),setTimeout(()=>{x({type:"",text:""})},5e3)}catch(p){console.error("Error adding report:",p),x({type:"error",text:`Error adding report: ${p.message}`}),a(!1)}finally{j(!1)}},R=()=>{if(!g){x({type:"info",text:"Please upload a report file first before selecting a cover image."});return}f?rt():_.current.click()},n=()=>{h.current.click()};return reactExports.useEffect(()=>()=>{B&&f&&URL.revokeObjectURL(B)},[B,f]),reactExports.useEffect(()=>{G||S(!1)},[G]),jsxRuntimeExports.jsxs("div",{className:"reports-form-container",children:[jsxRuntimeExports.jsxs("div",{className:"report-form-header",children:[jsxRuntimeExports.jsx("h1",{className:"report-form-title",children:"Add New Report"}),jsxRuntimeExports.jsx("p",{className:"report-form-subtitle",children:"Upload documents, reports, and presentations to showcase your work"})]}),T.text&&jsxRuntimeExports.jsx("div",{className:`report-message ${T.type}`,children:T.text}),jsxRuntimeExports.jsxs("form",{onSubmit:Z,className:"report-form",children:[jsxRuntimeExports.jsxs("div",{className:"report-form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"report-form-fields",children:[jsxRuntimeExports.jsxs("div",{className:"report-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",children:"Report Name*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:r,className:m.name?"error":"",placeholder:"e.g., Business Proposal Q1 2024"}),m.name&&jsxRuntimeExports.jsx("div",{className:"error-text",children:m.name})]}),jsxRuntimeExports.jsxs("div",{className:"report-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",children:"Description*"}),jsxRuntimeExports.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:r,className:m.description?"error":"",placeholder:"Briefly describe what this report contains...",rows:4}),m.description&&jsxRuntimeExports.jsx("div",{className:"error-text",children:m.description})]}),jsxRuntimeExports.jsxs("div",{className:"report-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"date",children:"Date*"}),jsxRuntimeExports.jsx("input",{type:"datetime-local",id:"date",name:"date",value:L.date,onChange:r,className:"date-picker"}),jsxRuntimeExports.jsx("small",{className:"form-help-text",children:"Select the date and time of the report"})]}),jsxRuntimeExports.jsxs("div",{className:"report-form-group",children:[jsxRuntimeExports.jsx("label",{children:"PDF File*"}),jsxRuntimeExports.jsxs("div",{className:`report-pdf-selector ${m.pdf?"error-border":""} ${G?"has-file":""}`,onClick:n,children:[G?jsxRuntimeExports.jsxs("div",{className:"selected-file",children:[jsxRuntimeExports.jsx("div",{className:"file-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),jsxRuntimeExports.jsx("polyline",{points:"14 2 14 8 20 8"}),jsxRuntimeExports.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),jsxRuntimeExports.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),jsxRuntimeExports.jsx("polyline",{points:"10 9 9 9 8 9"})]})}),jsxRuntimeExports.jsxs("div",{className:"file-details",children:[jsxRuntimeExports.jsx("span",{className:"file-name",children:O}),jsxRuntimeExports.jsx("span",{className:"file-type",children:"PDF Document"})]})]}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder pdf-placeholder",children:[jsxRuntimeExports.jsx("div",{className:"upload-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),jsxRuntimeExports.jsx("polyline",{points:"14 2 14 8 20 8"}),jsxRuntimeExports.jsx("path",{d:"M12 18v-6"}),jsxRuntimeExports.jsx("path",{d:"M8 15l4 4 4-4"})]})}),jsxRuntimeExports.jsx("p",{children:"Click to upload PDF document"}),jsxRuntimeExports.jsx("span",{children:"PDF files only (Max 20MB)"})]}),jsxRuntimeExports.jsx("input",{ref:h,type:"file",accept:".pdf",onChange:Y,style:{display:"none"}})]}),m.pdf&&jsxRuntimeExports.jsx("div",{className:"error-text",children:m.pdf}),d&&!l&&jsxRuntimeExports.jsxs("div",{className:"processing-message",children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("span",{children:"Generating cover image..."})]}),!G&&jsxRuntimeExports.jsx("div",{className:"form-help-text",children:"Upload a report file first, then you can add or generate a cover image"})]})]}),jsxRuntimeExports.jsxs("div",{className:"report-image-upload",children:[jsxRuntimeExports.jsxs("label",{className:"cover-image-label",children:["Cover Image*",f&&!y&&jsxRuntimeExports.jsx("span",{className:"auto-generated-badge",children:"Auto-generated"})]}),jsxRuntimeExports.jsxs("div",{className:`report-image-preview 
                ${m.coverImage?"error-border":""} 
                ${B?"has-image":""} 
                ${f&&!y?"auto-generated":""} 
                ${g?"":"disabled"}`,onClick:R,children:[B?jsxRuntimeExports.jsx("img",{src:B,alt:"Cover preview"}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder",children:[jsxRuntimeExports.jsx("div",{className:"upload-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),jsxRuntimeExports.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),jsxRuntimeExports.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),jsxRuntimeExports.jsx("p",{children:g?"Click to upload cover image":"Upload report file first"}),jsxRuntimeExports.jsx("span",{children:g?"PNG, JPG or WEBP (Min: 800x600px)":"Cover image will be available after report upload"})]}),jsxRuntimeExports.jsx("input",{ref:_,type:"file",accept:"image/*",onChange:H,style:{display:"none"},disabled:!g})]}),m.coverImage&&jsxRuntimeExports.jsx("div",{className:"error-text",children:m.coverImage}),f&&!y&&jsxRuntimeExports.jsxs("div",{className:"auto-cover-message",children:["Cover image automatically generated from PDF."," ",jsxRuntimeExports.jsx("button",{type:"button",className:"change-cover-btn",onClick:rt,children:"Upload manually instead"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"report-form-actions",children:jsxRuntimeExports.jsx("button",{type:"submit",className:"report-submit-button",disabled:d||l,children:d||l?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("span",{children:l?"Committing...":"Uploading..."})]}):"Add Report"})}),(l||e)&&jsxRuntimeExports.jsxs("div",{className:`commit-status ${e.includes("Error")?"error":e.includes("success")?"success":"info"}`,children:[e,l&&!e.includes("success")&&jsxRuntimeExports.jsx("div",{className:"spinner"})]})]})]})}function LoginPage({setAuthenticated:L}){const[c,G]=reactExports.useState(!1),[o,b]=reactExports.useState(null),[q,B]=reactExports.useState(!1),tt="abdobella977@gmail.com";reactExports.useEffect(()=>{b(null),B(!1)},[]),reactExports.useEffect(()=>{if(o&&!q){const E=setTimeout(()=>{b(null)},5e3);return()=>clearTimeout(E)}},[o,q]);const O=async()=>{G(!0),b(null),B(!1);const E=getAuth(),d=new GithubAuthProvider;try{const j=await signInWithPopup(E,d),T=j.user,m=GithubAuthProvider.credentialFromResult(j).accessToken;if(console.log("User email:",T.email),console.log("Authorized email:",tt),T.email!==tt){console.log("Unauthorized access attempt"),await signOut(E),B(!0),b("You are not my owner! Get the hell out of here!"),localStorage.removeItem("firebaseAuthUser"),L(!1);return}localStorage.setItem("firebaseAuthUser",JSON.stringify({uid:T.uid,displayName:T.displayName,email:T.email,photoURL:T.photoURL})),L(!0)}catch(j){j.code;const T=j.message;console.error("Login error:",j),b(`Login failed: ${T}`)}finally{G(!1)}};return jsxRuntimeExports.jsx("div",{className:"login-container",children:jsxRuntimeExports.jsxs("div",{className:"login-form",children:[jsxRuntimeExports.jsx("h1",{className:"login-title",children:"Admin Access"}),jsxRuntimeExports.jsx("p",{className:"login-subtitle",children:"Sign in with your GitHub account to access the admin panel"}),jsxRuntimeExports.jsxs("button",{className:"github-login-btn",onClick:O,disabled:c,children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,className:"github-icon"}),c?"Connecting...":"Sign in with GitHub"]}),o&&jsxRuntimeExports.jsxs("div",{className:`login-error ${q?"unauthorized":""}`,children:[q&&jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faExclamationTriangle,className:"error-icon"}),o]})]})})}function ArrangeProjects(){const[L,c]=reactExports.useState([]),[G,o]=reactExports.useState([]);reactExports.useEffect(()=>{(async()=>{try{const tt=collection(db,"projects"),E=(await getDocs(tt)).docs.map(d=>({id:d.id,...d.data()}));c(E),console.log(E)}catch(tt){console.error("Error fetching projects:",tt)}})()},[]);const b=Math.ceil(L.length/3),q=async()=>{try{const B=collection(db,"projects"),O=(await getDocs(B)).docs.map(async j=>{const T=doc(db,"projects",j.id);await updateDoc(T,{showInOverview:!1})});await Promise.all(O);const d=G.map(j=>j.id).map(async j=>{const T=doc(db,"projects",j);await updateDoc(T,{showInOverview:!0})});await Promise.all(d),alert("Featured projects updated successfully!")}catch(B){console.error("Error updating featured projects:",B),alert("Failed to update featured projects. See console for details.")}};return jsxRuntimeExports.jsxs("div",{className:"arrange-projects-form filldb-form",children:[jsxRuntimeExports.jsx("div",{className:"highlighted-projects",children:G.length>0&&G.filter((B,tt)=>tt<3).map(B=>jsxRuntimeExports.jsx("div",{className:"highlighted-project",onClick:()=>{o(G.filter(tt=>tt!==B))},children:jsxRuntimeExports.jsx("h3",{children:B.title})},B.id||B.title))}),jsxRuntimeExports.jsx("div",{className:"scrollable-grid",children:jsxRuntimeExports.jsx("div",{style:{display:"flex",flexWrap:"wrap"},children:L.length>0&&L.map(B=>jsxRuntimeExports.jsx("div",{style:{flex:`1 0 ${100/b}%`},className:"project",onClick:()=>{if(G.includes(B))o(G.filter(tt=>tt!==B));else{if(G.length===3)return;o([...G,B])}},children:jsxRuntimeExports.jsx("h3",{children:B.title})},B.id||B.title))})}),jsxRuntimeExports.jsx("button",{className:"validate-btn",onClick:()=>q(),children:"Validate"})]})}function CertificatesForm(){const[L,c]=reactExports.useState({certificateTitle:"",issuer:"",link:"",downloadPath:""}),[G,o]=reactExports.useState(null),[b,q]=reactExports.useState(null),[B,tt]=reactExports.useState(!1),[O,E]=reactExports.useState({type:"",text:""}),[d,j]=reactExports.useState({}),T=reactExports.useRef(null),[x,m]=reactExports.useState(""),[v,f]=reactExports.useState(!1),u={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/certificates/",token:localStorage.getItem("githubToken")||""},y=a=>{const{name:w,value:r}=a.target;c({...L,[w]:r}),d[w]&&j({...d,[w]:""})},D=a=>{const w=a.target.files[0];if(w){o(w);const r=new FileReader;r.onload=()=>{q(r.result)},r.readAsDataURL(w),d.image&&j({...d,image:""})}},_=()=>{const a={};return L.certificateTitle.trim()||(a.certificateTitle="Title is required"),L.issuer.trim()||(a.issuer="Issuer is required"),L.link.trim()||(a.link="Link is required"),L.downloadPath.trim()||(a.downloadPath="Download path is required"),G||(a.image="Certificate image is required"),j(a),Object.keys(a).length===0},h=a=>new Promise((w,r)=>{const g=new FileReader;g.readAsDataURL(a),g.onload=()=>{const S=g.result.split(",")[1];w(S)},g.onerror=S=>r(S)}),e=async(a,w,r)=>{if(!a||!u.token)throw new Error("Missing file or GitHub token");try{const g=await h(a);let S=null;try{const $=await fetch(`https://api.github.com/repos/${u.owner}/${u.repo}/contents/${w}?ref=${u.branch}`,{headers:{Authorization:`token ${u.token}`,Accept:"application/vnd.github.v3+json"}});$.status===200&&(S=(await $.json()).sha)}catch{console.log(`File does not exist yet: ${w}`)}const J={message:r,content:g,branch:u.branch};S&&(J.sha=S);const H=await fetch(`https://api.github.com/repos/${u.owner}/${u.repo}/contents/${w}`,{method:"PUT",headers:{Authorization:`token ${u.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(J)}),Y=await H.json();if(H.status===200||H.status===201)return Y;throw new Error(`GitHub API Error: ${Y.message}`)}catch(g){throw console.error("Error committing to GitHub:",g),g}},s=async a=>{if(a.preventDefault(),!!_())try{if(tt(!0),!u.token){const Y=prompt("Please enter your GitHub token to commit images:");if(!Y){E({type:"error",text:"GitHub token is required to commit images."}),tt(!1);return}localStorage.setItem("githubToken",Y),u.token=Y}const w=v4().replace(/-/g,"").substring(0,24),r=Date.now(),g=G.name.split(".").pop(),S=`${w}.${g}`,J=`${u.baseImagePath}${S}`;f(!0),m("Committing certificate image to GitHub...");try{await e(G,J,`Add certificate image: ${L.certificateTitle}`),m("Image successfully committed to GitHub!")}catch(Y){throw m(`Error committing image: ${Y.message}`),Y}const H={_id:w,certificateTitle:L.certificateTitle,issuer:L.issuer,link:L.link,downloadPath:L.downloadPath,image:`/images/certificates/${S}`,createdAt:serverTimestamp(),updatedAt:serverTimestamp(),__v:0};await addDoc(collection(db,"certificates"),H),c({certificateTitle:"",issuer:"",link:"",downloadPath:""}),o(null),q(null),T.current&&(T.current.value=""),E({type:"success",text:"Certificate added successfully!"}),setTimeout(()=>{m(""),f(!1)},3e3),setTimeout(()=>{E({type:"",text:""})},5e3)}catch(w){console.error("Error adding certificate:",w),E({type:"error",text:`Error adding certificate: ${w.message}`}),f(!1)}finally{tt(!1)}},l=()=>{T.current.click()};return jsxRuntimeExports.jsxs("div",{className:"certificates-form-container",children:[jsxRuntimeExports.jsxs("div",{className:"certificate-form-header",children:[jsxRuntimeExports.jsx("h1",{className:"certificate-form-title",children:"Add New Certificate"}),jsxRuntimeExports.jsx("p",{className:"certificate-form-subtitle",children:"Add your professional certificates and achievements to showcase your expertise"})]}),O.text&&jsxRuntimeExports.jsx("div",{className:`certificate-message ${O.type}`,children:O.text}),jsxRuntimeExports.jsxs("form",{onSubmit:s,className:"certificate-form",children:[jsxRuntimeExports.jsxs("div",{className:"certificate-form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"certificate-form-fields",children:[jsxRuntimeExports.jsxs("div",{className:"certificate-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"title",children:"Certificate Title*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"title",name:"certificateTitle",value:L.certificateTitle,onChange:y,className:d.certificateTitle?"error":"",placeholder:"e.g., AWS Certified Solutions Architect"}),d.certificateTitle&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.certificateTitle})]}),jsxRuntimeExports.jsxs("div",{className:"certificate-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"issuer",children:"Issuing Organization*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"issuer",name:"issuer",value:L.issuer,onChange:y,className:d.issuer?"error":"",placeholder:"e.g., Amazon Web Services"}),d.issuer&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.issuer})]}),jsxRuntimeExports.jsxs("div",{className:"certificate-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"link",children:"Certificate Link*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"link",name:"link",value:L.link,onChange:y,className:d.link?"error":"",placeholder:"https://verify.example.com/cert/123"}),d.link&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.link})]}),jsxRuntimeExports.jsxs("div",{className:"certificate-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"downloadPath",children:"Download Link*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"downloadPath",name:"downloadPath",value:L.downloadPath,onChange:y,className:d.downloadPath?"error":"",placeholder:"https://example.com/download/certificate.pdf"}),d.downloadPath&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.downloadPath})]})]}),jsxRuntimeExports.jsxs("div",{className:"certificate-image-upload",children:[jsxRuntimeExports.jsxs("div",{className:`certificate-image-preview ${d.image?"error-border":""} ${b?"has-image":""}`,onClick:l,children:[b?jsxRuntimeExports.jsx("img",{src:b,alt:"Certificate preview"}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder",children:[jsxRuntimeExports.jsx("div",{className:"upload-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports.jsx("polyline",{points:"17 8 12 3 7 8"}),jsxRuntimeExports.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),jsxRuntimeExports.jsx("p",{children:"Click to upload certificate image"}),jsxRuntimeExports.jsx("span",{children:"PNG, JPG or WEBP (Max 5MB)"})]}),jsxRuntimeExports.jsx("input",{ref:T,type:"file",accept:"image/*",onChange:D,style:{display:"none"}})]}),d.image&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.image})]})]}),jsxRuntimeExports.jsx("div",{className:"certificate-form-actions",children:jsxRuntimeExports.jsx("button",{type:"submit",className:"certificate-submit-button",disabled:B||v,children:B||v?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("span",{children:v?"Committing...":"Uploading..."})]}):"Add Certificate"})}),(v||x)&&jsxRuntimeExports.jsxs("div",{className:`commit-status ${x.includes("Error")?"error":x.includes("success")?"success":"info"}`,children:[x,v&&!x.includes("success")&&jsxRuntimeExports.jsx("div",{className:"spinner"})]})]})]})}function Clients(){const[L,c]=reactExports.useState({name:"",description:"",profession:"",company:""}),[G,o]=reactExports.useState(null),[b,q]=reactExports.useState(null),[B,tt]=reactExports.useState(!1),[O,E]=reactExports.useState({type:"",text:""}),[d,j]=reactExports.useState({}),T=reactExports.useRef(null),[x,m]=reactExports.useState(""),[v,f]=reactExports.useState(!1),u={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/clients/",token:localStorage.getItem("githubToken")||""},y=a=>{const{name:w,value:r}=a.target;c({...L,[w]:r}),d[w]&&j({...d,[w]:""})},D=a=>{const w=a.target.files[0];if(w){o(w);const r=new FileReader;r.onload=()=>{q(r.result)},r.readAsDataURL(w),d.image&&j({...d,image:""})}},_=()=>{const a={};return L.name.trim()||(a.name="Client name is required"),L.description.trim()||(a.description="Description is required"),L.profession.trim()||(a.profession="Profession is required"),L.company.trim()||(a.company="Company name is required"),G||(a.image="Client image is required"),j(a),Object.keys(a).length===0},h=a=>new Promise((w,r)=>{const g=new FileReader;g.readAsDataURL(a),g.onload=()=>{const S=g.result.split(",")[1];w(S)},g.onerror=S=>r(S)}),e=async(a,w,r)=>{if(!a||!u.token)throw new Error("Missing file or GitHub token");try{const g=await h(a);let S=null;try{const $=await fetch(`https://api.github.com/repos/${u.owner}/${u.repo}/contents/${w}?ref=${u.branch}`,{headers:{Authorization:`token ${u.token}`,Accept:"application/vnd.github.v3+json"}});$.status===200&&(S=(await $.json()).sha)}catch{console.log(`File does not exist yet: ${w}`)}const J={message:r,content:g,branch:u.branch};S&&(J.sha=S);const H=await fetch(`https://api.github.com/repos/${u.owner}/${u.repo}/contents/${w}`,{method:"PUT",headers:{Authorization:`token ${u.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(J)}),Y=await H.json();if(H.status===200||H.status===201)return Y;throw new Error(`GitHub API Error: ${Y.message}`)}catch(g){throw console.error("Error committing to GitHub:",g),g}},s=async a=>{if(a.preventDefault(),!!_())try{if(tt(!0),!u.token){const H=prompt("Please enter your GitHub token to commit images:");if(!H){E({type:"error",text:"GitHub token is required to commit images."}),tt(!1);return}localStorage.setItem("githubToken",H),u.token=H}const w=v4().replace(/-/g,"").substring(0,24),r=G.name.split(".").pop(),g=`${w}.${r}`,S=`${u.baseImagePath}${g}`;f(!0),m("Committing client image to GitHub...");try{await e(G,S,`Add client image: ${L.name}`),m("Image successfully committed to GitHub!")}catch(H){throw m(`Error committing image: ${H.message}`),H}const J={_id:w,name:L.name,description:L.description,profession:L.profession,company:L.company,image:`/images/clients/${g}`,createdAt:serverTimestamp(),updatedAt:serverTimestamp()};await addDoc(collection(db,"clients"),J),c({name:"",description:"",profession:"",company:""}),o(null),q(null),T.current&&(T.current.value=""),E({type:"success",text:"Client added successfully!"}),setTimeout(()=>{m(""),f(!1)},3e3),setTimeout(()=>{E({type:"",text:""})},5e3)}catch(w){console.error("Error adding client:",w),E({type:"error",text:`Error adding client: ${w.message}`}),f(!1)}finally{tt(!1)}},l=()=>{T.current.click()};return jsxRuntimeExports.jsxs("div",{className:"clients-form-container",children:[jsxRuntimeExports.jsxs("div",{className:"client-form-header",children:[jsxRuntimeExports.jsx("h1",{className:"client-form-title",children:"Add New Client"}),jsxRuntimeExports.jsx("p",{className:"client-form-subtitle",children:"Add clients and testimonials to showcase your professional connections"})]}),O.text&&jsxRuntimeExports.jsx("div",{className:`client-message ${O.type}`,children:O.text}),jsxRuntimeExports.jsxs("form",{onSubmit:s,className:"client-form",children:[jsxRuntimeExports.jsxs("div",{className:"client-form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"client-form-fields",children:[jsxRuntimeExports.jsxs("div",{className:"client-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",children:"Client Name*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",name:"name",value:L.name,onChange:y,className:d.name?"error":"",placeholder:"e.g., John Smith"}),d.name&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.name})]}),jsxRuntimeExports.jsxs("div",{className:"client-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"profession",children:"Client Profession*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"profession",name:"profession",value:L.profession,onChange:y,className:d.profession?"error":"",placeholder:"e.g., Marketing Director"}),d.profession&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.profession})]}),jsxRuntimeExports.jsxs("div",{className:"client-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"company",children:"Company/Organization*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"company",name:"company",value:L.company,onChange:y,className:d.company?"error":"",placeholder:"e.g., Acme Inc."}),d.company&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.company})]}),jsxRuntimeExports.jsxs("div",{className:"client-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",children:"Client Testimonial/Description*"}),jsxRuntimeExports.jsx("textarea",{id:"description",name:"description",value:L.description,onChange:y,className:d.description?"error":"",placeholder:"What they said about your work...",rows:5}),d.description&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.description})]})]}),jsxRuntimeExports.jsxs("div",{className:"client-image-upload",children:[jsxRuntimeExports.jsxs("div",{className:`client-image-preview ${d.image?"error-border":""} ${b?"has-image":""}`,onClick:l,children:[b?jsxRuntimeExports.jsx("img",{src:b,alt:"Client preview"}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder",children:[jsxRuntimeExports.jsx("div",{className:"upload-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports.jsx("polyline",{points:"17 8 12 3 7 8"}),jsxRuntimeExports.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),jsxRuntimeExports.jsx("p",{children:"Click to upload client photo"}),jsxRuntimeExports.jsx("span",{children:"Square image recommended (1:1)"})]}),jsxRuntimeExports.jsx("input",{ref:T,type:"file",accept:"image/*",onChange:D,style:{display:"none"}})]}),d.image&&jsxRuntimeExports.jsx("div",{className:"error-text",children:d.image})]})]}),jsxRuntimeExports.jsx("div",{className:"client-form-actions",children:jsxRuntimeExports.jsx("button",{type:"submit",className:"client-submit-button",disabled:B||v,children:B||v?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("span",{children:v?"Committing...":"Uploading..."})]}):"Add Client"})}),(v||x)&&jsxRuntimeExports.jsxs("div",{className:`commit-status ${x.includes("Error")?"error":x.includes("success")?"success":"info"}`,children:[x,v&&!x.includes("success")&&jsxRuntimeExports.jsx("div",{className:"spinner"})]})]})]})}function VisitorStats(){const[L,c]=reactExports.useState({totalVisitors:0,totalPageViews:0,recentVisitors:[],allVisitors:[],topPages:[],browsers:{},operatingSystems:{},referrers:{},screenResolutions:{},languages:{},timezones:{},repeatVisitors:0,newVisitorsToday:0,avgVisitDuration:0,hourlyDistribution:{},dailyDistribution:{},loading:!0,error:null}),[G,o]=reactExports.useState({timeRange:"all",browser:"all",os:"all",ipSearch:""}),[b,q]=reactExports.useState({currentPage:1,itemsPerPage:10,viewAll:!1,totalPages:1,lastVisible:null}),B=()=>{const e=new Date;return e.setHours(0,0,0,0),e};reactExports.useEffect(()=>{(async()=>{try{const s=collection(db,"visitors");let l=s,a=null;if(G.timeRange!=="all"){const M=new Date;G.timeRange==="day"?M.setDate(M.getDate()-1):G.timeRange==="week"?M.setDate(M.getDate()-7):G.timeRange==="month"&&M.setMonth(M.getMonth()-1),a=M,l=query(s,where("timestamp",">=",M))}const w=await getDocs(l),r=new Set,g={},S={},J={},H={},Y={},$={},rt=Array(24).fill(0),P=Array(7).fill(0);let W=0,Z=0,R=0,n=0,i=0;const p=B();w.docs.forEach(M=>{const V=M.data();if(r.add(V.ip),V.timestamp){const St=typeof V.timestamp=="string"?new Date(V.timestamp):V.timestamp.toDate?V.timestamp.toDate():new Date,Bt=new Date(St);Bt.setHours(0,0,0,0),Bt.getTime()===p.getTime()&&R++;const Ot=St.getHours();rt[Ot]++;const Gt=St.getDay();P[Gt]++}const nt=V.browser||"unknown";g[nt]=(g[nt]||0)+1;const ft=V.operatingSystem||"unknown";S[ft]=(S[ft]||0)+1;let vt="direct";try{V.referrer&&(vt=new URL(V.referrer).hostname)}catch{vt="invalid"}J[vt]=(J[vt]||0)+1;const At=V.screenResolution||"unknown";H[At]=(H[At]||0)+1;const Q=V.language||"unknown";Y[Q]=(Y[Q]||0)+1;const wt=V.timezone||"unknown";$[wt]=($[wt]||0)+1,V.visitCount&&V.visitCount>1&&W++,Z+=V.visitCount||1,V.visitDuration&&(n+=V.visitDuration,i++)});const k=i>0?Math.round(n/i):0;let F=query(s,orderBy("timestamp","desc"));G.browser!=="all"&&(F=query(F,where("browser","==",G.browser))),G.os!=="all"&&(F=query(F,where("operatingSystem","==",G.os))),a&&(F=query(F,where("timestamp",">=",a)));let z=(await getDocs(F)).docs.map(M=>({id:M.id,...M.data(),timestamp:tt(M.data().timestamp)}));G.ipSearch&&(z=z.filter(M=>M.ip&&M.ip.includes(G.ipSearch)));const et=Math.ceil(z.length/b.itemsPerPage),dt=(b.currentPage-1)*b.itemsPerPage,ut=b.viewAll?z.length:dt+b.itemsPerPage,mt=z.slice(dt,ut);let xt=collection(db,"pageViews");a&&(xt=query(xt,where("timestamp",">=",a)));const st=await getDocs(xt),it={};st.docs.forEach(M=>{const V=M.data().path;V&&(it[V]=(it[V]||0)+1)});const A=Object.entries(it).map(([M,V])=>({path:M,count:V})).sort((M,V)=>V.count-M.count).slice(0,5);c({totalVisitors:r.size,totalPageViews:Z,recentVisitors:mt,allVisitors:z,topPages:A,browsers:g,operatingSystems:S,referrers:J,screenResolutions:H,languages:Y,timezones:$,repeatVisitors:W,newVisitorsToday:R,avgVisitDuration:k,hourlyDistribution:rt,dailyDistribution:P,loading:!1,error:null}),q(M=>({...M,totalPages:et}))}catch(s){console.error("Error fetching visitor stats:",s),c(l=>({...l,loading:!1,error:"Failed to load visitor statistics"}))}})()},[G,b.currentPage,b.itemsPerPage,b.viewAll]);const tt=e=>{if(!e)return"N/A";try{return(typeof e=="string"?new Date(e):e.toDate?e.toDate():new Date).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},O=e=>{if(!e)return"N/A";const s=Math.floor(e/60),l=e%60;return`${s}m ${l}s`},E=reactExports.useMemo(()=>Object.entries(L.browsers).map(([e,s])=>({name:e,count:s})).sort((e,s)=>s.count-e.count).slice(0,5),[L.browsers]),d=reactExports.useMemo(()=>Object.entries(L.operatingSystems).map(([e,s])=>({name:e,count:s})).sort((e,s)=>s.count-e.count).slice(0,5),[L.operatingSystems]),j=reactExports.useMemo(()=>Object.entries(L.referrers).map(([e,s])=>({name:e,count:s})).sort((e,s)=>s.count-e.count).slice(0,5),[L.referrers]),T=reactExports.useMemo(()=>Object.entries(L.screenResolutions).map(([e,s])=>({name:e,count:s})).sort((e,s)=>s.count-e.count).slice(0,5),[L.screenResolutions]),x=reactExports.useMemo(()=>Object.keys(L.browsers),[L.browsers]),m=reactExports.useMemo(()=>Object.keys(L.operatingSystems),[L.operatingSystems]),v=e=>{const{name:s,value:l}=e.target;o(a=>({...a,[s]:l})),q(a=>({...a,currentPage:1,viewAll:!1}))},f=e=>{o(s=>({...s,ipSearch:e.target.value})),q(s=>({...s,currentPage:1,viewAll:!1}))},u=e=>{q(s=>({...s,currentPage:e,viewAll:!1}))},y=()=>{q(e=>({...e,viewAll:!e.viewAll}))},D=(e,s)=>s===0?"rgba(72, 187, 120, 0)":`rgba(72, 187, 120, ${e/s})`,_=Array.isArray(L.hourlyDistribution)?Math.max(...L.hourlyDistribution):0,h=Array.isArray(L.dailyDistribution)?Math.max(...L.dailyDistribution):0;return L.loading?jsxRuntimeExports.jsxs("div",{className:"loading",children:[jsxRuntimeExports.jsx("div",{className:"loading-spinner"}),jsxRuntimeExports.jsx("div",{children:"Loading visitor statistics..."})]}):L.error?jsxRuntimeExports.jsx("div",{className:"error",children:L.error}):jsxRuntimeExports.jsxs("div",{className:"visitor-stats",children:[jsxRuntimeExports.jsxs("h2",{children:[jsxRuntimeExports.jsx("span",{children:"Visitor"})," Statistics"]}),jsxRuntimeExports.jsxs("div",{className:"filters",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"filter-label",children:"Time Range:"}),jsxRuntimeExports.jsxs("select",{name:"timeRange",value:G.timeRange,onChange:v,className:"filter-select",children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All Time"}),jsxRuntimeExports.jsx("option",{value:"day",children:"Last 24 Hours"}),jsxRuntimeExports.jsx("option",{value:"week",children:"Last 7 Days"}),jsxRuntimeExports.jsx("option",{value:"month",children:"Last 30 Days"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"filter-label",children:"Browser:"}),jsxRuntimeExports.jsxs("select",{name:"browser",value:G.browser,onChange:v,className:"filter-select",children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All Browsers"}),x.map(e=>jsxRuntimeExports.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"filter-label",children:"Operating System:"}),jsxRuntimeExports.jsxs("select",{name:"os",value:G.os,onChange:v,className:"filter-select",children:[jsxRuntimeExports.jsx("option",{value:"all",children:"All OS"}),m.map(e=>jsxRuntimeExports.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"filter-label",children:"Search IP:"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search by IP address",value:G.ipSearch,onChange:f,className:"search-input"})]})]}),jsxRuntimeExports.jsxs("div",{className:"stats-overview",children:[jsxRuntimeExports.jsxs("div",{className:"stats-card",children:[jsxRuntimeExports.jsx("h3",{children:"Total Unique Visitors"}),jsxRuntimeExports.jsx("div",{className:"stat-number",children:L.totalVisitors}),jsxRuntimeExports.jsx("div",{className:"stat-detail",children:"Unique IP addresses"})]}),jsxRuntimeExports.jsxs("div",{className:"stats-card",children:[jsxRuntimeExports.jsx("h3",{children:"Total Page Views"}),jsxRuntimeExports.jsx("div",{className:"stat-number",children:L.totalPageViews}),jsxRuntimeExports.jsx("div",{className:"stat-detail",children:"All visits combined"})]}),jsxRuntimeExports.jsxs("div",{className:"stats-card",children:[jsxRuntimeExports.jsx("h3",{children:"Repeat Visitors"}),jsxRuntimeExports.jsxs("div",{className:"stat-number",children:[L.repeatVisitors,jsxRuntimeExports.jsxs("span",{className:"stat-detail",style:{display:"inline-block",marginLeft:"10px"},children:["(",Math.round(L.repeatVisitors/L.totalVisitors*100||0),"%)"]})]}),jsxRuntimeExports.jsx("div",{className:"stat-detail",children:"Visited more than once"})]}),jsxRuntimeExports.jsxs("div",{className:"stats-card",children:[jsxRuntimeExports.jsx("h3",{children:"New Today"}),jsxRuntimeExports.jsx("div",{className:"stat-number",children:L.newVisitorsToday}),jsxRuntimeExports.jsx("div",{className:"stat-detail",children:"Visitors in last 24h"})]})]}),jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Visit Details"}),jsxRuntimeExports.jsxs("div",{className:"mini-stats-grid",children:[jsxRuntimeExports.jsxs("div",{className:"mini-stat",children:[jsxRuntimeExports.jsx("div",{className:"mini-stat-title",children:"Avg. Visit Duration"}),jsxRuntimeExports.jsx("div",{className:"mini-stat-value",children:O(L.avgVisitDuration)})]}),jsxRuntimeExports.jsxs("div",{className:"mini-stat",children:[jsxRuntimeExports.jsx("div",{className:"mini-stat-title",children:"Pages per Visit"}),jsxRuntimeExports.jsx("div",{className:"mini-stat-value",children:(L.totalPageViews/L.totalVisitors||0).toFixed(1)})]}),jsxRuntimeExports.jsxs("div",{className:"mini-stat",children:[jsxRuntimeExports.jsx("div",{className:"mini-stat-title",children:"Bounce Rate"}),jsxRuntimeExports.jsxs("div",{className:"mini-stat-value",children:[Math.round((1-L.repeatVisitors/L.totalVisitors)*100||0),"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"mini-stat",children:[jsxRuntimeExports.jsx("div",{className:"mini-stat-title",children:"Unique Languages"}),jsxRuntimeExports.jsx("div",{className:"mini-stat-value",children:Object.keys(L.languages).length})]}),jsxRuntimeExports.jsxs("div",{className:"mini-stat",children:[jsxRuntimeExports.jsx("div",{className:"mini-stat-title",children:"Unique Timezones"}),jsxRuntimeExports.jsx("div",{className:"mini-stat-value",children:Object.keys(L.timezones).length})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Visit Distribution by Time"}),jsxRuntimeExports.jsx("h4",{style:{marginTop:"20px",color:"rgba(255, 255, 255, 0.8)"},children:"Hourly Distribution"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",marginTop:"10px"},children:[jsxRuntimeExports.jsx("div",{style:{width:"30px"},children:[0,6,12,18].map(e=>jsxRuntimeExports.jsxs("div",{className:"heatmap-label",style:{height:"30px"},children:[e,"h"]},e))}),jsxRuntimeExports.jsx("div",{style:{flex:1},children:jsxRuntimeExports.jsx("div",{className:"heatmap-row",children:Array(24).fill(0).map((e,s)=>jsxRuntimeExports.jsx("div",{className:"heatmap-cell",style:{background:D(L.hourlyDistribution[s],_),border:"1px solid rgba(255, 255, 255, 0.1)"},title:`${s}:00 - ${s+1}:00: ${L.hourlyDistribution[s]} visits`,children:L.hourlyDistribution[s]>0&&L.hourlyDistribution[s]},s))})})]}),jsxRuntimeExports.jsx("h4",{style:{marginTop:"30px",color:"rgba(255, 255, 255, 0.8)"},children:"Daily Distribution"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",marginTop:"10px"},children:[jsxRuntimeExports.jsx("div",{style:{width:"30px"}}),jsxRuntimeExports.jsx("div",{style:{flex:1,display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"3px"},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>jsxRuntimeExports.jsx("div",{className:"heatmap-day",children:e},e))})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",marginTop:"5px"},children:[jsxRuntimeExports.jsx("div",{style:{width:"30px"}}),jsxRuntimeExports.jsx("div",{style:{flex:1},children:jsxRuntimeExports.jsx("div",{className:"heatmap-row",children:L.dailyDistribution.map((e,s)=>jsxRuntimeExports.jsx("div",{className:"heatmap-cell",style:{background:D(e,h)},title:`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][s]}: ${e} visits`,children:e>0&&e},s))})})]}),jsxRuntimeExports.jsxs("div",{className:"heatmap-legend",children:[jsxRuntimeExports.jsxs("div",{className:"legend-item",children:[jsxRuntimeExports.jsx("div",{className:"legend-color",style:{background:"rgba(72, 187, 120, 0.1)"}}),jsxRuntimeExports.jsx("span",{children:"Low"})]}),jsxRuntimeExports.jsxs("div",{className:"legend-item",children:[jsxRuntimeExports.jsx("div",{className:"legend-color",style:{background:"rgba(72, 187, 120, 0.3)"}}),jsxRuntimeExports.jsx("span",{})]}),jsxRuntimeExports.jsxs("div",{className:"legend-item",children:[jsxRuntimeExports.jsx("div",{className:"legend-color",style:{background:"rgba(72, 187, 120, 0.5)"}}),jsxRuntimeExports.jsx("span",{})]}),jsxRuntimeExports.jsxs("div",{className:"legend-item",children:[jsxRuntimeExports.jsx("div",{className:"legend-color",style:{background:"rgba(72, 187, 120, 0.7)"}}),jsxRuntimeExports.jsx("span",{})]}),jsxRuntimeExports.jsxs("div",{className:"legend-item",children:[jsxRuntimeExports.jsx("div",{className:"legend-color",style:{background:"rgba(72, 187, 120, 1)"}}),jsxRuntimeExports.jsx("span",{children:"High"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"distribution-row",children:[jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Top Pages"}),jsxRuntimeExports.jsxs("ul",{className:"top-pages",children:[L.topPages.map((e,s)=>jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("span",{className:"page-path",children:e.path||"/"}),jsxRuntimeExports.jsxs("span",{className:"page-count",children:[e.count," views"]})]},s)),L.topPages.length===0&&jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("span",{children:"No page view data available"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Traffic Sources"}),jsxRuntimeExports.jsxs("ul",{className:"top-pages",children:[j.map((e,s)=>jsxRuntimeExports.jsxs("li",{className:"referrer-item",children:[jsxRuntimeExports.jsx("span",{className:"referrer-domain",children:e.name==="direct"?"Direct / Bookmarked":e.name}),jsxRuntimeExports.jsx("span",{className:"page-count",children:e.count})]},s)),j.length===0&&jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("span",{children:"No referrer data available"})})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"distribution-row",children:[jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Browser Distribution"}),jsxRuntimeExports.jsx("ul",{className:"top-pages",children:E.map((e,s)=>jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("img",{src:`/images/browsers/${e.name.toLowerCase()}.svg`,alt:e.name,className:"browser-icon",onError:l=>{l.target.style.display="none"}}),e.name.charAt(0).toUpperCase()+e.name.slice(1)]}),jsxRuntimeExports.jsx("span",{className:"page-count",children:e.count})]},s))})]}),jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Operating System"}),jsxRuntimeExports.jsx("ul",{className:"top-pages",children:d.map((e,s)=>jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsxs("span",{children:[jsxRuntimeExports.jsx("img",{src:`/images/os/${e.name.toLowerCase()}.svg`,alt:e.name,className:"os-icon",onError:l=>{l.target.style.display="none"}}),e.name.charAt(0).toUpperCase()+e.name.slice(1)]}),jsxRuntimeExports.jsx("span",{className:"page-count",children:e.count})]},s))})]}),jsxRuntimeExports.jsxs("div",{className:"distribution-row",children:[jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Screen Resolutions"}),jsxRuntimeExports.jsx("ul",{className:"top-pages",children:T.map((e,s)=>jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("span",{className:"referrer-domain",children:e.name}),jsxRuntimeExports.jsx("span",{className:"page-count",children:e.count})]},s))})]}),jsxRuntimeExports.jsx("div",{className:"stats-section"}),jsxRuntimeExports.jsx("h3",{children:"Languages"}),jsxRuntimeExports.jsx("ul",{className:"top-pages",children:Object.entries(L.languages).map(([e,s])=>({lang:e,count:s})).sort((e,s)=>s.count-e.count).slice(0,5).map((e,s)=>jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("span",{className:"referrer-domain",children:e.lang==="unknown"?"Unknown":e.lang}),jsxRuntimeExports.jsx("span",{className:"page-count",children:e.count})]},s))})]})]}),jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Visitor Log"}),jsxRuntimeExports.jsx("div",{className:"visitors-table-container",children:jsxRuntimeExports.jsxs("table",{className:"visitors-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"IP Address"}),jsxRuntimeExports.jsx("th",{children:"Page"}),jsxRuntimeExports.jsx("th",{children:"Browser / OS"}),jsxRuntimeExports.jsx("th",{children:"Screen"}),jsxRuntimeExports.jsx("th",{children:"Language"}),jsxRuntimeExports.jsx("th",{children:"Time"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[L.recentVisitors.map((e,s)=>{var l,a;return jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsxs("td",{children:[e.ip||"Unknown",e.visitCount>1&&jsxRuntimeExports.jsxs("span",{className:"badge badge-repeat",children:[e.visitCount,"x"]})]}),jsxRuntimeExports.jsx("td",{children:jsxRuntimeExports.jsx("span",{className:"page-path",children:e.path||"/"})}),jsxRuntimeExports.jsxs("td",{children:[jsxRuntimeExports.jsx("img",{src:`/images/browsers/${(l=e.browser)==null?void 0:l.toLowerCase()}.svg`,alt:e.browser,className:"browser-icon",onError:w=>{w.target.style.display="none"}}),e.browser||"Unknown"," /",jsxRuntimeExports.jsx("img",{src:`/images/os/${(a=e.operatingSystem)==null?void 0:a.toLowerCase()}.svg`,alt:e.operatingSystem,className:"os-icon",onError:w=>{w.target.style.display="none"}}),e.operatingSystem||"Unknown"]}),jsxRuntimeExports.jsx("td",{children:e.screenResolution||"Unknown"}),jsxRuntimeExports.jsx("td",{children:e.language||"Unknown"}),jsxRuntimeExports.jsx("td",{children:e.timestamp})]},s)}),L.recentVisitors.length===0&&jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:"6",style:{textAlign:"center"},children:"No visitor data available"})})]})]})}),jsxRuntimeExports.jsxs("div",{className:"pagination-controls",children:[jsxRuntimeExports.jsx("button",{className:`view-all-btn ${b.viewAll?"active":""}`,onClick:y,children:b.viewAll?"Show Less":"View All"}),!b.viewAll&&jsxRuntimeExports.jsxs("div",{className:"pagination-buttons",children:[jsxRuntimeExports.jsx("button",{className:"page-btn",disabled:b.currentPage===1,onClick:()=>u(1),children:"«"}),jsxRuntimeExports.jsx("button",{className:"page-btn",disabled:b.currentPage===1,onClick:()=>u(b.currentPage-1),children:"‹"}),Array.from({length:Math.min(5,b.totalPages)},(e,s)=>{const l=b.currentPage<=3?s+1:b.currentPage>=b.totalPages-2?b.totalPages-4+s:b.currentPage-2+s;return l<=b.totalPages&&l>0?jsxRuntimeExports.jsx("button",{className:`page-btn ${b.currentPage===l?"active":""}`,onClick:()=>u(l),children:l},l):null}),jsxRuntimeExports.jsx("button",{className:"page-btn",disabled:b.currentPage===b.totalPages,onClick:()=>u(b.currentPage+1),children:"›"}),jsxRuntimeExports.jsx("button",{className:"page-btn",disabled:b.currentPage===b.totalPages,onClick:()=>u(b.totalPages),children:"»"})]}),jsxRuntimeExports.jsxs("div",{className:"page-info",children:["Showing ",b.viewAll?"all":`${Math.min((b.currentPage-1)*b.itemsPerPage+1,L.allVisitors.length)} - ${Math.min(b.currentPage*b.itemsPerPage,L.allVisitors.length)}`," of ",L.allVisitors.length," visitors"]})]})]})]})}const tabs=[{id:0,label:"Project",component:jsxRuntimeExports.jsx(ProjectForm,{})},{id:1,label:"Arrange Projects",component:jsxRuntimeExports.jsx(ArrangeProjects,{})},{id:2,label:"Certificate",component:jsxRuntimeExports.jsx(CertificatesForm,{})},{id:3,label:"Report",component:jsxRuntimeExports.jsx(ReportForm,{})},{id:4,label:"Clients",component:jsxRuntimeExports.jsx(Clients,{})},{id:5,label:"Visitor Stats",component:jsxRuntimeExports.jsx(VisitorStats,{})}];function FillDB(){const[L,c]=reactExports.useState(!1),[G,o]=reactExports.useState(tabs[0].id),[b,q]=reactExports.useState(null),[B,tt]=reactExports.useState(!1);reactExports.useEffect(()=>{const E=getAuth(),d=onAuthStateChanged(E,j=>{if(j)j.email==="abdobella977@gmail.com"?(q(j),c(!0),localStorage.setItem("firebaseAuthUser",JSON.stringify({uid:j.uid,displayName:j.displayName,email:j.email,photoURL:j.photoURL}))):signOut(E).then(()=>{q(null),c(!1),localStorage.removeItem("firebaseAuthUser")});else{q(null);const T=localStorage.getItem("firebaseAuthUser");if(T){const x=JSON.parse(T);x.email==="abdobella977@gmail.com"?(c(!0),q(x)):(localStorage.removeItem("firebaseAuthUser"),c(!1))}else c(!1)}tt(!0)});return()=>d()},[]),reactExports.useEffect(()=>{var E;L&&console.log(`Tab changed to: ${(E=tabs[G])==null?void 0:E.label}`)},[G,L]);const O=async()=>{const E=getAuth();try{await signOut(E),localStorage.removeItem("firebaseAuthUser"),localStorage.removeItem("githubToken"),c(!1),q(null)}catch(d){console.error("Error signing out: ",d)}};return B?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:L?jsxRuntimeExports.jsxs("div",{className:"filldb-container",children:[jsxRuntimeExports.jsxs("div",{className:"sidebar",children:[b&&jsxRuntimeExports.jsxs("div",{className:"user-profile",children:[jsxRuntimeExports.jsx("img",{src:b.photoURL,alt:b.displayName,className:"user-avatar",onError:E=>{E.target.onerror=null,E.target.src="https://via.placeholder.com/30"}}),jsxRuntimeExports.jsx("span",{className:"user-name",children:b.displayName})]}),jsxRuntimeExports.jsx("div",{className:"nav-buttons",children:tabs.map(E=>jsxRuntimeExports.jsx("button",{className:`filldb-nav__btn ${G===E.id?"active":""}`,onClick:()=>o(E.id),children:E.label},E.id))}),jsxRuntimeExports.jsx("button",{className:"filldb-nav__btn logout-btn",onClick:O,children:"Logout"})]}),jsxRuntimeExports.jsx("div",{className:"main-content",children:tabs.map(E=>G===E.id&&E.component)})]}):jsxRuntimeExports.jsx(LoginPage,{setAuthenticated:c})}):jsxRuntimeExports.jsx("div",{className:"loading-auth",children:"Checking authentication..."})}export{FillDB as default};
