import{r as a,j as e,i as se,f as O,t as me,v as W,x as ie,e as J,y as ae,G as oe,z as ue,A as re,g as Y,B as ne,q as pe,C as he,D as ge,o as fe}from"./index-CD6DHRXK.js";import{F as R,f as xe}from"./index-C1KlrdvA.js";import{i as Q,j as je,k as le,l as de,m as be,n as ve,o as ye,p as Ne,c as we,q as Se,r as Ce,s as ke,t as De,u as Ie}from"./index-B9RSM9E-.js";import{c as $e,g as Pe}from"./index-Cg9aIctW.js";var Te=document.getElementsByClassName("closeTab"),Ae=document.getElementsByClassName("tab"),Fe=document.querySelectorAll("button.btn");Array.prototype.forEach.call(Te,function(t){t.addEventListener("click",Re)});Array.prototype.forEach.call(Ae,function(t){t.style.width=t.offsetWidth+"px"});Array.prototype.forEach.call(Fe,function(t){t.addEventListener("click",function(r){return r.preventDefault(),!1})});function Ee(t){var r=t.getBoundingClientRect(),i=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;return{top:r.top+o,left:r.left+i}}function Re(t){var r=t.currentTarget.parentElement,i=Ee(r),o=i.left,h=i.top+10,c=document.createElement("canvas"),l=c.getContext("2d"),d=window.devicePixelRatio,b=[];r.classList.add("tabClosed"),window.setTimeout(function(){document.body.appendChild(c),c.style.position="absolute",c.style.left=o-40+"px",c.style.top=h-150+"px",c.style.pointerEvents="none",c.style.width="80px",c.style.height="300px",c.width=80*d,c.height=300*d;function m(){l.clearRect(0,0,c.width,c.height),b.forEach(function(s,u){s.opacity-=.01,s.speed*=s.friction,s.radius*=s.friction,s.yVel+=s.gravity,s.y+=s.yVel,!(s.opacity<0)&&(s.radius<0||(l.beginPath(),l.globalAlpha=s.opacity,l.fillStyle=s.color,l.arc(s.x,s.y,s.radius,0,2*Math.PI,!1),l.fill()))})}(function s(){requestAnimationFrame(s),m()})(),setTimeout(function(){document.body.removeChild(c)},3e3)},150)}function Le({carouselSamples:t,setCarouselSamples:r,setPopupWindow:i}){const[o,h]=a.useState(""),[c,l]=a.useState(null),[d,b]=a.useState(null),[m,s]=a.useState(""),u=x=>{const g=x.target.files[0];if(g){if(!g.type.match("image.*")){s("Please select an image file");return}if(g.size>5*1024*1024){s("Image must be less than 5MB");return}l(g);const D=new FileReader;D.onload=F=>{b(F.target.result)},D.readAsDataURL(g),s("")}},n=x=>{x.preventDefault(),x.currentTarget.classList.add("drag-over")},p=x=>{x.currentTarget.classList.remove("drag-over")},v=x=>{if(x.preventDefault(),x.currentTarget.classList.remove("drag-over"),x.dataTransfer.files&&x.dataTransfer.files[0]){const g=x.dataTransfer.files[0];if(!g.type.match("image.*")){s("Please select an image file");return}if(g.size>5*1024*1024){s("Image must be less than 5MB");return}l(g);const D=new FileReader;D.onload=F=>{b(F.target.result)},D.readAsDataURL(g),s("")}},f=()=>{if(!o){s("Please enter a title for the carousel image");return}if(!c){s("Please select an image");return}let x=[...t];x.push({title:o,img:[c]}),r(x),i(null)};return e.jsx("div",{className:"popup-container",children:e.jsxs("div",{className:"carousel-form popup",children:[e.jsx("button",{type:"button",className:"close-button",onClick:()=>i(null),children:e.jsx(R,{icon:Q})}),e.jsx("h2",{className:"form-title",children:"Add Carousel Image"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"carouselTitle",children:"Image Title"}),e.jsx("input",{type:"text",id:"carouselTitle",className:"carousel-input",value:o,onChange:x=>h(x.target.value),placeholder:"Enter a descriptive title for this image"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image Upload"}),e.jsxs("div",{className:`carousel-upload-area ${d?"has-preview":""}`,onDragOver:n,onDragLeave:p,onDrop:v,children:[e.jsx("input",{type:"file",className:"file-input",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:u,id:"carouselImage"}),d?e.jsxs("div",{className:"carousel-preview",children:[e.jsx("img",{src:d,alt:"Preview",className:"preview-image"}),e.jsx("button",{type:"button",className:"remove-image-btn",onClick:()=>{l(null),b(null)},children:e.jsx(R,{icon:Q})})]}):e.jsxs("div",{className:"upload-placeholder",children:[e.jsx(R,{icon:je,className:"upload-icon"}),e.jsxs("div",{className:"upload-text",children:[e.jsx("p",{children:"Drag & drop image here"}),e.jsx("span",{children:"or"}),e.jsxs("label",{htmlFor:"carouselImage",className:"browse-btn",children:[e.jsx(R,{icon:le})," Browse files"]})]})]})]}),e.jsxs("div",{className:"image-requirements",children:[e.jsx(R,{icon:de,className:"info-icon"}),e.jsx("span",{children:"Recommended: JPG, PNG or WebP • Max 5MB • 16:9 aspect ratio"})]})]}),m&&e.jsx("div",{className:"form-error",children:m}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>i(null),children:"Cancel"}),e.jsx("button",{type:"button",className:"submit-btn",onClick:f,children:"Add to Carousel"})]})]})})}function Ge({codeSamples:t,setCodeSamples:r,setPopupWindow:i}){const[o,h]=a.useState(""),[c,l]=a.useState(""),[d,b]=a.useState(""),[m,s]=a.useState([]),[u,n]=a.useState(""),[p,v]=a.useState(!0);a.useEffect(()=>{(async()=>{try{v(!0);const D=(await $e(Pe)).scopes();s(D),D.length>0&&b(D.find(F=>F.includes("javascript"))||D[0])}catch(g){console.error("Error loading syntax highlighting:",g)}finally{v(!1)}})()},[]);const f=()=>{if(!o.trim()){n("Please enter a title for the code sample");return}if(!c.trim()){n("Please enter some code");return}if(!d){n("Please select a language");return}const x=[...t];x.push({title:o.trim(),code:c.trim(),language:d}),r(x),i(null)};return e.jsx("div",{className:"popup-container",children:e.jsxs("div",{className:"code-sample-form popup",children:[e.jsx("button",{type:"button",className:"close-button",onClick:()=>i(null),children:e.jsx(R,{icon:Q})}),e.jsxs("h2",{className:"form-title",children:[e.jsx(R,{icon:be,className:"title-icon"}),"Add Code Sample"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"codeSampleTitle",children:"Sample Title"}),e.jsx("input",{type:"text",id:"codeSampleTitle",className:"form-control",value:o,onChange:x=>h(x.target.value),placeholder:"e.g., 'Authentication Function', 'API Request Handler'"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"language",children:"Programming Language"}),e.jsx("div",{className:"select-wrapper",children:e.jsx("select",{id:"language",className:"form-control",value:d,onChange:x=>b(x.target.value),disabled:p,children:p?e.jsx("option",{value:"",children:"Loading languages..."}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select a language"}),m.map((x,g)=>e.jsx("option",{value:x,children:x.replace(/^source\./,"").replace(/\b\w/g,D=>D.toUpperCase())},g))]})})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"code",children:"Code"}),e.jsx("textarea",{id:"code",className:"code-editor",value:c,onChange:x=>l(x.target.value),placeholder:"Paste your code snippet here...",rows:10,spellCheck:"false"}),e.jsxs("div",{className:"code-helper",children:[e.jsx(R,{icon:de,className:"info-icon"}),e.jsx("span",{children:"Use proper indentation for better readability"})]})]}),u&&e.jsx("div",{className:"form-error",children:u}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>i(null),children:"Cancel"}),e.jsx("button",{type:"button",className:"submit-btn",onClick:f,children:"Add Code Sample"})]})]})})}function Ue({techs:t,setTechs:r,setPopupWindow:i}){const[o,h]=a.useState(""),[c,l]=a.useState(""),[d,b]=a.useState(""),m=()=>{if(!o.trim()){b("Please enter a technology name");return}if(!c.trim()){b("Please enter a technology description");return}const n=[...t];n.push({title:o.trim(),description:c.trim()}),r(n),i(null)},s=[{name:"React",desc:"A JavaScript library for building user interfaces"},{name:"Node.js",desc:"JavaScript runtime built on Chrome's V8 JavaScript engine"},{name:"Python",desc:"Interpreted high-level general-purpose programming language"},{name:"Docker",desc:"Platform for developing, shipping, and running applications in containers"},{name:"MongoDB",desc:"NoSQL document database with scalability and flexibility"},{name:"Firebase",desc:"Google's platform for app development, hosting and more"}],u=n=>{h(n.name),l(n.desc)};return e.jsx("div",{className:"popup-container",children:e.jsxs("div",{className:"tech-form popup",children:[e.jsx("button",{type:"button",className:"close-button",onClick:()=>i(null),children:e.jsx(R,{icon:Q})}),e.jsxs("h2",{className:"form-title",children:[e.jsx(R,{icon:ve,className:"title-icon"}),"Add Technology"]}),e.jsxs("div",{className:"quick-select",children:[e.jsx("label",{children:"Quick Select:"}),e.jsx("div",{className:"quick-select-buttons",children:s.map((n,p)=>e.jsx("button",{type:"button",onClick:()=>u(n),className:"quick-select-btn",children:n.name},p))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"techTitle",children:"Technology Name"}),e.jsx("input",{type:"text",id:"techTitle",className:"form-control",value:o,onChange:n=>h(n.target.value),placeholder:"e.g., 'React', 'TensorFlow', 'AWS'"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"techDescription",children:"Description"}),e.jsx("textarea",{id:"techDescription",className:"form-control",value:c,onChange:n=>l(n.target.value),placeholder:"Describe how this technology was used in your project",rows:4})]}),d&&e.jsx("div",{className:"form-error",children:d}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>i(null),children:"Cancel"}),e.jsx("button",{type:"button",className:"submit-btn",onClick:m,children:"Add Technology"})]})]})})}function He({resources:t,setResources:r,setPopupWindow:i}){const[o,h]=a.useState(""),[c,l]=a.useState(""),[d,b]=a.useState(""),m=()=>{if(!o.trim()){b("Please enter a resource title");return}if(!c.trim()){b("Please enter a resource description");return}const u=[...t];u.push({title:o.trim(),description:c.trim()}),r(u),i(null)},s=[{type:"Book",prefix:"Book: "},{type:"Article",prefix:"Article: "},{type:"Video",prefix:"Video Tutorial: "},{type:"Documentation",prefix:"Documentation: "},{type:"Framework",prefix:"Framework: "},{type:"Library",prefix:"Library: "}];return e.jsx("div",{className:"popup-container",children:e.jsxs("div",{className:"resource-form popup",children:[e.jsx("button",{type:"button",className:"close-button",onClick:()=>i(null),children:e.jsx(R,{icon:Q})}),e.jsxs("h2",{className:"form-title",children:[e.jsx(R,{icon:ye,className:"title-icon"}),"Add Resource"]}),e.jsxs("div",{className:"resource-types",children:[e.jsx("label",{children:"Resource Type:"}),e.jsx("div",{className:"resource-type-buttons",children:s.map((u,n)=>e.jsx("button",{type:"button",className:"resource-type-btn",onClick:()=>h(u.prefix),children:u.type},n))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"resourceTitle",children:"Resource Title"}),e.jsx("input",{type:"text",id:"resourceTitle",className:"form-control",value:o,onChange:u=>h(u.target.value),placeholder:"e.g., 'Clean Code by Robert Martin', 'React Documentation'"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"resourceDescription",children:"Description"}),e.jsx("textarea",{id:"resourceDescription",className:"form-control",value:c,onChange:u=>l(u.target.value),placeholder:"Describe how this resource was helpful for your project",rows:4})]}),d&&e.jsx("div",{className:"form-error",children:d}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>i(null),children:"Cancel"}),e.jsxs("button",{type:"button",className:"submit-btn",onClick:m,children:[e.jsx(R,{icon:le})," Add Resource"]})]})]})})}function qe({dataSources:t,setDataSources:r,setPopupWindow:i}){const[o,h]=a.useState(""),[c,l]=a.useState(""),[d,b]=a.useState(""),[m,s]=a.useState(""),[u,n]=a.useState(""),p=()=>{if(!o){n("Please select a data source type");return}if(!c.trim()){n("Please enter a name for the data source");return}const f=[...t];f.push({type:o,name:c.trim(),size:d.trim(),link:m.trim()}),r(f),i(null)},v=["excel","csv","json","sql-server","mysql","mongodb","python","xml"];return e.jsx("div",{className:"popup-container",children:e.jsxs("div",{className:"datasource-form popup",children:[e.jsx("button",{type:"button",className:"close-button",onClick:()=>i(null),children:e.jsx(R,{icon:Q})}),e.jsxs("h2",{className:"form-title",children:[e.jsx(R,{icon:Ne,className:"title-icon"}),"Add Data Source"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dataSourceType",children:"Data Source Type"}),e.jsx("div",{className:"datasource-types",children:v.map((f,x)=>e.jsxs("div",{className:`datasource-type ${o===f?"selected":""}`,onClick:()=>h(f),children:[e.jsx("div",{className:"datasource-icon",children:e.jsx("img",{src:`/images/datasources/${f}.svg`,alt:f,onError:g=>{g.target.onError=null,g.target.src="/images/datasources/default.svg"}})}),e.jsx("span",{children:f})]},x))})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"dataSourceName",children:[e.jsx(R,{icon:we,className:"field-icon"}),"Data Source Name"]}),e.jsx("input",{type:"text",id:"dataSourceName",className:"form-control",value:c,onChange:f=>l(f.target.value),placeholder:"e.g., 'Customer Records', 'Transaction Data'"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"dataSourceSize",children:[e.jsx(R,{icon:Se,className:"field-icon"}),"Size/Records (optional)"]}),e.jsx("input",{type:"text",id:"dataSourceSize",className:"form-control",value:d,onChange:f=>b(f.target.value),placeholder:"e.g., '2.5 GB', '10,000 records'"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"dataSourceLink",children:[e.jsx(R,{icon:Ce,className:"field-icon"}),"Source Link (optional)"]}),e.jsx("input",{type:"text",id:"dataSourceLink",className:"form-control",value:m,onChange:f=>s(f.target.value),placeholder:"URL to the data source if publicly available"})]}),u&&e.jsx("div",{className:"form-error",children:u}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>i(null),children:"Cancel"}),e.jsx("button",{type:"button",className:"submit-btn",onClick:p,disabled:!o||!c,children:"Add Data Source"})]})]})})}const Be=({tags:t,setTags:r,label:i})=>{const[o,h]=a.useState(""),[c,l]=a.useState(!1),d=a.useRef(null),b=p=>{h(p.target.value)},m=p=>{p.key==="Enter"||p.key===","?(p.preventDefault(),s()):p.key==="Backspace"&&o===""&&t.length>0&&u(t.length-1)},s=()=>{const p=o.trim();p&&!t.includes(p)&&(r([...t,p]),h(""))},u=p=>{r(t.filter((v,f)=>f!==p))},n=()=>{d.current.focus()};return e.jsxs("div",{className:`tag-input-container ${c?"focused":""}`,onClick:n,children:[e.jsx("div",{className:"tag-input-icon",children:e.jsx(R,{icon:ke})}),e.jsx("div",{className:"tag-input-wrapper",children:e.jsxs("div",{className:"tag-input-field",children:[t.map((p,v)=>e.jsxs("div",{className:"tag",children:[e.jsx("span",{className:"tag-text",children:p}),e.jsx("span",{className:"tag-close",onClick:f=>{f.stopPropagation(),u(v)},children:e.jsx(R,{icon:De})})]},v)),e.jsx("input",{ref:d,type:"text",value:o,onChange:b,onKeyDown:m,onFocus:()=>l(!0),onBlur:()=>{l(!1),o&&s()},className:"tag-input",placeholder:t.length>0?"":"Type and press Enter to add tags"})]})}),e.jsx("div",{className:"tag-input-helper",children:"Press Enter or comma to add"})]})},G=[];for(let t=0;t<256;++t)G.push((t+256).toString(16).slice(1));function Ve(t,r=0){return(G[t[r+0]]+G[t[r+1]]+G[t[r+2]]+G[t[r+3]]+"-"+G[t[r+4]]+G[t[r+5]]+"-"+G[t[r+6]]+G[t[r+7]]+"-"+G[t[r+8]]+G[t[r+9]]+"-"+G[t[r+10]]+G[t[r+11]]+G[t[r+12]]+G[t[r+13]]+G[t[r+14]]+G[t[r+15]]).toLowerCase()}let te;const Me=new Uint8Array(16);function Oe(){if(!te){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");te=crypto.getRandomValues.bind(crypto)}return te(Me)}const ze=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ce={randomUUID:ze};function ee(t,r,i){var h;if(ce.randomUUID&&!t)return ce.randomUUID();t=t||{};const o=t.random??((h=t.rng)==null?void 0:h.call(t))??Oe();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,Ve(o)}const Z=({type:t="text",name:r,className:i="form__input",placeholder:o="",required:h=!0,value:c,onChange:l,label:d})=>e.jsxs("div",{className:"input-flow",children:[e.jsx("input",{type:t,name:r,className:i,placeholder:o,required:h,value:c,onChange:l,id:r}),e.jsx("label",{className:"form__label",htmlFor:r,children:d})]}),_e=({name:t})=>e.jsx("input",{type:"file",name:t}),Je=({name:t})=>e.jsxs("div",{className:"input-flow",children:[e.jsx("input",{type:"checkbox",name:t}),e.jsx("label",{className:"form__label",children:"Highlighted"})]}),K=({items:t,setItems:r,title:i,setPopupWindow:o,formComponent:h})=>{const c=(l,d)=>{l.preventDefault();let b=[...t];b.splice(d,1),r(b)};return e.jsxs("div",{className:"group-container",children:[e.jsxs("div",{className:"input-container",children:[e.jsx("h2",{className:"title",children:i}),e.jsx("input",{type:"button",className:"add-code-sample",value:`Add ${i}`,onClick:()=>{o(h)}})]}),t.length>0&&e.jsx("div",{className:"code-samples h-list",children:t.map((l,d)=>e.jsxs("li",{className:"tab tabSelected",children:[e.jsx("button",{className:"btn title",children:l.title}),e.jsx("button",{className:"btn closeTab",onClick:b=>c(b,d),children:"✕"})]},d))})]})};function We(){const[t,r]=a.useState(null),[i,o]=a.useState([]),[h,c]=a.useState([]),[l,d]=a.useState([]),[b,m]=a.useState([]),[s,u]=a.useState([]),[n,p]=a.useState([]),[v,f]=a.useState("Submit"),[x,g]=a.useState(!1),[D,F]=a.useState(""),[H,V]=a.useState(!1),I={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/projects/",token:localStorage.getItem("githubToken")||""},z=S=>new Promise((j,P)=>{const k=new FileReader;k.readAsDataURL(S),k.onload=()=>{const w=k.result.split(",")[1];j(w)},k.onerror=w=>P(w)}),_=async(S,j,P)=>{if(!S||!I.token)throw new Error("Missing file or GitHub token");try{const k=await z(S);let w=null;try{const T=await fetch(`https://api.github.com/repos/${I.owner}/${I.repo}/contents/${j}?ref=${I.branch}`,{headers:{Authorization:`token ${I.token}`,Accept:"application/vnd.github.v3+json"}});T.status===200&&(w=(await T.json()).sha)}catch{console.log(`File does not exist yet: ${j}`)}const y={message:P,content:k,branch:I.branch};w&&(y.sha=w);const E=await fetch(`https://api.github.com/repos/${I.owner}/${I.repo}/contents/${j}`,{method:"PUT",headers:{Authorization:`token ${I.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(y)}),L=await E.json();if(E.status===200||E.status===201)return L;throw new Error(`GitHub API Error: ${L.message}`)}catch(k){throw console.error("Error committing to GitHub:",k),k}},C=async(S,j,P,k,w)=>{V(!0),F("Starting to commit images to GitHub...");try{const y=I.baseImagePath+w,E=`${y}/carousel`,L=[];if(S){const T=Date.now(),q=`${y}/${j}`;F(`Committing main image: ${j}`);const B=_(S,q,`Add project main image: ${j}`);L.push(B)}for(let T=0;T<P.length;T++){const q=P[T];if(q.img&&q.img[0]){const B=k[T],A=`${E}/${B}`;F(`Committing carousel image ${T+1}/${P.length}: ${B}`);const U=_(q.img[0],A,`Add project carousel image: ${B}`);L.push(U)}}return await Promise.all(L),F("All images successfully committed to GitHub!"),setTimeout(()=>{F(""),V(!1)},3e3),!0}catch(y){return console.error("Error committing images to GitHub:",y),F(`Error committing images: ${y.message}`),V(!1),!1}},N=async S=>{if(S.preventDefault(),!x){g(!0),f("Submitting...");try{const j=new FormData(S.target),P=j.get("image");if(P&&P.type!=="image/webp"){alert("Only .webp images are accepted for the main image."),f("Submit"),g(!1);return}if(!I.token){const A=prompt("Please enter your GitHub token to commit images:");if(!A){alert("GitHub token is required to commit images."),f("Submit"),g(!1);return}localStorage.setItem("githubToken",A),I.token=A}const k=ee().replace(/-/g,"").substring(0,24),y=`${`public/images/projects/${k}`}/carousel`,E={_id:k,title:j.get("title"),description:j.get("description"),githubLink:j.get("githubLink"),startDate:j.get("startDate")?new Date(j.get("startDate")).toISOString():null,endDate:j.get("endDate")?new Date(j.get("endDate")).toISOString():null,durration:j.get("endDate")?"completed":"ongoing",highlighted:j.get("highlighted")==="on"?"star":"basic",tags:n,showInOverview:!1,codeSamples:i,dataSources:s,tools:{techs:l.map((A,U)=>({_id:`${k}${U}t`,title:A.title,description:A.description})),resources:b.map((A,U)=>({_id:`${k}${U}r`,title:A.title,description:A.description}))},carouselImages:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),__v:0},L=Date.now();let T=null;P&&(T=`${L}.webp`,E.image=`/images/projects/${k}/${T}`);let q=[];for(let A=0;A<h.length;A++){const U=h[A];if(U.img&&U.img[0]){if(U.img[0].type!=="image/webp"){alert(`Only .webp images are accepted for carousel image ${A+1}.`),f("Submit"),g(!1);return}const M=`${L}-${A}.webp`;q.push(M),E.carouselImages.push({_id:`${k}${A}c`,img:`/images/projects/${k}/carousel/${M}`,title:U.title})}}f("Saving to Firebase...");const B=se(O,"projects",k);await me(B,E),f("Committing images..."),await C(P,T,h,q,k),f("Successfully Submitted!"),setTimeout(()=>{S.target.reset(),o([]),c([]),d([]),m([]),u([]),p([]),f("Submit"),g(!1)},3e3)}catch(j){console.error("Error submitting project:",j),f("Error: Please try again"),g(!1)}}};a.useEffect(()=>{const S=()=>{f("Submit")},j=document.querySelectorAll("input, textarea");return j.forEach(P=>{P.addEventListener("input",S)}),()=>{j.forEach(P=>{P.removeEventListener("input",S)})}},[]);const $=[e.jsx(Ge,{codeSamples:i,setCodeSamples:o,setPopupWindow:r}),e.jsx(Le,{carouselSamples:h,setCarouselSamples:c,setPopupWindow:r}),e.jsx(Ue,{techs:l,setTechs:d,setPopupWindow:r}),e.jsx(He,{resources:b,setResources:m,setPopupWindow:r}),e.jsx(qe,{dataSources:s,setDataSources:u,setPopupWindow:r})];return e.jsxs("form",{onSubmit:N,className:"filldb-form project-form",children:[e.jsx("h1",{className:"project-form__title",children:"Create New Project"}),e.jsx("br",{}),e.jsxs("div",{className:"input-container",children:[e.jsx(Z,{name:"title",label:"Title"}),e.jsx(Z,{name:"githubLink",label:"Github Link"})]}),e.jsxs("div",{className:"input-container",children:[e.jsx(Z,{type:"date",name:"startDate",label:"Start Date"}),e.jsx(Z,{type:"date",name:"endDate",required:!1,label:"End Date"})]}),e.jsx("textarea",{className:"description",type:"text",name:"description",required:!0,placeholder:"Write a Brief Description of the Project"}),e.jsx(_e,{name:"image"}),e.jsx("br",{}),e.jsx(K,{items:i,setItems:o,title:"Code Samples",formComponent:$[0],setPopupWindow:r}),e.jsx(K,{items:h,setItems:c,title:"Carousels",formComponent:$[1],setPopupWindow:r}),e.jsx(K,{items:l,setItems:d,title:"Technologies",formComponent:$[2],setPopupWindow:r}),e.jsx(K,{items:b,setItems:m,title:"Resources",formComponent:$[3],setPopupWindow:r}),e.jsx(K,{items:s,setItems:u,title:"Data Sources",formComponent:$[4],setPopupWindow:r}),t,e.jsx("br",{}),e.jsx("br",{}),e.jsx(Je,{name:"highlighted"}),e.jsx(Be,{tags:n,setTags:p}),e.jsx("input",{type:"submit",value:v,disabled:x||H,className:x||H?"submitting":""}),(H||D)&&e.jsxs("div",{className:`commit-status ${D.includes("Error")?"error":D.includes("success")?"success":"info"}`,children:[D,H&&e.jsx("div",{className:"spinner"})]})]})}function Qe(){const[t,r]=a.useState({name:"",description:"",date:new Date().toLocaleString()}),[i,o]=a.useState(null),[h,c]=a.useState(null),[l,d]=a.useState(null),[b,m]=a.useState(""),[s,u]=a.useState(!1),[n,p]=a.useState({type:"",text:""}),[v,f]=a.useState({}),x=a.useRef(null),g=a.useRef(null),[D,F]=a.useState(""),[H,V]=a.useState(!1),I={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/reports/",basePdfPath:"public/reports/",token:localStorage.getItem("githubToken")||""},z=w=>{const{name:y,value:E}=w.target;r({...t,[y]:E}),v[y]&&f({...v,[y]:""})},_=w=>{const y=w.target.files[0];if(y){c(y);const E=new FileReader;E.onload=()=>{d(E.result)},E.readAsDataURL(y),v.coverImage&&f({...v,coverImage:""})}},C=w=>{const y=w.target.files[0];y&&(o(y),m(y.name),t.name.trim()||r({...t,name:y.name}),v.pdf&&f({...v,pdf:""}))},N=()=>{const w={};return t.name.trim()||(w.name="Report name is required"),t.description.trim()||(w.description="Description is required"),h||(w.coverImage="Cover image is required"),i||(w.pdf="PDF file is required"),f(w),Object.keys(w).length===0},$=w=>new Promise((y,E)=>{const L=new FileReader;L.readAsDataURL(w),L.onload=()=>{const T=L.result.split(",")[1];y(T)},L.onerror=T=>E(T)}),S=async(w,y,E)=>{if(!w||!I.token)throw new Error("Missing file or GitHub token");try{const L=await $(w);let T=null;try{const U=await fetch(`https://api.github.com/repos/${I.owner}/${I.repo}/contents/${y}?ref=${I.branch}`,{headers:{Authorization:`token ${I.token}`,Accept:"application/vnd.github.v3+json"}});U.status===200&&(T=(await U.json()).sha)}catch{console.log(`File does not exist yet: ${y}`)}const q={message:E,content:L,branch:I.branch};T&&(q.sha=T);const B=await fetch(`https://api.github.com/repos/${I.owner}/${I.repo}/contents/${y}`,{method:"PUT",headers:{Authorization:`token ${I.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(q)}),A=await B.json();if(B.status===200||B.status===201)return A;throw new Error(`GitHub API Error: ${A.message}`)}catch(L){throw console.error("Error committing to GitHub:",L),L}},j=async w=>{if(w.preventDefault(),!!N())try{if(u(!0),!I.token){const M=prompt("Please enter your GitHub token to commit files:");if(!M){p({type:"error",text:"GitHub token is required to commit files."}),u(!1);return}localStorage.setItem("githubToken",M),I.token=M}const y=ee().replace(/-/g,"").substring(0,24),E=Date.now(),L=h.name.split(".").pop(),T=i.name.replace(/[^a-zA-Z0-9.]/g,"_"),q=`${I.basePdfPath}${y}_${T}`,B=`${y}-cover.${L}`,A=`${I.baseImagePath}${B}`;V(!0);try{F("Committing cover image to GitHub..."),await S(h,A,`Add report cover image for: ${t.name}`),F("Committing PDF file to GitHub..."),await S(i,q,`Add report PDF: ${t.name}`),F("Files successfully committed to GitHub!")}catch(M){throw F(`Error committing files: ${M.message}`),M}const U={_id:y,name:t.name,description:t.description,date:t.date,coverImage:`/images/reports/${B}`,pdfPath:`/reports/${y}_${T}`,createdAt:W(),updatedAt:W()};await ie(J(O,"reports"),U),r({name:"",description:"",date:new Date().toLocaleString()}),o(null),m(""),c(null),d(null),x.current&&(x.current.value=""),g.current&&(g.current.value=""),p({type:"success",text:"Report added successfully!"}),setTimeout(()=>{F(""),V(!1)},3e3),setTimeout(()=>{p({type:"",text:""})},5e3)}catch(y){console.error("Error adding report:",y),p({type:"error",text:`Error adding report: ${y.message}`}),V(!1)}finally{u(!1)}},P=()=>{x.current.click()},k=()=>{g.current.click()};return e.jsxs("div",{className:"reports-form-container",children:[e.jsxs("div",{className:"report-form-header",children:[e.jsx("h1",{className:"report-form-title",children:"Add New Report"}),e.jsx("p",{className:"report-form-subtitle",children:"Upload documents, reports, and presentations to showcase your work"})]}),n.text&&e.jsx("div",{className:`report-message ${n.type}`,children:n.text}),e.jsxs("form",{onSubmit:j,className:"report-form",children:[e.jsxs("div",{className:"report-form-grid",children:[e.jsxs("div",{className:"report-form-fields",children:[e.jsxs("div",{className:"report-form-group",children:[e.jsx("label",{htmlFor:"name",children:"Report Name*"}),e.jsx("input",{type:"text",id:"name",name:"name",value:t.name,onChange:z,className:v.name?"error":"",placeholder:"e.g., Business Proposal Q1 2024"}),v.name&&e.jsx("div",{className:"error-text",children:v.name})]}),e.jsxs("div",{className:"report-form-group",children:[e.jsx("label",{htmlFor:"description",children:"Description*"}),e.jsx("textarea",{id:"description",name:"description",value:t.description,onChange:z,className:v.description?"error":"",placeholder:"Briefly describe what this report contains...",rows:4}),v.description&&e.jsx("div",{className:"error-text",children:v.description})]}),e.jsxs("div",{className:"report-form-group",children:[e.jsx("label",{htmlFor:"date",children:"Date"}),e.jsx("input",{type:"text",id:"date",name:"date",value:t.date,onChange:z,placeholder:"e.g., 2/27/2025 10:42 AM"}),e.jsx("small",{className:"form-help-text",children:"Default: current date and time"})]}),e.jsxs("div",{className:"report-form-group",children:[e.jsx("label",{children:"PDF File*"}),e.jsxs("div",{className:`report-pdf-selector ${v.pdf?"error-border":""} ${i?"has-file":""}`,onClick:k,children:[i?e.jsxs("div",{className:"selected-file",children:[e.jsx("div",{className:"file-icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("polyline",{points:"10 9 9 9 8 9"})]})}),e.jsxs("div",{className:"file-details",children:[e.jsx("span",{className:"file-name",children:b}),e.jsx("span",{className:"file-type",children:"PDF Document"})]})]}):e.jsxs("div",{className:"upload-placeholder pdf-placeholder",children:[e.jsx("div",{className:"upload-icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M12 18v-6"}),e.jsx("path",{d:"M8 15l4 4 4-4"})]})}),e.jsx("p",{children:"Click to upload PDF document"}),e.jsx("span",{children:"PDF files only (Max 20MB)"})]}),e.jsx("input",{ref:g,type:"file",accept:".pdf",onChange:C,style:{display:"none"}})]}),v.pdf&&e.jsx("div",{className:"error-text",children:v.pdf})]})]}),e.jsxs("div",{className:"report-image-upload",children:[e.jsx("label",{className:"cover-image-label",children:"Cover Image*"}),e.jsxs("div",{className:`report-image-preview ${v.coverImage?"error-border":""} ${l?"has-image":""}`,onClick:P,children:[l?e.jsx("img",{src:l,alt:"Cover preview"}):e.jsxs("div",{className:"upload-placeholder",children:[e.jsx("div",{className:"upload-icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),e.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),e.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),e.jsx("p",{children:"Click to upload cover image"}),e.jsx("span",{children:"PNG, JPG or WEBP (Min: 800x600px)"})]}),e.jsx("input",{ref:x,type:"file",accept:"image/*",onChange:_,style:{display:"none"}})]}),v.coverImage&&e.jsx("div",{className:"error-text",children:v.coverImage})]})]}),e.jsx("div",{className:"report-form-actions",children:e.jsx("button",{type:"submit",className:"report-submit-button",disabled:s||H,children:s||H?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:H?"Committing...":"Uploading..."})]}):"Add Report"})}),(H||D)&&e.jsxs("div",{className:`commit-status ${D.includes("Error")?"error":D.includes("success")?"success":"info"}`,children:[D,H&&!D.includes("success")&&e.jsx("div",{className:"spinner"})]})]})]})}function Ke({setAuthenticated:t}){const[r,i]=a.useState(!1),[o,h]=a.useState(null),[c,l]=a.useState(!1),d="abdobella977@gmail.com";a.useEffect(()=>{h(null),l(!1)},[]),a.useEffect(()=>{if(o&&!c){const m=setTimeout(()=>{h(null)},5e3);return()=>clearTimeout(m)}},[o,c]);const b=async()=>{i(!0),h(null),l(!1);const m=ae(),s=new oe;try{const u=await ue(m,s),n=u.user,v=oe.credentialFromResult(u).accessToken;if(console.log("User email:",n.email),console.log("Authorized email:",d),n.email!==d){console.log("Unauthorized access attempt"),await re(m),l(!0),h("You are not my owner! Get the hell out of here!"),localStorage.removeItem("firebaseAuthUser"),t(!1);return}localStorage.setItem("firebaseAuthUser",JSON.stringify({uid:n.uid,displayName:n.displayName,email:n.email,photoURL:n.photoURL})),t(!0)}catch(u){u.code;const n=u.message;console.error("Login error:",u),h(`Login failed: ${n}`)}finally{i(!1)}};return e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-form",children:[e.jsx("h1",{className:"login-title",children:"Admin Access"}),e.jsx("p",{className:"login-subtitle",children:"Sign in with your GitHub account to access the admin panel"}),e.jsxs("button",{className:"github-login-btn",onClick:b,disabled:r,children:[e.jsx(R,{icon:xe,className:"github-icon"}),r?"Connecting...":"Sign in with GitHub"]}),o&&e.jsxs("div",{className:`login-error ${c?"unauthorized":""}`,children:[c&&e.jsx(R,{icon:Ie,className:"error-icon"}),o]})]})})}function Ye(){const[t,r]=a.useState([]),[i,o]=a.useState([]);a.useEffect(()=>{(async()=>{try{const d=J(O,"projects"),m=(await Y(d)).docs.map(s=>({id:s.id,...s.data()}));r(m),console.log(m)}catch(d){console.error("Error fetching projects:",d)}})()},[]);const h=Math.ceil(t.length/3),c=async()=>{try{const l=J(O,"projects"),b=(await Y(l)).docs.map(async u=>{const n=se(O,"projects",u.id);await ne(n,{showInOverview:!1})});await Promise.all(b);const s=i.map(u=>u.id).map(async u=>{const n=se(O,"projects",u);await ne(n,{showInOverview:!0})});await Promise.all(s),alert("Featured projects updated successfully!")}catch(l){console.error("Error updating featured projects:",l),alert("Failed to update featured projects. See console for details.")}};return e.jsxs("div",{className:"arrange-projects-form filldb-form",children:[e.jsx("div",{className:"highlighted-projects",children:i.length>0&&i.filter((l,d)=>d<3).map(l=>e.jsx("div",{className:"highlighted-project",onClick:()=>{o(i.filter(d=>d!==l))},children:e.jsx("h3",{children:l.title})},l.id||l.title))}),e.jsx("div",{className:"scrollable-grid",children:e.jsx("div",{style:{display:"flex",flexWrap:"wrap"},children:t.length>0&&t.map(l=>e.jsx("div",{style:{flex:`1 0 ${100/h}%`},className:"project",onClick:()=>{if(i.includes(l))o(i.filter(d=>d!==l));else{if(i.length===3)return;o([...i,l])}},children:e.jsx("h3",{children:l.title})},l.id||l.title))})}),e.jsx("button",{className:"validate-btn",onClick:()=>c(),children:"Validate"})]})}function Ze(){const[t,r]=a.useState({certificateTitle:"",issuer:"",link:"",downloadPath:""}),[i,o]=a.useState(null),[h,c]=a.useState(null),[l,d]=a.useState(!1),[b,m]=a.useState({type:"",text:""}),[s,u]=a.useState({}),n=a.useRef(null),[p,v]=a.useState(""),[f,x]=a.useState(!1),g={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/certificates/",token:localStorage.getItem("githubToken")||""},D=C=>{const{name:N,value:$}=C.target;r({...t,[N]:$}),s[N]&&u({...s,[N]:""})},F=C=>{const N=C.target.files[0];if(N){o(N);const $=new FileReader;$.onload=()=>{c($.result)},$.readAsDataURL(N),s.image&&u({...s,image:""})}},H=()=>{const C={};return t.certificateTitle.trim()||(C.certificateTitle="Title is required"),t.issuer.trim()||(C.issuer="Issuer is required"),t.link.trim()||(C.link="Link is required"),t.downloadPath.trim()||(C.downloadPath="Download path is required"),i||(C.image="Certificate image is required"),u(C),Object.keys(C).length===0},V=C=>new Promise((N,$)=>{const S=new FileReader;S.readAsDataURL(C),S.onload=()=>{const j=S.result.split(",")[1];N(j)},S.onerror=j=>$(j)}),I=async(C,N,$)=>{if(!C||!g.token)throw new Error("Missing file or GitHub token");try{const S=await V(C);let j=null;try{const y=await fetch(`https://api.github.com/repos/${g.owner}/${g.repo}/contents/${N}?ref=${g.branch}`,{headers:{Authorization:`token ${g.token}`,Accept:"application/vnd.github.v3+json"}});y.status===200&&(j=(await y.json()).sha)}catch{console.log(`File does not exist yet: ${N}`)}const P={message:$,content:S,branch:g.branch};j&&(P.sha=j);const k=await fetch(`https://api.github.com/repos/${g.owner}/${g.repo}/contents/${N}`,{method:"PUT",headers:{Authorization:`token ${g.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(P)}),w=await k.json();if(k.status===200||k.status===201)return w;throw new Error(`GitHub API Error: ${w.message}`)}catch(S){throw console.error("Error committing to GitHub:",S),S}},z=async C=>{if(C.preventDefault(),!!H())try{if(d(!0),!g.token){const w=prompt("Please enter your GitHub token to commit images:");if(!w){m({type:"error",text:"GitHub token is required to commit images."}),d(!1);return}localStorage.setItem("githubToken",w),g.token=w}const N=ee().replace(/-/g,"").substring(0,24),$=Date.now(),S=i.name.split(".").pop(),j=`${N}.${S}`,P=`${g.baseImagePath}${j}`;x(!0),v("Committing certificate image to GitHub...");try{await I(i,P,`Add certificate image: ${t.certificateTitle}`),v("Image successfully committed to GitHub!")}catch(w){throw v(`Error committing image: ${w.message}`),w}const k={_id:N,certificateTitle:t.certificateTitle,issuer:t.issuer,link:t.link,downloadPath:t.downloadPath,image:`/images/certificates/${j}`,createdAt:W(),updatedAt:W(),__v:0};await ie(J(O,"certificates"),k),r({certificateTitle:"",issuer:"",link:"",downloadPath:""}),o(null),c(null),n.current&&(n.current.value=""),m({type:"success",text:"Certificate added successfully!"}),setTimeout(()=>{v(""),x(!1)},3e3),setTimeout(()=>{m({type:"",text:""})},5e3)}catch(N){console.error("Error adding certificate:",N),m({type:"error",text:`Error adding certificate: ${N.message}`}),x(!1)}finally{d(!1)}},_=()=>{n.current.click()};return e.jsxs("div",{className:"certificates-form-container",children:[e.jsxs("div",{className:"certificate-form-header",children:[e.jsx("h1",{className:"certificate-form-title",children:"Add New Certificate"}),e.jsx("p",{className:"certificate-form-subtitle",children:"Add your professional certificates and achievements to showcase your expertise"})]}),b.text&&e.jsx("div",{className:`certificate-message ${b.type}`,children:b.text}),e.jsxs("form",{onSubmit:z,className:"certificate-form",children:[e.jsxs("div",{className:"certificate-form-grid",children:[e.jsxs("div",{className:"certificate-form-fields",children:[e.jsxs("div",{className:"certificate-form-group",children:[e.jsx("label",{htmlFor:"title",children:"Certificate Title*"}),e.jsx("input",{type:"text",id:"title",name:"certificateTitle",value:t.certificateTitle,onChange:D,className:s.certificateTitle?"error":"",placeholder:"e.g., AWS Certified Solutions Architect"}),s.certificateTitle&&e.jsx("div",{className:"error-text",children:s.certificateTitle})]}),e.jsxs("div",{className:"certificate-form-group",children:[e.jsx("label",{htmlFor:"issuer",children:"Issuing Organization*"}),e.jsx("input",{type:"text",id:"issuer",name:"issuer",value:t.issuer,onChange:D,className:s.issuer?"error":"",placeholder:"e.g., Amazon Web Services"}),s.issuer&&e.jsx("div",{className:"error-text",children:s.issuer})]}),e.jsxs("div",{className:"certificate-form-group",children:[e.jsx("label",{htmlFor:"link",children:"Certificate Link*"}),e.jsx("input",{type:"text",id:"link",name:"link",value:t.link,onChange:D,className:s.link?"error":"",placeholder:"https://verify.example.com/cert/123"}),s.link&&e.jsx("div",{className:"error-text",children:s.link})]}),e.jsxs("div",{className:"certificate-form-group",children:[e.jsx("label",{htmlFor:"downloadPath",children:"Download Link*"}),e.jsx("input",{type:"text",id:"downloadPath",name:"downloadPath",value:t.downloadPath,onChange:D,className:s.downloadPath?"error":"",placeholder:"https://example.com/download/certificate.pdf"}),s.downloadPath&&e.jsx("div",{className:"error-text",children:s.downloadPath})]})]}),e.jsxs("div",{className:"certificate-image-upload",children:[e.jsxs("div",{className:`certificate-image-preview ${s.image?"error-border":""} ${h?"has-image":""}`,onClick:_,children:[h?e.jsx("img",{src:h,alt:"Certificate preview"}):e.jsxs("div",{className:"upload-placeholder",children:[e.jsx("div",{className:"upload-icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),e.jsx("p",{children:"Click to upload certificate image"}),e.jsx("span",{children:"PNG, JPG or WEBP (Max 5MB)"})]}),e.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:F,style:{display:"none"}})]}),s.image&&e.jsx("div",{className:"error-text",children:s.image})]})]}),e.jsx("div",{className:"certificate-form-actions",children:e.jsx("button",{type:"submit",className:"certificate-submit-button",disabled:l||f,children:l||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:f?"Committing...":"Uploading..."})]}):"Add Certificate"})}),(f||p)&&e.jsxs("div",{className:`commit-status ${p.includes("Error")?"error":p.includes("success")?"success":"info"}`,children:[p,f&&!p.includes("success")&&e.jsx("div",{className:"spinner"})]})]})]})}function Xe(){const[t,r]=a.useState({name:"",description:"",profession:"",company:""}),[i,o]=a.useState(null),[h,c]=a.useState(null),[l,d]=a.useState(!1),[b,m]=a.useState({type:"",text:""}),[s,u]=a.useState({}),n=a.useRef(null),[p,v]=a.useState(""),[f,x]=a.useState(!1),g={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/clients/",token:localStorage.getItem("githubToken")||""},D=C=>{const{name:N,value:$}=C.target;r({...t,[N]:$}),s[N]&&u({...s,[N]:""})},F=C=>{const N=C.target.files[0];if(N){o(N);const $=new FileReader;$.onload=()=>{c($.result)},$.readAsDataURL(N),s.image&&u({...s,image:""})}},H=()=>{const C={};return t.name.trim()||(C.name="Client name is required"),t.description.trim()||(C.description="Description is required"),t.profession.trim()||(C.profession="Profession is required"),t.company.trim()||(C.company="Company name is required"),i||(C.image="Client image is required"),u(C),Object.keys(C).length===0},V=C=>new Promise((N,$)=>{const S=new FileReader;S.readAsDataURL(C),S.onload=()=>{const j=S.result.split(",")[1];N(j)},S.onerror=j=>$(j)}),I=async(C,N,$)=>{if(!C||!g.token)throw new Error("Missing file or GitHub token");try{const S=await V(C);let j=null;try{const y=await fetch(`https://api.github.com/repos/${g.owner}/${g.repo}/contents/${N}?ref=${g.branch}`,{headers:{Authorization:`token ${g.token}`,Accept:"application/vnd.github.v3+json"}});y.status===200&&(j=(await y.json()).sha)}catch{console.log(`File does not exist yet: ${N}`)}const P={message:$,content:S,branch:g.branch};j&&(P.sha=j);const k=await fetch(`https://api.github.com/repos/${g.owner}/${g.repo}/contents/${N}`,{method:"PUT",headers:{Authorization:`token ${g.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(P)}),w=await k.json();if(k.status===200||k.status===201)return w;throw new Error(`GitHub API Error: ${w.message}`)}catch(S){throw console.error("Error committing to GitHub:",S),S}},z=async C=>{if(C.preventDefault(),!!H())try{if(d(!0),!g.token){const k=prompt("Please enter your GitHub token to commit images:");if(!k){m({type:"error",text:"GitHub token is required to commit images."}),d(!1);return}localStorage.setItem("githubToken",k),g.token=k}const N=ee().replace(/-/g,"").substring(0,24),$=i.name.split(".").pop(),S=`${N}.${$}`,j=`${g.baseImagePath}${S}`;x(!0),v("Committing client image to GitHub...");try{await I(i,j,`Add client image: ${t.name}`),v("Image successfully committed to GitHub!")}catch(k){throw v(`Error committing image: ${k.message}`),k}const P={_id:N,name:t.name,description:t.description,profession:t.profession,company:t.company,image:`/images/clients/${S}`,createdAt:W(),updatedAt:W()};await ie(J(O,"clients"),P),r({name:"",description:"",profession:"",company:""}),o(null),c(null),n.current&&(n.current.value=""),m({type:"success",text:"Client added successfully!"}),setTimeout(()=>{v(""),x(!1)},3e3),setTimeout(()=>{m({type:"",text:""})},5e3)}catch(N){console.error("Error adding client:",N),m({type:"error",text:`Error adding client: ${N.message}`}),x(!1)}finally{d(!1)}},_=()=>{n.current.click()};return e.jsxs("div",{className:"clients-form-container",children:[e.jsxs("div",{className:"client-form-header",children:[e.jsx("h1",{className:"client-form-title",children:"Add New Client"}),e.jsx("p",{className:"client-form-subtitle",children:"Add clients and testimonials to showcase your professional connections"})]}),b.text&&e.jsx("div",{className:`client-message ${b.type}`,children:b.text}),e.jsxs("form",{onSubmit:z,className:"client-form",children:[e.jsxs("div",{className:"client-form-grid",children:[e.jsxs("div",{className:"client-form-fields",children:[e.jsxs("div",{className:"client-form-group",children:[e.jsx("label",{htmlFor:"name",children:"Client Name*"}),e.jsx("input",{type:"text",id:"name",name:"name",value:t.name,onChange:D,className:s.name?"error":"",placeholder:"e.g., John Smith"}),s.name&&e.jsx("div",{className:"error-text",children:s.name})]}),e.jsxs("div",{className:"client-form-group",children:[e.jsx("label",{htmlFor:"profession",children:"Client Profession*"}),e.jsx("input",{type:"text",id:"profession",name:"profession",value:t.profession,onChange:D,className:s.profession?"error":"",placeholder:"e.g., Marketing Director"}),s.profession&&e.jsx("div",{className:"error-text",children:s.profession})]}),e.jsxs("div",{className:"client-form-group",children:[e.jsx("label",{htmlFor:"company",children:"Company/Organization*"}),e.jsx("input",{type:"text",id:"company",name:"company",value:t.company,onChange:D,className:s.company?"error":"",placeholder:"e.g., Acme Inc."}),s.company&&e.jsx("div",{className:"error-text",children:s.company})]}),e.jsxs("div",{className:"client-form-group",children:[e.jsx("label",{htmlFor:"description",children:"Client Testimonial/Description*"}),e.jsx("textarea",{id:"description",name:"description",value:t.description,onChange:D,className:s.description?"error":"",placeholder:"What they said about your work...",rows:5}),s.description&&e.jsx("div",{className:"error-text",children:s.description})]})]}),e.jsxs("div",{className:"client-image-upload",children:[e.jsxs("div",{className:`client-image-preview ${s.image?"error-border":""} ${h?"has-image":""}`,onClick:_,children:[h?e.jsx("img",{src:h,alt:"Client preview"}):e.jsxs("div",{className:"upload-placeholder",children:[e.jsx("div",{className:"upload-icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),e.jsx("p",{children:"Click to upload client photo"}),e.jsx("span",{children:"Square image recommended (1:1)"})]}),e.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:F,style:{display:"none"}})]}),s.image&&e.jsx("div",{className:"error-text",children:s.image})]})]}),e.jsx("div",{className:"client-form-actions",children:e.jsx("button",{type:"submit",className:"client-submit-button",disabled:l||f,children:l||f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:f?"Committing...":"Uploading..."})]}):"Add Client"})}),(f||p)&&e.jsxs("div",{className:`commit-status ${p.includes("Error")?"error":p.includes("success")?"success":"info"}`,children:[p,f&&!p.includes("success")&&e.jsx("div",{className:"spinner"})]})]})]})}function et(){const[t,r]=a.useState({totalVisitors:0,recentVisitors:[],topPages:[],loading:!0,error:null});return a.useEffect(()=>{(async()=>{try{const o=J(O,"visitors"),h=await Y(o),c=pe(o,he("timestamp","desc"),ge(10)),d=(await Y(c)).docs.map(n=>{var p,v;return{id:n.id,...n.data(),timestamp:((v=(p=n.data().timestamp)==null?void 0:p.toDate)==null?void 0:v.call(p))||new Date}}),b=J(O,"pageViews"),m=await Y(b),s={};m.docs.forEach(n=>{const p=n.data().path;p&&(s[p]=(s[p]||0)+1)});const u=Object.entries(s).map(([n,p])=>({path:n,count:p})).sort((n,p)=>p.count-n.count).slice(0,5);r({totalVisitors:h.size,recentVisitors:d,topPages:u,loading:!1,error:null})}catch(o){console.error("Error fetching visitor stats:",o),r(h=>({...h,loading:!1,error:"Failed to load visitor statistics"}))}})()},[]),t.loading?e.jsx("div",{className:"loading",children:"Loading visitor statistics..."}):t.error?e.jsx("div",{className:"error",children:t.error}):e.jsxs("div",{className:"visitor-stats",children:[e.jsx("h2",{children:"Visitor Statistics"}),e.jsxs("div",{className:"stats-card",children:[e.jsx("h3",{children:"Total Unique Visitors"}),e.jsx("div",{className:"stat-number",children:t.totalVisitors})]}),e.jsxs("div",{className:"stats-section",children:[e.jsx("h3",{children:"Top Pages"}),e.jsx("ul",{className:"top-pages",children:t.topPages.map((i,o)=>e.jsxs("li",{children:[e.jsx("span",{className:"page-path",children:i.path||"/"}),e.jsxs("span",{className:"page-count",children:[i.count," views"]})]},o))})]}),e.jsxs("div",{className:"stats-section",children:[e.jsx("h3",{children:"Recent Visitors"}),e.jsxs("table",{className:"visitors-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"IP Address"}),e.jsx("th",{children:"Browser"}),e.jsx("th",{children:"OS"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:t.recentVisitors.map((i,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:i.ip}),e.jsx("td",{children:i.browser}),e.jsx("td",{children:i.operatingSystem}),e.jsx("td",{children:i.timestamp.toLocaleString()})]},o))})]})]})]})}const X=[{id:0,label:"Project",component:e.jsx(We,{})},{id:1,label:"Arrange Projects",component:e.jsx(Ye,{})},{id:2,label:"Certificate",component:e.jsx(Ze,{})},{id:4,label:"Report",component:e.jsx(Qe,{})},{id:5,label:"Clients",component:e.jsx(Xe,{})},{id:6,label:"Visitor Stats",component:e.jsx(et,{})}];function it(){const[t,r]=a.useState(!1),[i,o]=a.useState(X[0].id),[h,c]=a.useState(null),[l,d]=a.useState(!1);a.useEffect(()=>{const m=ae(),s=fe(m,u=>{if(u)u.email==="abdobella977@gmail.com"?(c(u),r(!0),localStorage.setItem("firebaseAuthUser",JSON.stringify({uid:u.uid,displayName:u.displayName,email:u.email,photoURL:u.photoURL}))):re(m).then(()=>{c(null),r(!1),localStorage.removeItem("firebaseAuthUser")});else{c(null);const n=localStorage.getItem("firebaseAuthUser");if(n){const p=JSON.parse(n);p.email==="abdobella977@gmail.com"?(r(!0),c(p)):(localStorage.removeItem("firebaseAuthUser"),r(!1))}else r(!1)}d(!0)});return()=>s()},[]),a.useEffect(()=>{var m;t&&console.log(`Tab changed to: ${(m=X[i])==null?void 0:m.label}`)},[i,t]);const b=async()=>{const m=ae();try{await re(m),localStorage.removeItem("firebaseAuthUser"),localStorage.removeItem("githubToken"),r(!1),c(null)}catch(s){console.error("Error signing out: ",s)}};return l?e.jsx(e.Fragment,{children:t?e.jsxs("div",{className:"filldb-container",children:[e.jsxs("div",{className:"buttons",children:[h&&e.jsxs("div",{className:"user-profile",children:[e.jsx("img",{src:h.photoURL,alt:h.displayName,className:"user-avatar",onError:m=>{m.target.onerror=null,m.target.src="https://via.placeholder.com/30"}}),e.jsx("span",{className:"user-name",children:h.displayName})]}),X.map(m=>e.jsx("button",{className:`filldb-nav__btn ${i===m.id?"active":""}`,onClick:()=>o(m.id),children:m.label},m.id)),e.jsx("button",{className:"filldb-nav__btn logout-btn",onClick:b,children:"Logout"})]}),e.jsx("div",{className:"tab-content",children:X.map(m=>i===m.id&&m.component)})]}):e.jsx(Ke,{setAuthenticated:r})}):e.jsx("div",{className:"loading-auth",children:"Checking authentication..."})}export{it as default};
