var Ys=Object.defineProperty;var fs=H=>{throw TypeError(H)};var Ks=(H,a,G)=>a in H?Ys(H,a,{enumerable:!0,configurable:!0,writable:!0,value:G}):H[a]=G;var Kt=(H,a,G)=>Ks(H,typeof a!="symbol"?a+"":a,G),je=(H,a,G)=>a.has(H)||fs("Cannot "+G);var t=(H,a,G)=>(je(H,a,"read from private field"),G?G.call(H):a.get(H)),rt=(H,a,G)=>a.has(H)?fs("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(H):a.set(H,G),lt=(H,a,G,n)=>(je(H,a,"write to private field"),n?n.call(H,G):a.set(H,G),G),Y=(H,a,G)=>(je(H,a,"access private method"),G);var he=(H,a,G,n)=>({set _(_){lt(H,a,_,G)},get _(){return t(H,a,n)}});import{r as reactExports,j as jsxRuntimeExports,i as doc,f as db,t as setDoc,l as getAugmentedNamespace,v as serverTimestamp,x as addDoc,e as collection,y as getAuth,G as GithubAuthProvider,z as signInWithPopup,A as signOut,g as getDocs,B as updateDoc,q as query,C as orderBy,D as limit,o as onAuthStateChanged}from"./index-CeZO-5Hv.js";import{F as FontAwesomeIcon,f as faGithub}from"./index-CR7dR3cd.js";import{i as faTimes,j as faImage,k as faPlus,l as faInfoCircle,m as faCode,n as faMicrochip,o as faBook,p as faDatabase,c as faFileAlt,q as faInfo,r as faLink,s as faTags,t as faTimesCircle,u as faExclamationTriangle}from"./index-B9RSM9E-.js";import{c as createStarryNight,g as grammars}from"./index-CFrqMI23.js";var close=document.getElementsByClassName("closeTab"),tabs$1=document.getElementsByClassName("tab"),anchors=document.querySelectorAll("button.btn");Array.prototype.forEach.call(close,function(H){H.addEventListener("click",explode)});Array.prototype.forEach.call(tabs$1,function(H){H.style.width=H.offsetWidth+"px"});Array.prototype.forEach.call(anchors,function(H){H.addEventListener("click",function(a){return a.preventDefault(),!1})});function getOffset(H){var a=H.getBoundingClientRect(),G=window.pageXOffset||document.documentElement.scrollLeft,n=window.pageYOffset||document.documentElement.scrollTop;return{top:a.top+n,left:a.left+G}}function explode(H){var a=H.currentTarget.parentElement,G=getOffset(a),n=G.left,_=G.top+10,q=document.createElement("canvas"),B=q.getContext("2d"),tt=window.devicePixelRatio,L=[];a.classList.add("tabClosed"),window.setTimeout(function(){document.body.appendChild(q),q.style.position="absolute",q.style.left=n-40+"px",q.style.top=_-150+"px",q.style.pointerEvents="none",q.style.width="80px",q.style.height="300px",q.width=80*tt,q.height=300*tt;function v(){B.clearRect(0,0,q.width,q.height),L.forEach(function(l,P){l.opacity-=.01,l.speed*=l.friction,l.radius*=l.friction,l.yVel+=l.gravity,l.y+=l.yVel,!(l.opacity<0)&&(l.radius<0||(B.beginPath(),B.globalAlpha=l.opacity,B.fillStyle=l.color,B.arc(l.x,l.y,l.radius,0,2*Math.PI,!1),B.fill()))})}(function l(){requestAnimationFrame(l),v()})(),setTimeout(function(){document.body.removeChild(q)},3e3)},150)}function CarouselForm({carouselSamples:H,setCarouselSamples:a,setPopupWindow:G}){const[n,_]=reactExports.useState(""),[q,B]=reactExports.useState(null),[tt,L]=reactExports.useState(null),[v,l]=reactExports.useState(""),P=f=>{const h=f.target.files[0];if(h){if(!h.type.match("image.*")){l("Please select an image file");return}if(h.size>5*1024*1024){l("Image must be less than 5MB");return}B(h);const x=new FileReader;x.onload=M=>{L(M.target.result)},x.readAsDataURL(h),l("")}},R=f=>{f.preventDefault(),f.currentTarget.classList.add("drag-over")},m=f=>{f.currentTarget.classList.remove("drag-over")},g=f=>{if(f.preventDefault(),f.currentTarget.classList.remove("drag-over"),f.dataTransfer.files&&f.dataTransfer.files[0]){const h=f.dataTransfer.files[0];if(!h.type.match("image.*")){l("Please select an image file");return}if(h.size>5*1024*1024){l("Image must be less than 5MB");return}B(h);const x=new FileReader;x.onload=M=>{L(M.target.result)},x.readAsDataURL(h),l("")}},A=()=>{if(!n){l("Please enter a title for the carousel image");return}if(!q){l("Please select an image");return}let f=[...H];f.push({title:n,img:[q]}),a(f),G(null)};return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"carousel-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsx("h2",{className:"form-title",children:"Add Carousel Image"}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"carouselTitle",children:"Image Title"}),jsxRuntimeExports.jsx("input",{type:"text",id:"carouselTitle",className:"carousel-input",value:n,onChange:f=>_(f.target.value),placeholder:"Enter a descriptive title for this image"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Image Upload"}),jsxRuntimeExports.jsxs("div",{className:`carousel-upload-area ${tt?"has-preview":""}`,onDragOver:R,onDragLeave:m,onDrop:g,children:[jsxRuntimeExports.jsx("input",{type:"file",className:"file-input",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:P,id:"carouselImage"}),tt?jsxRuntimeExports.jsxs("div",{className:"carousel-preview",children:[jsxRuntimeExports.jsx("img",{src:tt,alt:"Preview",className:"preview-image"}),jsxRuntimeExports.jsx("button",{type:"button",className:"remove-image-btn",onClick:()=>{B(null),L(null)},children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})})]}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faImage,className:"upload-icon"}),jsxRuntimeExports.jsxs("div",{className:"upload-text",children:[jsxRuntimeExports.jsx("p",{children:"Drag & drop image here"}),jsxRuntimeExports.jsx("span",{children:"or"}),jsxRuntimeExports.jsxs("label",{htmlFor:"carouselImage",className:"browse-btn",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faPlus})," Browse files"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"image-requirements",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faInfoCircle,className:"info-icon"}),jsxRuntimeExports.jsx("span",{children:"Recommended: JPG, PNG or WebP • Max 5MB • 16:9 aspect ratio"})]})]}),v&&jsxRuntimeExports.jsx("div",{className:"form-error",children:v}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",onClick:A,children:"Add to Carousel"})]})]})})}function CodeSampleForm({codeSamples:H,setCodeSamples:a,setPopupWindow:G}){const[n,_]=reactExports.useState(""),[q,B]=reactExports.useState(""),[tt,L]=reactExports.useState(""),[v,l]=reactExports.useState([]),[P,R]=reactExports.useState(""),[m,g]=reactExports.useState(!0);reactExports.useEffect(()=>{(async()=>{try{g(!0);const x=(await createStarryNight(grammars)).scopes();l(x),x.length>0&&L(x.find(M=>M.includes("javascript"))||x[0])}catch(h){console.error("Error loading syntax highlighting:",h)}finally{g(!1)}})()},[]);const A=()=>{if(!n.trim()){R("Please enter a title for the code sample");return}if(!q.trim()){R("Please enter some code");return}if(!tt){R("Please select a language");return}const f=[...H];f.push({title:n.trim(),code:q.trim(),language:tt}),a(f),G(null)};return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"code-sample-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsxs("h2",{className:"form-title",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faCode,className:"title-icon"}),"Add Code Sample"]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"codeSampleTitle",children:"Sample Title"}),jsxRuntimeExports.jsx("input",{type:"text",id:"codeSampleTitle",className:"form-control",value:n,onChange:f=>_(f.target.value),placeholder:"e.g., 'Authentication Function', 'API Request Handler'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"language",children:"Programming Language"}),jsxRuntimeExports.jsx("div",{className:"select-wrapper",children:jsxRuntimeExports.jsx("select",{id:"language",className:"form-control",value:tt,onChange:f=>L(f.target.value),disabled:m,children:m?jsxRuntimeExports.jsx("option",{value:"",children:"Loading languages..."}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select a language"}),v.map((f,h)=>jsxRuntimeExports.jsx("option",{value:f,children:f.replace(/^source\./,"").replace(/\b\w/g,x=>x.toUpperCase())},h))]})})})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"code",children:"Code"}),jsxRuntimeExports.jsx("textarea",{id:"code",className:"code-editor",value:q,onChange:f=>B(f.target.value),placeholder:"Paste your code snippet here...",rows:10,spellCheck:"false"}),jsxRuntimeExports.jsxs("div",{className:"code-helper",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faInfoCircle,className:"info-icon"}),jsxRuntimeExports.jsx("span",{children:"Use proper indentation for better readability"})]})]}),P&&jsxRuntimeExports.jsx("div",{className:"form-error",children:P}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",onClick:A,children:"Add Code Sample"})]})]})})}function TechsForm({techs:H,setTechs:a,setPopupWindow:G}){const[n,_]=reactExports.useState(""),[q,B]=reactExports.useState(""),[tt,L]=reactExports.useState(""),v=()=>{if(!n.trim()){L("Please enter a technology name");return}if(!q.trim()){L("Please enter a technology description");return}const R=[...H];R.push({title:n.trim(),description:q.trim()}),a(R),G(null)},l=[{name:"React",desc:"A JavaScript library for building user interfaces"},{name:"Node.js",desc:"JavaScript runtime built on Chrome's V8 JavaScript engine"},{name:"Python",desc:"Interpreted high-level general-purpose programming language"},{name:"Docker",desc:"Platform for developing, shipping, and running applications in containers"},{name:"MongoDB",desc:"NoSQL document database with scalability and flexibility"},{name:"Firebase",desc:"Google's platform for app development, hosting and more"}],P=R=>{_(R.name),B(R.desc)};return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"tech-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsxs("h2",{className:"form-title",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faMicrochip,className:"title-icon"}),"Add Technology"]}),jsxRuntimeExports.jsxs("div",{className:"quick-select",children:[jsxRuntimeExports.jsx("label",{children:"Quick Select:"}),jsxRuntimeExports.jsx("div",{className:"quick-select-buttons",children:l.map((R,m)=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>P(R),className:"quick-select-btn",children:R.name},m))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"techTitle",children:"Technology Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"techTitle",className:"form-control",value:n,onChange:R=>_(R.target.value),placeholder:"e.g., 'React', 'TensorFlow', 'AWS'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"techDescription",children:"Description"}),jsxRuntimeExports.jsx("textarea",{id:"techDescription",className:"form-control",value:q,onChange:R=>B(R.target.value),placeholder:"Describe how this technology was used in your project",rows:4})]}),tt&&jsxRuntimeExports.jsx("div",{className:"form-error",children:tt}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",onClick:v,children:"Add Technology"})]})]})})}function ResourcesForm({resources:H,setResources:a,setPopupWindow:G}){const[n,_]=reactExports.useState(""),[q,B]=reactExports.useState(""),[tt,L]=reactExports.useState(""),v=()=>{if(!n.trim()){L("Please enter a resource title");return}if(!q.trim()){L("Please enter a resource description");return}const P=[...H];P.push({title:n.trim(),description:q.trim()}),a(P),G(null)},l=[{type:"Book",prefix:"Book: "},{type:"Article",prefix:"Article: "},{type:"Video",prefix:"Video Tutorial: "},{type:"Documentation",prefix:"Documentation: "},{type:"Framework",prefix:"Framework: "},{type:"Library",prefix:"Library: "}];return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"resource-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsxs("h2",{className:"form-title",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faBook,className:"title-icon"}),"Add Resource"]}),jsxRuntimeExports.jsxs("div",{className:"resource-types",children:[jsxRuntimeExports.jsx("label",{children:"Resource Type:"}),jsxRuntimeExports.jsx("div",{className:"resource-type-buttons",children:l.map((P,R)=>jsxRuntimeExports.jsx("button",{type:"button",className:"resource-type-btn",onClick:()=>_(P.prefix),children:P.type},R))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"resourceTitle",children:"Resource Title"}),jsxRuntimeExports.jsx("input",{type:"text",id:"resourceTitle",className:"form-control",value:n,onChange:P=>_(P.target.value),placeholder:"e.g., 'Clean Code by Robert Martin', 'React Documentation'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"resourceDescription",children:"Description"}),jsxRuntimeExports.jsx("textarea",{id:"resourceDescription",className:"form-control",value:q,onChange:P=>B(P.target.value),placeholder:"Describe how this resource was helpful for your project",rows:4})]}),tt&&jsxRuntimeExports.jsx("div",{className:"form-error",children:tt}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsxs("button",{type:"button",className:"submit-btn",onClick:v,children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faPlus})," Add Resource"]})]})]})})}function DataSourcesForm({dataSources:H,setDataSources:a,setPopupWindow:G}){const[n,_]=reactExports.useState(""),[q,B]=reactExports.useState(""),[tt,L]=reactExports.useState(""),[v,l]=reactExports.useState(""),[P,R]=reactExports.useState(""),m=()=>{if(!n){R("Please select a data source type");return}if(!q.trim()){R("Please enter a name for the data source");return}const A=[...H];A.push({type:n,name:q.trim(),size:tt.trim(),link:v.trim()}),a(A),G(null)},g=["excel","csv","json","sql-server","mysql","mongodb","python","xml"];return jsxRuntimeExports.jsx("div",{className:"popup-container",children:jsxRuntimeExports.jsxs("div",{className:"datasource-form popup",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"close-button",onClick:()=>G(null),children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimes})}),jsxRuntimeExports.jsxs("h2",{className:"form-title",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faDatabase,className:"title-icon"}),"Add Data Source"]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"dataSourceType",children:"Data Source Type"}),jsxRuntimeExports.jsx("div",{className:"datasource-types",children:g.map((A,f)=>jsxRuntimeExports.jsxs("div",{className:`datasource-type ${n===A?"selected":""}`,onClick:()=>_(A),children:[jsxRuntimeExports.jsx("div",{className:"datasource-icon",children:jsxRuntimeExports.jsx("img",{src:`/images/datasources/${A}.svg`,alt:A,onError:h=>{h.target.onError=null,h.target.src="/images/datasources/default.svg"}})}),jsxRuntimeExports.jsx("span",{children:A})]},f))})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"dataSourceName",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faFileAlt,className:"field-icon"}),"Data Source Name"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"dataSourceName",className:"form-control",value:q,onChange:A=>B(A.target.value),placeholder:"e.g., 'Customer Records', 'Transaction Data'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"dataSourceSize",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faInfo,className:"field-icon"}),"Size/Records (optional)"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"dataSourceSize",className:"form-control",value:tt,onChange:A=>L(A.target.value),placeholder:"e.g., '2.5 GB', '10,000 records'"})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"dataSourceLink",children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLink,className:"field-icon"}),"Source Link (optional)"]}),jsxRuntimeExports.jsx("input",{type:"text",id:"dataSourceLink",className:"form-control",value:v,onChange:A=>l(A.target.value),placeholder:"URL to the data source if publicly available"})]}),P&&jsxRuntimeExports.jsx("div",{className:"form-error",children:P}),jsxRuntimeExports.jsxs("div",{className:"form-actions",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>G(null),children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"submit-btn",onClick:m,disabled:!n||!q,children:"Add Data Source"})]})]})})}const TagInput=({tags:H,setTags:a,label:G})=>{const[n,_]=reactExports.useState(""),[q,B]=reactExports.useState(!1),tt=reactExports.useRef(null),L=m=>{_(m.target.value)},v=m=>{m.key==="Enter"||m.key===","?(m.preventDefault(),l()):m.key==="Backspace"&&n===""&&H.length>0&&P(H.length-1)},l=()=>{const m=n.trim();m&&!H.includes(m)&&(a([...H,m]),_(""))},P=m=>{a(H.filter((g,A)=>A!==m))},R=()=>{tt.current.focus()};return jsxRuntimeExports.jsxs("div",{className:`tag-input-container ${q?"focused":""}`,onClick:R,children:[jsxRuntimeExports.jsx("div",{className:"tag-input-icon",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTags})}),jsxRuntimeExports.jsx("div",{className:"tag-input-wrapper",children:jsxRuntimeExports.jsxs("div",{className:"tag-input-field",children:[H.map((m,g)=>jsxRuntimeExports.jsxs("div",{className:"tag",children:[jsxRuntimeExports.jsx("span",{className:"tag-text",children:m}),jsxRuntimeExports.jsx("span",{className:"tag-close",onClick:A=>{A.stopPropagation(),P(g)},children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faTimesCircle})})]},g)),jsxRuntimeExports.jsx("input",{ref:tt,type:"text",value:n,onChange:L,onKeyDown:v,onFocus:()=>B(!0),onBlur:()=>{B(!1),n&&l()},className:"tag-input",placeholder:H.length>0?"":"Type and press Enter to add tags"})]})}),jsxRuntimeExports.jsx("div",{className:"tag-input-helper",children:"Press Enter or comma to add"})]})},byteToHex=[];for(let H=0;H<256;++H)byteToHex.push((H+256).toString(16).slice(1));function unsafeStringify(H,a=0){return(byteToHex[H[a+0]]+byteToHex[H[a+1]]+byteToHex[H[a+2]]+byteToHex[H[a+3]]+"-"+byteToHex[H[a+4]]+byteToHex[H[a+5]]+"-"+byteToHex[H[a+6]]+byteToHex[H[a+7]]+"-"+byteToHex[H[a+8]]+byteToHex[H[a+9]]+"-"+byteToHex[H[a+10]]+byteToHex[H[a+11]]+byteToHex[H[a+12]]+byteToHex[H[a+13]]+byteToHex[H[a+14]]+byteToHex[H[a+15]]).toLowerCase()}let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");getRandomValues=crypto.getRandomValues.bind(crypto)}return getRandomValues(rnds8)}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(H,a,G){var _;if(native.randomUUID&&!H)return native.randomUUID();H=H||{};const n=H.random??((_=H.rng)==null?void 0:_.call(H))??rng();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,unsafeStringify(n)}const InputComponent=({type:H="text",name:a,className:G="form__input",placeholder:n="",required:_=!0,value:q,onChange:B,label:tt})=>jsxRuntimeExports.jsxs("div",{className:"input-flow",children:[jsxRuntimeExports.jsx("input",{type:H,name:a,className:G,placeholder:n,required:_,value:q,onChange:B,id:a}),jsxRuntimeExports.jsx("label",{className:"form__label",htmlFor:a,children:tt})]}),FileInputComponent=({name:H})=>jsxRuntimeExports.jsx("input",{type:"file",name:H}),CheckboxComponent=({name:H})=>jsxRuntimeExports.jsxs("div",{className:"input-flow",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",name:H}),jsxRuntimeExports.jsx("label",{className:"form__label",children:"Highlighted"})]}),ProjectDataComponent=({items:H,setItems:a,title:G,setPopupWindow:n,formComponent:_})=>{const q=(B,tt)=>{B.preventDefault();let L=[...H];L.splice(tt,1),a(L)};return jsxRuntimeExports.jsxs("div",{className:"group-container",children:[jsxRuntimeExports.jsxs("div",{className:"input-container",children:[jsxRuntimeExports.jsx("h2",{className:"title",children:G}),jsxRuntimeExports.jsx("input",{type:"button",className:"add-code-sample",value:`Add ${G}`,onClick:()=>{n(_)}})]}),H.length>0&&jsxRuntimeExports.jsx("div",{className:"code-samples h-list",children:H.map((B,tt)=>jsxRuntimeExports.jsxs("li",{className:"tab tabSelected",children:[jsxRuntimeExports.jsx("button",{className:"btn title",children:B.title}),jsxRuntimeExports.jsx("button",{className:"btn closeTab",onClick:L=>q(L,tt),children:"✕"})]},tt))})]})};function ProjectForm(){const[H,a]=reactExports.useState(null),[G,n]=reactExports.useState([]),[_,q]=reactExports.useState([]),[B,tt]=reactExports.useState([]),[L,v]=reactExports.useState([]),[l,P]=reactExports.useState([]),[R,m]=reactExports.useState([]),[g,A]=reactExports.useState("Submit"),[f,h]=reactExports.useState(!1),[x,M]=reactExports.useState(""),[E,c]=reactExports.useState(!1),u={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/projects/",token:localStorage.getItem("githubToken")||""},r=b=>new Promise((S,K)=>{const U=new FileReader;U.readAsDataURL(b),U.onload=()=>{const X=U.result.split(",")[1];S(X)},U.onerror=X=>K(X)}),d=async(b,S,K)=>{if(!b||!u.token)throw new Error("Missing file or GitHub token");try{const U=await r(b);let X=null;try{const W=await fetch(`https://api.github.com/repos/${u.owner}/${u.repo}/contents/${S}?ref=${u.branch}`,{headers:{Authorization:`token ${u.token}`,Accept:"application/vnd.github.v3+json"}});W.status===200&&(X=(await W.json()).sha)}catch{console.log(`File does not exist yet: ${S}`)}const $={message:K,content:U,branch:u.branch};X&&($.sha=X);const at=await fetch(`https://api.github.com/repos/${u.owner}/${u.repo}/contents/${S}`,{method:"PUT",headers:{Authorization:`token ${u.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify($)}),F=await at.json();if(at.status===200||at.status===201)return F;throw new Error(`GitHub API Error: ${F.message}`)}catch(U){throw console.error("Error committing to GitHub:",U),U}},o=async(b,S,K,U,X)=>{c(!0),M("Starting to commit images to GitHub...");try{const $=u.baseImagePath+X,at=`${$}/carousel`,F=[];if(b){const W=Date.now(),Z=`${$}/${S}`;M(`Committing main image: ${S}`);const w=d(b,Z,`Add project main image: ${S}`);F.push(w)}for(let W=0;W<K.length;W++){const Z=K[W];if(Z.img&&Z.img[0]){const w=U[W],s=`${at}/${w}`;M(`Committing carousel image ${W+1}/${K.length}: ${w}`);const e=d(Z.img[0],s,`Add project carousel image: ${w}`);F.push(e)}}return await Promise.all(F),M("All images successfully committed to GitHub!"),setTimeout(()=>{M(""),c(!1)},3e3),!0}catch($){return console.error("Error committing images to GitHub:",$),M(`Error committing images: ${$.message}`),c(!1),!1}},C=async b=>{if(b.preventDefault(),!f){h(!0),A("Submitting...");try{const S=new FormData(b.target),K=S.get("image");if(K&&K.type!=="image/webp"){alert("Only .webp images are accepted for the main image."),A("Submit"),h(!1);return}if(!u.token){const s=prompt("Please enter your GitHub token to commit images:");if(!s){alert("GitHub token is required to commit images."),A("Submit"),h(!1);return}localStorage.setItem("githubToken",s),u.token=s}const U=v4().replace(/-/g,"").substring(0,24),$=`${`public/images/projects/${U}`}/carousel`,at={_id:U,title:S.get("title"),description:S.get("description"),githubLink:S.get("githubLink"),startDate:S.get("startDate")?new Date(S.get("startDate")).toISOString():null,endDate:S.get("endDate")?new Date(S.get("endDate")).toISOString():null,durration:S.get("endDate")?"completed":"ongoing",highlighted:S.get("highlighted")==="on"?"star":"basic",tags:R,showInOverview:!1,codeSamples:G,dataSources:l,tools:{techs:B.map((s,e)=>({_id:`${U}${e}t`,title:s.title,description:s.description})),resources:L.map((s,e)=>({_id:`${U}${e}r`,title:s.title,description:s.description}))},carouselImages:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),__v:0},F=Date.now();let W=null;K&&(W=`${F}.webp`,at.image=`/images/projects/${U}/${W}`);let Z=[];for(let s=0;s<_.length;s++){const e=_[s];if(e.img&&e.img[0]){if(e.img[0].type!=="image/webp"){alert(`Only .webp images are accepted for carousel image ${s+1}.`),A("Submit"),h(!1);return}const p=`${F}-${s}.webp`;Z.push(p),at.carouselImages.push({_id:`${U}${s}c`,img:`/images/projects/${U}/carousel/${p}`,title:e.title})}}A("Saving to Firebase...");const w=doc(db,"projects",U);await setDoc(w,at),A("Committing images..."),await o(K,W,_,Z,U),A("Successfully Submitted!"),setTimeout(()=>{b.target.reset(),n([]),q([]),tt([]),v([]),P([]),m([]),A("Submit"),h(!1)},3e3)}catch(S){console.error("Error submitting project:",S),A("Error: Please try again"),h(!1)}}};reactExports.useEffect(()=>{const b=()=>{A("Submit")},S=document.querySelectorAll("input, textarea");return S.forEach(K=>{K.addEventListener("input",b)}),()=>{S.forEach(K=>{K.removeEventListener("input",b)})}},[]);const i=[jsxRuntimeExports.jsx(CodeSampleForm,{codeSamples:G,setCodeSamples:n,setPopupWindow:a}),jsxRuntimeExports.jsx(CarouselForm,{carouselSamples:_,setCarouselSamples:q,setPopupWindow:a}),jsxRuntimeExports.jsx(TechsForm,{techs:B,setTechs:tt,setPopupWindow:a}),jsxRuntimeExports.jsx(ResourcesForm,{resources:L,setResources:v,setPopupWindow:a}),jsxRuntimeExports.jsx(DataSourcesForm,{dataSources:l,setDataSources:P,setPopupWindow:a})];return jsxRuntimeExports.jsxs("form",{onSubmit:C,className:"filldb-form project-form",children:[jsxRuntimeExports.jsx("h1",{className:"project-form__title",children:"Create New Project"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsxs("div",{className:"input-container",children:[jsxRuntimeExports.jsx(InputComponent,{name:"title",label:"Title"}),jsxRuntimeExports.jsx(InputComponent,{name:"githubLink",label:"Github Link"})]}),jsxRuntimeExports.jsxs("div",{className:"input-container",children:[jsxRuntimeExports.jsx(InputComponent,{type:"date",name:"startDate",label:"Start Date"}),jsxRuntimeExports.jsx(InputComponent,{type:"date",name:"endDate",required:!1,label:"End Date"})]}),jsxRuntimeExports.jsx("textarea",{className:"description",type:"text",name:"description",required:!0,placeholder:"Write a Brief Description of the Project"}),jsxRuntimeExports.jsx(FileInputComponent,{name:"image"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:G,setItems:n,title:"Code Samples",formComponent:i[0],setPopupWindow:a}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:_,setItems:q,title:"Carousels",formComponent:i[1],setPopupWindow:a}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:B,setItems:tt,title:"Technologies",formComponent:i[2],setPopupWindow:a}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:L,setItems:v,title:"Resources",formComponent:i[3],setPopupWindow:a}),jsxRuntimeExports.jsx(ProjectDataComponent,{items:l,setItems:P,title:"Data Sources",formComponent:i[4],setPopupWindow:a}),H,jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx(CheckboxComponent,{name:"highlighted"}),jsxRuntimeExports.jsx(TagInput,{tags:R,setTags:m}),jsxRuntimeExports.jsx("input",{type:"submit",value:g,disabled:f||E,className:f||E?"submitting":""}),(E||x)&&jsxRuntimeExports.jsxs("div",{className:`commit-status ${x.includes("Error")?"error":x.includes("success")?"success":"info"}`,children:[x,E&&jsxRuntimeExports.jsx("div",{className:"spinner"})]})]})}function commonjsRequire(H){throw new Error('Could not dynamically require "'+H+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(a,G){module.exports=a.pdfjsLib=G()})(globalThis,()=>(()=>{var __webpack_modules__=[,(H,a)=>{var Xt;Object.defineProperty(a,"__esModule",{value:!0}),a.VerbosityLevel=a.Util=a.UnknownErrorException=a.UnexpectedResponseException=a.TextRenderingMode=a.RenderingIntentFlag=a.PromiseCapability=a.PermissionFlag=a.PasswordResponses=a.PasswordException=a.PageActionEventType=a.OPS=a.MissingPDFException=a.MAX_IMAGE_SIZE_TO_CACHE=a.LINE_FACTOR=a.LINE_DESCENT_FACTOR=a.InvalidPDFException=a.ImageKind=a.IDENTITY_MATRIX=a.FormatError=a.FeatureTest=a.FONT_IDENTITY_MATRIX=a.DocumentActionEventType=a.CMapCompressionType=a.BaseException=a.BASELINE_FACTOR=a.AnnotationType=a.AnnotationReplyType=a.AnnotationPrefix=a.AnnotationMode=a.AnnotationFlag=a.AnnotationFieldFlag=a.AnnotationEditorType=a.AnnotationEditorPrefix=a.AnnotationEditorParamsType=a.AnnotationBorderStyleType=a.AnnotationActionEventType=a.AbortException=void 0,a.assert=F,a.bytesToString=ut,a.createValidAbsoluteUrl=Z,a.getModificationDate=St,a.getUuid=Nt,a.getVerbosityLevel=U,a.info=X,a.isArrayBuffer=Q,a.isArrayEqual=Ct,a.isNodeJS=void 0,a.normalizeUnicode=kt,a.objectFromMap=At,a.objectSize=xt,a.setVerbosityLevel=K,a.shadow=w,a.string32=mt,a.stringToBytes=dt,a.stringToPDFString=ft,a.stringToUTF8String=vt,a.unreachable=at,a.utf8StringToString=_t,a.warn=$;const G=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");a.isNodeJS=G;const n=[1,0,0,1,0,0];a.IDENTITY_MATRIX=n;const _=[.001,0,0,.001,0,0];a.FONT_IDENTITY_MATRIX=_;const q=1e7;a.MAX_IMAGE_SIZE_TO_CACHE=q;const B=1.35;a.LINE_FACTOR=B;const tt=.35;a.LINE_DESCENT_FACTOR=tt;const L=tt/B;a.BASELINE_FACTOR=L;const v={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};a.RenderingIntentFlag=v;const l={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};a.AnnotationMode=l;const P="pdfjs_internal_editor_";a.AnnotationEditorPrefix=P;const R={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};a.AnnotationEditorType=R;const m={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};a.AnnotationEditorParamsType=m;const g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};a.PermissionFlag=g;const A={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};a.TextRenderingMode=A;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};a.ImageKind=f;const h={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};a.AnnotationType=h;const x={GROUP:"Group",REPLY:"R"};a.AnnotationReplyType=x;const M={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};a.AnnotationFlag=M;const E={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};a.AnnotationFieldFlag=E;const c={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};a.AnnotationBorderStyleType=c;const u={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};a.AnnotationActionEventType=u;const r={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};a.DocumentActionEventType=r;const d={O:"PageOpen",C:"PageClose"};a.PageActionEventType=d;const o={ERRORS:0,WARNINGS:1,INFOS:5};a.VerbosityLevel=o;const C={NONE:0,BINARY:1};a.CMapCompressionType=C;const i={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};a.OPS=i;const b={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};a.PasswordResponses=b;let S=o.WARNINGS;function K(yt){Number.isInteger(yt)&&(S=yt)}function U(){return S}function X(yt){S>=o.INFOS&&console.log(`Info: ${yt}`)}function $(yt){S>=o.WARNINGS&&console.log(`Warning: ${yt}`)}function at(yt){throw new Error(yt)}function F(yt,ot){yt||at(ot)}function W(yt){switch(yt==null?void 0:yt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Z(yt,ot=null,ct=null){if(!yt)return null;try{if(ct&&typeof yt=="string"){if(ct.addDefaultProtocol&&yt.startsWith("www.")){const Gt=yt.match(/\./g);(Gt==null?void 0:Gt.length)>=2&&(yt=`http://${yt}`)}if(ct.tryConvertEncoding)try{yt=vt(yt)}catch{}}const Pt=ot?new URL(yt,ot):new URL(yt);if(W(Pt))return Pt}catch{}return null}function w(yt,ot,ct,Pt=!1){return Object.defineProperty(yt,ot,{value:ct,enumerable:!Pt,configurable:!0,writable:!1}),ct}const s=function(){function ot(ct,Pt){this.constructor===ot&&at("Cannot initialize BaseException."),this.message=ct,this.name=Pt}return ot.prototype=new Error,ot.constructor=ot,ot}();a.BaseException=s;class e extends s{constructor(ot,ct){super(ot,"PasswordException"),this.code=ct}}a.PasswordException=e;class p extends s{constructor(ot,ct){super(ot,"UnknownErrorException"),this.details=ct}}a.UnknownErrorException=p;class k extends s{constructor(ot){super(ot,"InvalidPDFException")}}a.InvalidPDFException=k;class j extends s{constructor(ot){super(ot,"MissingPDFException")}}a.MissingPDFException=j;class I extends s{constructor(ot,ct){super(ot,"UnexpectedResponseException"),this.status=ct}}a.UnexpectedResponseException=I;class V extends s{constructor(ot){super(ot,"FormatError")}}a.FormatError=V;class et extends s{constructor(ot){super(ot,"AbortException")}}a.AbortException=et;function ut(yt){(typeof yt!="object"||(yt==null?void 0:yt.length)===void 0)&&at("Invalid argument for bytesToString");const ot=yt.length,ct=8192;if(ot<ct)return String.fromCharCode.apply(null,yt);const Pt=[];for(let Gt=0;Gt<ot;Gt+=ct){const Wt=Math.min(Gt+ct,ot),O=yt.subarray(Gt,Wt);Pt.push(String.fromCharCode.apply(null,O))}return Pt.join("")}function dt(yt){typeof yt!="string"&&at("Invalid argument for stringToBytes");const ot=yt.length,ct=new Uint8Array(ot);for(let Pt=0;Pt<ot;++Pt)ct[Pt]=yt.charCodeAt(Pt)&255;return ct}function mt(yt){return String.fromCharCode(yt>>24&255,yt>>16&255,yt>>8&255,yt&255)}function xt(yt){return Object.keys(yt).length}function At(yt){const ot=Object.create(null);for(const[ct,Pt]of yt)ot[ct]=Pt;return ot}function st(){const yt=new Uint8Array(4);return yt[0]=1,new Uint32Array(yt.buffer,0,1)[0]===1}function it(){try{return new Function(""),!0}catch{return!1}}class y{static get isLittleEndian(){return w(this,"isLittleEndian",st())}static get isEvalSupported(){return w(this,"isEvalSupported",it())}static get isOffscreenCanvasSupported(){return w(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?w(this,"platform",{isWin:!1,isMac:!1}):w(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var ot,ct;return w(this,"isCSSRoundSupported",(ct=(ot=globalThis.CSS)==null?void 0:ot.supports)==null?void 0:ct.call(ot,"width: round(1.5px, 1px)"))}}a.FeatureTest=y;const N=[...Array(256).keys()].map(yt=>yt.toString(16).padStart(2,"0"));class J{static makeHexColor(ot,ct,Pt){return`#${N[ot]}${N[ct]}${N[Pt]}`}static scaleMinMax(ot,ct){let Pt;ot[0]?(ot[0]<0&&(Pt=ct[0],ct[0]=ct[1],ct[1]=Pt),ct[0]*=ot[0],ct[1]*=ot[0],ot[3]<0&&(Pt=ct[2],ct[2]=ct[3],ct[3]=Pt),ct[2]*=ot[3],ct[3]*=ot[3]):(Pt=ct[0],ct[0]=ct[2],ct[2]=Pt,Pt=ct[1],ct[1]=ct[3],ct[3]=Pt,ot[1]<0&&(Pt=ct[2],ct[2]=ct[3],ct[3]=Pt),ct[2]*=ot[1],ct[3]*=ot[1],ot[2]<0&&(Pt=ct[0],ct[0]=ct[1],ct[1]=Pt),ct[0]*=ot[2],ct[1]*=ot[2]),ct[0]+=ot[4],ct[1]+=ot[4],ct[2]+=ot[5],ct[3]+=ot[5]}static transform(ot,ct){return[ot[0]*ct[0]+ot[2]*ct[1],ot[1]*ct[0]+ot[3]*ct[1],ot[0]*ct[2]+ot[2]*ct[3],ot[1]*ct[2]+ot[3]*ct[3],ot[0]*ct[4]+ot[2]*ct[5]+ot[4],ot[1]*ct[4]+ot[3]*ct[5]+ot[5]]}static applyTransform(ot,ct){const Pt=ot[0]*ct[0]+ot[1]*ct[2]+ct[4],Gt=ot[0]*ct[1]+ot[1]*ct[3]+ct[5];return[Pt,Gt]}static applyInverseTransform(ot,ct){const Pt=ct[0]*ct[3]-ct[1]*ct[2],Gt=(ot[0]*ct[3]-ot[1]*ct[2]+ct[2]*ct[5]-ct[4]*ct[3])/Pt,Wt=(-ot[0]*ct[1]+ot[1]*ct[0]+ct[4]*ct[1]-ct[5]*ct[0])/Pt;return[Gt,Wt]}static getAxialAlignedBoundingBox(ot,ct){const Pt=this.applyTransform(ot,ct),Gt=this.applyTransform(ot.slice(2,4),ct),Wt=this.applyTransform([ot[0],ot[3]],ct),O=this.applyTransform([ot[2],ot[1]],ct);return[Math.min(Pt[0],Gt[0],Wt[0],O[0]),Math.min(Pt[1],Gt[1],Wt[1],O[1]),Math.max(Pt[0],Gt[0],Wt[0],O[0]),Math.max(Pt[1],Gt[1],Wt[1],O[1])]}static inverseTransform(ot){const ct=ot[0]*ot[3]-ot[1]*ot[2];return[ot[3]/ct,-ot[1]/ct,-ot[2]/ct,ot[0]/ct,(ot[2]*ot[5]-ot[4]*ot[3])/ct,(ot[4]*ot[1]-ot[5]*ot[0])/ct]}static singularValueDecompose2dScale(ot){const ct=[ot[0],ot[2],ot[1],ot[3]],Pt=ot[0]*ct[0]+ot[1]*ct[2],Gt=ot[0]*ct[1]+ot[1]*ct[3],Wt=ot[2]*ct[0]+ot[3]*ct[2],O=ot[2]*ct[1]+ot[3]*ct[3],gt=(Pt+O)/2,wt=Math.sqrt((Pt+O)**2-4*(Pt*O-Wt*Gt))/2,Mt=gt+wt||1,Lt=gt-wt||1;return[Math.sqrt(Mt),Math.sqrt(Lt)]}static normalizeRect(ot){const ct=ot.slice(0);return ot[0]>ot[2]&&(ct[0]=ot[2],ct[2]=ot[0]),ot[1]>ot[3]&&(ct[1]=ot[3],ct[3]=ot[1]),ct}static intersect(ot,ct){const Pt=Math.max(Math.min(ot[0],ot[2]),Math.min(ct[0],ct[2])),Gt=Math.min(Math.max(ot[0],ot[2]),Math.max(ct[0],ct[2]));if(Pt>Gt)return null;const Wt=Math.max(Math.min(ot[1],ot[3]),Math.min(ct[1],ct[3])),O=Math.min(Math.max(ot[1],ot[3]),Math.max(ct[1],ct[3]));return Wt>O?null:[Pt,Wt,Gt,O]}static bezierBoundingBox(ot,ct,Pt,Gt,Wt,O,gt,wt){const Mt=[],Lt=[[],[]];let Tt,D,T,z,ht,pt,bt,Et;for(let Ht=0;Ht<2;++Ht){if(Ht===0?(D=6*ot-12*Pt+6*Wt,Tt=-3*ot+9*Pt-9*Wt+3*gt,T=3*Pt-3*ot):(D=6*ct-12*Gt+6*O,Tt=-3*ct+9*Gt-9*O+3*wt,T=3*Gt-3*ct),Math.abs(Tt)<1e-12){if(Math.abs(D)<1e-12)continue;z=-T/D,0<z&&z<1&&Mt.push(z);continue}bt=D*D-4*T*Tt,Et=Math.sqrt(bt),!(bt<0)&&(ht=(-D+Et)/(2*Tt),0<ht&&ht<1&&Mt.push(ht),pt=(-D-Et)/(2*Tt),0<pt&&pt<1&&Mt.push(pt))}let Dt=Mt.length,Ft;const Rt=Dt;for(;Dt--;)z=Mt[Dt],Ft=1-z,Lt[0][Dt]=Ft*Ft*Ft*ot+3*Ft*Ft*z*Pt+3*Ft*z*z*Wt+z*z*z*gt,Lt[1][Dt]=Ft*Ft*Ft*ct+3*Ft*Ft*z*Gt+3*Ft*z*z*O+z*z*z*wt;return Lt[0][Rt]=ot,Lt[1][Rt]=ct,Lt[0][Rt+1]=gt,Lt[1][Rt+1]=wt,Lt[0].length=Lt[1].length=Rt+2,[Math.min(...Lt[0]),Math.min(...Lt[1]),Math.max(...Lt[0]),Math.max(...Lt[1])]}}a.Util=J;const nt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ft(yt){if(yt[0]>="ï"){let ct;if(yt[0]==="þ"&&yt[1]==="ÿ"?ct="utf-16be":yt[0]==="ÿ"&&yt[1]==="þ"?ct="utf-16le":yt[0]==="ï"&&yt[1]==="»"&&yt[2]==="¿"&&(ct="utf-8"),ct)try{const Pt=new TextDecoder(ct,{fatal:!0}),Gt=dt(yt);return Pt.decode(Gt)}catch(Pt){$(`stringToPDFString: "${Pt}".`)}}const ot=[];for(let ct=0,Pt=yt.length;ct<Pt;ct++){const Gt=nt[yt.charCodeAt(ct)];ot.push(Gt?String.fromCharCode(Gt):yt.charAt(ct))}return ot.join("")}function vt(yt){return decodeURIComponent(escape(yt))}function _t(yt){return unescape(encodeURIComponent(yt))}function Q(yt){return typeof yt=="object"&&(yt==null?void 0:yt.byteLength)!==void 0}function Ct(yt,ot){if(yt.length!==ot.length)return!1;for(let ct=0,Pt=yt.length;ct<Pt;ct++)if(yt[ct]!==ot[ct])return!1;return!0}function St(yt=new Date){return[yt.getUTCFullYear().toString(),(yt.getUTCMonth()+1).toString().padStart(2,"0"),yt.getUTCDate().toString().padStart(2,"0"),yt.getUTCHours().toString().padStart(2,"0"),yt.getUTCMinutes().toString().padStart(2,"0"),yt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){rt(this,Xt,!1);this.promise=new Promise((ot,ct)=>{this.resolve=Pt=>{lt(this,Xt,!0),ot(Pt)},this.reject=Pt=>{lt(this,Xt,!0),ct(Pt)}})}get settled(){return t(this,Xt)}}Xt=new WeakMap,a.PromiseCapability=Ut;let Ot=null,zt=null;function kt(yt){return Ot||(Ot=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,zt=new Map([["ﬅ","ſt"]])),yt.replaceAll(Ot,(ot,ct,Pt)=>ct?ct.normalize("NFKC"):zt.get(Pt))}function Nt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const yt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(yt);else for(let ot=0;ot<32;ot++)yt[ot]=Math.floor(Math.random()*255);return ut(yt)}const Vt="pdfjs_internal_id_";a.AnnotationPrefix=Vt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var H,G,n,_,re,xe,tt,L,v,l,P,R,m,g,A,Ae,h,x,Me,E,c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(r){if(typeof r=="string"||r instanceof URL?r={url:r}:(0,_util.isArrayBuffer)(r)&&(r={data:r}),typeof r!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!r.url&&!r.data&&!r.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const d=new PDFDocumentLoadingTask,{docId:o}=d,C=r.url?getUrlProp(r.url):null,i=r.data?getDataProp(r.data):null,b=r.httpHeaders||null,S=r.withCredentials===!0,K=r.password??null,U=r.range instanceof PDFDataRangeTransport?r.range:null,X=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let $=r.worker instanceof PDFWorker?r.worker:null;const at=r.verbosity,F=typeof r.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(r.docBaseUrl)?r.docBaseUrl:null,W=typeof r.cMapUrl=="string"?r.cMapUrl:null,Z=r.cMapPacked!==!1,w=r.CMapReaderFactory||DefaultCMapReaderFactory,s=typeof r.standardFontDataUrl=="string"?r.standardFontDataUrl:null,e=r.StandardFontDataFactory||DefaultStandardFontDataFactory,p=r.stopAtErrors!==!0,k=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,j=r.isEvalSupported!==!1,I=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!_util.isNodeJS,V=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,et=typeof r.disableFontFace=="boolean"?r.disableFontFace:_util.isNodeJS,ut=r.fontExtraProperties===!0,dt=r.enableXfa===!0,mt=r.ownerDocument||globalThis.document,xt=r.disableRange===!0,At=r.disableStream===!0,st=r.disableAutoFetch===!0,it=r.pdfBug===!0,y=U?U.length:r.length??NaN,N=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!_util.isNodeJS&&!et,J=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:w===_display_utils.DOMCMapReaderFactory&&e===_display_utils.DOMStandardFontDataFactory&&W&&s&&(0,_display_utils.isValidFetchUrl)(W,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(s,document.baseURI),nt=r.canvasFactory||new DefaultCanvasFactory({ownerDocument:mt}),ft=r.filterFactory||new DefaultFilterFactory({docId:o,ownerDocument:mt}),vt=null;(0,_util.setVerbosityLevel)(at);const _t={canvasFactory:nt,filterFactory:ft};if(J||(_t.cMapReaderFactory=new w({baseUrl:W,isCompressed:Z}),_t.standardFontDataFactory=new e({baseUrl:s})),!$){const St={verbosity:at,port:_worker_options.GlobalWorkerOptions.workerPort};$=St.port?PDFWorker.fromPort(St):new PDFWorker(St),d._worker=$}const Q={docId:o,apiVersion:"3.11.174",data:i,password:K,disableAutoFetch:st,rangeChunkSize:X,length:y,docBaseUrl:F,enableXfa:dt,evaluatorOptions:{maxImageSize:k,disableFontFace:et,ignoreErrors:p,isEvalSupported:j,isOffscreenCanvasSupported:I,canvasMaxAreaInBytes:V,fontExtraProperties:ut,useSystemFonts:N,cMapUrl:J?W:null,standardFontDataUrl:J?s:null}},Ct={ignoreErrors:p,isEvalSupported:j,disableFontFace:et,fontExtraProperties:ut,enableXfa:dt,ownerDocument:mt,disableAutoFetch:st,pdfBug:it,styleElement:vt};return $.promise.then(function(){if(d.destroyed)throw new Error("Loading aborted");const St=_fetchDocument($,Q),Ut=new Promise(function(Ot){let zt;U?zt=new _transport_stream.PDFDataTransportStream({length:y,initialData:U.initialData,progressiveDone:U.progressiveDone,contentDispositionFilename:U.contentDispositionFilename,disableRange:xt,disableStream:At},U):i||(zt=(Nt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Nt):(0,_display_utils.isValidFetchUrl)(Nt.url)?new _displayFetch_stream.PDFFetchStream(Nt):new _displayNetwork.PDFNetworkStream(Nt))({url:C,length:y,httpHeaders:b,withCredentials:S,rangeChunkSize:X,disableRange:xt,disableStream:At})),Ot(zt)});return Promise.all([St,Ut]).then(function([Ot,zt]){if(d.destroyed)throw new Error("Loading aborted");const kt=new _message_handler.MessageHandler(o,Ot,$.port),Nt=new WorkerTransport(kt,d,zt,Ct,_t);d._transport=Nt,kt.send("Ready",null)})}).catch(d._capability.reject),d}async function _fetchDocument(r,d){if(r.destroyed)throw new Error("Worker was destroyed");const o=await r.messageHandler.sendWithPromise("GetDocRequest",d,d.data?[d.data.buffer]:null);if(r.destroyed)throw new Error("Worker was destroyed");return o}function getUrlProp(r){if(r instanceof URL)return r.href;try{return new URL(r,window.location).href}catch{if(_util.isNodeJS&&typeof r=="string")return r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(r){if(_util.isNodeJS&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return(0,_util.stringToBytes)(r);if(typeof r=="object"&&!isNaN(r==null?void 0:r.length)||(0,_util.isArrayBuffer)(r))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const a=class a{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${he(a,H)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var d,o,C;this.destroyed=!0;try{(d=this._worker)!=null&&d.port&&(this._worker._pendingDestroy=!0),await((o=this._transport)==null?void 0:o.destroy())}catch(i){throw(C=this._worker)!=null&&C.port&&delete this._worker._pendingDestroy,i}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};H=new WeakMap,rt(a,H,0);let PDFDocumentLoadingTask=a;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(d,o,C=!1,i=null){this.length=d,this.initialData=o,this.progressiveDone=C,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(d){this._rangeListeners.push(d)}addProgressListener(d){this._progressListeners.push(d)}addProgressiveReadListener(d){this._progressiveReadListeners.push(d)}addProgressiveDoneListener(d){this._progressiveDoneListeners.push(d)}onDataRange(d,o){for(const C of this._rangeListeners)C(d,o)}onDataProgress(d,o){this._readyCapability.promise.then(()=>{for(const C of this._progressListeners)C(d,o)})}onDataProgressiveRead(d){this._readyCapability.promise.then(()=>{for(const o of this._progressiveReadListeners)o(d)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const d of this._progressiveDoneListeners)d()})}transportReady(){this._readyCapability.resolve()}requestDataRange(d,o){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(d,o){this._pdfInfo=d,this._transport=o,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(C=>{if(!C)return C;const i=[];for(const b in C)i.push(...C[b]);return i}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(d){return this._transport.getPage(d)}getPageIndex(d){return this._transport.getPageIndex(d)}getDestinations(){return this._transport.getDestinations()}getDestination(d){return this._transport.getDestination(d)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(d=!1){return this._transport.startCleanup(d||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(d,o,C,i=!1){rt(this,_);rt(this,G,null);rt(this,n,!1);this._pageIndex=d,this._pageInfo=o,this._transport=C,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=C.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:d,rotation:o=this.rotate,offsetX:C=0,offsetY:i=0,dontFlip:b=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:d,rotation:o,offsetX:C,offsetY:i,dontFlip:b})}getAnnotations({intent:d="display"}={}){const o=this._transport.getRenderingIntent(d);return this._transport.getAnnotations(this._pageIndex,o.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var d;return((d=this._transport._htmlForXfa)==null?void 0:d.children[this._pageIndex])||null}render({canvasContext:d,viewport:o,intent:C="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:b=null,background:S=null,optionalContentConfigPromise:K=null,annotationCanvasMap:U=null,pageColors:X=null,printAnnotationStorage:$=null}){var e,p;(e=this._stats)==null||e.time("Overall");const at=this._transport.getRenderingIntent(C,i,$);lt(this,n,!1),Y(this,_,xe).call(this),K||(K=this._transport.getOptionalContentConfig());let F=this._intentStates.get(at.cacheKey);F||(F=Object.create(null),this._intentStates.set(at.cacheKey,F)),F.streamReaderCancelTimeout&&(clearTimeout(F.streamReaderCancelTimeout),F.streamReaderCancelTimeout=null);const W=!!(at.renderingIntent&_util.RenderingIntentFlag.PRINT);F.displayReadyCapability||(F.displayReadyCapability=new _util.PromiseCapability,F.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(p=this._stats)==null||p.time("Page Request"),this._pumpOperatorList(at));const Z=k=>{var j,I;F.renderTasks.delete(w),(this._maybeCleanupAfterRender||W)&&lt(this,n,!0),Y(this,_,re).call(this,!W),k?(w.capability.reject(k),this._abortOperatorList({intentState:F,reason:k instanceof Error?k:new Error(k)})):w.capability.resolve(),(j=this._stats)==null||j.timeEnd("Rendering"),(I=this._stats)==null||I.timeEnd("Overall")},w=new InternalRenderTask({callback:Z,params:{canvasContext:d,viewport:o,transform:b,background:S},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:U,operatorList:F.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!W,pdfBug:this._pdfBug,pageColors:X});(F.renderTasks||(F.renderTasks=new Set)).add(w);const s=w.task;return Promise.all([F.displayReadyCapability.promise,K]).then(([k,j])=>{var I;if(this.destroyed){Z();return}(I=this._stats)==null||I.time("Rendering"),w.initializeGraphics({transparency:k,optionalContentConfig:j}),w.operatorListChanged()}).catch(Z),s}getOperatorList({intent:d="display",annotationMode:o=_util.AnnotationMode.ENABLE,printAnnotationStorage:C=null}={}){var U;function i(){S.operatorList.lastChunk&&(S.opListReadCapability.resolve(S.operatorList),S.renderTasks.delete(K))}const b=this._transport.getRenderingIntent(d,o,C,!0);let S=this._intentStates.get(b.cacheKey);S||(S=Object.create(null),this._intentStates.set(b.cacheKey,S));let K;return S.opListReadCapability||(K=Object.create(null),K.operatorListChanged=i,S.opListReadCapability=new _util.PromiseCapability,(S.renderTasks||(S.renderTasks=new Set)).add(K),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(U=this._stats)==null||U.time("Page Request"),this._pumpOperatorList(b)),S.opListReadCapability.promise}streamTextContent({includeMarkedContent:d=!1,disableNormalization:o=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:d===!0,disableNormalization:o===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(d={}){if(this._transport._htmlForXfa)return this.getXfa().then(C=>_xfa_text.XfaText.textContent(C));const o=this.streamTextContent(d);return new Promise(function(C,i){function b(){S.read().then(function({value:U,done:X}){if(X){C(K);return}Object.assign(K.styles,U.styles),K.items.push(...U.items),b()},i)}const S=o.getReader(),K={items:[],styles:Object.create(null)};b()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const d=[];for(const o of this._intentStates.values())if(this._abortOperatorList({intentState:o,reason:new Error("Page was destroyed."),force:!0}),!o.opListReadCapability)for(const C of o.renderTasks)d.push(C.completed),C.cancel();return this.objs.clear(),lt(this,n,!1),Y(this,_,xe).call(this),Promise.all(d)}cleanup(d=!1){lt(this,n,!0);const o=Y(this,_,re).call(this,!1);return d&&o&&this._stats&&(this._stats=new _display_utils.StatTimer),o}_startRenderPage(d,o){var i,b;const C=this._intentStates.get(o);C&&((i=this._stats)==null||i.timeEnd("Page Request"),(b=C.displayReadyCapability)==null||b.resolve(d))}_renderPageChunk(d,o){for(let C=0,i=d.length;C<i;C++)o.operatorList.fnArray.push(d.fnArray[C]),o.operatorList.argsArray.push(d.argsArray[C]);o.operatorList.lastChunk=d.lastChunk,o.operatorList.separateAnnots=d.separateAnnots;for(const C of o.renderTasks)C.operatorListChanged();d.lastChunk&&Y(this,_,re).call(this,!0)}_pumpOperatorList({renderingIntent:d,cacheKey:o,annotationStorageSerializable:C}){const{map:i,transfers:b}=C,K=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:d,cacheKey:o,annotationStorage:i},b).getReader(),U=this._intentStates.get(o);U.streamReader=K;const X=()=>{K.read().then(({value:$,done:at})=>{if(at){U.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk($,U),X())},$=>{if(U.streamReader=null,!this._transport.destroyed){if(U.operatorList){U.operatorList.lastChunk=!0;for(const at of U.renderTasks)at.operatorListChanged();Y(this,_,re).call(this,!0)}if(U.displayReadyCapability)U.displayReadyCapability.reject($);else if(U.opListReadCapability)U.opListReadCapability.reject($);else throw $}})};X()}_abortOperatorList({intentState:d,reason:o,force:C=!1}){if(d.streamReader){if(d.streamReaderCancelTimeout&&(clearTimeout(d.streamReaderCancelTimeout),d.streamReaderCancelTimeout=null),!C){if(d.renderTasks.size>0)return;if(o instanceof _display_utils.RenderingCancelledException){let i=RENDERING_CANCELLED_TIMEOUT;o.extraDelay>0&&o.extraDelay<1e3&&(i+=o.extraDelay),d.streamReaderCancelTimeout=setTimeout(()=>{d.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:d,reason:o,force:!0})},i);return}}if(d.streamReader.cancel(new _util.AbortException(o.message)).catch(()=>{}),d.streamReader=null,!this._transport.destroyed){for(const[i,b]of this._intentStates)if(b===d){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}G=new WeakMap,n=new WeakMap,_=new WeakSet,re=function(d=!1){if(Y(this,_,xe).call(this),!t(this,n)||this.destroyed)return!1;if(d)return lt(this,G,setTimeout(()=>{lt(this,G,null),Y(this,_,re).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:o,operatorList:C}of this._intentStates.values())if(o.size>0||!C.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),lt(this,n,!1),!0},xe=function(){t(this,G)&&(clearTimeout(t(this,G)),lt(this,G,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){rt(this,tt,new Set);rt(this,L,Promise.resolve())}postMessage(d,o){const C={data:structuredClone(d,o?{transfer:o}:null)};t(this,L).then(()=>{for(const i of t(this,tt))i.call(this,C)})}addEventListener(d,o){t(this,tt).add(o)}removeEventListener(d,o){t(this,tt).delete(o)}terminate(){t(this,tt).clear()}}tt=new WeakMap,L=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const r=(v=document==null?void 0:document.currentScript)==null?void 0:v.src;r&&(PDFWorkerUtil.fallbackWorkerSrc=r.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(r,d){let o;try{if(o=new URL(r),!o.origin||o.origin==="null")return!1}catch{return!1}const C=new URL(d,o);return o.origin===C.origin},PDFWorkerUtil.createCDNWrapper=function(r){const d=`importScripts("${r}");`;return URL.createObjectURL(new Blob([d]))}}const _PDFWorker=class _PDFWorker{constructor({name:r=null,port:d=null,verbosity:o=(0,_util.getVerbosityLevel)()}={}){var C;if(this.name=r,this.destroyed=!1,this.verbosity=o,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,d){if((C=t(_PDFWorker,l))!=null&&C.has(d))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,l)||lt(_PDFWorker,l,new WeakMap)).set(d,this),this._initializeFromPort(d);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(r){this._port=r,this._messageHandler=new _message_handler.MessageHandler("main","worker",r),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:r}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,r)||(r=PDFWorkerUtil.createCDNWrapper(new URL(r,window.location).href));const d=new Worker(r),o=new _message_handler.MessageHandler("main","worker",d),C=()=>{d.removeEventListener("error",i),o.destroy(),d.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||C()};d.addEventListener("error",i),o.on("test",S=>{if(d.removeEventListener("error",i),this.destroyed){C();return}S?(this._messageHandler=o,this._port=d,this._webWorker=d,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),o.destroy(),d.terminate())}),o.on("ready",S=>{if(d.removeEventListener("error",i),this.destroyed){C();return}try{b()}catch{this._setupFakeWorker()}});const b=()=>{const S=new Uint8Array;o.send("test",S,[S.buffer])};b();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(r=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const d=new LoopbackPort;this._port=d;const o=`fake${PDFWorkerUtil.fakeWorkerId++}`,C=new _message_handler.MessageHandler(o+"_worker",o,d);r.setup(C,d);const i=new _message_handler.MessageHandler(o,o+"_worker",d);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(r=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${r.message}".`))})}destroy(){var r;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(r=t(_PDFWorker,l))==null||r.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(r){var o;if(!(r!=null&&r.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const d=(o=t(this,l))==null?void 0:o.get(r.port);if(d){if(d._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return d}return new _PDFWorker(r)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var r;try{return((r=globalThis.pdfjsWorker)==null?void 0:r.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};l=new WeakMap,rt(_PDFWorker,l);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(d,o,C,i,b){rt(this,A);rt(this,P,new Map);rt(this,R,new Map);rt(this,m,new Map);rt(this,g,null);this.messageHandler=d,this.loadingTask=o,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,this.canvasFactory=b.canvasFactory,this.filterFactory=b.filterFactory,this.cMapReaderFactory=b.cMapReaderFactory,this.standardFontDataFactory=b.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=C,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(d,o=_util.AnnotationMode.ENABLE,C=null,i=!1){let b=_util.RenderingIntentFlag.DISPLAY,S=_annotation_storage.SerializableEmpty;switch(d){case"any":b=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":b=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${d}`)}switch(o){case _util.AnnotationMode.DISABLE:b+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:b+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:b+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,S=(b&_util.RenderingIntentFlag.PRINT&&C instanceof _annotation_storage.PrintAnnotationStorage?C:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${o}`)}return i&&(b+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:b,cacheKey:`${b}_${S.hash}`,annotationStorageSerializable:S}}destroy(){var C;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(C=t(this,g))==null||C.reject(new Error("Worker was destroyed during onPassword callback"));const d=[];for(const i of t(this,R).values())d.push(i._destroy());t(this,R).clear(),t(this,m).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const o=this.messageHandler.sendWithPromise("Terminate",null);return d.push(o),Promise.all(d).then(()=>{var i;this.commonObjs.clear(),this.fontLoader.clear(),t(this,P).clear(),this.filterFactory.destroy(),(i=this._networkStream)==null||i.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:d,loadingTask:o}=this;d.on("GetReader",(C,i)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=b=>{this._lastProgress={loaded:b.loaded,total:b.total}},i.onPull=()=>{this._fullReader.read().then(function({value:b,done:S}){if(S){i.close();return}(0,_util.assert)(b instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(b),1,[b])}).catch(b=>{i.error(b)})},i.onCancel=b=>{this._fullReader.cancel(b),i.ready.catch(S=>{if(!this.destroyed)throw S})}}),d.on("ReaderHeadersReady",C=>{const i=new _util.PromiseCapability,b=this._fullReader;return b.headersReady.then(()=>{var S;(!b.isStreamingSupported||!b.isRangeSupported)&&(this._lastProgress&&((S=o.onProgress)==null||S.call(o,this._lastProgress)),b.onProgress=K=>{var U;(U=o.onProgress)==null||U.call(o,{loaded:K.loaded,total:K.total})}),i.resolve({isStreamingSupported:b.isStreamingSupported,isRangeSupported:b.isRangeSupported,contentLength:b.contentLength})},i.reject),i.promise}),d.on("GetRangeReader",(C,i)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const b=this._networkStream.getRangeReader(C.begin,C.end);if(!b){i.close();return}i.onPull=()=>{b.read().then(function({value:S,done:K}){if(K){i.close();return}(0,_util.assert)(S instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(S),1,[S])}).catch(S=>{i.error(S)})},i.onCancel=S=>{b.cancel(S),i.ready.catch(K=>{if(!this.destroyed)throw K})}}),d.on("GetDoc",({pdfInfo:C})=>{this._numPages=C.numPages,this._htmlForXfa=C.htmlForXfa,delete C.htmlForXfa,o._capability.resolve(new PDFDocumentProxy(C,this))}),d.on("DocException",function(C){let i;switch(C.name){case"PasswordException":i=new _util.PasswordException(C.message,C.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(C.message);break;case"MissingPDFException":i=new _util.MissingPDFException(C.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(C.message,C.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(C.message,C.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}o._capability.reject(i)}),d.on("PasswordRequest",C=>{if(lt(this,g,new _util.PromiseCapability),o.onPassword){const i=b=>{b instanceof Error?t(this,g).reject(b):t(this,g).resolve({password:b})};try{o.onPassword(i,C.code)}catch(b){t(this,g).reject(b)}}else t(this,g).reject(new _util.PasswordException(C.message,C.code));return t(this,g).promise}),d.on("DataLoaded",C=>{var i;(i=o.onProgress)==null||i.call(o,{loaded:C.length,total:C.length}),this.downloadInfoCapability.resolve(C)}),d.on("StartRenderPage",C=>{if(this.destroyed)return;t(this,R).get(C.pageIndex)._startRenderPage(C.transparency,C.cacheKey)}),d.on("commonobj",([C,i,b])=>{var S;if(!this.destroyed&&!this.commonObjs.has(C))switch(i){case"Font":const K=this._params;if("error"in b){const $=b.error;(0,_util.warn)(`Error during font loading: ${$}`),this.commonObjs.resolve(C,$);break}const U=K.pdfBug&&((S=globalThis.FontInspector)!=null&&S.enabled)?($,at)=>globalThis.FontInspector.fontAdded($,at):null,X=new _font_loader.FontFaceObject(b,{isEvalSupported:K.isEvalSupported,disableFontFace:K.disableFontFace,ignoreErrors:K.ignoreErrors,inspectFont:U});this.fontLoader.bind(X).catch($=>d.sendWithPromise("FontFallback",{id:C})).finally(()=>{!K.fontExtraProperties&&X.data&&(X.data=null),this.commonObjs.resolve(C,X)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(C,b);break;default:throw new Error(`Got unknown common object type ${i}`)}}),d.on("obj",([C,i,b,S])=>{var U;if(this.destroyed)return;const K=t(this,R).get(i);if(!K.objs.has(C))switch(b){case"Image":if(K.objs.resolve(C,S),S){let X;if(S.bitmap){const{width:$,height:at}=S;X=$*at*4}else X=((U=S.data)==null?void 0:U.length)||0;X>_util.MAX_IMAGE_SIZE_TO_CACHE&&(K._maybeCleanupAfterRender=!0)}break;case"Pattern":K.objs.resolve(C,S);break;default:throw new Error(`Got unknown object type ${b}`)}}),d.on("DocProgress",C=>{var i;this.destroyed||(i=o.onProgress)==null||i.call(o,{loaded:C.loaded,total:C.total})}),d.on("FetchBuiltInCMap",C=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(C):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),d.on("FetchStandardFontData",C=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(C):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var C;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:d,transfers:o}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:d,filename:((C=this._fullReader)==null?void 0:C.filename)??null},o).finally(()=>{this.annotationStorage.resetModified()})}getPage(d){if(!Number.isInteger(d)||d<=0||d>this._numPages)return Promise.reject(new Error("Invalid page request."));const o=d-1,C=t(this,m).get(o);if(C)return C;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:o}).then(b=>{if(this.destroyed)throw new Error("Transport destroyed");const S=new PDFPageProxy(o,b,this,this._params.pdfBug);return t(this,R).set(o,S),S});return t(this,m).set(o,i),i}getPageIndex(d){return typeof d!="object"||d===null||!Number.isInteger(d.num)||d.num<0||!Number.isInteger(d.gen)||d.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:d.num,gen:d.gen})}getAnnotations(d,o){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:d,intent:o})}getFieldObjects(){return Y(this,A,Ae).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,A,Ae).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(d){return typeof d!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:d})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,A,Ae).call(this,"GetDocJSActions")}getPageJSActions(d){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:d})}getStructTree(d){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:d})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(d=>new _optional_content_config.OptionalContentConfig(d))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const d="GetMetadata",o=t(this,P).get(d);if(o)return o;const C=this.messageHandler.sendWithPromise(d,null).then(i=>{var b,S;return{info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:((b=this._fullReader)==null?void 0:b.filename)??null,contentLength:((S=this._fullReader)==null?void 0:S.contentLength)??null}});return t(this,P).set(d,C),C}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(d=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const o of t(this,R).values())if(!o.cleanup())throw new Error(`startCleanup: Page ${o.pageNumber} is currently rendering.`);this.commonObjs.clear(),d||this.fontLoader.clear(),t(this,P).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:d,enableXfa:o}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:d,enableXfa:o})}}P=new WeakMap,R=new WeakMap,m=new WeakMap,g=new WeakMap,A=new WeakSet,Ae=function(d,o=null){const C=t(this,P).get(d);if(C)return C;const i=this.messageHandler.sendWithPromise(d,o);return t(this,P).set(d,i),i};class PDFObjects{constructor(){rt(this,x);rt(this,h,Object.create(null))}get(d,o=null){if(o){const i=Y(this,x,Me).call(this,d);return i.capability.promise.then(()=>o(i.data)),null}const C=t(this,h)[d];if(!(C!=null&&C.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${d}.`);return C.data}has(d){const o=t(this,h)[d];return(o==null?void 0:o.capability.settled)||!1}resolve(d,o=null){const C=Y(this,x,Me).call(this,d);C.data=o,C.capability.resolve()}clear(){var d;for(const o in t(this,h)){const{data:C}=t(this,h)[o];(d=C==null?void 0:C.bitmap)==null||d.close()}lt(this,h,Object.create(null))}}h=new WeakMap,x=new WeakSet,Me=function(d){var o;return(o=t(this,h))[d]||(o[d]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(d){rt(this,E,null);lt(this,E,d),this.onContinue=null}get promise(){return t(this,E).capability.promise}cancel(d=0){t(this,E).cancel(null,d)}get separateAnnots(){const{separateAnnots:d}=t(this,E).operatorList;if(!d)return!1;const{annotationCanvasMap:o}=t(this,E);return d.form||d.canvas&&(o==null?void 0:o.size)>0}}E=new WeakMap,exports.RenderTask=RenderTask;const u=class u{constructor({callback:d,params:o,objs:C,commonObjs:i,annotationCanvasMap:b,operatorList:S,pageIndex:K,canvasFactory:U,filterFactory:X,useRequestAnimationFrame:$=!1,pdfBug:at=!1,pageColors:F=null}){this.callback=d,this.params=o,this.objs=C,this.commonObjs=i,this.annotationCanvasMap=b,this.operatorListIdx=null,this.operatorList=S,this._pageIndex=K,this.canvasFactory=U,this.filterFactory=X,this._pdfBug=at,this.pageColors=F,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=$===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=o.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:d=!1,optionalContentConfig:o}){var K,U;if(this.cancelled)return;if(this._canvas){if(t(u,c).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(u,c).add(this._canvas)}this._pdfBug&&((K=globalThis.StepperManager)!=null&&K.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:C,viewport:i,transform:b,background:S}=this.params;this.gfx=new _canvas.CanvasGraphics(C,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:o},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:b,viewport:i,transparency:d,background:S}),this.operatorListIdx=0,this.graphicsReady=!0,(U=this.graphicsReadyCallback)==null||U.call(this)}cancel(d=null,o=0){var C;this.running=!1,this.cancelled=!0,(C=this.gfx)==null||C.endDrawing(),t(u,c).delete(this._canvas),this.callback(d||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,o))}operatorListChanged(){var d;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(d=this.stepper)==null||d.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(u,c).delete(this._canvas),this.callback())))}};c=new WeakMap,rt(u,c,new WeakSet);let InternalRenderTask=u;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(H,a,G)=>{var v,l,P,ms,m;Object.defineProperty(a,"__esModule",{value:!0}),a.SerializableEmpty=a.PrintAnnotationStorage=a.AnnotationStorage=void 0;var n=G(1),_=G(4),q=G(8);const B=Object.freeze({map:null,hash:"",transfers:void 0});a.SerializableEmpty=B;class tt{constructor(){rt(this,P);rt(this,v,!1);rt(this,l,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(A,f){const h=t(this,l).get(A);return h===void 0?f:Object.assign(f,h)}getRawValue(A){return t(this,l).get(A)}remove(A){if(t(this,l).delete(A),t(this,l).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of t(this,l).values())if(f instanceof _.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(A,f){const h=t(this,l).get(A);let x=!1;if(h!==void 0)for(const[M,E]of Object.entries(f))h[M]!==E&&(x=!0,h[M]=E);else x=!0,t(this,l).set(A,f);x&&Y(this,P,ms).call(this),f instanceof _.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(A){return t(this,l).has(A)}getAll(){return t(this,l).size>0?(0,n.objectFromMap)(t(this,l)):null}setAll(A){for(const[f,h]of Object.entries(A))this.setValue(f,h)}get size(){return t(this,l).size}resetModified(){t(this,v)&&(lt(this,v,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new L(this)}get serializable(){if(t(this,l).size===0)return B;const A=new Map,f=new q.MurmurHash3_64,h=[],x=Object.create(null);let M=!1;for(const[E,c]of t(this,l)){const u=c instanceof _.AnnotationEditor?c.serialize(!1,x):c;u&&(A.set(E,u),f.update(`${E}:${JSON.stringify(u)}`),M||(M=!!u.bitmap))}if(M)for(const E of A.values())E.bitmap&&h.push(E.bitmap);return A.size>0?{map:A,hash:f.hexdigest(),transfers:h}:B}}v=new WeakMap,l=new WeakMap,P=new WeakSet,ms=function(){t(this,v)||(lt(this,v,!0),typeof this.onSetModified=="function"&&this.onSetModified())},a.AnnotationStorage=tt;class L extends tt{constructor(f){super();rt(this,m);const{map:h,hash:x,transfers:M}=f.serializable,E=structuredClone(h,M?{transfer:M}:null);lt(this,m,{map:E,hash:x,transfers:M})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,m)}}m=new WeakMap,a.PrintAnnotationStorage=L},(H,a,G)=>{var L,v,l,P,R,m,g,A,f,h,x,M,E,c,u,De,Ie,o,Le,Ne,gs,bs,xs,Oe,As;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditor=void 0;var n=G(5),_=G(1),q=G(6);const $=class ${constructor(F){rt(this,u);rt(this,L,"");rt(this,v,!1);rt(this,l,null);rt(this,P,null);rt(this,R,null);rt(this,m,!1);rt(this,g,null);rt(this,A,this.focusin.bind(this));rt(this,f,this.focusout.bind(this));rt(this,h,!1);rt(this,x,!1);rt(this,M,!1);Kt(this,"_initialOptions",Object.create(null));Kt(this,"_uiManager",null);Kt(this,"_focusEventsAllowed",!0);Kt(this,"_l10nPromise",null);rt(this,E,!1);rt(this,c,$._zIndex++);this.constructor===$&&(0,_.unreachable)("Cannot initialize AnnotationEditor."),this.parent=F.parent,this.id=F.id,this.width=this.height=null,this.pageIndex=F.parent.pageIndex,this.name=F.name,this.div=null,this._uiManager=F.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=F.isCentered,this._structTreeParentId=null;const{rotation:W,rawDims:{pageWidth:Z,pageHeight:w,pageX:s,pageY:e}}=this.parent.viewport;this.rotation=W,this.pageRotation=(360+W-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Z,w],this.pageTranslation=[s,e];const[p,k]=this.parentDimensions;this.x=F.x/p,this.y=F.y/k,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,_.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(F){const W=new tt({id:F.parent.getNextId(),parent:F.parent,uiManager:F._uiManager});W.annotationElementId=F.annotationElementId,W.deleted=!0,W._uiManager.addToAnnotationStorage(W)}static initialize(F,W=null){if($._l10nPromise||($._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(w=>[w,F.get(w)]))),W!=null&&W.strings)for(const w of W.strings)$._l10nPromise.set(w,F.get(w));if($._borderLineWidth!==-1)return;const Z=getComputedStyle(document.documentElement);$._borderLineWidth=parseFloat(Z.getPropertyValue("--outline-width"))||0}static updateDefaultParams(F,W){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(F){return!1}static paste(F,W){(0,_.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,E)}set _isDraggable(F){var W;lt(this,E,F),(W=this.div)==null||W.classList.toggle("draggable",F)}center(){const[F,W]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*W/(F*2),this.y+=this.width*F/(W*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*W/(F*2),this.y-=this.width*F/(W*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(F){this._uiManager.addCommands(F)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,c)}setParent(F){F!==null&&(this.pageIndex=F.pageIndex,this.pageDimensions=F.pageDimensions),this.parent=F}focusin(F){this._focusEventsAllowed&&(t(this,h)?lt(this,h,!1):this.parent.setSelected(this))}focusout(F){var Z;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const W=F.relatedTarget;W!=null&&W.closest(`#${this.id}`)||(F.preventDefault(),(Z=this.parent)!=null&&Z.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(F,W,Z,w){const[s,e]=this.parentDimensions;[Z,w]=this.screenToPageTranslation(Z,w),this.x=(F+Z)/s,this.y=(W+w)/e,this.fixAndSetPosition()}translate(F,W){Y(this,u,De).call(this,this.parentDimensions,F,W)}translateInPage(F,W){Y(this,u,De).call(this,this.pageDimensions,F,W),this.div.scrollIntoView({block:"nearest"})}drag(F,W){const[Z,w]=this.parentDimensions;if(this.x+=F/Z,this.y+=W/w,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:j,y:I}=this.div.getBoundingClientRect();this.parent.findNewParent(this,j,I)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:e}=this;const[p,k]=Y(this,u,Ie).call(this);s+=p,e+=k,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*e).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[F,W]=this.pageDimensions;let{x:Z,y:w,width:s,height:e}=this;switch(s*=F,e*=W,Z*=F,w*=W,this.rotation){case 0:Z=Math.max(0,Math.min(F-s,Z)),w=Math.max(0,Math.min(W-e,w));break;case 90:Z=Math.max(0,Math.min(F-e,Z)),w=Math.min(W,Math.max(s,w));break;case 180:Z=Math.min(F,Math.max(s,Z)),w=Math.min(W,Math.max(e,w));break;case 270:Z=Math.min(F,Math.max(e,Z)),w=Math.max(0,Math.min(W-s,w));break}this.x=Z/=F,this.y=w/=W;const[p,k]=Y(this,u,Ie).call(this);Z+=p,w+=k;const{style:j}=this.div;j.left=`${(100*Z).toFixed(2)}%`,j.top=`${(100*w).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(F,W){var Z;return Y(Z=$,o,Le).call(Z,F,W,this.parentRotation)}pageTranslationToScreen(F,W){var Z;return Y(Z=$,o,Le).call(Z,F,W,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:F,pageDimensions:[W,Z]}=this,w=W*F,s=Z*F;return _.FeatureTest.isCSSRoundSupported?[Math.round(w),Math.round(s)]:[w,s]}setDims(F,W){var s;const[Z,w]=this.parentDimensions;this.div.style.width=`${(100*F/Z).toFixed(2)}%`,t(this,m)||(this.div.style.height=`${(100*W/w).toFixed(2)}%`),(s=t(this,l))==null||s.classList.toggle("small",F<$.SMALL_EDITOR_SIZE||W<$.SMALL_EDITOR_SIZE)}fixDims(){const{style:F}=this.div,{height:W,width:Z}=F,w=Z.endsWith("%"),s=!t(this,m)&&W.endsWith("%");if(w&&s)return;const[e,p]=this.parentDimensions;w||(F.width=`${(100*parseFloat(Z)/e).toFixed(2)}%`),!t(this,m)&&!s&&(F.height=`${(100*parseFloat(W)/p).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,l))return;const F=lt(this,l,document.createElement("button"));F.className="altText";const W=await $._l10nPromise.get("editor_alt_text_button_label");F.textContent=W,F.setAttribute("aria-label",W),F.tabIndex="0",F.addEventListener("contextmenu",q.noContextMenu),F.addEventListener("pointerdown",Z=>Z.stopPropagation()),F.addEventListener("click",Z=>{Z.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),F.addEventListener("keydown",Z=>{Z.target===F&&Z.key==="Enter"&&(Z.preventDefault(),this._uiManager.editAltText(this))}),Y(this,u,Oe).call(this),this.div.append(F),$.SMALL_EDITOR_SIZE||($.SMALL_EDITOR_SIZE=Math.min(128,Math.round(F.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,L),decorative:t(this,v)}}set altTextData({altText:F,decorative:W}){t(this,L)===F&&t(this,v)===W||(lt(this,L,F),lt(this,v,W),Y(this,u,Oe).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,A)),this.div.addEventListener("focusout",t(this,f));const[F,W]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*W/F).toFixed(2)}%`,this.div.style.maxHeight=`${(100*F/W).toFixed(2)}%`);const[Z,w]=this.getInitialTranslation();return this.translate(Z,w),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(F){const{isMac:W}=_.FeatureTest.platform;if(F.button!==0||F.ctrlKey&&W){F.preventDefault();return}lt(this,h,!0),Y(this,u,As).call(this,F)}moveInDOM(){var F;(F=this.parent)==null||F.moveEditorInDOM(this)}_setParentAndPosition(F,W,Z){F.changeParent(this),this.x=W,this.y=Z,this.fixAndSetPosition()}getRect(F,W){const Z=this.parentScale,[w,s]=this.pageDimensions,[e,p]=this.pageTranslation,k=F/Z,j=W/Z,I=this.x*w,V=this.y*s,et=this.width*w,ut=this.height*s;switch(this.rotation){case 0:return[I+k+e,s-V-j-ut+p,I+k+et+e,s-V-j+p];case 90:return[I+j+e,s-V+k+p,I+j+ut+e,s-V+k+et+p];case 180:return[I-k-et+e,s-V+j+p,I-k+e,s-V+j+ut+p];case 270:return[I-j-ut+e,s-V-k-et+p,I-j+e,s-V-k+p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(F,W){const[Z,w,s,e]=F,p=s-Z,k=e-w;switch(this.rotation){case 0:return[Z,W-e,p,k];case 90:return[Z,W-w,k,p];case 180:return[s,W-w,p,k];case 270:return[s,W-e,k,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){lt(this,M,!0)}disableEditMode(){lt(this,M,!1)}isInEditMode(){return t(this,M)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var F,W;(F=this.div)==null||F.addEventListener("focusin",t(this,A)),(W=this.div)==null||W.addEventListener("focusout",t(this,f))}serialize(F=!1,W=null){(0,_.unreachable)("An editor must be serializable")}static deserialize(F,W,Z){const w=new this.prototype.constructor({parent:W,id:W.getNextId(),uiManager:Z});w.rotation=F.rotation;const[s,e]=w.pageDimensions,[p,k,j,I]=w.getRectInCurrentCoords(F.rect,e);return w.x=p/s,w.y=k/e,w.width=j/s,w.height=I/e,w}remove(){var F;this.div.removeEventListener("focusin",t(this,A)),this.div.removeEventListener("focusout",t(this,f)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(F=t(this,l))==null||F.remove(),lt(this,l,null),lt(this,P,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,u,gs).call(this),t(this,g).classList.remove("hidden"))}select(){var F;this.makeResizable(),(F=this.div)==null||F.classList.add("selectedEditor")}unselect(){var F,W,Z;(F=t(this,g))==null||F.classList.add("hidden"),(W=this.div)==null||W.classList.remove("selectedEditor"),(Z=this.div)!=null&&Z.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(F,W){}disableEditing(){t(this,l)&&(t(this,l).hidden=!0)}enableEditing(){t(this,l)&&(t(this,l).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,x)}set isEditing(F){lt(this,x,F),this.parent&&(F?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(F,W){lt(this,m,!0);const Z=F/W,{style:w}=this.div;w.aspectRatio=Z,w.height="auto"}static get MIN_SIZE(){return 16}};L=new WeakMap,v=new WeakMap,l=new WeakMap,P=new WeakMap,R=new WeakMap,m=new WeakMap,g=new WeakMap,A=new WeakMap,f=new WeakMap,h=new WeakMap,x=new WeakMap,M=new WeakMap,E=new WeakMap,c=new WeakMap,u=new WeakSet,De=function([F,W],Z,w){[Z,w]=this.screenToPageTranslation(Z,w),this.x+=Z/F,this.y+=w/W,this.fixAndSetPosition()},Ie=function(){const[F,W]=this.parentDimensions,{_borderLineWidth:Z}=$,w=Z/F,s=Z/W;switch(this.rotation){case 90:return[-w,s];case 180:return[w,s];case 270:return[w,-s];default:return[-w,-s]}},o=new WeakSet,Le=function(F,W,Z){switch(Z){case 90:return[W,-F];case 180:return[-F,-W];case 270:return[-W,F];default:return[F,W]}},Ne=function(F){switch(F){case 90:{const[W,Z]=this.pageDimensions;return[0,-W/Z,Z/W,0]}case 180:return[-1,0,0,-1];case 270:{const[W,Z]=this.pageDimensions;return[0,W/Z,-Z/W,0]}default:return[1,0,0,1]}},gs=function(){if(t(this,g))return;lt(this,g,document.createElement("div")),t(this,g).classList.add("resizers");const F=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||F.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const W of F){const Z=document.createElement("div");t(this,g).append(Z),Z.classList.add("resizer",W),Z.addEventListener("pointerdown",Y(this,u,bs).bind(this,W)),Z.addEventListener("contextmenu",q.noContextMenu)}this.div.prepend(t(this,g))},bs=function(F,W){W.preventDefault();const{isMac:Z}=_.FeatureTest.platform;if(W.button!==0||W.ctrlKey&&Z)return;const w=Y(this,u,xs).bind(this,F),s=this._isDraggable;this._isDraggable=!1;const e={passive:!0,capture:!0};window.addEventListener("pointermove",w,e);const p=this.x,k=this.y,j=this.width,I=this.height,V=this.parent.div.style.cursor,et=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(W.target).cursor;const ut=()=>{this._isDraggable=s,window.removeEventListener("pointerup",ut),window.removeEventListener("blur",ut),window.removeEventListener("pointermove",w,e),this.parent.div.style.cursor=V,this.div.style.cursor=et;const dt=this.x,mt=this.y,xt=this.width,At=this.height;dt===p&&mt===k&&xt===j&&At===I||this.addCommands({cmd:()=>{this.width=xt,this.height=At,this.x=dt,this.y=mt;const[st,it]=this.parentDimensions;this.setDims(st*xt,it*At),this.fixAndSetPosition()},undo:()=>{this.width=j,this.height=I,this.x=p,this.y=k;const[st,it]=this.parentDimensions;this.setDims(st*j,it*I),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ut),window.addEventListener("blur",ut)},xs=function(F,W){const[Z,w]=this.parentDimensions,s=this.x,e=this.y,p=this.width,k=this.height,j=$.MIN_SIZE/Z,I=$.MIN_SIZE/w,V=kt=>Math.round(kt*1e4)/1e4,et=Y(this,u,Ne).call(this,this.rotation),ut=(kt,Nt)=>[et[0]*kt+et[2]*Nt,et[1]*kt+et[3]*Nt],dt=Y(this,u,Ne).call(this,360-this.rotation),mt=(kt,Nt)=>[dt[0]*kt+dt[2]*Nt,dt[1]*kt+dt[3]*Nt];let xt,At,st=!1,it=!1;switch(F){case"topLeft":st=!0,xt=(kt,Nt)=>[0,0],At=(kt,Nt)=>[kt,Nt];break;case"topMiddle":xt=(kt,Nt)=>[kt/2,0],At=(kt,Nt)=>[kt/2,Nt];break;case"topRight":st=!0,xt=(kt,Nt)=>[kt,0],At=(kt,Nt)=>[0,Nt];break;case"middleRight":it=!0,xt=(kt,Nt)=>[kt,Nt/2],At=(kt,Nt)=>[0,Nt/2];break;case"bottomRight":st=!0,xt=(kt,Nt)=>[kt,Nt],At=(kt,Nt)=>[0,0];break;case"bottomMiddle":xt=(kt,Nt)=>[kt/2,Nt],At=(kt,Nt)=>[kt/2,0];break;case"bottomLeft":st=!0,xt=(kt,Nt)=>[0,Nt],At=(kt,Nt)=>[kt,0];break;case"middleLeft":it=!0,xt=(kt,Nt)=>[0,Nt/2],At=(kt,Nt)=>[kt,Nt/2];break}const y=xt(p,k),N=At(p,k);let J=ut(...N);const nt=V(s+J[0]),ft=V(e+J[1]);let vt=1,_t=1,[Q,Ct]=this.screenToPageTranslation(W.movementX,W.movementY);if([Q,Ct]=mt(Q/Z,Ct/w),st){const kt=Math.hypot(p,k);vt=_t=Math.max(Math.min(Math.hypot(N[0]-y[0]-Q,N[1]-y[1]-Ct)/kt,1/p,1/k),j/p,I/k)}else it?vt=Math.max(j,Math.min(1,Math.abs(N[0]-y[0]-Q)))/p:_t=Math.max(I,Math.min(1,Math.abs(N[1]-y[1]-Ct)))/k;const St=V(p*vt),Ut=V(k*_t);J=ut(...At(St,Ut));const Ot=nt-J[0],zt=ft-J[1];this.width=St,this.height=Ut,this.x=Ot,this.y=zt,this.setDims(Z*St,w*Ut),this.fixAndSetPosition()},Oe=async function(){var Z;const F=t(this,l);if(!F)return;if(!t(this,L)&&!t(this,v)){F.classList.remove("done"),(Z=t(this,P))==null||Z.remove();return}$._l10nPromise.get("editor_alt_text_edit_button_label").then(w=>{F.setAttribute("aria-label",w)});let W=t(this,P);if(!W){lt(this,P,W=document.createElement("span")),W.className="tooltip",W.setAttribute("role","tooltip");const w=W.id=`alt-text-tooltip-${this.id}`;F.setAttribute("aria-describedby",w);const s=100;F.addEventListener("mouseenter",()=>{lt(this,R,setTimeout(()=>{lt(this,R,null),t(this,P).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},s))}),F.addEventListener("mouseleave",()=>{var e;clearTimeout(t(this,R)),lt(this,R,null),(e=t(this,P))==null||e.classList.remove("show")})}F.classList.add("done"),W.innerText=t(this,v)?await $._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,L),W.parentNode||F.append(W)},As=function(F){if(!this._isDraggable)return;const W=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Z,w;W&&(Z={passive:!0,capture:!0},w=e=>{const[p,k]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(p,k)},window.addEventListener("pointermove",w,Z));const s=()=>{if(window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),W&&window.removeEventListener("pointermove",w,Z),lt(this,h,!1),!this._uiManager.endDragSession()){const{isMac:e}=_.FeatureTest.platform;F.ctrlKey&&!e||F.shiftKey||F.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",s),window.addEventListener("blur",s)},rt($,o),Kt($,"_borderLineWidth",-1),Kt($,"_colorManager",new n.ColorManager),Kt($,"_zIndex",1),Kt($,"SMALL_EDITOR_SIZE",0);let B=$;a.AnnotationEditor=B;class tt extends B{constructor(F){super(F),this.annotationElementId=F.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(H,a,G)=>{var m,g,A,f,h,Be,E,c,u,r,d,ys,i,b,S,K,U,X,$,at,F,W,Z,w,s,e,p,k,j,I,V,et,ut,dt,mt,xt,At,st,it,y,N,J,nt,ft,vt,_t,Q,_s,Ue,He,ye,$e,We,Zt,de,vs,Es,Ge,ue,ze;Object.defineProperty(a,"__esModule",{value:!0}),a.KeyboardManager=a.CommandManager=a.ColorManager=a.AnnotationEditorUIManager=void 0,a.bindEvents=q,a.opacityToHex=B;var n=G(1),_=G(6);function q(Wt,O,gt){for(const wt of gt)O.addEventListener(wt,Wt[wt].bind(Wt))}function B(Wt){return Math.round(Math.min(255,Math.max(1,255*Wt))).toString(16).padStart(2,"0")}class tt{constructor(){rt(this,m,0)}getId(){return`${n.AnnotationEditorPrefix}${he(this,m)._++}`}}m=new WeakMap;const M=class M{constructor(){rt(this,h);rt(this,g,(0,n.getUuid)());rt(this,A,0);rt(this,f,null)}static get _isSVGFittingCanvas(){const O='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',wt=new OffscreenCanvas(1,3).getContext("2d"),Mt=new Image;Mt.src=O;const Lt=Mt.decode().then(()=>(wt.drawImage(Mt,0,0,1,1,0,0,1,3),new Uint32Array(wt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",Lt)}async getFromFile(O){const{lastModified:gt,name:wt,size:Mt,type:Lt}=O;return Y(this,h,Be).call(this,`${gt}_${wt}_${Mt}_${Lt}`,O)}async getFromUrl(O){return Y(this,h,Be).call(this,O,O)}async getFromId(O){t(this,f)||lt(this,f,new Map);const gt=t(this,f).get(O);return gt?gt.bitmap?(gt.refCounter+=1,gt):gt.file?this.getFromFile(gt.file):this.getFromUrl(gt.url):null}getSvgUrl(O){const gt=t(this,f).get(O);return gt!=null&&gt.isSvg?gt.svgUrl:null}deleteId(O){t(this,f)||lt(this,f,new Map);const gt=t(this,f).get(O);gt&&(gt.refCounter-=1,gt.refCounter===0&&(gt.bitmap=null))}isValidId(O){return O.startsWith(`image_${t(this,g)}_`)}};g=new WeakMap,A=new WeakMap,f=new WeakMap,h=new WeakSet,Be=async function(O,gt){t(this,f)||lt(this,f,new Map);let wt=t(this,f).get(O);if(wt===null)return null;if(wt!=null&&wt.bitmap)return wt.refCounter+=1,wt;try{wt||(wt={bitmap:null,id:`image_${t(this,g)}_${he(this,A)._++}`,refCounter:0,isSvg:!1});let Mt;if(typeof gt=="string"){wt.url=gt;const Lt=await fetch(gt);if(!Lt.ok)throw new Error(Lt.statusText);Mt=await Lt.blob()}else Mt=wt.file=gt;if(Mt.type==="image/svg+xml"){const Lt=M._isSVGFittingCanvas,Tt=new FileReader,D=new Image,T=new Promise((z,ht)=>{D.onload=()=>{wt.bitmap=D,wt.isSvg=!0,z()},Tt.onload=async()=>{const pt=wt.svgUrl=Tt.result;D.src=await Lt?`${pt}#svgView(preserveAspectRatio(none))`:pt},D.onerror=Tt.onerror=ht});Tt.readAsDataURL(Mt),await T}else wt.bitmap=await createImageBitmap(Mt);wt.refCounter=1}catch(Mt){console.error(Mt),wt=null}return t(this,f).set(O,wt),wt&&t(this,f).set(wt.id,wt),wt};let L=M;class v{constructor(O=128){rt(this,E,[]);rt(this,c,!1);rt(this,u);rt(this,r,-1);lt(this,u,O)}add({cmd:O,undo:gt,mustExec:wt,type:Mt=NaN,overwriteIfSameType:Lt=!1,keepUndo:Tt=!1}){if(wt&&O(),t(this,c))return;const D={cmd:O,undo:gt,type:Mt};if(t(this,r)===-1){t(this,E).length>0&&(t(this,E).length=0),lt(this,r,0),t(this,E).push(D);return}if(Lt&&t(this,E)[t(this,r)].type===Mt){Tt&&(D.undo=t(this,E)[t(this,r)].undo),t(this,E)[t(this,r)]=D;return}const T=t(this,r)+1;T===t(this,u)?t(this,E).splice(0,1):(lt(this,r,T),T<t(this,E).length&&t(this,E).splice(T)),t(this,E).push(D)}undo(){t(this,r)!==-1&&(lt(this,c,!0),t(this,E)[t(this,r)].undo(),lt(this,c,!1),lt(this,r,t(this,r)-1))}redo(){t(this,r)<t(this,E).length-1&&(lt(this,r,t(this,r)+1),lt(this,c,!0),t(this,E)[t(this,r)].cmd(),lt(this,c,!1))}hasSomethingToUndo(){return t(this,r)!==-1}hasSomethingToRedo(){return t(this,r)<t(this,E).length-1}destroy(){lt(this,E,null)}}E=new WeakMap,c=new WeakMap,u=new WeakMap,r=new WeakMap,a.CommandManager=v;class l{constructor(O){rt(this,d);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:gt}=n.FeatureTest.platform;for(const[wt,Mt,Lt={}]of O)for(const Tt of wt){const D=Tt.startsWith("mac+");gt&&D?(this.callbacks.set(Tt.slice(4),{callback:Mt,options:Lt}),this.allKeys.add(Tt.split("+").at(-1))):!gt&&!D&&(this.callbacks.set(Tt,{callback:Mt,options:Lt}),this.allKeys.add(Tt.split("+").at(-1)))}}exec(O,gt){if(!this.allKeys.has(gt.key))return;const wt=this.callbacks.get(Y(this,d,ys).call(this,gt));if(!wt)return;const{callback:Mt,options:{bubbles:Lt=!1,args:Tt=[],checker:D=null}}=wt;D&&!D(O,gt)||(Mt.bind(O,...Tt)(),Lt||(gt.stopPropagation(),gt.preventDefault()))}}d=new WeakSet,ys=function(O){O.altKey&&this.buffer.push("alt"),O.ctrlKey&&this.buffer.push("ctrl"),O.metaKey&&this.buffer.push("meta"),O.shiftKey&&this.buffer.push("shift"),this.buffer.push(O.key);const gt=this.buffer.join("+");return this.buffer.length=0,gt},a.KeyboardManager=l;const C=class C{get _colors(){const O=new Map([["CanvasText",null],["Canvas",null]]);return(0,_.getColorValues)(O),(0,n.shadow)(this,"_colors",O)}convert(O){const gt=(0,_.getRGB)(O);if(!window.matchMedia("(forced-colors: active)").matches)return gt;for(const[wt,Mt]of this._colors)if(Mt.every((Lt,Tt)=>Lt===gt[Tt]))return C._colorsMapping.get(wt);return gt}getHexCode(O){const gt=this._colors.get(O);return gt?n.Util.makeHexColor(...gt):O}};Kt(C,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let P=C;a.ColorManager=P;const Gt=class Gt{constructor(O,gt,wt,Mt,Lt,Tt){rt(this,Q);rt(this,i,null);rt(this,b,new Map);rt(this,S,new Map);rt(this,K,null);rt(this,U,null);rt(this,X,new v);rt(this,$,0);rt(this,at,new Set);rt(this,F,null);rt(this,W,null);rt(this,Z,new Set);rt(this,w,null);rt(this,s,new tt);rt(this,e,!1);rt(this,p,!1);rt(this,k,null);rt(this,j,n.AnnotationEditorType.NONE);rt(this,I,new Set);rt(this,V,null);rt(this,et,this.blur.bind(this));rt(this,ut,this.focus.bind(this));rt(this,dt,this.copy.bind(this));rt(this,mt,this.cut.bind(this));rt(this,xt,this.paste.bind(this));rt(this,At,this.keydown.bind(this));rt(this,st,this.onEditingAction.bind(this));rt(this,it,this.onPageChanging.bind(this));rt(this,y,this.onScaleChanging.bind(this));rt(this,N,this.onRotationChanging.bind(this));rt(this,J,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});rt(this,nt,[0,0]);rt(this,ft,null);rt(this,vt,null);rt(this,_t,null);lt(this,vt,O),lt(this,_t,gt),lt(this,K,wt),this._eventBus=Mt,this._eventBus._on("editingaction",t(this,st)),this._eventBus._on("pagechanging",t(this,it)),this._eventBus._on("scalechanging",t(this,y)),this._eventBus._on("rotationchanging",t(this,N)),lt(this,U,Lt.annotationStorage),lt(this,w,Lt.filterFactory),lt(this,V,Tt),this.viewParameters={realScale:_.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const O=Gt.prototype,gt=Lt=>{const{activeElement:Tt}=document;return Tt&&t(Lt,vt).contains(Tt)&&Lt.hasSomethingToControl()},wt=this.TRANSLATE_SMALL,Mt=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new l([[["ctrl+a","mac+meta+a"],O.selectAll],[["ctrl+z","mac+meta+z"],O.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],O.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],O.delete],[["Escape","mac+Escape"],O.unselectAll],[["ArrowLeft","mac+ArrowLeft"],O.translateSelectedEditors,{args:[-wt,0],checker:gt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],O.translateSelectedEditors,{args:[-Mt,0],checker:gt}],[["ArrowRight","mac+ArrowRight"],O.translateSelectedEditors,{args:[wt,0],checker:gt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],O.translateSelectedEditors,{args:[Mt,0],checker:gt}],[["ArrowUp","mac+ArrowUp"],O.translateSelectedEditors,{args:[0,-wt],checker:gt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],O.translateSelectedEditors,{args:[0,-Mt],checker:gt}],[["ArrowDown","mac+ArrowDown"],O.translateSelectedEditors,{args:[0,wt],checker:gt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],O.translateSelectedEditors,{args:[0,Mt],checker:gt}]]))}destroy(){Y(this,Q,ye).call(this),Y(this,Q,Ue).call(this),this._eventBus._off("editingaction",t(this,st)),this._eventBus._off("pagechanging",t(this,it)),this._eventBus._off("scalechanging",t(this,y)),this._eventBus._off("rotationchanging",t(this,N));for(const O of t(this,S).values())O.destroy();t(this,S).clear(),t(this,b).clear(),t(this,Z).clear(),lt(this,i,null),t(this,I).clear(),t(this,X).destroy(),t(this,K).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,V)?t(this,w).addHCMFilter(t(this,V).foreground,t(this,V).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,vt)).direction)}editAltText(O){var gt;(gt=t(this,K))==null||gt.editAltText(this,O)}onPageChanging({pageNumber:O}){lt(this,$,O-1)}focusMainContainer(){t(this,vt).focus()}findParent(O,gt){for(const wt of t(this,S).values()){const{x:Mt,y:Lt,width:Tt,height:D}=wt.div.getBoundingClientRect();if(O>=Mt&&O<=Mt+Tt&&gt>=Lt&&gt<=Lt+D)return wt}return null}disableUserSelect(O=!1){t(this,_t).classList.toggle("noUserSelect",O)}addShouldRescale(O){t(this,Z).add(O)}removeShouldRescale(O){t(this,Z).delete(O)}onScaleChanging({scale:O}){this.commitOrRemove(),this.viewParameters.realScale=O*_.PixelsPerInch.PDF_TO_CSS_UNITS;for(const gt of t(this,Z))gt.onScaleChanging()}onRotationChanging({pagesRotation:O}){this.commitOrRemove(),this.viewParameters.rotation=O}addToAnnotationStorage(O){!O.isEmpty()&&t(this,U)&&!t(this,U).has(O.id)&&t(this,U).setValue(O.id,O)}blur(){if(!this.hasSelection)return;const{activeElement:O}=document;for(const gt of t(this,I))if(gt.div.contains(O)){lt(this,k,[gt,O]),gt._focusEventsAllowed=!1;break}}focus(){if(!t(this,k))return;const[O,gt]=t(this,k);lt(this,k,null),gt.addEventListener("focusin",()=>{O._focusEventsAllowed=!0},{once:!0}),gt.focus()}addEditListeners(){Y(this,Q,He).call(this),Y(this,Q,$e).call(this)}removeEditListeners(){Y(this,Q,ye).call(this),Y(this,Q,We).call(this)}copy(O){var wt;if(O.preventDefault(),(wt=t(this,i))==null||wt.commitOrRemove(),!this.hasSelection)return;const gt=[];for(const Mt of t(this,I)){const Lt=Mt.serialize(!0);Lt&&gt.push(Lt)}gt.length!==0&&O.clipboardData.setData("application/pdfjs",JSON.stringify(gt))}cut(O){this.copy(O),this.delete()}paste(O){O.preventDefault();const{clipboardData:gt}=O;for(const Lt of gt.items)for(const Tt of t(this,W))if(Tt.isHandlingMimeForPasting(Lt.type)){Tt.paste(Lt,this.currentLayer);return}let wt=gt.getData("application/pdfjs");if(!wt)return;try{wt=JSON.parse(wt)}catch(Lt){(0,n.warn)(`paste: "${Lt.message}".`);return}if(!Array.isArray(wt))return;this.unselectAll();const Mt=this.currentLayer;try{const Lt=[];for(const T of wt){const z=Mt.deserialize(T);if(!z)return;Lt.push(z)}const Tt=()=>{for(const T of Lt)Y(this,Q,Ge).call(this,T);Y(this,Q,ze).call(this,Lt)},D=()=>{for(const T of Lt)T.remove()};this.addCommands({cmd:Tt,undo:D,mustExec:!0})}catch(Lt){(0,n.warn)(`paste: "${Lt.message}".`)}}keydown(O){var gt;(gt=this.getActive())!=null&&gt.shouldGetKeyboardEvents()||Gt._keyboardManager.exec(this,O)}onEditingAction(O){["undo","redo","delete","selectAll"].includes(O.name)&&this[O.name]()}setEditingState(O){O?(Y(this,Q,_s).call(this),Y(this,Q,He).call(this),Y(this,Q,$e).call(this),Y(this,Q,Zt).call(this,{isEditing:t(this,j)!==n.AnnotationEditorType.NONE,isEmpty:Y(this,Q,ue).call(this),hasSomethingToUndo:t(this,X).hasSomethingToUndo(),hasSomethingToRedo:t(this,X).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,Q,Ue).call(this),Y(this,Q,ye).call(this),Y(this,Q,We).call(this),Y(this,Q,Zt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(O){if(!t(this,W)){lt(this,W,O);for(const gt of t(this,W))Y(this,Q,de).call(this,gt.defaultPropertiesToUpdate)}}getId(){return t(this,s).getId()}get currentLayer(){return t(this,S).get(t(this,$))}getLayer(O){return t(this,S).get(O)}get currentPageIndex(){return t(this,$)}addLayer(O){t(this,S).set(O.pageIndex,O),t(this,e)?O.enable():O.disable()}removeLayer(O){t(this,S).delete(O.pageIndex)}updateMode(O,gt=null){if(t(this,j)!==O){if(lt(this,j,O),O===n.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,Q,Es).call(this);return}this.setEditingState(!0),Y(this,Q,vs).call(this),this.unselectAll();for(const wt of t(this,S).values())wt.updateMode(O);if(gt){for(const wt of t(this,b).values())if(wt.annotationElementId===gt){this.setSelected(wt),wt.enterInEditMode();break}}}}updateToolbar(O){O!==t(this,j)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:O})}updateParams(O,gt){if(t(this,W)){if(O===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(O);return}for(const wt of t(this,I))wt.updateParams(O,gt);for(const wt of t(this,W))wt.updateDefaultParams(O,gt)}}enableWaiting(O=!1){if(t(this,p)!==O){lt(this,p,O);for(const gt of t(this,S).values())O?gt.disableClick():gt.enableClick(),gt.div.classList.toggle("waiting",O)}}getEditors(O){const gt=[];for(const wt of t(this,b).values())wt.pageIndex===O&&gt.push(wt);return gt}getEditor(O){return t(this,b).get(O)}addEditor(O){t(this,b).set(O.id,O)}removeEditor(O){var gt;t(this,b).delete(O.id),this.unselect(O),(!O.annotationElementId||!t(this,at).has(O.annotationElementId))&&((gt=t(this,U))==null||gt.remove(O.id))}addDeletedAnnotationElement(O){t(this,at).add(O.annotationElementId),O.deleted=!0}isDeletedAnnotationElement(O){return t(this,at).has(O)}removeDeletedAnnotationElement(O){t(this,at).delete(O.annotationElementId),O.deleted=!1}setActiveEditor(O){t(this,i)!==O&&(lt(this,i,O),O&&Y(this,Q,de).call(this,O.propertiesToUpdate))}toggleSelected(O){if(t(this,I).has(O)){t(this,I).delete(O),O.unselect(),Y(this,Q,Zt).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,I).add(O),O.select(),Y(this,Q,de).call(this,O.propertiesToUpdate),Y(this,Q,Zt).call(this,{hasSelectedEditor:!0})}setSelected(O){for(const gt of t(this,I))gt!==O&&gt.unselect();t(this,I).clear(),t(this,I).add(O),O.select(),Y(this,Q,de).call(this,O.propertiesToUpdate),Y(this,Q,Zt).call(this,{hasSelectedEditor:!0})}isSelected(O){return t(this,I).has(O)}unselect(O){O.unselect(),t(this,I).delete(O),Y(this,Q,Zt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,I).size!==0}undo(){t(this,X).undo(),Y(this,Q,Zt).call(this,{hasSomethingToUndo:t(this,X).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,Q,ue).call(this)})}redo(){t(this,X).redo(),Y(this,Q,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,X).hasSomethingToRedo(),isEmpty:Y(this,Q,ue).call(this)})}addCommands(O){t(this,X).add(O),Y(this,Q,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,Q,ue).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const O=[...t(this,I)],gt=()=>{for(const Mt of O)Mt.remove()},wt=()=>{for(const Mt of O)Y(this,Q,Ge).call(this,Mt)};this.addCommands({cmd:gt,undo:wt,mustExec:!0})}commitOrRemove(){var O;(O=t(this,i))==null||O.commitOrRemove()}hasSomethingToControl(){return t(this,i)||this.hasSelection}selectAll(){for(const O of t(this,I))O.commit();Y(this,Q,ze).call(this,t(this,b).values())}unselectAll(){if(t(this,i)){t(this,i).commitOrRemove();return}if(this.hasSelection){for(const O of t(this,I))O.unselect();t(this,I).clear(),Y(this,Q,Zt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(O,gt,wt=!1){if(wt||this.commitOrRemove(),!this.hasSelection)return;t(this,nt)[0]+=O,t(this,nt)[1]+=gt;const[Mt,Lt]=t(this,nt),Tt=[...t(this,I)],D=1e3;t(this,ft)&&clearTimeout(t(this,ft)),lt(this,ft,setTimeout(()=>{lt(this,ft,null),t(this,nt)[0]=t(this,nt)[1]=0,this.addCommands({cmd:()=>{for(const T of Tt)t(this,b).has(T.id)&&T.translateInPage(Mt,Lt)},undo:()=>{for(const T of Tt)t(this,b).has(T.id)&&T.translateInPage(-Mt,-Lt)},mustExec:!1})},D));for(const T of Tt)T.translateInPage(O,gt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),lt(this,F,new Map);for(const O of t(this,I))t(this,F).set(O,{savedX:O.x,savedY:O.y,savedPageIndex:O.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,F))return!1;this.disableUserSelect(!1);const O=t(this,F);lt(this,F,null);let gt=!1;for(const[{x:Mt,y:Lt,pageIndex:Tt},D]of O)D.newX=Mt,D.newY=Lt,D.newPageIndex=Tt,gt||(gt=Mt!==D.savedX||Lt!==D.savedY||Tt!==D.savedPageIndex);if(!gt)return!1;const wt=(Mt,Lt,Tt,D)=>{if(t(this,b).has(Mt.id)){const T=t(this,S).get(D);T?Mt._setParentAndPosition(T,Lt,Tt):(Mt.pageIndex=D,Mt.x=Lt,Mt.y=Tt)}};return this.addCommands({cmd:()=>{for(const[Mt,{newX:Lt,newY:Tt,newPageIndex:D}]of O)wt(Mt,Lt,Tt,D)},undo:()=>{for(const[Mt,{savedX:Lt,savedY:Tt,savedPageIndex:D}]of O)wt(Mt,Lt,Tt,D)},mustExec:!0}),!0}dragSelectedEditors(O,gt){if(t(this,F))for(const wt of t(this,F).keys())wt.drag(O,gt)}rebuild(O){if(O.parent===null){const gt=this.getLayer(O.pageIndex);gt?(gt.changeParent(O),gt.addOrRebuild(O)):(this.addEditor(O),this.addToAnnotationStorage(O),O.rebuild())}else O.parent.addOrRebuild(O)}isActive(O){return t(this,i)===O}getActive(){return t(this,i)}getMode(){return t(this,j)}get imageManager(){return(0,n.shadow)(this,"imageManager",new L)}};i=new WeakMap,b=new WeakMap,S=new WeakMap,K=new WeakMap,U=new WeakMap,X=new WeakMap,$=new WeakMap,at=new WeakMap,F=new WeakMap,W=new WeakMap,Z=new WeakMap,w=new WeakMap,s=new WeakMap,e=new WeakMap,p=new WeakMap,k=new WeakMap,j=new WeakMap,I=new WeakMap,V=new WeakMap,et=new WeakMap,ut=new WeakMap,dt=new WeakMap,mt=new WeakMap,xt=new WeakMap,At=new WeakMap,st=new WeakMap,it=new WeakMap,y=new WeakMap,N=new WeakMap,J=new WeakMap,nt=new WeakMap,ft=new WeakMap,vt=new WeakMap,_t=new WeakMap,Q=new WeakSet,_s=function(){window.addEventListener("focus",t(this,ut)),window.addEventListener("blur",t(this,et))},Ue=function(){window.removeEventListener("focus",t(this,ut)),window.removeEventListener("blur",t(this,et))},He=function(){window.addEventListener("keydown",t(this,At),{capture:!0})},ye=function(){window.removeEventListener("keydown",t(this,At),{capture:!0})},$e=function(){document.addEventListener("copy",t(this,dt)),document.addEventListener("cut",t(this,mt)),document.addEventListener("paste",t(this,xt))},We=function(){document.removeEventListener("copy",t(this,dt)),document.removeEventListener("cut",t(this,mt)),document.removeEventListener("paste",t(this,xt))},Zt=function(O){Object.entries(O).some(([wt,Mt])=>t(this,J)[wt]!==Mt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,J),O)})},de=function(O){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:O})},vs=function(){if(!t(this,e)){lt(this,e,!0);for(const O of t(this,S).values())O.enable()}},Es=function(){if(this.unselectAll(),t(this,e)){lt(this,e,!1);for(const O of t(this,S).values())O.disable()}},Ge=function(O){const gt=t(this,S).get(O.pageIndex);gt?gt.addOrRebuild(O):this.addEditor(O)},ue=function(){if(t(this,b).size===0)return!0;if(t(this,b).size===1)for(const O of t(this,b).values())return O.isEmpty();return!1},ze=function(O){t(this,I).clear();for(const gt of O)gt.isEmpty()||(t(this,I).add(gt),gt.select());Y(this,Q,Zt).call(this,{hasSelectedEditor:!0})},Kt(Gt,"TRANSLATE_SMALL",1),Kt(Gt,"TRANSLATE_BIG",10);let R=Gt;a.AnnotationEditorUIManager=R},(H,a,G)=>{var $,at,F,W,Z,w,s,e,p,k,j,I,ae,oe,Ve,_e,ve,pe,fe;Object.defineProperty(a,"__esModule",{value:!0}),a.StatTimer=a.RenderingCancelledException=a.PixelsPerInch=a.PageViewport=a.PDFDateString=a.DOMStandardFontDataFactory=a.DOMSVGFactory=a.DOMFilterFactory=a.DOMCanvasFactory=a.DOMCMapReaderFactory=void 0,a.deprecated=r,a.getColorValues=b,a.getCurrentTransform=S,a.getCurrentTransformInverse=K,a.getFilenameFromUrl=h,a.getPdfFilenameFromUrl=x,a.getRGB=i,a.getXfaPageViewport=C,a.isDataScheme=A,a.isPdfFile=f,a.isValidFetchUrl=E,a.loadScript=u,a.noContextMenu=c,a.setLayerDimensions=U;var n=G(7),_=G(1);const q="http://www.w3.org/2000/svg",X=class X{};Kt(X,"CSS",96),Kt(X,"PDF",72),Kt(X,"PDF_TO_CSS_UNITS",X.CSS/X.PDF);let B=X;a.PixelsPerInch=B;class tt extends n.BaseFilterFactory{constructor({docId:y,ownerDocument:N=globalThis.document}={}){super();rt(this,I);rt(this,$);rt(this,at);rt(this,F);rt(this,W);rt(this,Z);rt(this,w);rt(this,s);rt(this,e);rt(this,p);rt(this,k);rt(this,j,0);lt(this,F,y),lt(this,W,N)}addFilter(y){if(!y)return"none";let N=t(this,I,ae).get(y);if(N)return N;let J,nt,ft,vt;if(y.length===1){const St=y[0],Ut=new Array(256);for(let Ot=0;Ot<256;Ot++)Ut[Ot]=St[Ot]/255;vt=J=nt=ft=Ut.join(",")}else{const[St,Ut,Ot]=y,zt=new Array(256),kt=new Array(256),Nt=new Array(256);for(let Vt=0;Vt<256;Vt++)zt[Vt]=St[Vt]/255,kt[Vt]=Ut[Vt]/255,Nt[Vt]=Ot[Vt]/255;J=zt.join(","),nt=kt.join(","),ft=Nt.join(","),vt=`${J}${nt}${ft}`}if(N=t(this,I,ae).get(vt),N)return t(this,I,ae).set(y,N),N;const _t=`g_${t(this,F)}_transfer_map_${he(this,j)._++}`,Q=`url(#${_t})`;t(this,I,ae).set(y,Q),t(this,I,ae).set(vt,Q);const Ct=Y(this,I,_e).call(this,_t);return Y(this,I,pe).call(this,J,nt,ft,Ct),Q}addHCMFilter(y,N){var Ut;const J=`${y}-${N}`;if(t(this,w)===J)return t(this,s);if(lt(this,w,J),lt(this,s,"none"),(Ut=t(this,Z))==null||Ut.remove(),!y||!N)return t(this,s);const nt=Y(this,I,fe).call(this,y);y=_.Util.makeHexColor(...nt);const ft=Y(this,I,fe).call(this,N);if(N=_.Util.makeHexColor(...ft),t(this,I,oe).style.color="",y==="#000000"&&N==="#ffffff"||y===N)return t(this,s);const vt=new Array(256);for(let Ot=0;Ot<=255;Ot++){const zt=Ot/255;vt[Ot]=zt<=.03928?zt/12.92:((zt+.055)/1.055)**2.4}const _t=vt.join(","),Q=`g_${t(this,F)}_hcm_filter`,Ct=lt(this,e,Y(this,I,_e).call(this,Q));Y(this,I,pe).call(this,_t,_t,_t,Ct),Y(this,I,Ve).call(this,Ct);const St=(Ot,zt)=>{const kt=nt[Ot]/255,Nt=ft[Ot]/255,Vt=new Array(zt+1);for(let Xt=0;Xt<=zt;Xt++)Vt[Xt]=kt+Xt/zt*(Nt-kt);return Vt.join(",")};return Y(this,I,pe).call(this,St(0,5),St(1,5),St(2,5),Ct),lt(this,s,`url(#${Q})`),t(this,s)}addHighlightHCMFilter(y,N,J,nt){var Nt;const ft=`${y}-${N}-${J}-${nt}`;if(t(this,p)===ft)return t(this,k);if(lt(this,p,ft),lt(this,k,"none"),(Nt=t(this,e))==null||Nt.remove(),!y||!N)return t(this,k);const[vt,_t]=[y,N].map(Y(this,I,fe).bind(this));let Q=Math.round(.2126*vt[0]+.7152*vt[1]+.0722*vt[2]),Ct=Math.round(.2126*_t[0]+.7152*_t[1]+.0722*_t[2]),[St,Ut]=[J,nt].map(Y(this,I,fe).bind(this));Ct<Q&&([Q,Ct,St,Ut]=[Ct,Q,Ut,St]),t(this,I,oe).style.color="";const Ot=(Vt,Xt,yt)=>{const ot=new Array(256),ct=(Ct-Q)/yt,Pt=Vt/255,Gt=(Xt-Vt)/(255*yt);let Wt=0;for(let O=0;O<=yt;O++){const gt=Math.round(Q+O*ct),wt=Pt+O*Gt;for(let Mt=Wt;Mt<=gt;Mt++)ot[Mt]=wt;Wt=gt+1}for(let O=Wt;O<256;O++)ot[O]=ot[Wt-1];return ot.join(",")},zt=`g_${t(this,F)}_hcm_highlight_filter`,kt=lt(this,e,Y(this,I,_e).call(this,zt));return Y(this,I,Ve).call(this,kt),Y(this,I,pe).call(this,Ot(St[0],Ut[0],5),Ot(St[1],Ut[1],5),Ot(St[2],Ut[2],5),kt),lt(this,k,`url(#${zt})`),t(this,k)}destroy(y=!1){y&&(t(this,s)||t(this,k))||(t(this,at)&&(t(this,at).parentNode.parentNode.remove(),lt(this,at,null)),t(this,$)&&(t(this,$).clear(),lt(this,$,null)),lt(this,j,0))}}$=new WeakMap,at=new WeakMap,F=new WeakMap,W=new WeakMap,Z=new WeakMap,w=new WeakMap,s=new WeakMap,e=new WeakMap,p=new WeakMap,k=new WeakMap,j=new WeakMap,I=new WeakSet,ae=function(){return t(this,$)||lt(this,$,new Map)},oe=function(){if(!t(this,at)){const y=t(this,W).createElement("div"),{style:N}=y;N.visibility="hidden",N.contain="strict",N.width=N.height=0,N.position="absolute",N.top=N.left=0,N.zIndex=-1;const J=t(this,W).createElementNS(q,"svg");J.setAttribute("width",0),J.setAttribute("height",0),lt(this,at,t(this,W).createElementNS(q,"defs")),y.append(J),J.append(t(this,at)),t(this,W).body.append(y)}return t(this,at)},Ve=function(y){const N=t(this,W).createElementNS(q,"feColorMatrix");N.setAttribute("type","matrix"),N.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),y.append(N)},_e=function(y){const N=t(this,W).createElementNS(q,"filter");return N.setAttribute("color-interpolation-filters","sRGB"),N.setAttribute("id",y),t(this,I,oe).append(N),N},ve=function(y,N,J){const nt=t(this,W).createElementNS(q,N);nt.setAttribute("type","discrete"),nt.setAttribute("tableValues",J),y.append(nt)},pe=function(y,N,J,nt){const ft=t(this,W).createElementNS(q,"feComponentTransfer");nt.append(ft),Y(this,I,ve).call(this,ft,"feFuncR",y),Y(this,I,ve).call(this,ft,"feFuncG",N),Y(this,I,ve).call(this,ft,"feFuncB",J)},fe=function(y){return t(this,I,oe).style.color=y,i(getComputedStyle(t(this,I,oe)).getPropertyValue("color"))},a.DOMFilterFactory=tt;class L extends n.BaseCanvasFactory{constructor({ownerDocument:it=globalThis.document}={}){super(),this._document=it}_createCanvas(it,y){const N=this._document.createElement("canvas");return N.width=it,N.height=y,N}}a.DOMCanvasFactory=L;async function v(st,it=!1){if(E(st,document.baseURI)){const y=await fetch(st);if(!y.ok)throw new Error(y.statusText);return it?new Uint8Array(await y.arrayBuffer()):(0,_.stringToBytes)(await y.text())}return new Promise((y,N)=>{const J=new XMLHttpRequest;J.open("GET",st,!0),it&&(J.responseType="arraybuffer"),J.onreadystatechange=()=>{if(J.readyState===XMLHttpRequest.DONE){if(J.status===200||J.status===0){let nt;if(it&&J.response?nt=new Uint8Array(J.response):!it&&J.responseText&&(nt=(0,_.stringToBytes)(J.responseText)),nt){y(nt);return}}N(new Error(J.statusText))}},J.send(null)})}class l extends n.BaseCMapReaderFactory{_fetchData(it,y){return v(it,this.isCompressed).then(N=>({cMapData:N,compressionType:y}))}}a.DOMCMapReaderFactory=l;class P extends n.BaseStandardFontDataFactory{_fetchData(it){return v(it,!0)}}a.DOMStandardFontDataFactory=P;class R extends n.BaseSVGFactory{_createSVG(it){return document.createElementNS(q,it)}}a.DOMSVGFactory=R;class m{constructor({viewBox:it,scale:y,rotation:N,offsetX:J=0,offsetY:nt=0,dontFlip:ft=!1}){this.viewBox=it,this.scale=y,this.rotation=N,this.offsetX=J,this.offsetY=nt;const vt=(it[2]+it[0])/2,_t=(it[3]+it[1])/2;let Q,Ct,St,Ut;switch(N%=360,N<0&&(N+=360),N){case 180:Q=-1,Ct=0,St=0,Ut=1;break;case 90:Q=0,Ct=1,St=1,Ut=0;break;case 270:Q=0,Ct=-1,St=-1,Ut=0;break;case 0:Q=1,Ct=0,St=0,Ut=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}ft&&(St=-St,Ut=-Ut);let Ot,zt,kt,Nt;Q===0?(Ot=Math.abs(_t-it[1])*y+J,zt=Math.abs(vt-it[0])*y+nt,kt=(it[3]-it[1])*y,Nt=(it[2]-it[0])*y):(Ot=Math.abs(vt-it[0])*y+J,zt=Math.abs(_t-it[1])*y+nt,kt=(it[2]-it[0])*y,Nt=(it[3]-it[1])*y),this.transform=[Q*y,Ct*y,St*y,Ut*y,Ot-Q*y*vt-St*y*_t,zt-Ct*y*vt-Ut*y*_t],this.width=kt,this.height=Nt}get rawDims(){const{viewBox:it}=this;return(0,_.shadow)(this,"rawDims",{pageWidth:it[2]-it[0],pageHeight:it[3]-it[1],pageX:it[0],pageY:it[1]})}clone({scale:it=this.scale,rotation:y=this.rotation,offsetX:N=this.offsetX,offsetY:J=this.offsetY,dontFlip:nt=!1}={}){return new m({viewBox:this.viewBox.slice(),scale:it,rotation:y,offsetX:N,offsetY:J,dontFlip:nt})}convertToViewportPoint(it,y){return _.Util.applyTransform([it,y],this.transform)}convertToViewportRectangle(it){const y=_.Util.applyTransform([it[0],it[1]],this.transform),N=_.Util.applyTransform([it[2],it[3]],this.transform);return[y[0],y[1],N[0],N[1]]}convertToPdfPoint(it,y){return _.Util.applyInverseTransform([it,y],this.transform)}}a.PageViewport=m;class g extends _.BaseException{constructor(it,y=0){super(it,"RenderingCancelledException"),this.extraDelay=y}}a.RenderingCancelledException=g;function A(st){const it=st.length;let y=0;for(;y<it&&st[y].trim()==="";)y++;return st.substring(y,y+5).toLowerCase()==="data:"}function f(st){return typeof st=="string"&&/\.pdf$/i.test(st)}function h(st,it=!1){return it||([st]=st.split(/[#?]/,1)),st.substring(st.lastIndexOf("/")+1)}function x(st,it="document.pdf"){if(typeof st!="string")return it;if(A(st))return(0,_.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),it;const y=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,N=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,J=y.exec(st);let nt=N.exec(J[1])||N.exec(J[2])||N.exec(J[3]);if(nt&&(nt=nt[0],nt.includes("%")))try{nt=N.exec(decodeURIComponent(nt))[0]}catch{}return nt||it}class M{constructor(){Kt(this,"started",Object.create(null));Kt(this,"times",[])}time(it){it in this.started&&(0,_.warn)(`Timer is already running for ${it}`),this.started[it]=Date.now()}timeEnd(it){it in this.started||(0,_.warn)(`Timer has not been started for ${it}`),this.times.push({name:it,start:this.started[it],end:Date.now()}),delete this.started[it]}toString(){const it=[];let y=0;for(const{name:N}of this.times)y=Math.max(N.length,y);for(const{name:N,start:J,end:nt}of this.times)it.push(`${N.padEnd(y)} ${nt-J}ms
`);return it.join("")}}a.StatTimer=M;function E(st,it){try{const{protocol:y}=it?new URL(st,it):new URL(st);return y==="http:"||y==="https:"}catch{return!1}}function c(st){st.preventDefault()}function u(st,it=!1){return new Promise((y,N)=>{const J=document.createElement("script");J.src=st,J.onload=function(nt){it&&J.remove(),y(nt)},J.onerror=function(){N(new Error(`Cannot load script at: ${J.src}`))},(document.head||document.documentElement).append(J)})}function r(st){console.log("Deprecated API usage: "+st)}let d;class o{static toDateObject(it){if(!it||typeof it!="string")return null;d||(d=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const y=d.exec(it);if(!y)return null;const N=parseInt(y[1],10);let J=parseInt(y[2],10);J=J>=1&&J<=12?J-1:0;let nt=parseInt(y[3],10);nt=nt>=1&&nt<=31?nt:1;let ft=parseInt(y[4],10);ft=ft>=0&&ft<=23?ft:0;let vt=parseInt(y[5],10);vt=vt>=0&&vt<=59?vt:0;let _t=parseInt(y[6],10);_t=_t>=0&&_t<=59?_t:0;const Q=y[7]||"Z";let Ct=parseInt(y[8],10);Ct=Ct>=0&&Ct<=23?Ct:0;let St=parseInt(y[9],10)||0;return St=St>=0&&St<=59?St:0,Q==="-"?(ft+=Ct,vt+=St):Q==="+"&&(ft-=Ct,vt-=St),new Date(Date.UTC(N,J,nt,ft,vt,_t))}}a.PDFDateString=o;function C(st,{scale:it=1,rotation:y=0}){const{width:N,height:J}=st.attributes.style,nt=[0,0,parseInt(N),parseInt(J)];return new m({viewBox:nt,scale:it,rotation:y})}function i(st){if(st.startsWith("#")){const it=parseInt(st.slice(1),16);return[(it&16711680)>>16,(it&65280)>>8,it&255]}return st.startsWith("rgb(")?st.slice(4,-1).split(",").map(it=>parseInt(it)):st.startsWith("rgba(")?st.slice(5,-1).split(",").map(it=>parseInt(it)).slice(0,3):((0,_.warn)(`Not a valid color format: "${st}"`),[0,0,0])}function b(st){const it=document.createElement("span");it.style.visibility="hidden",document.body.append(it);for(const y of st.keys()){it.style.color=y;const N=window.getComputedStyle(it).color;st.set(y,i(N))}it.remove()}function S(st){const{a:it,b:y,c:N,d:J,e:nt,f:ft}=st.getTransform();return[it,y,N,J,nt,ft]}function K(st){const{a:it,b:y,c:N,d:J,e:nt,f:ft}=st.getTransform().invertSelf();return[it,y,N,J,nt,ft]}function U(st,it,y=!1,N=!0){if(it instanceof m){const{pageWidth:J,pageHeight:nt}=it.rawDims,{style:ft}=st,vt=_.FeatureTest.isCSSRoundSupported,_t=`var(--scale-factor) * ${J}px`,Q=`var(--scale-factor) * ${nt}px`,Ct=vt?`round(${_t}, 1px)`:`calc(${_t})`,St=vt?`round(${Q}, 1px)`:`calc(${Q})`;!y||it.rotation%180===0?(ft.width=Ct,ft.height=St):(ft.width=St,ft.height=Ct)}N&&st.setAttribute("data-main-rotation",it.rotation)}},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BaseStandardFontDataFactory=a.BaseSVGFactory=a.BaseFilterFactory=a.BaseCanvasFactory=a.BaseCMapReaderFactory=void 0;var n=G(1);class _{constructor(){this.constructor===_&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(l){return"none"}addHCMFilter(l,P){return"none"}addHighlightHCMFilter(l,P,R,m){return"none"}destroy(l=!1){}}a.BaseFilterFactory=_;class q{constructor(){this.constructor===q&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(l,P){if(l<=0||P<=0)throw new Error("Invalid canvas size");const R=this._createCanvas(l,P);return{canvas:R,context:R.getContext("2d")}}reset(l,P,R){if(!l.canvas)throw new Error("Canvas is not specified");if(P<=0||R<=0)throw new Error("Invalid canvas size");l.canvas.width=P,l.canvas.height=R}destroy(l){if(!l.canvas)throw new Error("Canvas is not specified");l.canvas.width=0,l.canvas.height=0,l.canvas=null,l.context=null}_createCanvas(l,P){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}a.BaseCanvasFactory=q;class B{constructor({baseUrl:l=null,isCompressed:P=!0}){this.constructor===B&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=l,this.isCompressed=P}async fetch({name:l}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!l)throw new Error("CMap name must be specified.");const P=this.baseUrl+l+(this.isCompressed?".bcmap":""),R=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(P,R).catch(m=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${P}`)})}_fetchData(l,P){(0,n.unreachable)("Abstract method `_fetchData` called.")}}a.BaseCMapReaderFactory=B;class tt{constructor({baseUrl:l=null}){this.constructor===tt&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=l}async fetch({filename:l}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!l)throw new Error("Font filename must be specified.");const P=`${this.baseUrl}${l}`;return this._fetchData(P).catch(R=>{throw new Error(`Unable to load font data at: ${P}`)})}_fetchData(l){(0,n.unreachable)("Abstract method `_fetchData` called.")}}a.BaseStandardFontDataFactory=tt;class L{constructor(){this.constructor===L&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(l,P,R=!1){if(l<=0||P<=0)throw new Error("Invalid SVG dimensions");const m=this._createSVG("svg:svg");return m.setAttribute("version","1.1"),R||(m.setAttribute("width",`${l}px`),m.setAttribute("height",`${P}px`)),m.setAttribute("preserveAspectRatio","none"),m.setAttribute("viewBox",`0 0 ${l} ${P}`),m}createElement(l){if(typeof l!="string")throw new Error("Invalid SVG element type");return this._createSVG(l)}_createSVG(l){(0,n.unreachable)("Abstract method `_createSVG` called.")}}a.BaseSVGFactory=L},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MurmurHash3_64=void 0;var n=G(1);const _=3285377520,q=4294901760,B=65535;class tt{constructor(v){this.h1=v?v&4294967295:_,this.h2=v?v&4294967295:_}update(v){let l,P;if(typeof v=="string"){l=new Uint8Array(v.length*2),P=0;for(let r=0,d=v.length;r<d;r++){const o=v.charCodeAt(r);o<=255?l[P++]=o:(l[P++]=o>>>8,l[P++]=o&255)}}else if((0,n.isArrayBuffer)(v))l=v.slice(),P=l.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const R=P>>2,m=P-R*4,g=new Uint32Array(l.buffer,0,R);let A=0,f=0,h=this.h1,x=this.h2;const M=3432918353,E=461845907,c=M&B,u=E&B;for(let r=0;r<R;r++)r&1?(A=g[r],A=A*M&q|A*c&B,A=A<<15|A>>>17,A=A*E&q|A*u&B,h^=A,h=h<<13|h>>>19,h=h*5+3864292196):(f=g[r],f=f*M&q|f*c&B,f=f<<15|f>>>17,f=f*E&q|f*u&B,x^=f,x=x<<13|x>>>19,x=x*5+3864292196);switch(A=0,m){case 3:A^=l[R*4+2]<<16;case 2:A^=l[R*4+1]<<8;case 1:A^=l[R*4],A=A*M&q|A*c&B,A=A<<15|A>>>17,A=A*E&q|A*u&B,R&1?h^=A:x^=A}this.h1=h,this.h2=x}hexdigest(){let v=this.h1,l=this.h2;return v^=l>>>1,v=v*3981806797&q|v*36045&B,l=l*4283543511&q|((l<<16|v>>>16)*2950163797&q)>>>16,v^=l>>>1,v=v*444984403&q|v*60499&B,l=l*3301882366&q|((l<<16|v>>>16)*3120437893&q)>>>16,v^=l>>>1,(v>>>0).toString(16).padStart(8,"0")+(l>>>0).toString(16).padStart(8,"0")}}a.MurmurHash3_64=tt},(H,a,G)=>{var B;Object.defineProperty(a,"__esModule",{value:!0}),a.FontLoader=a.FontFaceObject=void 0;var n=G(1);class _{constructor({ownerDocument:L=globalThis.document,styleElement:v=null}){rt(this,B,new Set);this._document=L,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(L){this.nativeFontFaces.add(L),this._document.fonts.add(L)}removeNativeFontFace(L){this.nativeFontFaces.delete(L),this._document.fonts.delete(L)}insertRule(L){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const v=this.styleElement.sheet;v.insertRule(L,v.cssRules.length)}clear(){for(const L of this.nativeFontFaces)this._document.fonts.delete(L);this.nativeFontFaces.clear(),t(this,B).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(L){if(!(!L||t(this,B).has(L.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:v,src:l,style:P}=L,R=new FontFace(v,l,P);this.addNativeFontFace(R);try{await R.load(),t(this,B).add(v)}catch{(0,n.warn)(`Cannot load system font: ${L.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(R)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(L){if(L.attached||L.missingFile&&!L.systemFontInfo)return;if(L.attached=!0,L.systemFontInfo){await this.loadSystemFont(L.systemFontInfo);return}if(this.isFontLoadingAPISupported){const l=L.createNativeFontFace();if(l){this.addNativeFontFace(l);try{await l.loaded}catch(P){throw(0,n.warn)(`Failed to load font '${l.family}': '${P}'.`),L.disableFontFace=!0,P}}return}const v=L.createFontFaceRule();if(v){if(this.insertRule(v),this.isSyncFontLoadingSupported)return;await new Promise(l=>{const P=this._queueLoadingCallback(l);this._prepareFontLoadEvent(L,P)})}}get isFontLoadingAPISupported(){var v;const L=!!((v=this._document)!=null&&v.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",L)}get isSyncFontLoadingSupported(){let L=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(L=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",L)}_queueLoadingCallback(L){function v(){for((0,n.assert)(!P.done,"completeRequest() cannot be called twice."),P.done=!0;l.length>0&&l[0].done;){const R=l.shift();setTimeout(R.callback,0)}}const{loadingRequests:l}=this,P={done:!1,complete:v,callback:L};return l.push(P),P}get _loadTestFont(){const L=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",L)}_prepareFontLoadEvent(L,v){function l(i,b){return i.charCodeAt(b)<<24|i.charCodeAt(b+1)<<16|i.charCodeAt(b+2)<<8|i.charCodeAt(b+3)&255}function P(i,b,S,K){const U=i.substring(0,b),X=i.substring(b+S);return U+K+X}let R,m;const g=this._document.createElement("canvas");g.width=1,g.height=1;const A=g.getContext("2d");let f=0;function h(i,b){if(++f>30){(0,n.warn)("Load test font never loaded."),b();return}if(A.font="30px "+i,A.fillText(".",0,20),A.getImageData(0,0,1,1).data[3]>0){b();return}setTimeout(h.bind(null,i,b))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let M=this._loadTestFont;M=P(M,976,x.length,x);const c=16,u=1482184792;let r=l(M,c);for(R=0,m=x.length-3;R<m;R+=4)r=r-u+l(x,R)|0;R<x.length&&(r=r-u+l(x+"XXX",R)|0),M=P(M,c,4,(0,n.string32)(r));const d=`url(data:font/opentype;base64,${btoa(M)});`,o=`@font-face {font-family:"${x}";src:${d}}`;this.insertRule(o);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const i of[L.loadedName,x]){const b=this._document.createElement("span");b.textContent="Hi",b.style.fontFamily=i,C.append(b)}this._document.body.append(C),h(x,()=>{C.remove(),v.complete()})}}B=new WeakMap,a.FontLoader=_;class q{constructor(L,{isEvalSupported:v=!0,disableFontFace:l=!1,ignoreErrors:P=!1,inspectFont:R=null}){this.compiledGlyphs=Object.create(null);for(const m in L)this[m]=L[m];this.isEvalSupported=v!==!1,this.disableFontFace=l===!0,this.ignoreErrors=P===!0,this._inspectFont=R}createNativeFontFace(){var v;if(!this.data||this.disableFontFace)return null;let L;if(!this.cssFontInfo)L=new FontFace(this.loadedName,this.data,{});else{const l={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(l.style=`oblique ${this.cssFontInfo.italicAngle}deg`),L=new FontFace(this.cssFontInfo.fontFamily,this.data,l)}return(v=this._inspectFont)==null||v.call(this,this),L}createFontFaceRule(){var P;if(!this.data||this.disableFontFace)return null;const L=(0,n.bytesToString)(this.data),v=`url(data:${this.mimetype};base64,${btoa(L)});`;let l;if(!this.cssFontInfo)l=`@font-face {font-family:"${this.loadedName}";src:${v}}`;else{let R=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(R+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),l=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${R}src:${v}}`}return(P=this._inspectFont)==null||P.call(this,this,v),l}getPathGenerator(L,v){if(this.compiledGlyphs[v]!==void 0)return this.compiledGlyphs[v];let l;try{l=L.get(this.loadedName+"_path_"+v)}catch(P){if(!this.ignoreErrors)throw P;return(0,n.warn)(`getPathGenerator - ignoring character: "${P}".`),this.compiledGlyphs[v]=function(R,m){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const P=[];for(const R of l){const m=R.args!==void 0?R.args.join(","):"";P.push("c.",R.cmd,"(",m,`);
`)}return this.compiledGlyphs[v]=new Function("c","size",P.join(""))}return this.compiledGlyphs[v]=function(P,R){for(const m of l)m.cmd==="scale"&&(m.args=[R,-R]),P[m.cmd].apply(P,m.args)}}}a.FontFaceObject=q},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NodeStandardFontDataFactory=a.NodeFilterFactory=a.NodeCanvasFactory=a.NodeCMapReaderFactory=void 0;var n=G(7);G(1);const _=function(v){return new Promise((l,P)=>{require$$5.readFile(v,(m,g)=>{if(m||!g){P(new Error(m));return}l(new Uint8Array(g))})})};class q extends n.BaseFilterFactory{}a.NodeFilterFactory=q;class B extends n.BaseCanvasFactory{_createCanvas(l,P){return require$$5.createCanvas(l,P)}}a.NodeCanvasFactory=B;class tt extends n.BaseCMapReaderFactory{_fetchData(l,P){return _(l).then(R=>({cMapData:R,compressionType:P}))}}a.NodeCMapReaderFactory=tt;class L extends n.BaseStandardFontDataFactory{_fetchData(l){return _(l)}}a.NodeStandardFontDataFactory=L},(H,a,G)=>{var at,qe,Xe;Object.defineProperty(a,"__esModule",{value:!0}),a.CanvasGraphics=void 0;var n=G(1),_=G(6),q=G(12),B=G(13);const tt=16,L=100,v=4096,l=15,P=10,R=1e3,m=16;function g(w,s){if(w._removeMirroring)throw new Error("Context is already forwarding operations.");w.__originalSave=w.save,w.__originalRestore=w.restore,w.__originalRotate=w.rotate,w.__originalScale=w.scale,w.__originalTranslate=w.translate,w.__originalTransform=w.transform,w.__originalSetTransform=w.setTransform,w.__originalResetTransform=w.resetTransform,w.__originalClip=w.clip,w.__originalMoveTo=w.moveTo,w.__originalLineTo=w.lineTo,w.__originalBezierCurveTo=w.bezierCurveTo,w.__originalRect=w.rect,w.__originalClosePath=w.closePath,w.__originalBeginPath=w.beginPath,w._removeMirroring=()=>{w.save=w.__originalSave,w.restore=w.__originalRestore,w.rotate=w.__originalRotate,w.scale=w.__originalScale,w.translate=w.__originalTranslate,w.transform=w.__originalTransform,w.setTransform=w.__originalSetTransform,w.resetTransform=w.__originalResetTransform,w.clip=w.__originalClip,w.moveTo=w.__originalMoveTo,w.lineTo=w.__originalLineTo,w.bezierCurveTo=w.__originalBezierCurveTo,w.rect=w.__originalRect,w.closePath=w.__originalClosePath,w.beginPath=w.__originalBeginPath,delete w._removeMirroring},w.save=function(){s.save(),this.__originalSave()},w.restore=function(){s.restore(),this.__originalRestore()},w.translate=function(p,k){s.translate(p,k),this.__originalTranslate(p,k)},w.scale=function(p,k){s.scale(p,k),this.__originalScale(p,k)},w.transform=function(p,k,j,I,V,et){s.transform(p,k,j,I,V,et),this.__originalTransform(p,k,j,I,V,et)},w.setTransform=function(p,k,j,I,V,et){s.setTransform(p,k,j,I,V,et),this.__originalSetTransform(p,k,j,I,V,et)},w.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},w.rotate=function(p){s.rotate(p),this.__originalRotate(p)},w.clip=function(p){s.clip(p),this.__originalClip(p)},w.moveTo=function(e,p){s.moveTo(e,p),this.__originalMoveTo(e,p)},w.lineTo=function(e,p){s.lineTo(e,p),this.__originalLineTo(e,p)},w.bezierCurveTo=function(e,p,k,j,I,V){s.bezierCurveTo(e,p,k,j,I,V),this.__originalBezierCurveTo(e,p,k,j,I,V)},w.rect=function(e,p,k,j){s.rect(e,p,k,j),this.__originalRect(e,p,k,j)},w.closePath=function(){s.closePath(),this.__originalClosePath()},w.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class A{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,e,p){let k;return this.cache[s]!==void 0?(k=this.cache[s],this.canvasFactory.reset(k,e,p)):(k=this.canvasFactory.create(e,p),this.cache[s]=k),k}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const e=this.cache[s];this.canvasFactory.destroy(e),delete this.cache[s]}}}function f(w,s,e,p,k,j,I,V,et,ut){const[dt,mt,xt,At,st,it]=(0,_.getCurrentTransform)(w);if(mt===0&&xt===0){const J=I*dt+st,nt=Math.round(J),ft=V*At+it,vt=Math.round(ft),_t=(I+et)*dt+st,Q=Math.abs(Math.round(_t)-nt)||1,Ct=(V+ut)*At+it,St=Math.abs(Math.round(Ct)-vt)||1;return w.setTransform(Math.sign(dt),0,0,Math.sign(At),nt,vt),w.drawImage(s,e,p,k,j,0,0,Q,St),w.setTransform(dt,mt,xt,At,st,it),[Q,St]}if(dt===0&&At===0){const J=V*xt+st,nt=Math.round(J),ft=I*mt+it,vt=Math.round(ft),_t=(V+ut)*xt+st,Q=Math.abs(Math.round(_t)-nt)||1,Ct=(I+et)*mt+it,St=Math.abs(Math.round(Ct)-vt)||1;return w.setTransform(0,Math.sign(mt),Math.sign(xt),0,nt,vt),w.drawImage(s,e,p,k,j,0,0,St,Q),w.setTransform(dt,mt,xt,At,st,it),[St,Q]}w.drawImage(s,e,p,k,j,I,V,et,ut);const y=Math.hypot(dt,mt),N=Math.hypot(xt,At);return[y*et,N*ut]}function h(w){const{width:s,height:e}=w;if(s>R||e>R)return null;const p=1e3,k=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),j=s+1;let I=new Uint8Array(j*(e+1)),V,et,ut;const dt=s+7&-8;let mt=new Uint8Array(dt*e),xt=0;for(const N of w.data){let J=128;for(;J>0;)mt[xt++]=N&J?0:255,J>>=1}let At=0;for(xt=0,mt[xt]!==0&&(I[0]=1,++At),et=1;et<s;et++)mt[xt]!==mt[xt+1]&&(I[et]=mt[xt]?2:1,++At),xt++;for(mt[xt]!==0&&(I[et]=2,++At),V=1;V<e;V++){xt=V*dt,ut=V*j,mt[xt-dt]!==mt[xt]&&(I[ut]=mt[xt]?1:8,++At);let N=(mt[xt]?4:0)+(mt[xt-dt]?8:0);for(et=1;et<s;et++)N=(N>>2)+(mt[xt+1]?4:0)+(mt[xt-dt+1]?8:0),k[N]&&(I[ut+et]=k[N],++At),xt++;if(mt[xt-dt]!==mt[xt]&&(I[ut+et]=mt[xt]?2:4,++At),At>p)return null}for(xt=dt*(e-1),ut=V*j,mt[xt]!==0&&(I[ut]=8,++At),et=1;et<s;et++)mt[xt]!==mt[xt+1]&&(I[ut+et]=mt[xt]?4:8,++At),xt++;if(mt[xt]!==0&&(I[ut+et]=4,++At),At>p)return null;const st=new Int32Array([0,j,-1,0,-j,0,0,0,1]),it=new Path2D;for(V=0;At&&V<=e;V++){let N=V*j;const J=N+s;for(;N<J&&!I[N];)N++;if(N===J)continue;it.moveTo(N%j,V);const nt=N;let ft=I[N];do{const vt=st[ft];do N+=vt;while(!I[N]);const _t=I[N];_t!==5&&_t!==10?(ft=_t,I[N]=0):(ft=_t&51*ft>>4,I[N]&=ft>>2|ft<<2),it.lineTo(N%j,N/j|0),I[N]||--At}while(nt!==N);--V}return mt=null,I=null,function(N){N.save(),N.scale(1/s,-1/e),N.translate(0,-e),N.fill(it),N.beginPath(),N.restore()}}class x{constructor(s,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,e])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,e){this.x=s,this.y=e}updatePathMinMax(s,e,p){[e,p]=n.Util.applyTransform([e,p],s),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,p),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,p)}updateRectMinMax(s,e){const p=n.Util.applyTransform(e,s),k=n.Util.applyTransform(e.slice(2),s);this.minX=Math.min(this.minX,p[0],k[0]),this.minY=Math.min(this.minY,p[1],k[1]),this.maxX=Math.max(this.maxX,p[0],k[0]),this.maxY=Math.max(this.maxY,p[1],k[1])}updateScalingPathMinMax(s,e){n.Util.scaleMinMax(s,e),this.minX=Math.min(this.minX,e[0]),this.maxX=Math.max(this.maxX,e[1]),this.minY=Math.min(this.minY,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(s,e,p,k,j,I,V,et,ut,dt){const mt=n.Util.bezierBoundingBox(e,p,k,j,I,V,et,ut);if(dt){dt[0]=Math.min(dt[0],mt[0],mt[2]),dt[1]=Math.max(dt[1],mt[0],mt[2]),dt[2]=Math.min(dt[2],mt[1],mt[3]),dt[3]=Math.max(dt[3],mt[1],mt[3]);return}this.updateRectMinMax(s,mt)}getPathBoundingBox(s=q.PathType.FILL,e=null){const p=[this.minX,this.minY,this.maxX,this.maxY];if(s===q.PathType.STROKE){e||(0,n.unreachable)("Stroke bounding box must include transform.");const k=n.Util.singularValueDecompose2dScale(e),j=k[0]*this.lineWidth/2,I=k[1]*this.lineWidth/2;p[0]-=j,p[1]-=I,p[2]+=j,p[3]+=I}return p}updateClipFromPath(){const s=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=q.PathType.FILL,e=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(s,e))}}function M(w,s){if(typeof ImageData<"u"&&s instanceof ImageData){w.putImageData(s,0,0);return}const e=s.height,p=s.width,k=e%m,j=(e-k)/m,I=k===0?j:j+1,V=w.createImageData(p,m);let et=0,ut;const dt=s.data,mt=V.data;let xt,At,st,it;if(s.kind===n.ImageKind.GRAYSCALE_1BPP){const y=dt.byteLength,N=new Uint32Array(mt.buffer,0,mt.byteLength>>2),J=N.length,nt=p+7>>3,ft=4294967295,vt=n.FeatureTest.isLittleEndian?4278190080:255;for(xt=0;xt<I;xt++){for(st=xt<j?m:k,ut=0,At=0;At<st;At++){const _t=y-et;let Q=0;const Ct=_t>nt?p:_t*8-7,St=Ct&-8;let Ut=0,Ot=0;for(;Q<St;Q+=8)Ot=dt[et++],N[ut++]=Ot&128?ft:vt,N[ut++]=Ot&64?ft:vt,N[ut++]=Ot&32?ft:vt,N[ut++]=Ot&16?ft:vt,N[ut++]=Ot&8?ft:vt,N[ut++]=Ot&4?ft:vt,N[ut++]=Ot&2?ft:vt,N[ut++]=Ot&1?ft:vt;for(;Q<Ct;Q++)Ut===0&&(Ot=dt[et++],Ut=128),N[ut++]=Ot&Ut?ft:vt,Ut>>=1}for(;ut<J;)N[ut++]=0;w.putImageData(V,0,xt*m)}}else if(s.kind===n.ImageKind.RGBA_32BPP){for(At=0,it=p*m*4,xt=0;xt<j;xt++)mt.set(dt.subarray(et,et+it)),et+=it,w.putImageData(V,0,At),At+=m;xt<I&&(it=p*k*4,mt.set(dt.subarray(et,et+it)),w.putImageData(V,0,At))}else if(s.kind===n.ImageKind.RGB_24BPP)for(st=m,it=p*st,xt=0;xt<I;xt++){for(xt>=j&&(st=k,it=p*st),ut=0,At=it;At--;)mt[ut++]=dt[et++],mt[ut++]=dt[et++],mt[ut++]=dt[et++],mt[ut++]=255;w.putImageData(V,0,xt*m)}else throw new Error(`bad image kind: ${s.kind}`)}function E(w,s){if(s.bitmap){w.drawImage(s.bitmap,0,0);return}const e=s.height,p=s.width,k=e%m,j=(e-k)/m,I=k===0?j:j+1,V=w.createImageData(p,m);let et=0;const ut=s.data,dt=V.data;for(let mt=0;mt<I;mt++){const xt=mt<j?m:k;({srcPos:et}=(0,B.convertBlackAndWhiteToRGBA)({src:ut,srcPos:et,dest:dt,width:p,height:xt,nonBlackColor:0})),w.putImageData(V,0,mt*m)}}function c(w,s){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const p of e)w[p]!==void 0&&(s[p]=w[p]);w.setLineDash!==void 0&&(s.setLineDash(w.getLineDash()),s.lineDashOffset=w.lineDashOffset)}function u(w){if(w.strokeStyle=w.fillStyle="#000000",w.fillRule="nonzero",w.globalAlpha=1,w.lineWidth=1,w.lineCap="butt",w.lineJoin="miter",w.miterLimit=10,w.globalCompositeOperation="source-over",w.font="10px sans-serif",w.setLineDash!==void 0&&(w.setLineDash([]),w.lineDashOffset=0),!n.isNodeJS){const{filter:s}=w;s!=="none"&&s!==""&&(w.filter="none")}}function r(w,s,e,p){const k=w.length;for(let j=3;j<k;j+=4){const I=w[j];if(I===0)w[j-3]=s,w[j-2]=e,w[j-1]=p;else if(I<255){const V=255-I;w[j-3]=w[j-3]*I+s*V>>8,w[j-2]=w[j-2]*I+e*V>>8,w[j-1]=w[j-1]*I+p*V>>8}}}function d(w,s,e){const p=w.length,k=1/255;for(let j=3;j<p;j+=4){const I=e?e[w[j]]:w[j];s[j]=s[j]*I*k|0}}function o(w,s,e){const p=w.length;for(let k=3;k<p;k+=4){const j=w[k-3]*77+w[k-2]*152+w[k-1]*28;s[k]=e?s[k]*e[j>>8]>>8:s[k]*j>>16}}function C(w,s,e,p,k,j,I,V,et,ut,dt){const mt=!!j,xt=mt?j[0]:0,At=mt?j[1]:0,st=mt?j[2]:0,it=k==="Luminosity"?o:d,N=Math.min(p,Math.ceil(1048576/e));for(let J=0;J<p;J+=N){const nt=Math.min(N,p-J),ft=w.getImageData(V-ut,J+(et-dt),e,nt),vt=s.getImageData(V,J+et,e,nt);mt&&r(ft.data,xt,At,st),it(ft.data,vt.data,I),s.putImageData(vt,V,J+et)}}function i(w,s,e,p){const k=p[0],j=p[1],I=p[2]-k,V=p[3]-j;I===0||V===0||(C(s.context,e,I,V,s.subtype,s.backdrop,s.transferMap,k,j,s.offsetX,s.offsetY),w.save(),w.globalAlpha=1,w.globalCompositeOperation="source-over",w.setTransform(1,0,0,1,0,0),w.drawImage(e.canvas,0,0),w.restore())}function b(w,s){const e=n.Util.singularValueDecompose2dScale(w);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const p=Math.fround((globalThis.devicePixelRatio||1)*_.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:e[0]<=p||e[1]<=p}const S=["butt","round","square"],K=["miter","round","bevel"],U={},X={},Z=class Z{constructor(s,e,p,k,j,{optionalContentConfig:I,markedContentStack:V=null},et,ut){rt(this,at);this.ctx=s,this.current=new x(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=p,this.canvasFactory=k,this.filterFactory=j,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=V||[],this.optionalContentConfig=I,this.cachedCanvases=new A(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=et,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ut,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,e=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):e}beginDrawing({transform:s,viewport:e,transparency:p=!1,background:k=null}){const j=this.ctx.canvas.width,I=this.ctx.canvas.height,V=this.ctx.fillStyle;if(this.ctx.fillStyle=k||"#ffffff",this.ctx.fillRect(0,0,j,I),this.ctx.fillStyle=V,p){const et=this.cachedCanvases.getCanvas("transparent",j,I);this.compositeCtx=this.ctx,this.transparentCanvas=et.canvas,this.ctx=et.context,this.ctx.save(),this.ctx.transform(...(0,_.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),u(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=(0,_.getCurrentTransform)(this.ctx)}executeOperatorList(s,e,p,k){const j=s.argsArray,I=s.fnArray;let V=e||0;const et=j.length;if(et===V)return V;const ut=et-V>P&&typeof p=="function",dt=ut?Date.now()+l:0;let mt=0;const xt=this.commonObjs,At=this.objs;let st;for(;;){if(k!==void 0&&V===k.nextBreakPoint)return k.breakIt(V,p),V;if(st=I[V],st!==n.OPS.dependency)this[st].apply(this,j[V]);else for(const it of j[V]){const y=it.startsWith("g_")?xt:At;if(!y.has(it))return y.get(it,p),V}if(V++,V===et)return V;if(ut&&++mt>P){if(Date.now()>dt)return p(),V;mt=0}}}endDrawing(){Y(this,at,qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const e of s.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);s.clear()}this._cachedBitmapsMap.clear(),Y(this,at,Xe).call(this)}_scaleImage(s,e){const p=s.width,k=s.height;let j=Math.max(Math.hypot(e[0],e[1]),1),I=Math.max(Math.hypot(e[2],e[3]),1),V=p,et=k,ut="prescale1",dt,mt;for(;j>2&&V>1||I>2&&et>1;){let xt=V,At=et;j>2&&V>1&&(xt=V>=16384?Math.floor(V/2)-1||1:Math.ceil(V/2),j/=V/xt),I>2&&et>1&&(At=et>=16384?Math.floor(et/2)-1||1:Math.ceil(et)/2,I/=et/At),dt=this.cachedCanvases.getCanvas(ut,xt,At),mt=dt.context,mt.clearRect(0,0,xt,At),mt.drawImage(s,0,0,V,et,0,0,xt,At),s=dt.canvas,V=xt,et=At,ut=ut==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:V,paintHeight:et}}_createMaskCanvas(s){const e=this.ctx,{width:p,height:k}=s,j=this.current.fillColor,I=this.current.patternFill,V=(0,_.getCurrentTransform)(e);let et,ut,dt,mt;if((s.bitmap||s.data)&&s.count>1){const Q=s.bitmap||s.data.buffer;ut=JSON.stringify(I?V:[V.slice(0,4),j]),et=this._cachedBitmapsMap.get(Q),et||(et=new Map,this._cachedBitmapsMap.set(Q,et));const Ct=et.get(ut);if(Ct&&!I){const St=Math.round(Math.min(V[0],V[2])+V[4]),Ut=Math.round(Math.min(V[1],V[3])+V[5]);return{canvas:Ct,offsetX:St,offsetY:Ut}}dt=Ct}dt||(mt=this.cachedCanvases.getCanvas("maskCanvas",p,k),E(mt.context,s));let xt=n.Util.transform(V,[1/p,0,0,-1/k,0,0]);xt=n.Util.transform(xt,[1,0,0,1,0,-k]);const At=n.Util.applyTransform([0,0],xt),st=n.Util.applyTransform([p,k],xt),it=n.Util.normalizeRect([At[0],At[1],st[0],st[1]]),y=Math.round(it[2]-it[0])||1,N=Math.round(it[3]-it[1])||1,J=this.cachedCanvases.getCanvas("fillCanvas",y,N),nt=J.context,ft=Math.min(At[0],st[0]),vt=Math.min(At[1],st[1]);nt.translate(-ft,-vt),nt.transform(...xt),dt||(dt=this._scaleImage(mt.canvas,(0,_.getCurrentTransformInverse)(nt)),dt=dt.img,et&&I&&et.set(ut,dt)),nt.imageSmoothingEnabled=b((0,_.getCurrentTransform)(nt),s.interpolate),f(nt,dt,0,0,dt.width,dt.height,0,0,p,k),nt.globalCompositeOperation="source-in";const _t=n.Util.transform((0,_.getCurrentTransformInverse)(nt),[1,0,0,1,-ft,-vt]);return nt.fillStyle=I?j.getPattern(e,this,_t,q.PathType.FILL):j,nt.fillRect(0,0,p,k),et&&!I&&(this.cachedCanvases.delete("fillCanvas"),et.set(ut,J.canvas)),{canvas:J.canvas,offsetX:Math.round(ft),offsetY:Math.round(vt)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=S[s]}setLineJoin(s){this.ctx.lineJoin=K[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,e){const p=this.ctx;p.setLineDash!==void 0&&(p.setLineDash(s),p.lineDashOffset=e)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[e,p]of s)switch(e){case"LW":this.setLineWidth(p);break;case"LC":this.setLineCap(p);break;case"LJ":this.setLineJoin(p);break;case"ML":this.setMiterLimit(p);break;case"D":this.setDash(p[0],p[1]);break;case"RI":this.setRenderingIntent(p);break;case"FL":this.setFlatness(p);break;case"Font":this.setFont(p[0],p[1]);break;case"CA":this.current.strokeAlpha=p;break;case"ca":this.current.fillAlpha=p,this.ctx.globalAlpha=p;break;case"BM":this.ctx.globalCompositeOperation=p;break;case"SMask":this.current.activeSMask=p?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(p);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,e=this.ctx.canvas.height,p="smaskGroupAt"+this.groupLevel,k=this.cachedCanvases.getCanvas(p,s,e);this.suspendedCtx=this.ctx,this.ctx=k.context;const j=this.ctx;j.setTransform(...(0,_.getCurrentTransform)(this.suspendedCtx)),c(this.suspendedCtx,j),g(j,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),c(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,p=this.suspendedCtx;i(p,e,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(c(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),c(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,e,p,k,j,I){this.ctx.transform(s,e,p,k,j,I),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,e,p){const k=this.ctx,j=this.current;let I=j.x,V=j.y,et,ut;const dt=(0,_.getCurrentTransform)(k),mt=dt[0]===0&&dt[3]===0||dt[1]===0&&dt[2]===0,xt=mt?p.slice(0):null;for(let At=0,st=0,it=s.length;At<it;At++)switch(s[At]|0){case n.OPS.rectangle:I=e[st++],V=e[st++];const y=e[st++],N=e[st++],J=I+y,nt=V+N;k.moveTo(I,V),y===0||N===0?k.lineTo(J,nt):(k.lineTo(J,V),k.lineTo(J,nt),k.lineTo(I,nt)),mt||j.updateRectMinMax(dt,[I,V,J,nt]),k.closePath();break;case n.OPS.moveTo:I=e[st++],V=e[st++],k.moveTo(I,V),mt||j.updatePathMinMax(dt,I,V);break;case n.OPS.lineTo:I=e[st++],V=e[st++],k.lineTo(I,V),mt||j.updatePathMinMax(dt,I,V);break;case n.OPS.curveTo:et=I,ut=V,I=e[st+4],V=e[st+5],k.bezierCurveTo(e[st],e[st+1],e[st+2],e[st+3],I,V),j.updateCurvePathMinMax(dt,et,ut,e[st],e[st+1],e[st+2],e[st+3],I,V,xt),st+=6;break;case n.OPS.curveTo2:et=I,ut=V,k.bezierCurveTo(I,V,e[st],e[st+1],e[st+2],e[st+3]),j.updateCurvePathMinMax(dt,et,ut,I,V,e[st],e[st+1],e[st+2],e[st+3],xt),I=e[st+2],V=e[st+3],st+=4;break;case n.OPS.curveTo3:et=I,ut=V,I=e[st+2],V=e[st+3],k.bezierCurveTo(e[st],e[st+1],I,V,I,V),j.updateCurvePathMinMax(dt,et,ut,e[st],e[st+1],I,V,I,V,xt),st+=4;break;case n.OPS.closePath:k.closePath();break}mt&&j.updateScalingPathMinMax(dt,xt),j.setCurrentPoint(I,V)}closePath(){this.ctx.closePath()}stroke(s=!0){const e=this.ctx,p=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof p=="object"&&(p!=null&&p.getPattern)?(e.save(),e.strokeStyle=p.getPattern(e,this,(0,_.getCurrentTransformInverse)(e),q.PathType.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const e=this.ctx,p=this.current.fillColor,k=this.current.patternFill;let j=!1;k&&(e.save(),e.fillStyle=p.getPattern(e,this,(0,_.getCurrentTransformInverse)(e),q.PathType.FILL),j=!0);const I=this.current.getClippedPathBoundingBox();this.contentVisible&&I!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),j&&e.restore(),s&&this.consumePath(I)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=U}eoClip(){this.pendingClip=X}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,e=this.ctx;if(s===void 0){e.beginPath();return}e.save(),e.beginPath();for(const p of s)e.setTransform(...p.transform),e.translate(p.x,p.y),p.addToPath(e,p.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,e){var dt;const p=this.commonObjs.get(s),k=this.current;if(!p)throw new Error(`Can't find font for ${s}`);if(k.fontMatrix=p.fontMatrix||n.FONT_IDENTITY_MATRIX,(k.fontMatrix[0]===0||k.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+s),e<0?(e=-e,k.fontDirection=-1):k.fontDirection=1,this.current.font=p,this.current.fontSize=e,p.isType3Font)return;const j=p.loadedName||"sans-serif",I=((dt=p.systemFontInfo)==null?void 0:dt.css)||`"${j}", ${p.fallbackName}`;let V="normal";p.black?V="900":p.bold&&(V="bold");const et=p.italic?"italic":"normal";let ut=e;e<tt?ut=tt:e>L&&(ut=L),this.current.fontSizeScale=e/ut,this.ctx.font=`${et} ${V} ${ut}px ${I}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,e){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=e}setLeadingMoveText(s,e){this.setLeading(-e),this.moveText(s,e)}setTextMatrix(s,e,p,k,j,I){this.current.textMatrix=[s,e,p,k,j,I],this.current.textMatrixScale=Math.hypot(s,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,e,p,k){const j=this.ctx,I=this.current,V=I.font,et=I.textRenderingMode,ut=I.fontSize/I.fontSizeScale,dt=et&n.TextRenderingMode.FILL_STROKE_MASK,mt=!!(et&n.TextRenderingMode.ADD_TO_PATH_FLAG),xt=I.patternFill&&!V.missingFile;let At;(V.disableFontFace||mt||xt)&&(At=V.getPathGenerator(this.commonObjs,s)),V.disableFontFace||xt?(j.save(),j.translate(e,p),j.beginPath(),At(j,ut),k&&j.setTransform(...k),(dt===n.TextRenderingMode.FILL||dt===n.TextRenderingMode.FILL_STROKE)&&j.fill(),(dt===n.TextRenderingMode.STROKE||dt===n.TextRenderingMode.FILL_STROKE)&&j.stroke(),j.restore()):((dt===n.TextRenderingMode.FILL||dt===n.TextRenderingMode.FILL_STROKE)&&j.fillText(s,e,p),(dt===n.TextRenderingMode.STROKE||dt===n.TextRenderingMode.FILL_STROKE)&&j.strokeText(s,e,p)),mt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,_.getCurrentTransform)(j),x:e,y:p,fontSize:ut,addToPath:At})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const e=s.getImageData(0,0,10,10).data;let p=!1;for(let k=3;k<e.length;k+=4)if(e[k]>0&&e[k]<255){p=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",p)}showText(s){const e=this.current,p=e.font;if(p.isType3Font)return this.showType3Text(s);const k=e.fontSize;if(k===0)return;const j=this.ctx,I=e.fontSizeScale,V=e.charSpacing,et=e.wordSpacing,ut=e.fontDirection,dt=e.textHScale*ut,mt=s.length,xt=p.vertical,At=xt?1:-1,st=p.defaultVMetrics,it=k*e.fontMatrix[0],y=e.textRenderingMode===n.TextRenderingMode.FILL&&!p.disableFontFace&&!e.patternFill;j.save(),j.transform(...e.textMatrix),j.translate(e.x,e.y+e.textRise),ut>0?j.scale(dt,-1):j.scale(dt,1);let N;if(e.patternFill){j.save();const _t=e.fillColor.getPattern(j,this,(0,_.getCurrentTransformInverse)(j),q.PathType.FILL);N=(0,_.getCurrentTransform)(j),j.restore(),j.fillStyle=_t}let J=e.lineWidth;const nt=e.textMatrixScale;if(nt===0||J===0){const _t=e.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(_t===n.TextRenderingMode.STROKE||_t===n.TextRenderingMode.FILL_STROKE)&&(J=this.getSinglePixelWidth())}else J/=nt;if(I!==1&&(j.scale(I,I),J/=I),j.lineWidth=J,p.isInvalidPDFjsFont){const _t=[];let Q=0;for(const Ct of s)_t.push(Ct.unicode),Q+=Ct.width;j.fillText(_t.join(""),0,0),e.x+=Q*it*dt,j.restore(),this.compose();return}let ft=0,vt;for(vt=0;vt<mt;++vt){const _t=s[vt];if(typeof _t=="number"){ft+=At*_t*k/1e3;continue}let Q=!1;const Ct=(_t.isSpace?et:0)+V,St=_t.fontChar,Ut=_t.accent;let Ot,zt,kt=_t.width;if(xt){const Vt=_t.vmetric||st,Xt=-(_t.vmetric?Vt[1]:kt*.5)*it,yt=Vt[2]*it;kt=Vt?-Vt[0]:kt,Ot=Xt/I,zt=(ft+yt)/I}else Ot=ft/I,zt=0;if(p.remeasure&&kt>0){const Vt=j.measureText(St).width*1e3/k*I;if(kt<Vt&&this.isFontSubpixelAAEnabled){const Xt=kt/Vt;Q=!0,j.save(),j.scale(Xt,1),Ot/=Xt}else kt!==Vt&&(Ot+=(kt-Vt)/2e3*k/I)}if(this.contentVisible&&(_t.isInFont||p.missingFile)){if(y&&!Ut)j.fillText(St,Ot,zt);else if(this.paintChar(St,Ot,zt,N),Ut){const Vt=Ot+k*Ut.offset.x/I,Xt=zt-k*Ut.offset.y/I;this.paintChar(Ut.fontChar,Vt,Xt,N)}}const Nt=xt?kt*it-Ct*ut:kt*it+Ct*ut;ft+=Nt,Q&&j.restore()}xt?e.y-=ft:e.x+=ft*dt,j.restore(),this.compose()}showType3Text(s){const e=this.ctx,p=this.current,k=p.font,j=p.fontSize,I=p.fontDirection,V=k.vertical?1:-1,et=p.charSpacing,ut=p.wordSpacing,dt=p.textHScale*I,mt=p.fontMatrix||n.FONT_IDENTITY_MATRIX,xt=s.length,At=p.textRenderingMode===n.TextRenderingMode.INVISIBLE;let st,it,y,N;if(!(At||j===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...p.textMatrix),e.translate(p.x,p.y),e.scale(dt,I),st=0;st<xt;++st){if(it=s[st],typeof it=="number"){N=V*it*j/1e3,this.ctx.translate(N,0),p.x+=N*dt;continue}const J=(it.isSpace?ut:0)+et,nt=k.charProcOperatorList[it.operatorListId];if(!nt){(0,n.warn)(`Type3 character "${it.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=it,this.save(),e.scale(j,j),e.transform(...mt),this.executeOperatorList(nt),this.restore()),y=n.Util.applyTransform([it.width,0],mt)[0]*j+J,e.translate(y,0),p.x+=y*dt}e.restore(),this.processingType3=null}}setCharWidth(s,e){}setCharWidthAndBounds(s,e,p,k,j,I){this.ctx.rect(p,k,j-p,I-k),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let e;if(s[0]==="TilingPattern"){const p=s[1],k=this.baseTransform||(0,_.getCurrentTransform)(this.ctx),j={createCanvasGraphics:I=>new Z(I,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new q.TilingPattern(s,p,this.ctx,j,k)}else e=this._getPattern(s[1],s[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,e,p){const k=n.Util.makeHexColor(s,e,p);this.ctx.strokeStyle=k,this.current.strokeColor=k}setFillRGBColor(s,e,p){const k=n.Util.makeHexColor(s,e,p);this.ctx.fillStyle=k,this.current.fillColor=k,this.current.patternFill=!1}_getPattern(s,e=null){let p;return this.cachedPatterns.has(s)?p=this.cachedPatterns.get(s):(p=(0,q.getShadingPattern)(this.getObject(s)),this.cachedPatterns.set(s,p)),e&&(p.matrix=e),p}shadingFill(s){if(!this.contentVisible)return;const e=this.ctx;this.save();const p=this._getPattern(s);e.fillStyle=p.getPattern(e,this,(0,_.getCurrentTransformInverse)(e),q.PathType.SHADING);const k=(0,_.getCurrentTransformInverse)(e);if(k){const{width:j,height:I}=e.canvas,[V,et,ut,dt]=n.Util.getAxialAlignedBoundingBox([0,0,j,I],k);this.ctx.fillRect(V,et,ut-V,dt-et)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,_.getCurrentTransform)(this.ctx),e)){const p=e[2]-e[0],k=e[3]-e[1];this.ctx.rect(e[0],e[1],p,k),this.current.updateRectMinMax((0,_.getCurrentTransform)(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;s.isolated||(0,n.info)("TODO: Support non-isolated groups."),s.knockout&&(0,n.warn)("Knockout groups not supported.");const p=(0,_.getCurrentTransform)(e);if(s.matrix&&e.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let k=n.Util.getAxialAlignedBoundingBox(s.bbox,(0,_.getCurrentTransform)(e));const j=[0,0,e.canvas.width,e.canvas.height];k=n.Util.intersect(k,j)||[0,0,0,0];const I=Math.floor(k[0]),V=Math.floor(k[1]);let et=Math.max(Math.ceil(k[2])-I,1),ut=Math.max(Math.ceil(k[3])-V,1),dt=1,mt=1;et>v&&(dt=et/v,et=v),ut>v&&(mt=ut/v,ut=v),this.current.startNewPathAndClipBox([0,0,et,ut]);let xt="groupAt"+this.groupLevel;s.smask&&(xt+="_smask_"+this.smaskCounter++%2);const At=this.cachedCanvases.getCanvas(xt,et,ut),st=At.context;st.scale(1/dt,1/mt),st.translate(-I,-V),st.transform(...p),s.smask?this.smaskStack.push({canvas:At.canvas,context:st,offsetX:I,offsetY:V,scaleX:dt,scaleY:mt,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(I,V),e.scale(dt,mt),e.save()),c(e,st),this.ctx=st,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,p=this.groupStack.pop();if(this.ctx=p,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const k=(0,_.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...k);const j=n.Util.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],k);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(j)}}beginAnnotation(s,e,p,k,j){if(Y(this,at,qe).call(this),u(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(e)&&e.length===4){const I=e[2]-e[0],V=e[3]-e[1];if(j&&this.annotationCanvasMap){p=p.slice(),p[4]-=e[0],p[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=I,e[3]=V;const[et,ut]=n.Util.singularValueDecompose2dScale((0,_.getCurrentTransform)(this.ctx)),{viewportScale:dt}=this,mt=Math.ceil(I*this.outputScaleX*dt),xt=Math.ceil(V*this.outputScaleY*dt);this.annotationCanvas=this.canvasFactory.create(mt,xt);const{canvas:At,context:st}=this.annotationCanvas;this.annotationCanvasMap.set(s,At),this.annotationCanvas.savedCtx=this.ctx,this.ctx=st,this.ctx.save(),this.ctx.setTransform(et,0,0,-ut,0,V*ut),u(this.ctx)}else u(this.ctx),this.ctx.rect(e[0],e[1],I,V),this.ctx.clip(),this.endPath()}this.current=new x(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...p),this.transform(...k)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,at,Xe).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const e=s.count;s=this.getObject(s.data,s),s.count=e;const p=this.ctx,k=this.processingType3;if(k&&(k.compiled===void 0&&(k.compiled=h(s)),k.compiled)){k.compiled(p);return}const j=this._createMaskCanvas(s),I=j.canvas;p.save(),p.setTransform(1,0,0,1,0,0),p.drawImage(I,j.offsetX,j.offsetY),p.restore(),this.compose()}paintImageMaskXObjectRepeat(s,e,p=0,k=0,j,I){if(!this.contentVisible)return;s=this.getObject(s.data,s);const V=this.ctx;V.save();const et=(0,_.getCurrentTransform)(V);V.transform(e,p,k,j,0,0);const ut=this._createMaskCanvas(s);V.setTransform(1,0,0,1,ut.offsetX-et[4],ut.offsetY-et[5]);for(let dt=0,mt=I.length;dt<mt;dt+=2){const xt=n.Util.transform(et,[e,p,k,j,I[dt],I[dt+1]]),[At,st]=n.Util.applyTransform([0,0],xt);V.drawImage(ut.canvas,At,st)}V.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const e=this.ctx,p=this.current.fillColor,k=this.current.patternFill;for(const j of s){const{data:I,width:V,height:et,transform:ut}=j,dt=this.cachedCanvases.getCanvas("maskCanvas",V,et),mt=dt.context;mt.save();const xt=this.getObject(I,j);E(mt,xt),mt.globalCompositeOperation="source-in",mt.fillStyle=k?p.getPattern(mt,this,(0,_.getCurrentTransformInverse)(e),q.PathType.FILL):p,mt.fillRect(0,0,V,et),mt.restore(),e.save(),e.transform(...ut),e.scale(1,-1),f(e,dt.canvas,0,0,V,et,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const e=this.getObject(s);if(!e){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(s,e,p,k){if(!this.contentVisible)return;const j=this.getObject(s);if(!j){(0,n.warn)("Dependent image isn't ready yet");return}const I=j.width,V=j.height,et=[];for(let ut=0,dt=k.length;ut<dt;ut+=2)et.push({transform:[e,0,0,p,k[ut],k[ut+1]],x:0,y:0,w:I,h:V});this.paintInlineImageXObjectGroup(j,et)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:e,width:p,height:k}=s,j=this.cachedCanvases.getCanvas("inlineImage",p,k),I=j.context;return I.filter=this.current.transferMaps,I.drawImage(e,0,0),I.filter="none",j.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const e=s.width,p=s.height,k=this.ctx;if(this.save(),!n.isNodeJS){const{filter:V}=k;V!=="none"&&V!==""&&(k.filter="none")}k.scale(1/e,-1/p);let j;if(s.bitmap)j=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)j=s;else{const et=this.cachedCanvases.getCanvas("inlineImage",e,p).context;M(et,s),j=this.applyTransferMapsToCanvas(et)}const I=this._scaleImage(j,(0,_.getCurrentTransformInverse)(k));k.imageSmoothingEnabled=b((0,_.getCurrentTransform)(k),s.interpolate),f(k,I.img,0,0,I.paintWidth,I.paintHeight,0,-p,e,p),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,e){if(!this.contentVisible)return;const p=this.ctx;let k;if(s.bitmap)k=s.bitmap;else{const j=s.width,I=s.height,et=this.cachedCanvases.getCanvas("inlineImage",j,I).context;M(et,s),k=this.applyTransferMapsToCanvas(et)}for(const j of e)p.save(),p.transform(...j.transform),p.scale(1,-1),f(p,k,j.x,j.y,j.w,j.h,0,-1,1,1),p.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,e){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,e){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const p=this.ctx;this.pendingClip&&(e||(this.pendingClip===X?p.clip("evenodd"):p.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),p.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,_.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const e=Math.abs(s[0]*s[3]-s[2]*s[1]),p=Math.hypot(s[0],s[2]),k=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(p,k)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:e,b:p,c:k,d:j}=this.ctx.getTransform();let I,V;if(p===0&&k===0){const et=Math.abs(e),ut=Math.abs(j);if(et===ut)if(s===0)I=V=1/et;else{const dt=et*s;I=V=dt<1?1/dt:1}else if(s===0)I=1/et,V=1/ut;else{const dt=et*s,mt=ut*s;I=dt<1?1/dt:1,V=mt<1?1/mt:1}}else{const et=Math.abs(e*j-p*k),ut=Math.hypot(e,p),dt=Math.hypot(k,j);if(s===0)I=dt/et,V=ut/et;else{const mt=s*et;I=dt>mt?dt/mt:1,V=ut>mt?ut/mt:1}}this._cachedScaleForStroking[0]=I,this._cachedScaleForStroking[1]=V}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:e}=this,{lineWidth:p}=this.current,[k,j]=this.getScaleForStroking();if(e.lineWidth=p||1,k===1&&j===1){e.stroke();return}const I=e.getLineDash();if(s&&e.save(),e.scale(k,j),I.length>0){const V=Math.max(k,j);e.setLineDash(I.map(et=>et/V)),e.lineDashOffset/=V}e.stroke(),s&&e.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};at=new WeakSet,qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Xe=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const e=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};let $=Z;a.CanvasGraphics=$;for(const w in n.OPS)$.prototype[w]!==void 0&&($.prototype[n.OPS[w]]=$.prototype[w])},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TilingPattern=a.PathType=void 0,a.getShadingPattern=m;var n=G(1),_=G(6);const q={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};a.PathType=q;function B(h,x){if(!x)return;const M=x[2]-x[0],E=x[3]-x[1],c=new Path2D;c.rect(x[0],x[1],M,E),h.clip(c)}class tt{constructor(){this.constructor===tt&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class L extends tt{constructor(x){super(),this._type=x[1],this._bbox=x[2],this._colorStops=x[3],this._p0=x[4],this._p1=x[5],this._r0=x[6],this._r1=x[7],this.matrix=null}_createGradient(x){let M;this._type==="axial"?M=x.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(M=x.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const E of this._colorStops)M.addColorStop(E[0],E[1]);return M}getPattern(x,M,E,c){let u;if(c===q.STROKE||c===q.FILL){const r=M.current.getClippedPathBoundingBox(c,(0,_.getCurrentTransform)(x))||[0,0,0,0],d=Math.ceil(r[2]-r[0])||1,o=Math.ceil(r[3]-r[1])||1,C=M.cachedCanvases.getCanvas("pattern",d,o,!0),i=C.context;i.clearRect(0,0,i.canvas.width,i.canvas.height),i.beginPath(),i.rect(0,0,i.canvas.width,i.canvas.height),i.translate(-r[0],-r[1]),E=n.Util.transform(E,[1,0,0,1,r[0],r[1]]),i.transform(...M.baseTransform),this.matrix&&i.transform(...this.matrix),B(i,this._bbox),i.fillStyle=this._createGradient(i),i.fill(),u=x.createPattern(C.canvas,"no-repeat");const b=new DOMMatrix(E);u.setTransform(b)}else B(x,this._bbox),u=this._createGradient(x);return u}}function v(h,x,M,E,c,u,r,d){const o=x.coords,C=x.colors,i=h.data,b=h.width*4;let S;o[M+1]>o[E+1]&&(S=M,M=E,E=S,S=u,u=r,r=S),o[E+1]>o[c+1]&&(S=E,E=c,c=S,S=r,r=d,d=S),o[M+1]>o[E+1]&&(S=M,M=E,E=S,S=u,u=r,r=S);const K=(o[M]+x.offsetX)*x.scaleX,U=(o[M+1]+x.offsetY)*x.scaleY,X=(o[E]+x.offsetX)*x.scaleX,$=(o[E+1]+x.offsetY)*x.scaleY,at=(o[c]+x.offsetX)*x.scaleX,F=(o[c+1]+x.offsetY)*x.scaleY;if(U>=F)return;const W=C[u],Z=C[u+1],w=C[u+2],s=C[r],e=C[r+1],p=C[r+2],k=C[d],j=C[d+1],I=C[d+2],V=Math.round(U),et=Math.round(F);let ut,dt,mt,xt,At,st,it,y;for(let N=V;N<=et;N++){if(N<$){const _t=N<U?0:(U-N)/(U-$);ut=K-(K-X)*_t,dt=W-(W-s)*_t,mt=Z-(Z-e)*_t,xt=w-(w-p)*_t}else{let _t;N>F?_t=1:$===F?_t=0:_t=($-N)/($-F),ut=X-(X-at)*_t,dt=s-(s-k)*_t,mt=e-(e-j)*_t,xt=p-(p-I)*_t}let J;N<U?J=0:N>F?J=1:J=(U-N)/(U-F),At=K-(K-at)*J,st=W-(W-k)*J,it=Z-(Z-j)*J,y=w-(w-I)*J;const nt=Math.round(Math.min(ut,At)),ft=Math.round(Math.max(ut,At));let vt=b*N+nt*4;for(let _t=nt;_t<=ft;_t++)J=(ut-_t)/(ut-At),J<0?J=0:J>1&&(J=1),i[vt++]=dt-(dt-st)*J|0,i[vt++]=mt-(mt-it)*J|0,i[vt++]=xt-(xt-y)*J|0,i[vt++]=255}}function l(h,x,M){const E=x.coords,c=x.colors;let u,r;switch(x.type){case"lattice":const d=x.verticesPerRow,o=Math.floor(E.length/d)-1,C=d-1;for(u=0;u<o;u++){let i=u*d;for(let b=0;b<C;b++,i++)v(h,M,E[i],E[i+1],E[i+d],c[i],c[i+1],c[i+d]),v(h,M,E[i+d+1],E[i+1],E[i+d],c[i+d+1],c[i+1],c[i+d])}break;case"triangles":for(u=0,r=E.length;u<r;u+=3)v(h,M,E[u],E[u+1],E[u+2],c[u],c[u+1],c[u+2]);break;default:throw new Error("illegal figure")}}class P extends tt{constructor(x){super(),this._coords=x[2],this._colors=x[3],this._figures=x[4],this._bounds=x[5],this._bbox=x[7],this._background=x[8],this.matrix=null}_createMeshCanvas(x,M,E){const d=Math.floor(this._bounds[0]),o=Math.floor(this._bounds[1]),C=Math.ceil(this._bounds[2])-d,i=Math.ceil(this._bounds[3])-o,b=Math.min(Math.ceil(Math.abs(C*x[0]*1.1)),3e3),S=Math.min(Math.ceil(Math.abs(i*x[1]*1.1)),3e3),K=C/b,U=i/S,X={coords:this._coords,colors:this._colors,offsetX:-d,offsetY:-o,scaleX:1/K,scaleY:1/U},$=b+2*2,at=S+2*2,F=E.getCanvas("mesh",$,at,!1),W=F.context,Z=W.createImageData(b,S);if(M){const s=Z.data;for(let e=0,p=s.length;e<p;e+=4)s[e]=M[0],s[e+1]=M[1],s[e+2]=M[2],s[e+3]=255}for(const s of this._figures)l(Z,s,X);return W.putImageData(Z,2,2),{canvas:F.canvas,offsetX:d-2*K,offsetY:o-2*U,scaleX:K,scaleY:U}}getPattern(x,M,E,c){B(x,this._bbox);let u;if(c===q.SHADING)u=n.Util.singularValueDecompose2dScale((0,_.getCurrentTransform)(x));else if(u=n.Util.singularValueDecompose2dScale(M.baseTransform),this.matrix){const d=n.Util.singularValueDecompose2dScale(this.matrix);u=[u[0]*d[0],u[1]*d[1]]}const r=this._createMeshCanvas(u,c===q.SHADING?null:this._background,M.cachedCanvases);return c!==q.SHADING&&(x.setTransform(...M.baseTransform),this.matrix&&x.transform(...this.matrix)),x.translate(r.offsetX,r.offsetY),x.scale(r.scaleX,r.scaleY),x.createPattern(r.canvas,"no-repeat")}}class R extends tt{getPattern(){return"hotpink"}}function m(h){switch(h[0]){case"RadialAxial":return new L(h);case"Mesh":return new P(h);case"Dummy":return new R}throw new Error(`Unknown IR type: ${h[0]}`)}const g={COLORED:1,UNCOLORED:2},f=class f{constructor(x,M,E,c,u){this.operatorList=x[2],this.matrix=x[3]||[1,0,0,1,0,0],this.bbox=x[4],this.xstep=x[5],this.ystep=x[6],this.paintType=x[7],this.tilingType=x[8],this.color=M,this.ctx=E,this.canvasGraphicsFactory=c,this.baseTransform=u}createPatternCanvas(x){const M=this.operatorList,E=this.bbox,c=this.xstep,u=this.ystep,r=this.paintType,d=this.tilingType,o=this.color,C=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+d);const i=E[0],b=E[1],S=E[2],K=E[3],U=n.Util.singularValueDecompose2dScale(this.matrix),X=n.Util.singularValueDecompose2dScale(this.baseTransform),$=[U[0]*X[0],U[1]*X[1]],at=this.getSizeAndScale(c,this.ctx.canvas.width,$[0]),F=this.getSizeAndScale(u,this.ctx.canvas.height,$[1]),W=x.cachedCanvases.getCanvas("pattern",at.size,F.size,!0),Z=W.context,w=C.createCanvasGraphics(Z);w.groupLevel=x.groupLevel,this.setFillAndStrokeStyleToContext(w,r,o);let s=i,e=b,p=S,k=K;return i<0&&(s=0,p+=Math.abs(i)),b<0&&(e=0,k+=Math.abs(b)),Z.translate(-(at.scale*s),-(F.scale*e)),w.transform(at.scale,0,0,F.scale,0,0),Z.save(),this.clipBbox(w,s,e,p,k),w.baseTransform=(0,_.getCurrentTransform)(w.ctx),w.executeOperatorList(M),w.endDrawing(),{canvas:W.canvas,scaleX:at.scale,scaleY:F.scale,offsetX:s,offsetY:e}}getSizeAndScale(x,M,E){x=Math.abs(x);const c=Math.max(f.MAX_PATTERN_SIZE,M);let u=Math.ceil(x*E);return u>=c?u=c:E=u/x,{scale:E,size:u}}clipBbox(x,M,E,c,u){const r=c-M,d=u-E;x.ctx.rect(M,E,r,d),x.current.updateRectMinMax((0,_.getCurrentTransform)(x.ctx),[M,E,c,u]),x.clip(),x.endPath()}setFillAndStrokeStyleToContext(x,M,E){const c=x.ctx,u=x.current;switch(M){case g.COLORED:const r=this.ctx;c.fillStyle=r.fillStyle,c.strokeStyle=r.strokeStyle,u.fillColor=r.fillStyle,u.strokeColor=r.strokeStyle;break;case g.UNCOLORED:const d=n.Util.makeHexColor(E[0],E[1],E[2]);c.fillStyle=d,c.strokeStyle=d,u.fillColor=d,u.strokeColor=d;break;default:throw new n.FormatError(`Unsupported paint type: ${M}`)}}getPattern(x,M,E,c){let u=E;c!==q.SHADING&&(u=n.Util.transform(u,M.baseTransform),this.matrix&&(u=n.Util.transform(u,this.matrix)));const r=this.createPatternCanvas(M);let d=new DOMMatrix(u);d=d.translate(r.offsetX,r.offsetY),d=d.scale(1/r.scaleX,1/r.scaleY);const o=x.createPattern(r.canvas,"repeat");return o.setTransform(d),o}};Kt(f,"MAX_PATTERN_SIZE",3e3);let A=f;a.TilingPattern=A},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.convertBlackAndWhiteToRGBA=q,a.convertToRGBA=_,a.grayToRGBA=tt;var n=G(1);function _(L){switch(L.kind){case n.ImageKind.GRAYSCALE_1BPP:return q(L);case n.ImageKind.RGB_24BPP:return B(L)}return null}function q({src:L,srcPos:v=0,dest:l,width:P,height:R,nonBlackColor:m=4294967295,inverseDecode:g=!1}){const A=n.FeatureTest.isLittleEndian?4278190080:255,[f,h]=g?[m,A]:[A,m],x=P>>3,M=P&7,E=L.length;l=new Uint32Array(l.buffer);let c=0;for(let u=0;u<R;u++){for(const d=v+x;v<d;v++){const o=v<E?L[v]:255;l[c++]=o&128?h:f,l[c++]=o&64?h:f,l[c++]=o&32?h:f,l[c++]=o&16?h:f,l[c++]=o&8?h:f,l[c++]=o&4?h:f,l[c++]=o&2?h:f,l[c++]=o&1?h:f}if(M===0)continue;const r=v<E?L[v++]:255;for(let d=0;d<M;d++)l[c++]=r&1<<7-d?h:f}return{srcPos:v,destPos:c}}function B({src:L,srcPos:v=0,dest:l,destPos:P=0,width:R,height:m}){let g=0;const A=L.length>>2,f=new Uint32Array(L.buffer,v,A);if(n.FeatureTest.isLittleEndian){for(;g<A-2;g+=3,P+=4){const h=f[g],x=f[g+1],M=f[g+2];l[P]=h|4278190080,l[P+1]=h>>>24|x<<8|4278190080,l[P+2]=x>>>16|M<<16|4278190080,l[P+3]=M>>>8|4278190080}for(let h=g*4,x=L.length;h<x;h+=3)l[P++]=L[h]|L[h+1]<<8|L[h+2]<<16|4278190080}else{for(;g<A-2;g+=3,P+=4){const h=f[g],x=f[g+1],M=f[g+2];l[P]=h|255,l[P+1]=h<<24|x>>>8|255,l[P+2]=x<<16|M>>>16|255,l[P+3]=M<<8|255}for(let h=g*4,x=L.length;h<x;h+=3)l[P++]=L[h]<<24|L[h+1]<<16|L[h+2]<<8|255}return{srcPos:v,destPos:P}}function tt(L,v){if(n.FeatureTest.isLittleEndian)for(let l=0,P=L.length;l<P;l++)v[l]=L[l]*65793|4278190080;else for(let l=0,P=L.length;l<P;l++)v[l]=L[l]*16843008|255}},(H,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.GlobalWorkerOptions=void 0;const G=Object.create(null);a.GlobalWorkerOptions=G,G.workerPort=null,G.workerSrc=""},(H,a,G)=>{var L,Ss,ws,Ee;Object.defineProperty(a,"__esModule",{value:!0}),a.MessageHandler=void 0;var n=G(1);const _={DATA:1,ERROR:2},q={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function B(R){switch(R instanceof Error||typeof R=="object"&&R!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),R.name){case"AbortException":return new n.AbortException(R.message);case"MissingPDFException":return new n.MissingPDFException(R.message);case"PasswordException":return new n.PasswordException(R.message,R.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(R.message,R.status);case"UnknownErrorException":return new n.UnknownErrorException(R.message,R.details);default:return new n.UnknownErrorException(R.message,R.toString())}}class tt{constructor(m,g,A){rt(this,L);this.sourceName=m,this.targetName=g,this.comObj=A,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=f=>{const h=f.data;if(h.targetName!==this.sourceName)return;if(h.stream){Y(this,L,ws).call(this,h);return}if(h.callback){const M=h.callbackId,E=this.callbackCapabilities[M];if(!E)throw new Error(`Cannot resolve callback ${M}`);if(delete this.callbackCapabilities[M],h.callback===_.DATA)E.resolve(h.data);else if(h.callback===_.ERROR)E.reject(B(h.reason));else throw new Error("Unexpected callback case");return}const x=this.actionHandler[h.action];if(!x)throw new Error(`Unknown action from worker: ${h.action}`);if(h.callbackId){const M=this.sourceName,E=h.sourceName;new Promise(function(c){c(x(h.data))}).then(function(c){A.postMessage({sourceName:M,targetName:E,callback:_.DATA,callbackId:h.callbackId,data:c})},function(c){A.postMessage({sourceName:M,targetName:E,callback:_.ERROR,callbackId:h.callbackId,reason:B(c)})});return}if(h.streamId){Y(this,L,Ss).call(this,h);return}x(h.data)},A.addEventListener("message",this._onComObjOnMessage)}on(m,g){const A=this.actionHandler;if(A[m])throw new Error(`There is already an actionName called "${m}"`);A[m]=g}send(m,g,A){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,data:g},A)}sendWithPromise(m,g,A){const f=this.callbackId++,h=new n.PromiseCapability;this.callbackCapabilities[f]=h;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,callbackId:f,data:g},A)}catch(x){h.reject(x)}return h.promise}sendWithStream(m,g,A,f){const h=this.streamId++,x=this.sourceName,M=this.targetName,E=this.comObj;return new ReadableStream({start:c=>{const u=new n.PromiseCapability;return this.streamControllers[h]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},E.postMessage({sourceName:x,targetName:M,action:m,streamId:h,data:g,desiredSize:c.desiredSize},f),u.promise},pull:c=>{const u=new n.PromiseCapability;return this.streamControllers[h].pullCall=u,E.postMessage({sourceName:x,targetName:M,stream:q.PULL,streamId:h,desiredSize:c.desiredSize}),u.promise},cancel:c=>{(0,n.assert)(c instanceof Error,"cancel must have a valid reason");const u=new n.PromiseCapability;return this.streamControllers[h].cancelCall=u,this.streamControllers[h].isClosed=!0,E.postMessage({sourceName:x,targetName:M,stream:q.CANCEL,streamId:h,reason:B(c)}),u.promise}},A)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}L=new WeakSet,Ss=function(m){const g=m.streamId,A=this.sourceName,f=m.sourceName,h=this.comObj,x=this,M=this.actionHandler[m.action],E={enqueue(c,u=1,r){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=u,d>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),h.postMessage({sourceName:A,targetName:f,stream:q.ENQUEUE,streamId:g,chunk:c},r)},close(){this.isCancelled||(this.isCancelled=!0,h.postMessage({sourceName:A,targetName:f,stream:q.CLOSE,streamId:g}),delete x.streamSinks[g])},error(c){(0,n.assert)(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,h.postMessage({sourceName:A,targetName:f,stream:q.ERROR,streamId:g,reason:B(c)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:m.desiredSize,ready:null};E.sinkCapability.resolve(),E.ready=E.sinkCapability.promise,this.streamSinks[g]=E,new Promise(function(c){c(M(m.data,E))}).then(function(){h.postMessage({sourceName:A,targetName:f,stream:q.START_COMPLETE,streamId:g,success:!0})},function(c){h.postMessage({sourceName:A,targetName:f,stream:q.START_COMPLETE,streamId:g,reason:B(c)})})},ws=function(m){const g=m.streamId,A=this.sourceName,f=m.sourceName,h=this.comObj,x=this.streamControllers[g],M=this.streamSinks[g];switch(m.stream){case q.START_COMPLETE:m.success?x.startCall.resolve():x.startCall.reject(B(m.reason));break;case q.PULL_COMPLETE:m.success?x.pullCall.resolve():x.pullCall.reject(B(m.reason));break;case q.PULL:if(!M){h.postMessage({sourceName:A,targetName:f,stream:q.PULL_COMPLETE,streamId:g,success:!0});break}M.desiredSize<=0&&m.desiredSize>0&&M.sinkCapability.resolve(),M.desiredSize=m.desiredSize,new Promise(function(E){var c;E((c=M.onPull)==null?void 0:c.call(M))}).then(function(){h.postMessage({sourceName:A,targetName:f,stream:q.PULL_COMPLETE,streamId:g,success:!0})},function(E){h.postMessage({sourceName:A,targetName:f,stream:q.PULL_COMPLETE,streamId:g,reason:B(E)})});break;case q.ENQUEUE:if((0,n.assert)(x,"enqueue should have stream controller"),x.isClosed)break;x.controller.enqueue(m.chunk);break;case q.CLOSE:if((0,n.assert)(x,"close should have stream controller"),x.isClosed)break;x.isClosed=!0,x.controller.close(),Y(this,L,Ee).call(this,x,g);break;case q.ERROR:(0,n.assert)(x,"error should have stream controller"),x.controller.error(B(m.reason)),Y(this,L,Ee).call(this,x,g);break;case q.CANCEL_COMPLETE:m.success?x.cancelCall.resolve():x.cancelCall.reject(B(m.reason)),Y(this,L,Ee).call(this,x,g);break;case q.CANCEL:if(!M)break;new Promise(function(E){var c;E((c=M.onCancel)==null?void 0:c.call(M,B(m.reason)))}).then(function(){h.postMessage({sourceName:A,targetName:f,stream:q.CANCEL_COMPLETE,streamId:g,success:!0})},function(E){h.postMessage({sourceName:A,targetName:f,stream:q.CANCEL_COMPLETE,streamId:g,reason:B(E)})}),M.sinkCapability.reject(B(m.reason)),M.isCancelled=!0,delete this.streamSinks[g];break;default:throw new Error("Unexpected stream case")}},Ee=async function(m,g){var A,f,h;await Promise.allSettled([(A=m.startCall)==null?void 0:A.promise,(f=m.pullCall)==null?void 0:f.promise,(h=m.cancelCall)==null?void 0:h.promise]),delete this.streamControllers[g]},a.MessageHandler=tt},(H,a,G)=>{var q,B;Object.defineProperty(a,"__esModule",{value:!0}),a.Metadata=void 0;var n=G(1);class _{constructor({parsedData:L,rawData:v}){rt(this,q);rt(this,B);lt(this,q,L),lt(this,B,v)}getRaw(){return t(this,B)}get(L){return t(this,q).get(L)??null}getAll(){return(0,n.objectFromMap)(t(this,q))}has(L){return t(this,q).has(L)}}q=new WeakMap,B=new WeakMap,a.Metadata=_},(H,a,G)=>{var L,v,l,P,R,m,Ye;Object.defineProperty(a,"__esModule",{value:!0}),a.OptionalContentConfig=void 0;var n=G(1),_=G(8);const q=Symbol("INTERNAL");class B{constructor(f,h){rt(this,L,!0);this.name=f,this.intent=h}get visible(){return t(this,L)}_setVisible(f,h){f!==q&&(0,n.unreachable)("Internal method `_setVisible` called."),lt(this,L,h)}}L=new WeakMap;class tt{constructor(f){rt(this,m);rt(this,v,null);rt(this,l,new Map);rt(this,P,null);rt(this,R,null);if(this.name=null,this.creator=null,f!==null){this.name=f.name,this.creator=f.creator,lt(this,R,f.order);for(const h of f.groups)t(this,l).set(h.id,new B(h.name,h.intent));if(f.baseState==="OFF")for(const h of t(this,l).values())h._setVisible(q,!1);for(const h of f.on)t(this,l).get(h)._setVisible(q,!0);for(const h of f.off)t(this,l).get(h)._setVisible(q,!1);lt(this,P,this.getHash())}}isVisible(f){if(t(this,l).size===0)return!0;if(!f)return(0,n.warn)("Optional content group not defined."),!0;if(f.type==="OCG")return t(this,l).has(f.id)?t(this,l).get(f.id).visible:((0,n.warn)(`Optional content group not found: ${f.id}`),!0);if(f.type==="OCMD"){if(f.expression)return Y(this,m,Ye).call(this,f.expression);if(!f.policy||f.policy==="AnyOn"){for(const h of f.ids){if(!t(this,l).has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(t(this,l).get(h).visible)return!0}return!1}else if(f.policy==="AllOn"){for(const h of f.ids){if(!t(this,l).has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(!t(this,l).get(h).visible)return!1}return!0}else if(f.policy==="AnyOff"){for(const h of f.ids){if(!t(this,l).has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(!t(this,l).get(h).visible)return!0}return!1}else if(f.policy==="AllOff"){for(const h of f.ids){if(!t(this,l).has(h))return(0,n.warn)(`Optional content group not found: ${h}`),!0;if(t(this,l).get(h).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${f.policy}.`),!0}return(0,n.warn)(`Unknown group type ${f.type}.`),!0}setVisibility(f,h=!0){if(!t(this,l).has(f)){(0,n.warn)(`Optional content group not found: ${f}`);return}t(this,l).get(f)._setVisible(q,!!h),lt(this,v,null)}get hasInitialVisibility(){return t(this,P)===null||this.getHash()===t(this,P)}getOrder(){return t(this,l).size?t(this,R)?t(this,R).slice():[...t(this,l).keys()]:null}getGroups(){return t(this,l).size>0?(0,n.objectFromMap)(t(this,l)):null}getGroup(f){return t(this,l).get(f)||null}getHash(){if(t(this,v)!==null)return t(this,v);const f=new _.MurmurHash3_64;for(const[h,x]of t(this,l))f.update(`${h}:${x.visible}`);return lt(this,v,f.hexdigest())}}v=new WeakMap,l=new WeakMap,P=new WeakMap,R=new WeakMap,m=new WeakSet,Ye=function(f){const h=f.length;if(h<2)return!0;const x=f[0];for(let M=1;M<h;M++){const E=f[M];let c;if(Array.isArray(E))c=Y(this,m,Ye).call(this,E);else if(t(this,l).has(E))c=t(this,l).get(E).visible;else return(0,n.warn)(`Optional content group not found: ${E}`),!0;switch(x){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return x==="And"},a.OptionalContentConfig=tt},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFDataTransportStream=void 0;var n=G(1),_=G(6);class q{constructor({length:v,initialData:l,progressiveDone:P=!1,contentDispositionFilename:R=null,disableRange:m=!1,disableStream:g=!1},A){if((0,n.assert)(A,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=P,this._contentDispositionFilename=R,(l==null?void 0:l.length)>0){const f=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=A,this._isStreamingSupported=!g,this._isRangeSupported=!m,this._contentLength=v,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((f,h)=>{this._onReceiveData({begin:f,chunk:h})}),this._pdfDataRangeTransport.addProgressListener((f,h)=>{this._onProgress({loaded:f,total:h})}),this._pdfDataRangeTransport.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:v,chunk:l}){const P=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;if(v===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(P):this._queuedChunks.push(P);else{const R=this._rangeReaders.some(function(m){return m._begin!==v?!1:(m._enqueue(P),!0)});(0,n.assert)(R,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var v;return((v=this._fullRequestReader)==null?void 0:v._loaded)??0}_onProgress(v){var l,P,R,m;v.total===void 0?(P=(l=this._rangeReaders[0])==null?void 0:l.onProgress)==null||P.call(l,{loaded:v.loaded}):(m=(R=this._fullRequestReader)==null?void 0:R.onProgress)==null||m.call(R,{loaded:v.loaded,total:v.total})}_onProgressiveDone(){var v;(v=this._fullRequestReader)==null||v.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(v){const l=this._rangeReaders.indexOf(v);l>=0&&this._rangeReaders.splice(l,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const v=this._queuedChunks;return this._queuedChunks=null,new B(this,v,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(v,l){if(l<=this._progressiveDataLength)return null;const P=new tt(this,v,l);return this._pdfDataRangeTransport.requestDataRange(v,l),this._rangeReaders.push(P),P}cancelAllRequests(v){var l;(l=this._fullRequestReader)==null||l.cancel(v);for(const P of this._rangeReaders.slice(0))P.cancel(v);this._pdfDataRangeTransport.abort()}}a.PDFDataTransportStream=q;class B{constructor(v,l,P=!1,R=null){this._stream=v,this._done=P||!1,this._filename=(0,_.isPdfFile)(R)?R:null,this._queuedChunks=l||[],this._loaded=0;for(const m of this._queuedChunks)this._loaded+=m.byteLength;this._requests=[],this._headersReady=Promise.resolve(),v._fullRequestReader=this,this.onProgress=null}_enqueue(v){this._done||(this._requests.length>0?this._requests.shift().resolve({value:v,done:!1}):this._queuedChunks.push(v),this._loaded+=v.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const v=new n.PromiseCapability;return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class tt{constructor(v,l,P){this._stream=v,this._begin=l,this._end=P,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(v){if(!this._done){if(this._requests.length===0)this._queuedChunk=v;else{this._requests.shift().resolve({value:v,done:!1});for(const P of this._requests)P.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const l=this._queuedChunk;return this._queuedChunk=null,{value:l,done:!1}}if(this._done)return{value:void 0,done:!0};const v=new n.PromiseCapability;return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFFetchStream=void 0;var n=G(1),_=G(20);function q(P,R,m){return{method:"GET",headers:P,signal:m.signal,mode:"cors",credentials:R?"include":"same-origin",redirect:"follow"}}function B(P){const R=new Headers;for(const m in P){const g=P[m];g!==void 0&&R.append(m,g)}return R}function tt(P){return P instanceof Uint8Array?P.buffer:P instanceof ArrayBuffer?P:((0,n.warn)(`getArrayBuffer - unexpected data format: ${P}`),new Uint8Array(P).buffer)}class L{constructor(R){this.source=R,this.isHttp=/^https?:/i.test(R.url),this.httpHeaders=this.isHttp&&R.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var R;return((R=this._fullRequestReader)==null?void 0:R._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new v(this),this._fullRequestReader}getRangeReader(R,m){if(m<=this._progressiveDataLength)return null;const g=new l(this,R,m);return this._rangeRequestReaders.push(g),g}cancelAllRequests(R){var m;(m=this._fullRequestReader)==null||m.cancel(R);for(const g of this._rangeRequestReaders.slice(0))g.cancel(R)}}a.PDFFetchStream=L;class v{constructor(R){this._stream=R,this._reader=null,this._loaded=0,this._filename=null;const m=R.source;this._withCredentials=m.withCredentials||!1,this._contentLength=m.length,this._headersCapability=new n.PromiseCapability,this._disableRange=m.disableRange||!1,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!m.disableStream,this._isRangeSupported=!m.disableRange,this._headers=B(this._stream.httpHeaders);const g=m.url;fetch(g,q(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,_.validateResponseStatus)(A.status))throw(0,_.createResponseStatusError)(A.status,g);this._reader=A.body.getReader(),this._headersCapability.resolve();const f=M=>A.headers.get(M),{allowRangeRequests:h,suggestedLength:x}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=h,this._contentLength=x||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var g;await this._headersCapability.promise;const{value:R,done:m}=await this._reader.read();return m?{value:R,done:m}:(this._loaded+=R.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded,total:this._contentLength}),{value:tt(R),done:!1})}cancel(R){var m;(m=this._reader)==null||m.cancel(R),this._abortController.abort()}}class l{constructor(R,m,g){this._stream=R,this._reader=null,this._loaded=0;const A=R.source;this._withCredentials=A.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!A.disableStream,this._abortController=new AbortController,this._headers=B(this._stream.httpHeaders),this._headers.append("Range",`bytes=${m}-${g-1}`);const f=A.url;fetch(f,q(this._headers,this._withCredentials,this._abortController)).then(h=>{if(!(0,_.validateResponseStatus)(h.status))throw(0,_.createResponseStatusError)(h.status,f);this._readCapability.resolve(),this._reader=h.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var g;await this._readCapability.promise;const{value:R,done:m}=await this._reader.read();return m?{value:R,done:m}:(this._loaded+=R.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded}),{value:tt(R),done:!1})}cancel(R){var m;(m=this._reader)==null||m.cancel(R),this._abortController.abort()}}},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createResponseStatusError=L,a.extractFilenameFromHeader=tt,a.validateRangeRequestCapabilities=B,a.validateResponseStatus=v;var n=G(1),_=G(21),q=G(6);function B({getResponseHeader:l,isHttp:P,rangeChunkSize:R,disableRange:m}){const g={allowRangeRequests:!1,suggestedLength:void 0},A=parseInt(l("Content-Length"),10);return!Number.isInteger(A)||(g.suggestedLength=A,A<=2*R)||m||!P||l("Accept-Ranges")!=="bytes"||(l("Content-Encoding")||"identity")!=="identity"||(g.allowRangeRequests=!0),g}function tt(l){const P=l("Content-Disposition");if(P){let R=(0,_.getFilenameFromContentDispositionHeader)(P);if(R.includes("%"))try{R=decodeURIComponent(R)}catch{}if((0,q.isPdfFile)(R))return R}return null}function L(l,P){return l===404||l===0&&P.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+P+'".'):new n.UnexpectedResponseException(`Unexpected server response (${l}) while retrieving PDF "${P}".`,l)}function v(l){return l===200||l===206}},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getFilenameFromContentDispositionHeader=_;var n=G(1);function _(q){let B=!0,tt=L("filename\\*","i").exec(q);if(tt){tt=tt[1];let A=R(tt);return A=unescape(A),A=m(A),A=g(A),l(A)}if(tt=P(q),tt){const A=g(tt);return l(A)}if(tt=L("filename","i").exec(q),tt){tt=tt[1];let A=R(tt);return A=g(A),l(A)}function L(A,f){return new RegExp("(?:^|;)\\s*"+A+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function v(A,f){if(A){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const h=new TextDecoder(A,{fatal:!0}),x=(0,n.stringToBytes)(f);f=h.decode(x),B=!1}catch{}}return f}function l(A){return B&&/[\x80-\xff]/.test(A)&&(A=v("utf-8",A),B&&(A=v("iso-8859-1",A))),A}function P(A){const f=[];let h;const x=L("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=x.exec(A))!==null;){let[,E,c,u]=h;if(E=parseInt(E,10),E in f){if(E===0)break;continue}f[E]=[c,u]}const M=[];for(let E=0;E<f.length&&E in f;++E){let[c,u]=f[E];u=R(u),c&&(u=unescape(u),E===0&&(u=m(u))),M.push(u)}return M.join("")}function R(A){if(A.startsWith('"')){const f=A.slice(1).split('\\"');for(let h=0;h<f.length;++h){const x=f[h].indexOf('"');x!==-1&&(f[h]=f[h].slice(0,x),f.length=h+1),f[h]=f[h].replaceAll(/\\(.)/g,"$1")}A=f.join('"')}return A}function m(A){const f=A.indexOf("'");if(f===-1)return A;const h=A.slice(0,f),M=A.slice(f+1).replace(/^[^']*'/,"");return v(h,M)}function g(A){return!A.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(A)?A:A.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,h,x,M){if(x==="q"||x==="Q")return M=M.replaceAll("_"," "),M=M.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,c){return String.fromCharCode(parseInt(c,16))}),v(h,M);try{M=atob(M)}catch{}return v(h,M)})}return""}},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNetworkStream=void 0;var n=G(1),_=G(20);const q=200,B=206;function tt(R){const m=R.response;return typeof m!="string"?m:(0,n.stringToBytes)(m).buffer}class L{constructor(m,g={}){this.url=m,this.isHttp=/^https?:/i.test(m),this.httpHeaders=this.isHttp&&g.httpHeaders||Object.create(null),this.withCredentials=g.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(m,g,A){const f={begin:m,end:g};for(const h in A)f[h]=A[h];return this.request(f)}requestFull(m){return this.request(m)}request(m){const g=new XMLHttpRequest,A=this.currXhrId++,f=this.pendingRequests[A]={xhr:g};g.open("GET",this.url),g.withCredentials=this.withCredentials;for(const h in this.httpHeaders){const x=this.httpHeaders[h];x!==void 0&&g.setRequestHeader(h,x)}return this.isHttp&&"begin"in m&&"end"in m?(g.setRequestHeader("Range",`bytes=${m.begin}-${m.end-1}`),f.expectedStatus=B):f.expectedStatus=q,g.responseType="arraybuffer",m.onError&&(g.onerror=function(h){m.onError(g.status)}),g.onreadystatechange=this.onStateChange.bind(this,A),g.onprogress=this.onProgress.bind(this,A),f.onHeadersReceived=m.onHeadersReceived,f.onDone=m.onDone,f.onError=m.onError,f.onProgress=m.onProgress,g.send(null),A}onProgress(m,g){var f;const A=this.pendingRequests[m];A&&((f=A.onProgress)==null||f.call(A,g))}onStateChange(m,g){var E,c,u;const A=this.pendingRequests[m];if(!A)return;const f=A.xhr;if(f.readyState>=2&&A.onHeadersReceived&&(A.onHeadersReceived(),delete A.onHeadersReceived),f.readyState!==4||!(m in this.pendingRequests))return;if(delete this.pendingRequests[m],f.status===0&&this.isHttp){(E=A.onError)==null||E.call(A,f.status);return}const h=f.status||q;if(!(h===q&&A.expectedStatus===B)&&h!==A.expectedStatus){(c=A.onError)==null||c.call(A,f.status);return}const M=tt(f);if(h===B){const r=f.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(r);A.onDone({begin:parseInt(d[1],10),chunk:M})}else M?A.onDone({begin:0,chunk:M}):(u=A.onError)==null||u.call(A,f.status)}getRequestXhr(m){return this.pendingRequests[m].xhr}isPendingRequest(m){return m in this.pendingRequests}abortRequest(m){const g=this.pendingRequests[m].xhr;delete this.pendingRequests[m],g.abort()}}class v{constructor(m){this._source=m,this._manager=new L(m.url,{httpHeaders:m.httpHeaders,withCredentials:m.withCredentials}),this._rangeChunkSize=m.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(m){const g=this._rangeRequestReaders.indexOf(m);g>=0&&this._rangeRequestReaders.splice(g,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new l(this._manager,this._source),this._fullRequestReader}getRangeReader(m,g){const A=new P(this._manager,m,g);return A.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(A),A}cancelAllRequests(m){var g;(g=this._fullRequestReader)==null||g.cancel(m);for(const A of this._rangeRequestReaders.slice(0))A.cancel(m)}}a.PDFNetworkStream=v;class l{constructor(m,g){this._manager=m;const A={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._fullRequestId=m.requestFull(A),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=g.disableRange||!1,this._contentLength=g.length,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const m=this._fullRequestId,g=this._manager.getRequestXhr(m),A=x=>g.getResponseHeader(x),{allowRangeRequests:f,suggestedLength:h}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:A,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});f&&(this._isRangeSupported=!0),this._contentLength=h||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(A),this._isRangeSupported&&this._manager.abortRequest(m),this._headersReceivedCapability.resolve()}_onDone(m){if(m&&(this._requests.length>0?this._requests.shift().resolve({value:m.chunk,done:!1}):this._cachedChunks.push(m.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(m){this._storedError=(0,_.createResponseStatusError)(m,this._url),this._headersReceivedCapability.reject(this._storedError);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(m){var g;(g=this.onProgress)==null||g.call(this,{loaded:m.loaded,total:m.lengthComputable?m.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const m=new n.PromiseCapability;return this._requests.push(m),m.promise}cancel(m){this._done=!0,this._headersReceivedCapability.reject(m);for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class P{constructor(m,g,A){this._manager=m;const f={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._requestId=m.requestRange(g,A,f),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var m;(m=this.onClosed)==null||m.call(this,this)}_onDone(m){const g=m.chunk;this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunk=g,this._done=!0;for(const A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(m){this._storedError=(0,_.createResponseStatusError)(m,this._url);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(m){var g;this.isStreamingSupported||(g=this.onProgress)==null||g.call(this,{loaded:m.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const m=new n.PromiseCapability;return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNodeStream=void 0;var n=G(1),_=G(20);const q=/^file:\/\/\/[a-zA-Z]:\//;function B(A){const f=require$$5,h=f.parse(A);return h.protocol==="file:"||h.host?h:/^[a-z]:[/\\]/i.test(A)?f.parse(`file:///${A}`):(h.host||(h.protocol="file:"),h)}class tt{constructor(f){this.source=f,this.url=B(f.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new m(this):new P(this),this._fullRequestReader}getRangeReader(f,h){if(h<=this._progressiveDataLength)return null;const x=this.isFsUrl?new g(this,f,h):new R(this,f,h);return this._rangeRequestReaders.push(x),x}cancelAllRequests(f){var h;(h=this._fullRequestReader)==null||h.cancel(f);for(const x of this._rangeRequestReaders.slice(0))x.cancel(f)}}a.PDFNodeStream=tt;class L{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null;const h=f.source;this._contentLength=h.length,this._loaded=0,this._filename=null,this._disableRange=h.disableRange||!1,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!h.disableStream,this._isRangeSupported=!h.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var x;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=f.length,(x=this.onProgress)==null||x.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",h=>{this._error(h)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class v{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const h=f.source;this._isStreamingSupported=!h.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var x;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=f.length,(x=this.onProgress)==null||x.call(this,{loaded:this._loaded}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",h=>{this._error(h)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(A,f){return{protocol:A.protocol,auth:A.auth,host:A.hostname,port:A.port,path:A.path,method:"GET",headers:f}}class P extends L{constructor(f){super(f);const h=x=>{if(x.statusCode===404){const u=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=u,this._headersCapability.reject(u);return}this._headersCapability.resolve(),this._setReadableStream(x);const M=u=>this._readableStream.headers[u.toLowerCase()],{allowRangeRequests:E,suggestedLength:c}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:M,isHttp:f.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=E,this._contentLength=c||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(M)};if(this._request=null,this._url.protocol==="http:"){const x=require$$5;this._request=x.request(l(this._url,f.httpHeaders),h)}else{const x=require$$5;this._request=x.request(l(this._url,f.httpHeaders),h)}this._request.on("error",x=>{this._storedError=x,this._headersCapability.reject(x)}),this._request.end()}}class R extends v{constructor(f,h,x){super(f),this._httpHeaders={};for(const E in f.httpHeaders){const c=f.httpHeaders[E];c!==void 0&&(this._httpHeaders[E]=c)}this._httpHeaders.Range=`bytes=${h}-${x-1}`;const M=E=>{if(E.statusCode===404){const c=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=c;return}this._setReadableStream(E)};if(this._request=null,this._url.protocol==="http:"){const E=require$$5;this._request=E.request(l(this._url,this._httpHeaders),M)}else{const E=require$$5;this._request=E.request(l(this._url,this._httpHeaders),M)}this._request.on("error",E=>{this._storedError=E}),this._request.end()}}class m extends L{constructor(f){super(f);let h=decodeURIComponent(this._url.path);q.test(this._url.href)&&(h=h.replace(/^\//,""));const x=require$$5;x.lstat(h,(M,E)=>{if(M){M.code==="ENOENT"&&(M=new n.MissingPDFException(`Missing PDF "${h}".`)),this._storedError=M,this._headersCapability.reject(M);return}this._contentLength=E.size,this._setReadableStream(x.createReadStream(h)),this._headersCapability.resolve()})}}class g extends v{constructor(f,h,x){super(f);let M=decodeURIComponent(this._url.path);q.test(this._url.href)&&(M=M.replace(/^\//,""));const E=require$$5;this._setReadableStream(E.createReadStream(M,{start:h,end:x-1}))}}},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SVGGraphics=void 0;var n=G(6),_=G(1);const q={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},B="http://www.w3.org/XML/1998/namespace",tt="http://www.w3.org/1999/xlink",L=["butt","round","square"],v=["miter","round","bevel"],l=function(E,c="",u=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!u)return URL.createObjectURL(new Blob([E],{type:c}));const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let d=`data:${c};base64,`;for(let o=0,C=E.length;o<C;o+=3){const i=E[o]&255,b=E[o+1]&255,S=E[o+2]&255,K=i>>2,U=(i&3)<<4|b>>4,X=o+1<C?(b&15)<<2|S>>6:64,$=o+2<C?S&63:64;d+=r[K]+r[U]+r[X]+r[$]}return d},P=function(){const E=new Uint8Array([137,80,78,71,13,10,26,10]),c=12,u=new Int32Array(256);for(let S=0;S<256;S++){let K=S;for(let U=0;U<8;U++)K=K&1?3988292384^K>>1&2147483647:K>>1&2147483647;u[S]=K}function r(S,K,U){let X=-1;for(let $=K;$<U;$++){const at=(X^S[$])&255,F=u[at];X=X>>>8^F}return X^-1}function d(S,K,U,X){let $=X;const at=K.length;U[$]=at>>24&255,U[$+1]=at>>16&255,U[$+2]=at>>8&255,U[$+3]=at&255,$+=4,U[$]=S.charCodeAt(0)&255,U[$+1]=S.charCodeAt(1)&255,U[$+2]=S.charCodeAt(2)&255,U[$+3]=S.charCodeAt(3)&255,$+=4,U.set(K,$),$+=K.length;const F=r(U,X+4,$);U[$]=F>>24&255,U[$+1]=F>>16&255,U[$+2]=F>>8&255,U[$+3]=F&255}function o(S,K,U){let X=1,$=0;for(let at=K;at<U;++at)X=(X+(S[at]&255))%65521,$=($+X)%65521;return $<<16|X}function C(S){if(!_.isNodeJS)return i(S);try{const K=parseInt(process.versions.node)>=8?S:Buffer.from(S),U=require$$5.deflateSync(K,{level:9});return U instanceof Uint8Array?U:new Uint8Array(U)}catch(K){(0,_.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+K)}return i(S)}function i(S){let K=S.length;const U=65535,X=Math.ceil(K/U),$=new Uint8Array(2+K+X*5+4);let at=0;$[at++]=120,$[at++]=156;let F=0;for(;K>U;)$[at++]=0,$[at++]=255,$[at++]=255,$[at++]=0,$[at++]=0,$.set(S.subarray(F,F+U),at),at+=U,F+=U,K-=U;$[at++]=1,$[at++]=K&255,$[at++]=K>>8&255,$[at++]=~K&65535&255,$[at++]=(~K&65535)>>8&255,$.set(S.subarray(F),at),at+=S.length-F;const W=o(S,0,S.length);return $[at++]=W>>24&255,$[at++]=W>>16&255,$[at++]=W>>8&255,$[at++]=W&255,$}function b(S,K,U,X){const $=S.width,at=S.height;let F,W,Z;const w=S.data;switch(K){case _.ImageKind.GRAYSCALE_1BPP:W=0,F=1,Z=$+7>>3;break;case _.ImageKind.RGB_24BPP:W=2,F=8,Z=$*3;break;case _.ImageKind.RGBA_32BPP:W=6,F=8,Z=$*4;break;default:throw new Error("invalid format")}const s=new Uint8Array((1+Z)*at);let e=0,p=0;for(let ut=0;ut<at;++ut)s[e++]=0,s.set(w.subarray(p,p+Z),e),p+=Z,e+=Z;if(K===_.ImageKind.GRAYSCALE_1BPP&&X){e=0;for(let ut=0;ut<at;ut++){e++;for(let dt=0;dt<Z;dt++)s[e++]^=255}}const k=new Uint8Array([$>>24&255,$>>16&255,$>>8&255,$&255,at>>24&255,at>>16&255,at>>8&255,at&255,F,W,0,0,0]),j=C(s),I=E.length+c*3+k.length+j.length,V=new Uint8Array(I);let et=0;return V.set(E,et),et+=E.length,d("IHDR",k,V,et),et+=c+k.length,d("IDATA",j,V,et),et+=c+j.length,d("IEND",new Uint8Array(0),V,et),l(V,"image/png",U)}return function(K,U,X){const $=K.kind===void 0?_.ImageKind.GRAYSCALE_1BPP:K.kind;return b(K,$,U,X)}}();class R{constructor(){this.fontSizeScale=1,this.fontWeight=q.fontWeight,this.fontSize=0,this.textMatrix=_.IDENTITY_MATRIX,this.fontMatrix=_.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=_.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=q.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(c,u){this.x=c,this.y=u}}function m(E){let c=[];const u=[];for(const r of E){if(r.fn==="save"){c.push({fnId:92,fn:"group",items:[]}),u.push(c),c=c.at(-1).items;continue}r.fn==="restore"?c=u.pop():c.push(r)}return c}function g(E){if(Number.isInteger(E))return E.toString();const c=E.toFixed(10);let u=c.length-1;if(c[u]!=="0")return c;do u--;while(c[u]==="0");return c.substring(0,c[u]==="."?u:u+1)}function A(E){if(E[4]===0&&E[5]===0){if(E[1]===0&&E[2]===0)return E[0]===1&&E[3]===1?"":`scale(${g(E[0])} ${g(E[3])})`;if(E[0]===E[3]&&E[1]===-E[2]){const c=Math.acos(E[0])*180/Math.PI;return`rotate(${g(c)})`}}else if(E[0]===1&&E[1]===0&&E[2]===0&&E[3]===1)return`translate(${g(E[4])} ${g(E[5])})`;return`matrix(${g(E[0])} ${g(E[1])} ${g(E[2])} ${g(E[3])} ${g(E[4])} ${g(E[5])})`}let f=0,h=0,x=0;class M{constructor(c,u,r=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new R,this.transformMatrix=_.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=c,this.objs=u,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!r,this._operatorIdMapping=[];for(const d in _.OPS)this._operatorIdMapping[_.OPS[d]]=d}getObject(c,u=null){return typeof c=="string"?c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c):u}save(){this.transformStack.push(this.transformMatrix);const c=this.current;this.extraStack.push(c),this.current=c.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(c){this.save(),this.executeOpTree(c),this.restore()}loadDependencies(c){const u=c.fnArray,r=c.argsArray;for(let d=0,o=u.length;d<o;d++)if(u[d]===_.OPS.dependency)for(const C of r[d]){const i=C.startsWith("g_")?this.commonObjs:this.objs,b=new Promise(S=>{i.get(C,S)});this.current.dependencies.push(b)}return Promise.all(this.current.dependencies)}transform(c,u,r,d,o,C){const i=[c,u,r,d,o,C];this.transformMatrix=_.Util.transform(this.transformMatrix,i),this.tgrp=null}getSVG(c,u){this.viewport=u;const r=this._initialize(u);return this.loadDependencies(c).then(()=>(this.transformMatrix=_.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(c)),r))}convertOpList(c){const u=this._operatorIdMapping,r=c.argsArray,d=c.fnArray,o=[];for(let C=0,i=d.length;C<i;C++){const b=d[C];o.push({fnId:b,fn:u[b],args:r[C]})}return m(o)}executeOpTree(c){for(const u of c){const r=u.fn,d=u.fnId,o=u.args;switch(d|0){case _.OPS.beginText:this.beginText();break;case _.OPS.dependency:break;case _.OPS.setLeading:this.setLeading(o);break;case _.OPS.setLeadingMoveText:this.setLeadingMoveText(o[0],o[1]);break;case _.OPS.setFont:this.setFont(o);break;case _.OPS.showText:this.showText(o[0]);break;case _.OPS.showSpacedText:this.showText(o[0]);break;case _.OPS.endText:this.endText();break;case _.OPS.moveText:this.moveText(o[0],o[1]);break;case _.OPS.setCharSpacing:this.setCharSpacing(o[0]);break;case _.OPS.setWordSpacing:this.setWordSpacing(o[0]);break;case _.OPS.setHScale:this.setHScale(o[0]);break;case _.OPS.setTextMatrix:this.setTextMatrix(o[0],o[1],o[2],o[3],o[4],o[5]);break;case _.OPS.setTextRise:this.setTextRise(o[0]);break;case _.OPS.setTextRenderingMode:this.setTextRenderingMode(o[0]);break;case _.OPS.setLineWidth:this.setLineWidth(o[0]);break;case _.OPS.setLineJoin:this.setLineJoin(o[0]);break;case _.OPS.setLineCap:this.setLineCap(o[0]);break;case _.OPS.setMiterLimit:this.setMiterLimit(o[0]);break;case _.OPS.setFillRGBColor:this.setFillRGBColor(o[0],o[1],o[2]);break;case _.OPS.setStrokeRGBColor:this.setStrokeRGBColor(o[0],o[1],o[2]);break;case _.OPS.setStrokeColorN:this.setStrokeColorN(o);break;case _.OPS.setFillColorN:this.setFillColorN(o);break;case _.OPS.shadingFill:this.shadingFill(o[0]);break;case _.OPS.setDash:this.setDash(o[0],o[1]);break;case _.OPS.setRenderingIntent:this.setRenderingIntent(o[0]);break;case _.OPS.setFlatness:this.setFlatness(o[0]);break;case _.OPS.setGState:this.setGState(o[0]);break;case _.OPS.fill:this.fill();break;case _.OPS.eoFill:this.eoFill();break;case _.OPS.stroke:this.stroke();break;case _.OPS.fillStroke:this.fillStroke();break;case _.OPS.eoFillStroke:this.eoFillStroke();break;case _.OPS.clip:this.clip("nonzero");break;case _.OPS.eoClip:this.clip("evenodd");break;case _.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case _.OPS.paintImageXObject:this.paintImageXObject(o[0]);break;case _.OPS.paintInlineImageXObject:this.paintInlineImageXObject(o[0]);break;case _.OPS.paintImageMaskXObject:this.paintImageMaskXObject(o[0]);break;case _.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(o[0],o[1]);break;case _.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case _.OPS.closePath:this.closePath();break;case _.OPS.closeStroke:this.closeStroke();break;case _.OPS.closeFillStroke:this.closeFillStroke();break;case _.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case _.OPS.nextLine:this.nextLine();break;case _.OPS.transform:this.transform(o[0],o[1],o[2],o[3],o[4],o[5]);break;case _.OPS.constructPath:this.constructPath(o[0],o[1]);break;case _.OPS.endPath:this.endPath();break;case 92:this.group(u.items);break;default:(0,_.warn)(`Unimplemented operator ${r}`);break}}}setWordSpacing(c){this.current.wordSpacing=c}setCharSpacing(c){this.current.charSpacing=c}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(c,u,r,d,o,C){const i=this.current;i.textMatrix=i.lineMatrix=[c,u,r,d,o,C],i.textMatrixScale=Math.hypot(c,u),i.x=i.lineX=0,i.y=i.lineY=0,i.xcoords=[],i.ycoords=[],i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",`${g(i.fontSize)}px`),i.tspan.setAttributeNS(null,"y",g(-i.y)),i.txtElement=this.svgFactory.createElement("svg:text"),i.txtElement.append(i.tspan)}beginText(){const c=this.current;c.x=c.lineX=0,c.y=c.lineY=0,c.textMatrix=_.IDENTITY_MATRIX,c.lineMatrix=_.IDENTITY_MATRIX,c.textMatrixScale=1,c.tspan=this.svgFactory.createElement("svg:tspan"),c.txtElement=this.svgFactory.createElement("svg:text"),c.txtgrp=this.svgFactory.createElement("svg:g"),c.xcoords=[],c.ycoords=[]}moveText(c,u){const r=this.current;r.x=r.lineX+=c,r.y=r.lineY+=u,r.xcoords=[],r.ycoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${g(r.fontSize)}px`),r.tspan.setAttributeNS(null,"y",g(-r.y))}showText(c){const u=this.current,r=u.font,d=u.fontSize;if(d===0)return;const o=u.fontSizeScale,C=u.charSpacing,i=u.wordSpacing,b=u.fontDirection,S=u.textHScale*b,K=r.vertical,U=K?1:-1,X=r.defaultVMetrics,$=d*u.fontMatrix[0];let at=0;for(const Z of c){if(Z===null){at+=b*i;continue}else if(typeof Z=="number"){at+=U*Z*d/1e3;continue}const w=(Z.isSpace?i:0)+C,s=Z.fontChar;let e,p,k=Z.width;if(K){let I;const V=Z.vmetric||X;I=Z.vmetric?V[1]:k*.5,I=-I*$;const et=V[2]*$;k=V?-V[0]:k,e=I/o,p=(at+et)/o}else e=at/o,p=0;(Z.isInFont||r.missingFile)&&(u.xcoords.push(u.x+e),K&&u.ycoords.push(-u.y+p),u.tspan.textContent+=s);const j=K?k*$-w*b:k*$+w*b;at+=j}u.tspan.setAttributeNS(null,"x",u.xcoords.map(g).join(" ")),K?u.tspan.setAttributeNS(null,"y",u.ycoords.map(g).join(" ")):u.tspan.setAttributeNS(null,"y",g(-u.y)),K?u.y-=at:u.x+=at*S,u.tspan.setAttributeNS(null,"font-family",u.fontFamily),u.tspan.setAttributeNS(null,"font-size",`${g(u.fontSize)}px`),u.fontStyle!==q.fontStyle&&u.tspan.setAttributeNS(null,"font-style",u.fontStyle),u.fontWeight!==q.fontWeight&&u.tspan.setAttributeNS(null,"font-weight",u.fontWeight);const F=u.textRenderingMode&_.TextRenderingMode.FILL_STROKE_MASK;if(F===_.TextRenderingMode.FILL||F===_.TextRenderingMode.FILL_STROKE?(u.fillColor!==q.fillColor&&u.tspan.setAttributeNS(null,"fill",u.fillColor),u.fillAlpha<1&&u.tspan.setAttributeNS(null,"fill-opacity",u.fillAlpha)):u.textRenderingMode===_.TextRenderingMode.ADD_TO_PATH?u.tspan.setAttributeNS(null,"fill","transparent"):u.tspan.setAttributeNS(null,"fill","none"),F===_.TextRenderingMode.STROKE||F===_.TextRenderingMode.FILL_STROKE){const Z=1/(u.textMatrixScale||1);this._setStrokeAttributes(u.tspan,Z)}let W=u.textMatrix;u.textRise!==0&&(W=W.slice(),W[5]+=u.textRise),u.txtElement.setAttributeNS(null,"transform",`${A(W)} scale(${g(S)}, -1)`),u.txtElement.setAttributeNS(B,"xml:space","preserve"),u.txtElement.append(u.tspan),u.txtgrp.append(u.txtElement),this._ensureTransformGroup().append(u.txtElement)}setLeadingMoveText(c,u){this.setLeading(-u),this.moveText(c,u)}addFontStyle(c){if(!c.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const u=l(c.data,c.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${c.loadedName}"; src: url(${u}); }
`}setFont(c){const u=this.current,r=this.commonObjs.get(c[0]);let d=c[1];u.font=r,this.embedFonts&&!r.missingFile&&!this.embeddedFonts[r.loadedName]&&(this.addFontStyle(r),this.embeddedFonts[r.loadedName]=r),u.fontMatrix=r.fontMatrix||_.FONT_IDENTITY_MATRIX;let o="normal";r.black?o="900":r.bold&&(o="bold");const C=r.italic?"italic":"normal";d<0?(d=-d,u.fontDirection=-1):u.fontDirection=1,u.fontSize=d,u.fontFamily=r.loadedName,u.fontWeight=o,u.fontStyle=C,u.tspan=this.svgFactory.createElement("svg:tspan"),u.tspan.setAttributeNS(null,"y",g(-u.y)),u.xcoords=[],u.ycoords=[]}endText(){var u;const c=this.current;c.textRenderingMode&_.TextRenderingMode.ADD_TO_PATH_FLAG&&((u=c.txtElement)!=null&&u.hasChildNodes())&&(c.element=c.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(c){c>0&&(this.current.lineWidth=c)}setLineCap(c){this.current.lineCap=L[c]}setLineJoin(c){this.current.lineJoin=v[c]}setMiterLimit(c){this.current.miterLimit=c}setStrokeAlpha(c){this.current.strokeAlpha=c}setStrokeRGBColor(c,u,r){this.current.strokeColor=_.Util.makeHexColor(c,u,r)}setFillAlpha(c){this.current.fillAlpha=c}setFillRGBColor(c,u,r){this.current.fillColor=_.Util.makeHexColor(c,u,r),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(c){this.current.strokeColor=this._makeColorN_Pattern(c)}setFillColorN(c){this.current.fillColor=this._makeColorN_Pattern(c)}shadingFill(c){const{width:u,height:r}=this.viewport,d=_.Util.inverseTransform(this.transformMatrix),[o,C,i,b]=_.Util.getAxialAlignedBoundingBox([0,0,u,r],d),S=this.svgFactory.createElement("svg:rect");S.setAttributeNS(null,"x",o),S.setAttributeNS(null,"y",C),S.setAttributeNS(null,"width",i-o),S.setAttributeNS(null,"height",b-C),S.setAttributeNS(null,"fill",this._makeShadingPattern(c)),this.current.fillAlpha<1&&S.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(S)}_makeColorN_Pattern(c){return c[0]==="TilingPattern"?this._makeTilingPattern(c):this._makeShadingPattern(c)}_makeTilingPattern(c){const u=c[1],r=c[2],d=c[3]||_.IDENTITY_MATRIX,[o,C,i,b]=c[4],S=c[5],K=c[6],U=c[7],X=`shading${x++}`,[$,at,F,W]=_.Util.normalizeRect([..._.Util.applyTransform([o,C],d),..._.Util.applyTransform([i,b],d)]),[Z,w]=_.Util.singularValueDecompose2dScale(d),s=S*Z,e=K*w,p=this.svgFactory.createElement("svg:pattern");p.setAttributeNS(null,"id",X),p.setAttributeNS(null,"patternUnits","userSpaceOnUse"),p.setAttributeNS(null,"width",s),p.setAttributeNS(null,"height",e),p.setAttributeNS(null,"x",`${$}`),p.setAttributeNS(null,"y",`${at}`);const k=this.svg,j=this.transformMatrix,I=this.current.fillColor,V=this.current.strokeColor,et=this.svgFactory.create(F-$,W-at);if(this.svg=et,this.transformMatrix=d,U===2){const ut=_.Util.makeHexColor(...u);this.current.fillColor=ut,this.current.strokeColor=ut}return this.executeOpTree(this.convertOpList(r)),this.svg=k,this.transformMatrix=j,this.current.fillColor=I,this.current.strokeColor=V,p.append(et.childNodes[0]),this.defs.append(p),`url(#${X})`}_makeShadingPattern(c){switch(typeof c=="string"&&(c=this.objs.get(c)),c[0]){case"RadialAxial":const u=`shading${x++}`,r=c[3];let d;switch(c[1]){case"axial":const o=c[4],C=c[5];d=this.svgFactory.createElement("svg:linearGradient"),d.setAttributeNS(null,"id",u),d.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),d.setAttributeNS(null,"x1",o[0]),d.setAttributeNS(null,"y1",o[1]),d.setAttributeNS(null,"x2",C[0]),d.setAttributeNS(null,"y2",C[1]);break;case"radial":const i=c[4],b=c[5],S=c[6],K=c[7];d=this.svgFactory.createElement("svg:radialGradient"),d.setAttributeNS(null,"id",u),d.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),d.setAttributeNS(null,"cx",b[0]),d.setAttributeNS(null,"cy",b[1]),d.setAttributeNS(null,"r",K),d.setAttributeNS(null,"fx",i[0]),d.setAttributeNS(null,"fy",i[1]),d.setAttributeNS(null,"fr",S);break;default:throw new Error(`Unknown RadialAxial type: ${c[1]}`)}for(const o of r){const C=this.svgFactory.createElement("svg:stop");C.setAttributeNS(null,"offset",o[0]),C.setAttributeNS(null,"stop-color",o[1]),d.append(C)}return this.defs.append(d),`url(#${u})`;case"Mesh":return(0,_.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${c[0]}`)}}setDash(c,u){this.current.dashArray=c,this.current.dashPhase=u}constructPath(c,u){const r=this.current;let d=r.x,o=r.y,C=[],i=0;for(const b of c)switch(b|0){case _.OPS.rectangle:d=u[i++],o=u[i++];const S=u[i++],K=u[i++],U=d+S,X=o+K;C.push("M",g(d),g(o),"L",g(U),g(o),"L",g(U),g(X),"L",g(d),g(X),"Z");break;case _.OPS.moveTo:d=u[i++],o=u[i++],C.push("M",g(d),g(o));break;case _.OPS.lineTo:d=u[i++],o=u[i++],C.push("L",g(d),g(o));break;case _.OPS.curveTo:d=u[i+4],o=u[i+5],C.push("C",g(u[i]),g(u[i+1]),g(u[i+2]),g(u[i+3]),g(d),g(o)),i+=6;break;case _.OPS.curveTo2:C.push("C",g(d),g(o),g(u[i]),g(u[i+1]),g(u[i+2]),g(u[i+3])),d=u[i+2],o=u[i+3],i+=4;break;case _.OPS.curveTo3:d=u[i+2],o=u[i+3],C.push("C",g(u[i]),g(u[i+1]),g(d),g(o),g(d),g(o)),i+=4;break;case _.OPS.closePath:C.push("Z");break}C=C.join(" "),r.path&&c.length>0&&c[0]!==_.OPS.rectangle&&c[0]!==_.OPS.moveTo?C=r.path.getAttributeNS(null,"d")+C:(r.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(r.path)),r.path.setAttributeNS(null,"d",C),r.path.setAttributeNS(null,"fill","none"),r.element=r.path,r.setCurrentPoint(d,o)}endPath(){const c=this.current;if(c.path=null,!this.pendingClip)return;if(!c.element){this.pendingClip=null;return}const u=`clippath${f++}`,r=this.svgFactory.createElement("svg:clipPath");r.setAttributeNS(null,"id",u),r.setAttributeNS(null,"transform",A(this.transformMatrix));const d=c.element.cloneNode(!0);if(this.pendingClip==="evenodd"?d.setAttributeNS(null,"clip-rule","evenodd"):d.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,r.append(d),this.defs.append(r),c.activeClipUrl){c.clipGroup=null;for(const o of this.extraStack)o.clipGroup=null;r.setAttributeNS(null,"clip-path",c.activeClipUrl)}c.activeClipUrl=`url(#${u})`,this.tgrp=null}clip(c){this.pendingClip=c}closePath(){const c=this.current;if(c.path){const u=`${c.path.getAttributeNS(null,"d")}Z`;c.path.setAttributeNS(null,"d",u)}}setLeading(c){this.current.leading=-c}setTextRise(c){this.current.textRise=c}setTextRenderingMode(c){this.current.textRenderingMode=c}setHScale(c){this.current.textHScale=c/100}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(const[u,r]of c)switch(u){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r);break;case"CA":this.setStrokeAlpha(r);break;case"ca":this.setFillAlpha(r);break;default:(0,_.warn)(`Unimplemented graphic state operator ${u}`);break}}fill(){const c=this.current;c.element&&(c.element.setAttributeNS(null,"fill",c.fillColor),c.element.setAttributeNS(null,"fill-opacity",c.fillAlpha),this.endPath())}stroke(){const c=this.current;c.element&&(this._setStrokeAttributes(c.element),c.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(c,u=1){const r=this.current;let d=r.dashArray;u!==1&&d.length>0&&(d=d.map(function(o){return u*o})),c.setAttributeNS(null,"stroke",r.strokeColor),c.setAttributeNS(null,"stroke-opacity",r.strokeAlpha),c.setAttributeNS(null,"stroke-miterlimit",g(r.miterLimit)),c.setAttributeNS(null,"stroke-linecap",r.lineCap),c.setAttributeNS(null,"stroke-linejoin",r.lineJoin),c.setAttributeNS(null,"stroke-width",g(u*r.lineWidth)+"px"),c.setAttributeNS(null,"stroke-dasharray",d.map(g).join(" ")),c.setAttributeNS(null,"stroke-dashoffset",g(u*r.dashPhase)+"px")}eoFill(){var c;(c=this.current.element)==null||c.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var c;(c=this.current.element)==null||c.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x","0"),c.setAttributeNS(null,"y","0"),c.setAttributeNS(null,"width","1px"),c.setAttributeNS(null,"height","1px"),c.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(c)}paintImageXObject(c){const u=this.getObject(c);if(!u){(0,_.warn)(`Dependent image with object ID ${c} is not ready yet`);return}this.paintInlineImageXObject(u)}paintInlineImageXObject(c,u){const r=c.width,d=c.height,o=P(c,this.forceDataSchema,!!u),C=this.svgFactory.createElement("svg:rect");C.setAttributeNS(null,"x","0"),C.setAttributeNS(null,"y","0"),C.setAttributeNS(null,"width",g(r)),C.setAttributeNS(null,"height",g(d)),this.current.element=C,this.clip("nonzero");const i=this.svgFactory.createElement("svg:image");i.setAttributeNS(tt,"xlink:href",o),i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y",g(-d)),i.setAttributeNS(null,"width",g(r)+"px"),i.setAttributeNS(null,"height",g(d)+"px"),i.setAttributeNS(null,"transform",`scale(${g(1/r)} ${g(-1/d)})`),u?u.append(i):this._ensureTransformGroup().append(i)}paintImageMaskXObject(c){const u=this.getObject(c.data,c);if(u.bitmap){(0,_.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const r=this.current,d=u.width,o=u.height,C=r.fillColor;r.maskId=`mask${h++}`;const i=this.svgFactory.createElement("svg:mask");i.setAttributeNS(null,"id",r.maskId);const b=this.svgFactory.createElement("svg:rect");b.setAttributeNS(null,"x","0"),b.setAttributeNS(null,"y","0"),b.setAttributeNS(null,"width",g(d)),b.setAttributeNS(null,"height",g(o)),b.setAttributeNS(null,"fill",C),b.setAttributeNS(null,"mask",`url(#${r.maskId})`),this.defs.append(i),this._ensureTransformGroup().append(b),this.paintInlineImageXObject(u,i)}paintFormXObjectBegin(c,u){if(Array.isArray(c)&&c.length===6&&this.transform(c[0],c[1],c[2],c[3],c[4],c[5]),u){const r=u[2]-u[0],d=u[3]-u[1],o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x",u[0]),o.setAttributeNS(null,"y",u[1]),o.setAttributeNS(null,"width",g(r)),o.setAttributeNS(null,"height",g(d)),this.current.element=o,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(c){const u=this.svgFactory.create(c.width,c.height),r=this.svgFactory.createElement("svg:defs");u.append(r),this.defs=r;const d=this.svgFactory.createElement("svg:g");return d.setAttributeNS(null,"transform",A(c.transform)),u.append(d),this.svg=d,u}_ensureClipGroup(){if(!this.current.clipGroup){const c=this.svgFactory.createElement("svg:g");c.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(c),this.current.clipGroup=c}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",A(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}a.SVGGraphics=M},(H,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaText=void 0;class G{static textContent(_){const q=[],B={items:q,styles:Object.create(null)};function tt(L){var P;if(!L)return;let v=null;const l=L.name;if(l==="#text")v=L.value;else if(G.shouldBuildText(l))(P=L==null?void 0:L.attributes)!=null&&P.textContent?v=L.attributes.textContent:L.value&&(v=L.value);else return;if(v!==null&&q.push({str:v}),!!L.children)for(const R of L.children)tt(R)}return tt(_),B}static shouldBuildText(_){return!(_==="textarea"||_==="input"||_==="option"||_==="select")}}a.XfaText=G},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TextLayerRenderTask=void 0,a.renderTextLayer=A,a.updateTextLayer=f;var n=G(1),_=G(6);const q=1e5,B=30,tt=.8,L=new Map;function v(h,x){let M;if(x&&n.FeatureTest.isOffscreenCanvasSupported)M=new OffscreenCanvas(h,h).getContext("2d",{alpha:!1});else{const E=document.createElement("canvas");E.width=E.height=h,M=E.getContext("2d",{alpha:!1})}return M}function l(h,x){const M=L.get(h);if(M)return M;const E=v(B,x);E.font=`${B}px ${h}`;const c=E.measureText("");let u=c.fontBoundingBoxAscent,r=Math.abs(c.fontBoundingBoxDescent);if(u){const o=u/(u+r);return L.set(h,o),E.canvas.width=E.canvas.height=0,o}E.strokeStyle="red",E.clearRect(0,0,B,B),E.strokeText("g",0,0);let d=E.getImageData(0,0,B,B).data;r=0;for(let o=d.length-1-3;o>=0;o-=4)if(d[o]>0){r=Math.ceil(o/4/B);break}E.clearRect(0,0,B,B),E.strokeText("A",0,B),d=E.getImageData(0,0,B,B).data,u=0;for(let o=0,C=d.length;o<C;o+=4)if(d[o]>0){u=B-Math.floor(o/4/B);break}if(E.canvas.width=E.canvas.height=0,u){const o=u/(u+r);return L.set(h,o),o}return L.set(h,tt),tt}function P(h,x,M){const E=document.createElement("span"),c={angle:0,canvasWidth:0,hasText:x.str!=="",hasEOL:x.hasEOL,fontSize:0};h._textDivs.push(E);const u=n.Util.transform(h._transform,x.transform);let r=Math.atan2(u[1],u[0]);const d=M[x.fontName];d.vertical&&(r+=Math.PI/2);const o=Math.hypot(u[2],u[3]),C=o*l(d.fontFamily,h._isOffscreenCanvasSupported);let i,b;r===0?(i=u[4],b=u[5]-C):(i=u[4]+C*Math.sin(r),b=u[5]-C*Math.cos(r));const S="calc(var(--scale-factor)*",K=E.style;h._container===h._rootContainer?(K.left=`${(100*i/h._pageWidth).toFixed(2)}%`,K.top=`${(100*b/h._pageHeight).toFixed(2)}%`):(K.left=`${S}${i.toFixed(2)}px)`,K.top=`${S}${b.toFixed(2)}px)`),K.fontSize=`${S}${o.toFixed(2)}px)`,K.fontFamily=d.fontFamily,c.fontSize=o,E.setAttribute("role","presentation"),E.textContent=x.str,E.dir=x.dir,h._fontInspectorEnabled&&(E.dataset.fontName=x.fontName),r!==0&&(c.angle=r*(180/Math.PI));let U=!1;if(x.str.length>1)U=!0;else if(x.str!==" "&&x.transform[0]!==x.transform[3]){const X=Math.abs(x.transform[0]),$=Math.abs(x.transform[3]);X!==$&&Math.max(X,$)/Math.min(X,$)>1.5&&(U=!0)}U&&(c.canvasWidth=d.vertical?x.height:x.width),h._textDivProperties.set(E,c),h._isReadableStream&&h._layoutText(E)}function R(h){const{div:x,scale:M,properties:E,ctx:c,prevFontSize:u,prevFontFamily:r}=h,{style:d}=x;let o="";if(E.canvasWidth!==0&&E.hasText){const{fontFamily:C}=d,{canvasWidth:i,fontSize:b}=E;(u!==b||r!==C)&&(c.font=`${b*M}px ${C}`,h.prevFontSize=b,h.prevFontFamily=C);const{width:S}=c.measureText(x.textContent);S>0&&(o=`scaleX(${i*M/S})`)}E.angle!==0&&(o=`rotate(${E.angle}deg) ${o}`),o.length>0&&(d.transform=o)}function m(h){if(h._canceled)return;const x=h._textDivs,M=h._capability;if(x.length>q){M.resolve();return}if(!h._isReadableStream)for(const c of x)h._layoutText(c);M.resolve()}class g{constructor({textContentSource:x,container:M,viewport:E,textDivs:c,textDivProperties:u,textContentItemsStr:r,isOffscreenCanvasSupported:d}){var S;this._textContentSource=x,this._isReadableStream=x instanceof ReadableStream,this._container=this._rootContainer=M,this._textDivs=c||[],this._textContentItemsStr=r||[],this._isOffscreenCanvasSupported=d,this._fontInspectorEnabled=!!((S=globalThis.FontInspector)!=null&&S.enabled),this._reader=null,this._textDivProperties=u||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:E.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:v(0,d)};const{pageWidth:o,pageHeight:C,pageX:i,pageY:b}=E.rawDims;this._transform=[1,0,0,-1,-i,b+C],this._pageWidth=o,this._pageHeight=C,(0,_.setLayerDimensions)(M,E),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(x,M){for(const E of x){if(E.str===void 0){if(E.type==="beginMarkedContentProps"||E.type==="beginMarkedContent"){const c=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),E.id!==null&&this._container.setAttribute("id",`${E.id}`),c.append(this._container)}else E.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(E.str),P(this,E,M)}}_layoutText(x){const M=this._layoutTextParams.properties=this._textDivProperties.get(x);if(this._layoutTextParams.div=x,R(this._layoutTextParams),M.hasText&&this._container.append(x),M.hasEOL){const E=document.createElement("br");E.setAttribute("role","presentation"),this._container.append(E)}}_render(){const x=new n.PromiseCapability;let M=Object.create(null);if(this._isReadableStream){const E=()=>{this._reader.read().then(({value:c,done:u})=>{if(u){x.resolve();return}Object.assign(M,c.styles),this._processItems(c.items,M),E()},x.reject)};this._reader=this._textContentSource.getReader(),E()}else if(this._textContentSource){const{items:E,styles:c}=this._textContentSource;this._processItems(E,c),x.resolve()}else throw new Error('No "textContentSource" parameter specified.');x.promise.then(()=>{M=null,m(this)},this._capability.reject)}}a.TextLayerRenderTask=g;function A(h){!h.textContentSource&&(h.textContent||h.textContentStream)&&((0,_.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),h.textContentSource=h.textContent||h.textContentStream);const{container:x,viewport:M}=h,E=getComputedStyle(x),c=E.getPropertyValue("visibility"),u=parseFloat(E.getPropertyValue("--scale-factor"));c==="visible"&&(!u||Math.abs(u-M.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const r=new g(h);return r._render(),r}function f({container:h,viewport:x,textDivs:M,textDivProperties:E,isOffscreenCanvasSupported:c,mustRotate:u=!0,mustRescale:r=!0}){if(u&&(0,_.setLayerDimensions)(h,{rotation:x.rotation}),r){const d=v(0,c),C={prevFontSize:null,prevFontFamily:null,div:null,scale:x.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:d};for(const i of M)C.properties=E.get(i),C.div=i,R(C)}}},(H,a,G)=>{var l,P,R,m,g,A,f,h,x,M,E,Ke,Se,Je,Qe;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditorLayer=void 0;var n=G(1),_=G(4),q=G(28),B=G(33),tt=G(6),L=G(34);const o=class o{constructor({uiManager:i,pageIndex:b,div:S,accessibilityManager:K,annotationLayer:U,viewport:X,l10n:$}){rt(this,E);rt(this,l);rt(this,P,!1);rt(this,R,null);rt(this,m,this.pointerup.bind(this));rt(this,g,this.pointerdown.bind(this));rt(this,A,new Map);rt(this,f,!1);rt(this,h,!1);rt(this,x,!1);rt(this,M);const at=[q.FreeTextEditor,B.InkEditor,L.StampEditor];if(!o._initialized){o._initialized=!0;for(const F of at)F.initialize($)}i.registerEditorTypes(at),lt(this,M,i),this.pageIndex=b,this.div=S,lt(this,l,K),lt(this,R,U),this.viewport=X,t(this,M).addLayer(this)}get isEmpty(){return t(this,A).size===0}updateToolbar(i){t(this,M).updateToolbar(i)}updateMode(i=t(this,M).getMode()){Y(this,E,Qe).call(this),i===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),i!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",i===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",i===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",i===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(i){if(!i&&t(this,M).getMode()!==n.AnnotationEditorType.INK)return;if(!i){for(const S of t(this,A).values())if(S.isEmpty()){S.setInBackground();return}}Y(this,E,Se).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(i){t(this,M).setEditingState(i)}addCommands(i){t(this,M).addCommands(i)}enable(){this.div.style.pointerEvents="auto";const i=new Set;for(const S of t(this,A).values())S.enableEditing(),S.annotationElementId&&i.add(S.annotationElementId);if(!t(this,R))return;const b=t(this,R).getEditableAnnotations();for(const S of b){if(S.hide(),t(this,M).isDeletedAnnotationElement(S.data.id)||i.has(S.data.id))continue;const K=this.deserialize(S);K&&(this.addOrRebuild(K),K.enableEditing())}}disable(){var b;lt(this,x,!0),this.div.style.pointerEvents="none";const i=new Set;for(const S of t(this,A).values()){if(S.disableEditing(),!S.annotationElementId||S.serialize()!==null){i.add(S.annotationElementId);continue}(b=this.getEditableAnnotation(S.annotationElementId))==null||b.show(),S.remove()}if(t(this,R)){const S=t(this,R).getEditableAnnotations();for(const K of S){const{id:U}=K.data;i.has(U)||t(this,M).isDeletedAnnotationElement(U)||K.show()}}Y(this,E,Qe).call(this),this.isEmpty&&(this.div.hidden=!0),lt(this,x,!1)}getEditableAnnotation(i){var b;return((b=t(this,R))==null?void 0:b.getEditableAnnotation(i))||null}setActiveEditor(i){t(this,M).getActive()!==i&&t(this,M).setActiveEditor(i)}enableClick(){this.div.addEventListener("pointerdown",t(this,g)),this.div.addEventListener("pointerup",t(this,m))}disableClick(){this.div.removeEventListener("pointerdown",t(this,g)),this.div.removeEventListener("pointerup",t(this,m))}attach(i){t(this,A).set(i.id,i);const{annotationElementId:b}=i;b&&t(this,M).isDeletedAnnotationElement(b)&&t(this,M).removeDeletedAnnotationElement(i)}detach(i){var b;t(this,A).delete(i.id),(b=t(this,l))==null||b.removePointerInTextLayer(i.contentDiv),!t(this,x)&&i.annotationElementId&&t(this,M).addDeletedAnnotationElement(i)}remove(i){this.detach(i),t(this,M).removeEditor(i),i.div.contains(document.activeElement)&&setTimeout(()=>{t(this,M).focusMainContainer()},0),i.div.remove(),i.isAttachedToDOM=!1,t(this,h)||this.addInkEditorIfNeeded(!1)}changeParent(i){var b;i.parent!==this&&(i.annotationElementId&&(t(this,M).addDeletedAnnotationElement(i.annotationElementId),_.AnnotationEditor.deleteAnnotationElement(i),i.annotationElementId=null),this.attach(i),(b=i.parent)==null||b.detach(i),i.setParent(this),i.div&&i.isAttachedToDOM&&(i.div.remove(),this.div.append(i.div)))}add(i){if(this.changeParent(i),t(this,M).addEditor(i),this.attach(i),!i.isAttachedToDOM){const b=i.render();this.div.append(b),i.isAttachedToDOM=!0}i.fixAndSetPosition(),i.onceAdded(),t(this,M).addToAnnotationStorage(i)}moveEditorInDOM(i){var S;if(!i.isAttachedToDOM)return;const{activeElement:b}=document;i.div.contains(b)&&(i._focusEventsAllowed=!1,setTimeout(()=>{i.div.contains(document.activeElement)?i._focusEventsAllowed=!0:(i.div.addEventListener("focusin",()=>{i._focusEventsAllowed=!0},{once:!0}),b.focus())},0)),i._structTreeParentId=(S=t(this,l))==null?void 0:S.moveElementInDOM(this.div,i.div,i.contentDiv,!0)}addOrRebuild(i){i.needsToBeRebuilt()?i.rebuild():this.add(i)}addUndoableEditor(i){const b=()=>i._uiManager.rebuild(i),S=()=>{i.remove()};this.addCommands({cmd:b,undo:S,mustExec:!1})}getNextId(){return t(this,M).getId()}pasteEditor(i,b){t(this,M).updateToolbar(i),t(this,M).updateMode(i);const{offsetX:S,offsetY:K}=Y(this,E,Je).call(this),U=this.getNextId(),X=Y(this,E,Ke).call(this,{parent:this,id:U,x:S,y:K,uiManager:t(this,M),isCentered:!0,...b});X&&this.add(X)}deserialize(i){switch(i.annotationType??i.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return q.FreeTextEditor.deserialize(i,this,t(this,M));case n.AnnotationEditorType.INK:return B.InkEditor.deserialize(i,this,t(this,M));case n.AnnotationEditorType.STAMP:return L.StampEditor.deserialize(i,this,t(this,M))}return null}addNewEditor(){Y(this,E,Se).call(this,Y(this,E,Je).call(this),!0)}setSelected(i){t(this,M).setSelected(i)}toggleSelected(i){t(this,M).toggleSelected(i)}isSelected(i){return t(this,M).isSelected(i)}unselect(i){t(this,M).unselect(i)}pointerup(i){const{isMac:b}=n.FeatureTest.platform;if(!(i.button!==0||i.ctrlKey&&b)&&i.target===this.div&&t(this,f)){if(lt(this,f,!1),!t(this,P)){lt(this,P,!0);return}if(t(this,M).getMode()===n.AnnotationEditorType.STAMP){t(this,M).unselectAll();return}Y(this,E,Se).call(this,i,!1)}}pointerdown(i){if(t(this,f)){lt(this,f,!1);return}const{isMac:b}=n.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&b||i.target!==this.div)return;lt(this,f,!0);const S=t(this,M).getActive();lt(this,P,!S||S.isEmpty())}findNewParent(i,b,S){const K=t(this,M).findParent(b,S);return K===null||K===this?!1:(K.changeParent(i),!0)}destroy(){var i,b;((i=t(this,M).getActive())==null?void 0:i.parent)===this&&(t(this,M).commitOrRemove(),t(this,M).setActiveEditor(null));for(const S of t(this,A).values())(b=t(this,l))==null||b.removePointerInTextLayer(S.contentDiv),S.setParent(null),S.isAttachedToDOM=!1,S.div.remove();this.div=null,t(this,A).clear(),t(this,M).removeLayer(this)}render({viewport:i}){this.viewport=i,(0,tt.setLayerDimensions)(this.div,i);for(const b of t(this,M).getEditors(this.pageIndex))this.add(b);this.updateMode()}update({viewport:i}){t(this,M).commitOrRemove(),this.viewport=i,(0,tt.setLayerDimensions)(this.div,{rotation:i.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:i,pageHeight:b}=this.viewport.rawDims;return[i,b]}};l=new WeakMap,P=new WeakMap,R=new WeakMap,m=new WeakMap,g=new WeakMap,A=new WeakMap,f=new WeakMap,h=new WeakMap,x=new WeakMap,M=new WeakMap,E=new WeakSet,Ke=function(i){switch(t(this,M).getMode()){case n.AnnotationEditorType.FREETEXT:return new q.FreeTextEditor(i);case n.AnnotationEditorType.INK:return new B.InkEditor(i);case n.AnnotationEditorType.STAMP:return new L.StampEditor(i)}return null},Se=function(i,b){const S=this.getNextId(),K=Y(this,E,Ke).call(this,{parent:this,id:S,x:i.offsetX,y:i.offsetY,uiManager:t(this,M),isCentered:b});return K&&this.add(K),K},Je=function(){const{x:i,y:b,width:S,height:K}=this.div.getBoundingClientRect(),U=Math.max(0,i),X=Math.max(0,b),$=Math.min(window.innerWidth,i+S),at=Math.min(window.innerHeight,b+K),F=(U+$)/2-i,W=(X+at)/2-b,[Z,w]=this.viewport.rotation%180===0?[F,W]:[W,F];return{offsetX:Z,offsetY:w}},Qe=function(){lt(this,h,!0);for(const i of t(this,A).values())i.isEmpty()&&i.remove();lt(this,h,!1)},Kt(o,"_initialized",!1);let v=o;a.AnnotationEditorLayer=v},(H,a,G)=>{var L,v,l,P,R,m,g,A,f,h,Cs,Rs,Ts,me,Ze,Ps,ts;Object.defineProperty(a,"__esModule",{value:!0}),a.FreeTextEditor=void 0;var n=G(1),_=G(5),q=G(4),B=G(29);const o=class o extends q.AnnotationEditor{constructor(b){super({...b,name:"freeTextEditor"});rt(this,h);rt(this,L,this.editorDivBlur.bind(this));rt(this,v,this.editorDivFocus.bind(this));rt(this,l,this.editorDivInput.bind(this));rt(this,P,this.editorDivKeydown.bind(this));rt(this,R);rt(this,m,"");rt(this,g,`${this.id}-editor`);rt(this,A);rt(this,f,null);lt(this,R,b.color||o._defaultColor||q.AnnotationEditor._defaultLineColor),lt(this,A,b.fontSize||o._defaultFontSize)}static get _keyboardManager(){const b=o.prototype,S=X=>X.isEmpty(),K=_.AnnotationEditorUIManager.TRANSLATE_SMALL,U=_.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new _.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],b.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],b.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],b._translateEmpty,{args:[-K,0],checker:S}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],b._translateEmpty,{args:[-U,0],checker:S}],[["ArrowRight","mac+ArrowRight"],b._translateEmpty,{args:[K,0],checker:S}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],b._translateEmpty,{args:[U,0],checker:S}],[["ArrowUp","mac+ArrowUp"],b._translateEmpty,{args:[0,-K],checker:S}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],b._translateEmpty,{args:[0,-U],checker:S}],[["ArrowDown","mac+ArrowDown"],b._translateEmpty,{args:[0,K],checker:S}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],b._translateEmpty,{args:[0,U],checker:S}]]))}static initialize(b){q.AnnotationEditor.initialize(b,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const S=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(S.getPropertyValue("--freetext-padding"))}static updateDefaultParams(b,S){switch(b){case n.AnnotationEditorParamsType.FREETEXT_SIZE:o._defaultFontSize=S;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:o._defaultColor=S;break}}updateParams(b,S){switch(b){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,h,Cs).call(this,S);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,h,Rs).call(this,S);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,o._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,o._defaultColor||q.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,A)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,R)]]}_translateEmpty(b,S){this._uiManager.translateSelectedEditors(b,S,!0)}getInitialTranslation(){const b=this.parentScale;return[-o._internalPadding*b,-(o._internalPadding+t(this,A))*b]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,P)),this.editorDiv.addEventListener("focus",t(this,v)),this.editorDiv.addEventListener("blur",t(this,L)),this.editorDiv.addEventListener("input",t(this,l)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,g)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,P)),this.editorDiv.removeEventListener("focus",t(this,v)),this.editorDiv.removeEventListener("blur",t(this,L)),this.editorDiv.removeEventListener("input",t(this,l)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(b){this._focusEventsAllowed&&(super.focusin(b),b.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var b;if(this.width){Y(this,h,ts).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(b=this._initialOptions)!=null&&b.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const b=t(this,m),S=lt(this,m,Y(this,h,Ts).call(this).trimEnd());if(b===S)return;const K=U=>{if(lt(this,m,U),!U){this.remove();return}Y(this,h,Ze).call(this),this._uiManager.rebuild(this),Y(this,h,me).call(this)};this.addCommands({cmd:()=>{K(S)},undo:()=>{K(b)},mustExec:!1}),Y(this,h,me).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(b){this.enterInEditMode()}keydown(b){b.target===this.div&&b.key==="Enter"&&(this.enterInEditMode(),b.preventDefault())}editorDivKeydown(b){o._keyboardManager.exec(this,b)}editorDivFocus(b){this.isEditing=!0}editorDivBlur(b){this.isEditing=!1}editorDivInput(b){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let b,S;this.width&&(b=this.x,S=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,g)),this.enableEditing(),q.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(U=>{var X;return(X=this.editorDiv)==null?void 0:X.setAttribute("aria-label",U)}),q.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(U=>{var X;return(X=this.editorDiv)==null?void 0:X.setAttribute("default-content",U)}),this.editorDiv.contentEditable=!0;const{style:K}=this.editorDiv;if(K.fontSize=`calc(${t(this,A)}px * var(--scale-factor))`,K.color=t(this,R),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,_.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[U,X]=this.parentDimensions;if(this.annotationElementId){const{position:$}=t(this,f);let[at,F]=this.getInitialTranslation();[at,F]=this.pageTranslationToScreen(at,F);const[W,Z]=this.pageDimensions,[w,s]=this.pageTranslation;let e,p;switch(this.rotation){case 0:e=b+($[0]-w)/W,p=S+this.height-($[1]-s)/Z;break;case 90:e=b+($[0]-w)/W,p=S-($[1]-s)/Z,[at,F]=[F,-at];break;case 180:e=b-this.width+($[0]-w)/W,p=S-($[1]-s)/Z,[at,F]=[-at,-F];break;case 270:e=b+($[0]-w-this.height*Z)/W,p=S+($[1]-s-this.width*W)/Z,[at,F]=[-F,at];break}this.setAt(e*U,p*X,at,F)}else this.setAt(b*U,S*X,this.width*U,this.height*X);Y(this,h,Ze).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(b,S,K){let U=null;if(b instanceof B.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:$,fontColor:at},rect:F,rotation:W,id:Z},textContent:w,textPosition:s,parent:{page:{pageNumber:e}}}=b;if(!w||w.length===0)return null;U=b={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(at),fontSize:$,value:w.join(`
`),position:s,pageIndex:e-1,rect:F,rotation:W,id:Z,deleted:!1}}const X=super.deserialize(b,S,K);return lt(X,A,b.fontSize),lt(X,R,n.Util.makeHexColor(...b.color)),lt(X,m,b.value),X.annotationElementId=b.id||null,lt(X,f,U),X}serialize(b=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const S=o._internalPadding*this.parentScale,K=this.getRect(S,S),U=q.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,R)),X={annotationType:n.AnnotationEditorType.FREETEXT,color:U,fontSize:t(this,A),value:t(this,m),pageIndex:this.pageIndex,rect:K,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return b?X:this.annotationElementId&&!Y(this,h,Ps).call(this,X)?null:(X.id=this.annotationElementId,X)}};L=new WeakMap,v=new WeakMap,l=new WeakMap,P=new WeakMap,R=new WeakMap,m=new WeakMap,g=new WeakMap,A=new WeakMap,f=new WeakMap,h=new WeakSet,Cs=function(b){const S=U=>{this.editorDiv.style.fontSize=`calc(${U}px * var(--scale-factor))`,this.translate(0,-(U-t(this,A))*this.parentScale),lt(this,A,U),Y(this,h,me).call(this)},K=t(this,A);this.addCommands({cmd:()=>{S(b)},undo:()=>{S(K)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Rs=function(b){const S=t(this,R);this.addCommands({cmd:()=>{lt(this,R,this.editorDiv.style.color=b)},undo:()=>{lt(this,R,this.editorDiv.style.color=S)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ts=function(){const b=this.editorDiv.getElementsByTagName("div");if(b.length===0)return this.editorDiv.innerText;const S=[];for(const K of b)S.push(K.innerText.replace(/\r\n?|\n/,""));return S.join(`
`)},me=function(){const[b,S]=this.parentDimensions;let K;if(this.isAttachedToDOM)K=this.div.getBoundingClientRect();else{const{currentLayer:U,div:X}=this,$=X.style.display;X.style.display="hidden",U.div.append(this.div),K=X.getBoundingClientRect(),X.remove(),X.style.display=$}this.rotation%180===this.parentRotation%180?(this.width=K.width/b,this.height=K.height/S):(this.width=K.height/b,this.height=K.width/S),this.fixAndSetPosition()},Ze=function(){if(this.editorDiv.replaceChildren(),!!t(this,m))for(const b of t(this,m).split(`
`)){const S=document.createElement("div");S.append(b?document.createTextNode(b):document.createElement("br")),this.editorDiv.append(S)}},Ps=function(b){const{value:S,fontSize:K,color:U,rect:X,pageIndex:$}=t(this,f);return b.value!==S||b.fontSize!==K||b.rect.some((at,F)=>Math.abs(at-X[F])>=1)||b.color.some((at,F)=>at!==U[F])||b.pageIndex!==$},ts=function(b=!1){if(!this.annotationElementId)return;if(Y(this,h,me).call(this),!b&&(this.width===0||this.height===0)){setTimeout(()=>Y(this,h,ts).call(this,!0),0);return}const S=o._internalPadding*this.parentScale;t(this,f).rect=this.getRect(S,S)},Kt(o,"_freeTextDefaultContent",""),Kt(o,"_internalPadding",0),Kt(o,"_defaultColor",null),Kt(o,"_defaultFontSize",10),Kt(o,"_type","freetext");let tt=o;a.FreeTextEditor=tt},(H,a,G)=>{var p,j,ne,ks,et,ut,dt,mt,xt,At,st,it,y,N,J,nt,ft,vt,_t,Q,Ct,St,Fs,we,es,ss,Nt,Vt,Xt,yt,ot,ct,Pt,is,Wt,O,gt,wt,js,ns;Object.defineProperty(a,"__esModule",{value:!0}),a.StampAnnotationElement=a.InkAnnotationElement=a.FreeTextAnnotationElement=a.AnnotationLayer=void 0;var n=G(1),_=G(6),q=G(3),B=G(30),tt=G(31),L=G(32);const v=1e3,l=9,P=new WeakSet;function R(Tt){return{width:Tt[2]-Tt[0],height:Tt[3]-Tt[1]}}class m{static create(D){switch(D.data.annotationType){case n.AnnotationType.LINK:return new A(D);case n.AnnotationType.TEXT:return new f(D);case n.AnnotationType.WIDGET:switch(D.data.fieldType){case"Tx":return new x(D);case"Btn":return D.data.radioButton?new c(D):D.data.checkBox?new E(D):new u(D);case"Ch":return new r(D);case"Sig":return new M(D)}return new h(D);case n.AnnotationType.POPUP:return new d(D);case n.AnnotationType.FREETEXT:return new C(D);case n.AnnotationType.LINE:return new i(D);case n.AnnotationType.SQUARE:return new b(D);case n.AnnotationType.CIRCLE:return new S(D);case n.AnnotationType.POLYLINE:return new K(D);case n.AnnotationType.CARET:return new X(D);case n.AnnotationType.INK:return new $(D);case n.AnnotationType.POLYGON:return new U(D);case n.AnnotationType.HIGHLIGHT:return new at(D);case n.AnnotationType.UNDERLINE:return new F(D);case n.AnnotationType.SQUIGGLY:return new W(D);case n.AnnotationType.STRIKEOUT:return new Z(D);case n.AnnotationType.STAMP:return new w(D);case n.AnnotationType.FILEATTACHMENT:return new s(D);default:return new g(D)}}}const k=class k{constructor(D,{isRenderable:T=!1,ignoreBorder:z=!1,createQuadrilaterals:ht=!1}={}){rt(this,p,!1);this.isRenderable=T,this.data=D.data,this.layer=D.layer,this.linkService=D.linkService,this.downloadManager=D.downloadManager,this.imageResourcesPath=D.imageResourcesPath,this.renderForms=D.renderForms,this.svgFactory=D.svgFactory,this.annotationStorage=D.annotationStorage,this.enableScripting=D.enableScripting,this.hasJSActions=D.hasJSActions,this._fieldObjects=D.fieldObjects,this.parent=D.parent,T&&(this.container=this._createContainer(z)),ht&&this._createQuadrilaterals()}static _hasPopupData({titleObj:D,contentsObj:T,richText:z}){return!!(D!=null&&D.str||T!=null&&T.str||z!=null&&z.str)}get hasPopupData(){return k._hasPopupData(this.data)}_createContainer(D){const{data:T,parent:{page:z,viewport:ht}}=this,pt=document.createElement("section");pt.setAttribute("data-annotation-id",T.id),this instanceof h||(pt.tabIndex=v),pt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&pt.setAttribute("aria-haspopup","dialog"),T.noRotate&&pt.classList.add("norotate");const{pageWidth:bt,pageHeight:Et,pageX:Dt,pageY:Ft}=ht.rawDims;if(!T.rect||this instanceof d){const{rotation:Bt}=T;return!T.hasOwnCanvas&&Bt!==0&&this.setRotation(Bt,pt),pt}const{width:Rt,height:Ht}=R(T.rect),jt=n.Util.normalizeRect([T.rect[0],z.view[3]-T.rect[1]+z.view[1],T.rect[2],z.view[3]-T.rect[3]+z.view[1]]);if(!D&&T.borderStyle.width>0){pt.style.borderWidth=`${T.borderStyle.width}px`;const Bt=T.borderStyle.horizontalCornerRadius,$t=T.borderStyle.verticalCornerRadius;if(Bt>0||$t>0){const Yt=`calc(${Bt}px * var(--scale-factor)) / calc(${$t}px * var(--scale-factor))`;pt.style.borderRadius=Yt}else if(this instanceof c){const Yt=`calc(${Rt}px * var(--scale-factor)) / calc(${Ht}px * var(--scale-factor))`;pt.style.borderRadius=Yt}switch(T.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:pt.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:pt.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:pt.style.borderBottomStyle="solid";break}const qt=T.borderColor||null;qt?(lt(this,p,!0),pt.style.borderColor=n.Util.makeHexColor(qt[0]|0,qt[1]|0,qt[2]|0)):pt.style.borderWidth=0}pt.style.left=`${100*(jt[0]-Dt)/bt}%`,pt.style.top=`${100*(jt[1]-Ft)/Et}%`;const{rotation:It}=T;return T.hasOwnCanvas||It===0?(pt.style.width=`${100*Rt/bt}%`,pt.style.height=`${100*Ht/Et}%`):this.setRotation(It,pt),pt}setRotation(D,T=this.container){if(!this.data.rect)return;const{pageWidth:z,pageHeight:ht}=this.parent.viewport.rawDims,{width:pt,height:bt}=R(this.data.rect);let Et,Dt;D%180===0?(Et=100*pt/z,Dt=100*bt/ht):(Et=100*bt/z,Dt=100*pt/ht),T.style.width=`${Et}%`,T.style.height=`${Dt}%`,T.setAttribute("data-main-rotation",(360-D)%360)}get _commonActions(){const D=(T,z,ht)=>{const pt=ht.detail[T],bt=pt[0],Et=pt.slice(1);ht.target.style[z]=B.ColorConverters[`${bt}_HTML`](Et),this.annotationStorage.setValue(this.data.id,{[z]:B.ColorConverters[`${bt}_rgb`](Et)})};return(0,n.shadow)(this,"_commonActions",{display:T=>{const{display:z}=T.detail,ht=z%2===1;this.container.style.visibility=ht?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:ht,noPrint:z===1||z===2})},print:T=>{this.annotationStorage.setValue(this.data.id,{noPrint:!T.detail.print})},hidden:T=>{const{hidden:z}=T.detail;this.container.style.visibility=z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:z,noView:z})},focus:T=>{setTimeout(()=>T.target.focus({preventScroll:!1}),0)},userName:T=>{T.target.title=T.detail.userName},readonly:T=>{T.target.disabled=T.detail.readonly},required:T=>{this._setRequired(T.target,T.detail.required)},bgColor:T=>{D("bgColor","backgroundColor",T)},fillColor:T=>{D("fillColor","backgroundColor",T)},fgColor:T=>{D("fgColor","color",T)},textColor:T=>{D("textColor","color",T)},borderColor:T=>{D("borderColor","borderColor",T)},strokeColor:T=>{D("strokeColor","borderColor",T)},rotation:T=>{const z=T.detail.rotation;this.setRotation(z),this.annotationStorage.setValue(this.data.id,{rotation:z})}})}_dispatchEventFromSandbox(D,T){const z=this._commonActions;for(const ht of Object.keys(T.detail)){const pt=D[ht]||z[ht];pt==null||pt(T)}}_setDefaultPropertiesFromJS(D){if(!this.enableScripting)return;const T=this.annotationStorage.getRawValue(this.data.id);if(!T)return;const z=this._commonActions;for(const[ht,pt]of Object.entries(T)){const bt=z[ht];if(bt){const Et={detail:{[ht]:pt},target:D};bt(Et),delete T[ht]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:D}=this.data;if(!D)return;const[T,z,ht,pt]=this.data.rect;if(D.length===1){const[,{x:$t,y:qt},{x:Yt,y:Qt}]=D[0];if(ht===$t&&pt===qt&&T===Yt&&z===Qt)return}const{style:bt}=this.container;let Et;if(t(this,p)){const{borderColor:$t,borderWidth:qt}=bt;bt.borderWidth=0,Et=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${$t}" stroke-width="${qt}">`],this.container.classList.add("hasBorder")}const Dt=ht-T,Ft=pt-z,{svgFactory:Rt}=this,Ht=Rt.createElement("svg");Ht.classList.add("quadrilateralsContainer"),Ht.setAttribute("width",0),Ht.setAttribute("height",0);const jt=Rt.createElement("defs");Ht.append(jt);const It=Rt.createElement("clipPath"),Bt=`clippath_${this.data.id}`;It.setAttribute("id",Bt),It.setAttribute("clipPathUnits","objectBoundingBox"),jt.append(It);for(const[,{x:$t,y:qt},{x:Yt,y:Qt}]of D){const Jt=Rt.createElement("rect"),te=(Yt-T)/Dt,se=(pt-qt)/Ft,ie=($t-Yt)/Dt,ps=(qt-Qt)/Ft;Jt.setAttribute("x",te),Jt.setAttribute("y",se),Jt.setAttribute("width",ie),Jt.setAttribute("height",ps),It.append(Jt),Et==null||Et.push(`<rect vector-effect="non-scaling-stroke" x="${te}" y="${se}" width="${ie}" height="${ps}"/>`)}t(this,p)&&(Et.push("</g></svg>')"),bt.backgroundImage=Et.join("")),this.container.append(Ht),this.container.style.clipPath=`url(#${Bt})`}_createPopup(){const{container:D,data:T}=this;D.setAttribute("aria-haspopup","dialog");const z=new d({data:{color:T.color,titleObj:T.titleObj,modificationDate:T.modificationDate,contentsObj:T.contentsObj,richText:T.richText,parentRect:T.rect,borderStyle:0,id:`popup_${T.id}`,rotation:T.rotation},parent:this.parent,elements:[this]});this.parent.div.append(z.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(D,T=null){const z=[];if(this._fieldObjects){const ht=this._fieldObjects[D];if(ht)for(const{page:pt,id:bt,exportValues:Et}of ht){if(pt===-1||bt===T)continue;const Dt=typeof Et=="string"?Et:null,Ft=document.querySelector(`[data-element-id="${bt}"]`);if(Ft&&!P.has(Ft)){(0,n.warn)(`_getElementsByName - element not allowed: ${bt}`);continue}z.push({id:bt,exportValue:Dt,domElement:Ft})}return z}for(const ht of document.getElementsByName(D)){const{exportValue:pt}=ht,bt=ht.getAttribute("data-element-id");bt!==T&&P.has(ht)&&z.push({id:bt,exportValue:pt,domElement:ht})}return z}show(){var D;this.container&&(this.container.hidden=!1),(D=this.popup)==null||D.maybeShow()}hide(){var D;this.container&&(this.container.hidden=!0),(D=this.popup)==null||D.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const D=this.getElementsToTriggerPopup();if(Array.isArray(D))for(const T of D)T.classList.add("highlightArea");else D.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:D,data:{id:T}}=this;this.container.addEventListener("dblclick",()=>{var z;(z=this.linkService.eventBus)==null||z.dispatch("switchannotationeditormode",{source:this,mode:D,editId:T})})}};p=new WeakMap;let g=k;class A extends g{constructor(T,z=null){super(T,{isRenderable:!0,ignoreBorder:!!(z!=null&&z.ignoreBorder),createQuadrilaterals:!0});rt(this,j);this.isTooltipOnly=T.data.isTooltipOnly}render(){const{data:T,linkService:z}=this,ht=document.createElement("a");ht.setAttribute("data-element-id",T.id);let pt=!1;return T.url?(z.addLinkAttributes(ht,T.url,T.newWindow),pt=!0):T.action?(this._bindNamedAction(ht,T.action),pt=!0):T.attachment?(this._bindAttachment(ht,T.attachment),pt=!0):T.setOCGState?(Y(this,j,ks).call(this,ht,T.setOCGState),pt=!0):T.dest?(this._bindLink(ht,T.dest),pt=!0):(T.actions&&(T.actions.Action||T.actions["Mouse Up"]||T.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(ht,T),pt=!0),T.resetForm?(this._bindResetFormAction(ht,T.resetForm),pt=!0):this.isTooltipOnly&&!pt&&(this._bindLink(ht,""),pt=!0)),this.container.classList.add("linkAnnotation"),pt&&this.container.append(ht),this.container}_bindLink(T,z){T.href=this.linkService.getDestinationHash(z),T.onclick=()=>(z&&this.linkService.goToDestination(z),!1),(z||z==="")&&Y(this,j,ne).call(this)}_bindNamedAction(T,z){T.href=this.linkService.getAnchorUrl(""),T.onclick=()=>(this.linkService.executeNamedAction(z),!1),Y(this,j,ne).call(this)}_bindAttachment(T,z){T.href=this.linkService.getAnchorUrl(""),T.onclick=()=>{var ht;return(ht=this.downloadManager)==null||ht.openOrDownloadData(this.container,z.content,z.filename),!1},Y(this,j,ne).call(this)}_bindJSAction(T,z){T.href=this.linkService.getAnchorUrl("");const ht=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const pt of Object.keys(z.actions)){const bt=ht.get(pt);bt&&(T[bt]=()=>{var Et;return(Et=this.linkService.eventBus)==null||Et.dispatch("dispatcheventinsandbox",{source:this,detail:{id:z.id,name:pt}}),!1})}T.onclick||(T.onclick=()=>!1),Y(this,j,ne).call(this)}_bindResetFormAction(T,z){const ht=T.onclick;if(ht||(T.href=this.linkService.getAnchorUrl("")),Y(this,j,ne).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),ht||(T.onclick=()=>!1);return}T.onclick=()=>{var Ht;ht==null||ht();const{fields:pt,refs:bt,include:Et}=z,Dt=[];if(pt.length!==0||bt.length!==0){const jt=new Set(bt);for(const It of pt){const Bt=this._fieldObjects[It]||[];for(const{id:$t}of Bt)jt.add($t)}for(const It of Object.values(this._fieldObjects))for(const Bt of It)jt.has(Bt.id)===Et&&Dt.push(Bt)}else for(const jt of Object.values(this._fieldObjects))Dt.push(...jt);const Ft=this.annotationStorage,Rt=[];for(const jt of Dt){const{id:It}=jt;switch(Rt.push(It),jt.type){case"text":{const $t=jt.defaultValue||"";Ft.setValue(It,{value:$t});break}case"checkbox":case"radiobutton":{const $t=jt.defaultValue===jt.exportValues;Ft.setValue(It,{value:$t});break}case"combobox":case"listbox":{const $t=jt.defaultValue||"";Ft.setValue(It,{value:$t});break}default:continue}const Bt=document.querySelector(`[data-element-id="${It}"]`);if(Bt){if(!P.has(Bt)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${It}`);continue}}else continue;Bt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Rt,name:"ResetForm"}})),!1}}}j=new WeakSet,ne=function(){this.container.setAttribute("data-internal-link","")},ks=function(T,z){T.href=this.linkService.getAnchorUrl(""),T.onclick=()=>(this.linkService.executeSetOCGState(z),!1),Y(this,j,ne).call(this)};class f extends g{constructor(D){super(D,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const D=document.createElement("img");return D.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",D.alt="[{{type}} Annotation]",D.dataset.l10nId="text_annotation_type",D.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(D),this.container}}class h extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(D){var T;this.data.hasOwnCanvas&&(((T=D.previousSibling)==null?void 0:T.nodeName)==="CANVAS"&&(D.previousSibling.hidden=!0),D.hidden=!1)}_getKeyModifier(D){const{isWin:T,isMac:z}=n.FeatureTest.platform;return T&&D.ctrlKey||z&&D.metaKey}_setEventListener(D,T,z,ht,pt){z.includes("mouse")?D.addEventListener(z,bt=>{var Et;(Et=this.linkService.eventBus)==null||Et.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ht,value:pt(bt),shift:bt.shiftKey,modifier:this._getKeyModifier(bt)}})}):D.addEventListener(z,bt=>{var Et;if(z==="blur"){if(!T.focused||!bt.relatedTarget)return;T.focused=!1}else if(z==="focus"){if(T.focused)return;T.focused=!0}pt&&((Et=this.linkService.eventBus)==null||Et.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ht,value:pt(bt)}}))})}_setEventListeners(D,T,z,ht){var pt,bt,Et;for(const[Dt,Ft]of z)(Ft==="Action"||(pt=this.data.actions)!=null&&pt[Ft])&&((Ft==="Focus"||Ft==="Blur")&&(T||(T={focused:!1})),this._setEventListener(D,T,Dt,Ft,ht),Ft==="Focus"&&!((bt=this.data.actions)!=null&&bt.Blur)?this._setEventListener(D,T,"blur","Blur",null):Ft==="Blur"&&!((Et=this.data.actions)!=null&&Et.Focus)&&this._setEventListener(D,T,"focus","Focus",null))}_setBackgroundColor(D){const T=this.data.backgroundColor||null;D.style.backgroundColor=T===null?"transparent":n.Util.makeHexColor(T[0],T[1],T[2])}_setTextStyle(D){const T=["left","center","right"],{fontColor:z}=this.data.defaultAppearanceData,ht=this.data.defaultAppearanceData.fontSize||l,pt=D.style;let bt;const Et=2,Dt=Ft=>Math.round(10*Ft)/10;if(this.data.multiLine){const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-Et),Rt=Math.round(Ft/(n.LINE_FACTOR*ht))||1,Ht=Ft/Rt;bt=Math.min(ht,Dt(Ht/n.LINE_FACTOR))}else{const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-Et);bt=Math.min(ht,Dt(Ft/n.LINE_FACTOR))}pt.fontSize=`calc(${bt}px * var(--scale-factor))`,pt.color=n.Util.makeHexColor(z[0],z[1],z[2]),this.data.textAlignment!==null&&(pt.textAlign=T[this.data.textAlignment])}_setRequired(D,T){T?D.setAttribute("required",!0):D.removeAttribute("required"),D.setAttribute("aria-required",T)}}class x extends h{constructor(D){const T=D.renderForms||!D.data.hasAppearance&&!!D.data.fieldValue;super(D,{isRenderable:T})}setPropertyOnSiblings(D,T,z,ht){const pt=this.annotationStorage;for(const bt of this._getElementsByName(D.name,D.id))bt.domElement&&(bt.domElement[T]=z),pt.setValue(bt.id,{[ht]:z})}render(){var ht,pt;const D=this.annotationStorage,T=this.data.id;this.container.classList.add("textWidgetAnnotation");let z=null;if(this.renderForms){const bt=D.getValue(T,{value:this.data.fieldValue});let Et=bt.value||"";const Dt=D.getValue(T,{charLimit:this.data.maxLen}).charLimit;Dt&&Et.length>Dt&&(Et=Et.slice(0,Dt));let Ft=bt.formattedValue||((ht=this.data.textContent)==null?void 0:ht.join(`
`))||null;Ft&&this.data.comb&&(Ft=Ft.replaceAll(/\s+/g,""));const Rt={userValue:Et,formattedValue:Ft,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(z=document.createElement("textarea"),z.textContent=Ft??Et,this.data.doNotScroll&&(z.style.overflowY="hidden")):(z=document.createElement("input"),z.type="text",z.setAttribute("value",Ft??Et),this.data.doNotScroll&&(z.style.overflowX="hidden")),this.data.hasOwnCanvas&&(z.hidden=!0),P.add(z),z.setAttribute("data-element-id",T),z.disabled=this.data.readOnly,z.name=this.data.fieldName,z.tabIndex=v,this._setRequired(z,this.data.required),Dt&&(z.maxLength=Dt),z.addEventListener("input",jt=>{D.setValue(T,{value:jt.target.value}),this.setPropertyOnSiblings(z,"value",jt.target.value,"value"),Rt.formattedValue=null}),z.addEventListener("resetform",jt=>{const It=this.data.defaultFieldValue??"";z.value=Rt.userValue=It,Rt.formattedValue=null});let Ht=jt=>{const{formattedValue:It}=Rt;It!=null&&(jt.target.value=It),jt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){z.addEventListener("focus",It=>{if(Rt.focused)return;const{target:Bt}=It;Rt.userValue&&(Bt.value=Rt.userValue),Rt.lastCommittedValue=Bt.value,Rt.commitKey=1,Rt.focused=!0}),z.addEventListener("updatefromsandbox",It=>{this.showElementAndHideCanvas(It.target);const Bt={value($t){Rt.userValue=$t.detail.value??"",D.setValue(T,{value:Rt.userValue.toString()}),$t.target.value=Rt.userValue},formattedValue($t){const{formattedValue:qt}=$t.detail;Rt.formattedValue=qt,qt!=null&&$t.target!==document.activeElement&&($t.target.value=qt),D.setValue(T,{formattedValue:qt})},selRange($t){$t.target.setSelectionRange(...$t.detail.selRange)},charLimit:$t=>{var Jt;const{charLimit:qt}=$t.detail,{target:Yt}=$t;if(qt===0){Yt.removeAttribute("maxLength");return}Yt.setAttribute("maxLength",qt);let Qt=Rt.userValue;!Qt||Qt.length<=qt||(Qt=Qt.slice(0,qt),Yt.value=Rt.userValue=Qt,D.setValue(T,{value:Qt}),(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:Qt,willCommit:!0,commitKey:1,selStart:Yt.selectionStart,selEnd:Yt.selectionEnd}}))}};this._dispatchEventFromSandbox(Bt,It)}),z.addEventListener("keydown",It=>{var qt;Rt.commitKey=1;let Bt=-1;if(It.key==="Escape"?Bt=0:It.key==="Enter"&&!this.data.multiLine?Bt=2:It.key==="Tab"&&(Rt.commitKey=3),Bt===-1)return;const{value:$t}=It.target;Rt.lastCommittedValue!==$t&&(Rt.lastCommittedValue=$t,Rt.userValue=$t,(qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:$t,willCommit:!0,commitKey:Bt,selStart:It.target.selectionStart,selEnd:It.target.selectionEnd}}))});const jt=Ht;Ht=null,z.addEventListener("blur",It=>{var $t;if(!Rt.focused||!It.relatedTarget)return;Rt.focused=!1;const{value:Bt}=It.target;Rt.userValue=Bt,Rt.lastCommittedValue!==Bt&&(($t=this.linkService.eventBus)==null||$t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:Bt,willCommit:!0,commitKey:Rt.commitKey,selStart:It.target.selectionStart,selEnd:It.target.selectionEnd}})),jt(It)}),(pt=this.data.actions)!=null&&pt.Keystroke&&z.addEventListener("beforeinput",It=>{var se;Rt.lastCommittedValue=null;const{data:Bt,target:$t}=It,{value:qt,selectionStart:Yt,selectionEnd:Qt}=$t;let Jt=Yt,te=Qt;switch(It.inputType){case"deleteWordBackward":{const ie=qt.substring(0,Yt).match(/\w*[^\w]*$/);ie&&(Jt-=ie[0].length);break}case"deleteWordForward":{const ie=qt.substring(Yt).match(/^[^\w]*\w*/);ie&&(te+=ie[0].length);break}case"deleteContentBackward":Yt===Qt&&(Jt-=1);break;case"deleteContentForward":Yt===Qt&&(te+=1);break}It.preventDefault(),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:qt,change:Bt||"",willCommit:!1,selStart:Jt,selEnd:te}})}),this._setEventListeners(z,Rt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],It=>It.target.value)}if(Ht&&z.addEventListener("blur",Ht),this.data.comb){const It=(this.data.rect[2]-this.data.rect[0])/Dt;z.classList.add("comb"),z.style.letterSpacing=`calc(${It}px * var(--scale-factor) - 1ch)`}}else z=document.createElement("div"),z.textContent=this.data.fieldValue,z.style.verticalAlign="middle",z.style.display="table-cell";return this._setTextStyle(z),this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class M extends h{constructor(D){super(D,{isRenderable:!!D.data.hasOwnCanvas})}}class E extends h{constructor(D){super(D,{isRenderable:D.renderForms})}render(){const D=this.annotationStorage,T=this.data,z=T.id;let ht=D.getValue(z,{value:T.exportValue===T.fieldValue}).value;typeof ht=="string"&&(ht=ht!=="Off",D.setValue(z,{value:ht})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const pt=document.createElement("input");return P.add(pt),pt.setAttribute("data-element-id",z),pt.disabled=T.readOnly,this._setRequired(pt,this.data.required),pt.type="checkbox",pt.name=T.fieldName,ht&&pt.setAttribute("checked",!0),pt.setAttribute("exportValue",T.exportValue),pt.tabIndex=v,pt.addEventListener("change",bt=>{const{name:Et,checked:Dt}=bt.target;for(const Ft of this._getElementsByName(Et,z)){const Rt=Dt&&Ft.exportValue===T.exportValue;Ft.domElement&&(Ft.domElement.checked=Rt),D.setValue(Ft.id,{value:Rt})}D.setValue(z,{value:Dt})}),pt.addEventListener("resetform",bt=>{const Et=T.defaultFieldValue||"Off";bt.target.checked=Et===T.exportValue}),this.enableScripting&&this.hasJSActions&&(pt.addEventListener("updatefromsandbox",bt=>{const Et={value(Dt){Dt.target.checked=Dt.detail.value!=="Off",D.setValue(z,{value:Dt.target.checked})}};this._dispatchEventFromSandbox(Et,bt)}),this._setEventListeners(pt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],bt=>bt.target.checked)),this._setBackgroundColor(pt),this._setDefaultPropertiesFromJS(pt),this.container.append(pt),this.container}}class c extends h{constructor(D){super(D,{isRenderable:D.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const D=this.annotationStorage,T=this.data,z=T.id;let ht=D.getValue(z,{value:T.fieldValue===T.buttonValue}).value;typeof ht=="string"&&(ht=ht!==T.buttonValue,D.setValue(z,{value:ht}));const pt=document.createElement("input");if(P.add(pt),pt.setAttribute("data-element-id",z),pt.disabled=T.readOnly,this._setRequired(pt,this.data.required),pt.type="radio",pt.name=T.fieldName,ht&&pt.setAttribute("checked",!0),pt.tabIndex=v,pt.addEventListener("change",bt=>{const{name:Et,checked:Dt}=bt.target;for(const Ft of this._getElementsByName(Et,z))D.setValue(Ft.id,{value:!1});D.setValue(z,{value:Dt})}),pt.addEventListener("resetform",bt=>{const Et=T.defaultFieldValue;bt.target.checked=Et!=null&&Et===T.buttonValue}),this.enableScripting&&this.hasJSActions){const bt=T.buttonValue;pt.addEventListener("updatefromsandbox",Et=>{const Dt={value:Ft=>{const Rt=bt===Ft.detail.value;for(const Ht of this._getElementsByName(Ft.target.name)){const jt=Rt&&Ht.id===z;Ht.domElement&&(Ht.domElement.checked=jt),D.setValue(Ht.id,{value:jt})}}};this._dispatchEventFromSandbox(Dt,Et)}),this._setEventListeners(pt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Et=>Et.target.checked)}return this._setBackgroundColor(pt),this._setDefaultPropertiesFromJS(pt),this.container.append(pt),this.container}}class u extends A{constructor(D){super(D,{ignoreBorder:D.data.hasAppearance})}render(){const D=super.render();D.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(D.title=this.data.alternativeText);const T=D.lastChild;return this.enableScripting&&this.hasJSActions&&T&&(this._setDefaultPropertiesFromJS(T),T.addEventListener("updatefromsandbox",z=>{this._dispatchEventFromSandbox({},z)})),D}}class r extends h{constructor(D){super(D,{isRenderable:D.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const D=this.annotationStorage,T=this.data.id,z=D.getValue(T,{value:this.data.fieldValue}),ht=document.createElement("select");P.add(ht),ht.setAttribute("data-element-id",T),ht.disabled=this.data.readOnly,this._setRequired(ht,this.data.required),ht.name=this.data.fieldName,ht.tabIndex=v;let pt=this.data.combo&&this.data.options.length>0;this.data.combo||(ht.size=this.data.options.length,this.data.multiSelect&&(ht.multiple=!0)),ht.addEventListener("resetform",Rt=>{const Ht=this.data.defaultFieldValue;for(const jt of ht.options)jt.selected=jt.value===Ht});for(const Rt of this.data.options){const Ht=document.createElement("option");Ht.textContent=Rt.displayValue,Ht.value=Rt.exportValue,z.value.includes(Rt.exportValue)&&(Ht.setAttribute("selected",!0),pt=!1),ht.append(Ht)}let bt=null;if(pt){const Rt=document.createElement("option");Rt.value=" ",Rt.setAttribute("hidden",!0),Rt.setAttribute("selected",!0),ht.prepend(Rt),bt=()=>{Rt.remove(),ht.removeEventListener("input",bt),bt=null},ht.addEventListener("input",bt)}const Et=Rt=>{const Ht=Rt?"value":"textContent",{options:jt,multiple:It}=ht;return It?Array.prototype.filter.call(jt,Bt=>Bt.selected).map(Bt=>Bt[Ht]):jt.selectedIndex===-1?null:jt[jt.selectedIndex][Ht]};let Dt=Et(!1);const Ft=Rt=>{const Ht=Rt.target.options;return Array.prototype.map.call(Ht,jt=>({displayValue:jt.textContent,exportValue:jt.value}))};return this.enableScripting&&this.hasJSActions?(ht.addEventListener("updatefromsandbox",Rt=>{const Ht={value(jt){bt==null||bt();const It=jt.detail.value,Bt=new Set(Array.isArray(It)?It:[It]);for(const $t of ht.options)$t.selected=Bt.has($t.value);D.setValue(T,{value:Et(!0)}),Dt=Et(!1)},multipleSelection(jt){ht.multiple=!0},remove(jt){const It=ht.options,Bt=jt.detail.remove;It[Bt].selected=!1,ht.remove(Bt),It.length>0&&Array.prototype.findIndex.call(It,qt=>qt.selected)===-1&&(It[0].selected=!0),D.setValue(T,{value:Et(!0),items:Ft(jt)}),Dt=Et(!1)},clear(jt){for(;ht.length!==0;)ht.remove(0);D.setValue(T,{value:null,items:[]}),Dt=Et(!1)},insert(jt){const{index:It,displayValue:Bt,exportValue:$t}=jt.detail.insert,qt=ht.children[It],Yt=document.createElement("option");Yt.textContent=Bt,Yt.value=$t,qt?qt.before(Yt):ht.append(Yt),D.setValue(T,{value:Et(!0),items:Ft(jt)}),Dt=Et(!1)},items(jt){const{items:It}=jt.detail;for(;ht.length!==0;)ht.remove(0);for(const Bt of It){const{displayValue:$t,exportValue:qt}=Bt,Yt=document.createElement("option");Yt.textContent=$t,Yt.value=qt,ht.append(Yt)}ht.options.length>0&&(ht.options[0].selected=!0),D.setValue(T,{value:Et(!0),items:Ft(jt)}),Dt=Et(!1)},indices(jt){const It=new Set(jt.detail.indices);for(const Bt of jt.target.options)Bt.selected=It.has(Bt.index);D.setValue(T,{value:Et(!0)}),Dt=Et(!1)},editable(jt){jt.target.disabled=!jt.detail.editable}};this._dispatchEventFromSandbox(Ht,Rt)}),ht.addEventListener("input",Rt=>{var jt;const Ht=Et(!0);D.setValue(T,{value:Ht}),Rt.preventDefault(),(jt=this.linkService.eventBus)==null||jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:Dt,changeEx:Ht,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(ht,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Rt=>Rt.target.value)):ht.addEventListener("input",function(Rt){D.setValue(T,{value:Et(!0)})}),this.data.combo&&this._setTextStyle(ht),this._setBackgroundColor(ht),this._setDefaultPropertiesFromJS(ht),this.container.append(ht),this.container}}class d extends g{constructor(D){const{data:T,elements:z}=D;super(D,{isRenderable:g._hasPopupData(T)}),this.elements=z}render(){this.container.classList.add("popupAnnotation");const D=new o({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),T=[];for(const z of this.elements)z.popup=D,T.push(z.data.id),z.addHighlightArea();return this.container.setAttribute("aria-controls",T.map(z=>`${n.AnnotationPrefix}${z}`).join(",")),this.container}}class o{constructor({container:D,color:T,elements:z,titleObj:ht,modificationDate:pt,contentsObj:bt,richText:Et,parent:Dt,rect:Ft,parentRect:Rt,open:Ht}){rt(this,St);rt(this,et,null);rt(this,ut,Y(this,St,Fs).bind(this));rt(this,dt,Y(this,St,ss).bind(this));rt(this,mt,Y(this,St,es).bind(this));rt(this,xt,Y(this,St,we).bind(this));rt(this,At,null);rt(this,st,null);rt(this,it,null);rt(this,y,null);rt(this,N,null);rt(this,J,null);rt(this,nt,!1);rt(this,ft,null);rt(this,vt,null);rt(this,_t,null);rt(this,Q,null);rt(this,Ct,!1);var It;lt(this,st,D),lt(this,Q,ht),lt(this,it,bt),lt(this,_t,Et),lt(this,N,Dt),lt(this,At,T),lt(this,vt,Ft),lt(this,J,Rt),lt(this,y,z);const jt=_.PDFDateString.toDateObject(pt);jt&&lt(this,et,Dt.l10n.get("annotation_date_string",{date:jt.toLocaleDateString(),time:jt.toLocaleTimeString()})),this.trigger=z.flatMap(Bt=>Bt.getElementsToTriggerPopup());for(const Bt of this.trigger)Bt.addEventListener("click",t(this,xt)),Bt.addEventListener("mouseenter",t(this,mt)),Bt.addEventListener("mouseleave",t(this,dt)),Bt.classList.add("popupTriggerArea");for(const Bt of z)(It=Bt.container)==null||It.addEventListener("keydown",t(this,ut));t(this,st).hidden=!0,Ht&&Y(this,St,we).call(this)}render(){if(t(this,ft))return;const{page:{view:D},viewport:{rawDims:{pageWidth:T,pageHeight:z,pageX:ht,pageY:pt}}}=t(this,N),bt=lt(this,ft,document.createElement("div"));if(bt.className="popup",t(this,At)){const Jt=bt.style.outlineColor=n.Util.makeHexColor(...t(this,At));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?bt.style.backgroundColor=`color-mix(in srgb, ${Jt} 30%, white)`:bt.style.backgroundColor=n.Util.makeHexColor(...t(this,At).map(se=>Math.floor(.7*(255-se)+se)))}const Et=document.createElement("span");Et.className="header";const Dt=document.createElement("h1");if(Et.append(Dt),{dir:Dt.dir,str:Dt.textContent}=t(this,Q),bt.append(Et),t(this,et)){const Jt=document.createElement("span");Jt.classList.add("popupDate"),t(this,et).then(te=>{Jt.textContent=te}),Et.append(Jt)}const Ft=t(this,it),Rt=t(this,_t);if(Rt!=null&&Rt.str&&(!(Ft!=null&&Ft.str)||Ft.str===Rt.str))L.XfaLayer.render({xfaHtml:Rt.html,intent:"richText",div:bt}),bt.lastChild.classList.add("richText","popupContent");else{const Jt=this._formatContents(Ft);bt.append(Jt)}let Ht=!!t(this,J),jt=Ht?t(this,J):t(this,vt);for(const Jt of t(this,y))if(!jt||n.Util.intersect(Jt.data.rect,jt)!==null){jt=Jt.data.rect,Ht=!0;break}const It=n.Util.normalizeRect([jt[0],D[3]-jt[1]+D[1],jt[2],D[3]-jt[3]+D[1]]),$t=Ht?jt[2]-jt[0]+5:0,qt=It[0]+$t,Yt=It[1],{style:Qt}=t(this,st);Qt.left=`${100*(qt-ht)/T}%`,Qt.top=`${100*(Yt-pt)/z}%`,t(this,st).append(bt)}_formatContents({str:D,dir:T}){const z=document.createElement("p");z.classList.add("popupContent"),z.dir=T;const ht=D.split(/(?:\r\n?|\n)/);for(let pt=0,bt=ht.length;pt<bt;++pt){const Et=ht[pt];z.append(document.createTextNode(Et)),pt<bt-1&&z.append(document.createElement("br"))}return z}forceHide(){lt(this,Ct,this.isVisible),t(this,Ct)&&(t(this,st).hidden=!0)}maybeShow(){t(this,Ct)&&(lt(this,Ct,!1),t(this,st).hidden=!1)}get isVisible(){return t(this,st).hidden===!1}}et=new WeakMap,ut=new WeakMap,dt=new WeakMap,mt=new WeakMap,xt=new WeakMap,At=new WeakMap,st=new WeakMap,it=new WeakMap,y=new WeakMap,N=new WeakMap,J=new WeakMap,nt=new WeakMap,ft=new WeakMap,vt=new WeakMap,_t=new WeakMap,Q=new WeakMap,Ct=new WeakMap,St=new WeakSet,Fs=function(D){D.altKey||D.shiftKey||D.ctrlKey||D.metaKey||(D.key==="Enter"||D.key==="Escape"&&t(this,nt))&&Y(this,St,we).call(this)},we=function(){lt(this,nt,!t(this,nt)),t(this,nt)?(Y(this,St,es).call(this),t(this,st).addEventListener("click",t(this,xt)),t(this,st).addEventListener("keydown",t(this,ut))):(Y(this,St,ss).call(this),t(this,st).removeEventListener("click",t(this,xt)),t(this,st).removeEventListener("keydown",t(this,ut)))},es=function(){t(this,ft)||this.render(),this.isVisible?t(this,nt)&&t(this,st).classList.add("focused"):(t(this,st).hidden=!1,t(this,st).style.zIndex=parseInt(t(this,st).style.zIndex)+1e3)},ss=function(){t(this,st).classList.remove("focused"),!(t(this,nt)||!this.isVisible)&&(t(this,st).hidden=!0,t(this,st).style.zIndex=parseInt(t(this,st).style.zIndex)-1e3)};class C extends g{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0}),this.textContent=D.data.textContent,this.textPosition=D.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const D=document.createElement("div");D.classList.add("annotationTextContent"),D.setAttribute("role","comment");for(const T of this.textContent){const z=document.createElement("span");z.textContent=T,D.append(z)}this.container.append(D)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}a.FreeTextAnnotationElement=C;class i extends g{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,Nt,null)}render(){this.container.classList.add("lineAnnotation");const T=this.data,{width:z,height:ht}=R(T.rect),pt=this.svgFactory.create(z,ht,!0),bt=lt(this,Nt,this.svgFactory.createElement("svg:line"));return bt.setAttribute("x1",T.rect[2]-T.lineCoordinates[0]),bt.setAttribute("y1",T.rect[3]-T.lineCoordinates[1]),bt.setAttribute("x2",T.rect[2]-T.lineCoordinates[2]),bt.setAttribute("y2",T.rect[3]-T.lineCoordinates[3]),bt.setAttribute("stroke-width",T.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),pt.append(bt),this.container.append(pt),!T.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Nt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Nt=new WeakMap;class b extends g{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,Vt,null)}render(){this.container.classList.add("squareAnnotation");const T=this.data,{width:z,height:ht}=R(T.rect),pt=this.svgFactory.create(z,ht,!0),bt=T.borderStyle.width,Et=lt(this,Vt,this.svgFactory.createElement("svg:rect"));return Et.setAttribute("x",bt/2),Et.setAttribute("y",bt/2),Et.setAttribute("width",z-bt),Et.setAttribute("height",ht-bt),Et.setAttribute("stroke-width",bt||1),Et.setAttribute("stroke","transparent"),Et.setAttribute("fill","transparent"),pt.append(Et),this.container.append(pt),!T.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Vt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Vt=new WeakMap;class S extends g{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,Xt,null)}render(){this.container.classList.add("circleAnnotation");const T=this.data,{width:z,height:ht}=R(T.rect),pt=this.svgFactory.create(z,ht,!0),bt=T.borderStyle.width,Et=lt(this,Xt,this.svgFactory.createElement("svg:ellipse"));return Et.setAttribute("cx",z/2),Et.setAttribute("cy",ht/2),Et.setAttribute("rx",z/2-bt/2),Et.setAttribute("ry",ht/2-bt/2),Et.setAttribute("stroke-width",bt||1),Et.setAttribute("stroke","transparent"),Et.setAttribute("fill","transparent"),pt.append(Et),this.container.append(pt),!T.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Xt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xt=new WeakMap;class K extends g{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,yt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const T=this.data,{width:z,height:ht}=R(T.rect),pt=this.svgFactory.create(z,ht,!0);let bt=[];for(const Dt of T.vertices){const Ft=Dt.x-T.rect[0],Rt=T.rect[3]-Dt.y;bt.push(Ft+","+Rt)}bt=bt.join(" ");const Et=lt(this,yt,this.svgFactory.createElement(this.svgElementName));return Et.setAttribute("points",bt),Et.setAttribute("stroke-width",T.borderStyle.width||1),Et.setAttribute("stroke","transparent"),Et.setAttribute("fill","transparent"),pt.append(Et),this.container.append(pt),!T.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,yt)}addHighlightArea(){this.container.classList.add("highlightArea")}}yt=new WeakMap;class U extends K{constructor(D){super(D),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class X extends g{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class $ extends g{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,ot,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const T=this.data,{width:z,height:ht}=R(T.rect),pt=this.svgFactory.create(z,ht,!0);for(const bt of T.inkLists){let Et=[];for(const Ft of bt){const Rt=Ft.x-T.rect[0],Ht=T.rect[3]-Ft.y;Et.push(`${Rt},${Ht}`)}Et=Et.join(" ");const Dt=this.svgFactory.createElement(this.svgElementName);t(this,ot).push(Dt),Dt.setAttribute("points",Et),Dt.setAttribute("stroke-width",T.borderStyle.width||1),Dt.setAttribute("stroke","transparent"),Dt.setAttribute("fill","transparent"),!T.popupRef&&this.hasPopupData&&this._createPopup(),pt.append(Dt)}return this.container.append(pt),this.container}getElementsToTriggerPopup(){return t(this,ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}ot=new WeakMap,a.InkAnnotationElement=$;class at extends g{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class F extends g{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class W extends g{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Z extends g{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class w extends g{constructor(D){super(D,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}a.StampAnnotationElement=w;class s extends g{constructor(T){var pt;super(T,{isRenderable:!0});rt(this,Pt);rt(this,ct,null);const{filename:z,content:ht}=this.data.file;this.filename=(0,_.getFilenameFromUrl)(z,!0),this.content=ht,(pt=this.linkService.eventBus)==null||pt.dispatch("fileattachmentannotation",{source:this,filename:z,content:ht})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:T,data:z}=this;let ht;z.hasAppearance||z.fillAlpha===0?ht=document.createElement("div"):(ht=document.createElement("img"),ht.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(z.name)?"paperclip":"pushpin"}.svg`,z.fillAlpha&&z.fillAlpha<1&&(ht.style=`filter: opacity(${Math.round(z.fillAlpha*100)}%);`)),ht.addEventListener("dblclick",Y(this,Pt,is).bind(this)),lt(this,ct,ht);const{isMac:pt}=n.FeatureTest.platform;return T.addEventListener("keydown",bt=>{bt.key==="Enter"&&(pt?bt.metaKey:bt.ctrlKey)&&Y(this,Pt,is).call(this)}),!z.popupRef&&this.hasPopupData?this._createPopup():ht.classList.add("popupTriggerArea"),T.append(ht),T}getElementsToTriggerPopup(){return t(this,ct)}addHighlightArea(){this.container.classList.add("highlightArea")}}ct=new WeakMap,Pt=new WeakSet,is=function(){var T;(T=this.downloadManager)==null||T.openOrDownloadData(this.container,this.content,this.filename)};class e{constructor({div:D,accessibilityManager:T,annotationCanvasMap:z,l10n:ht,page:pt,viewport:bt}){rt(this,wt);rt(this,Wt,null);rt(this,O,null);rt(this,gt,new Map);this.div=D,lt(this,Wt,T),lt(this,O,z),this.l10n=ht,this.page=pt,this.viewport=bt,this.zIndex=0,this.l10n||(this.l10n=tt.NullL10n)}async render(D){const{annotations:T}=D,z=this.div;(0,_.setLayerDimensions)(z,this.viewport);const ht=new Map,pt={data:null,layer:z,linkService:D.linkService,downloadManager:D.downloadManager,imageResourcesPath:D.imageResourcesPath||"",renderForms:D.renderForms!==!1,svgFactory:new _.DOMSVGFactory,annotationStorage:D.annotationStorage||new q.AnnotationStorage,enableScripting:D.enableScripting===!0,hasJSActions:D.hasJSActions,fieldObjects:D.fieldObjects,parent:this,elements:null};for(const bt of T){if(bt.noHTML)continue;const Et=bt.annotationType===n.AnnotationType.POPUP;if(Et){const Rt=ht.get(bt.id);if(!Rt)continue;pt.elements=Rt}else{const{width:Rt,height:Ht}=R(bt.rect);if(Rt<=0||Ht<=0)continue}pt.data=bt;const Dt=m.create(pt);if(!Dt.isRenderable)continue;if(!Et&&bt.popupRef){const Rt=ht.get(bt.popupRef);Rt?Rt.push(Dt):ht.set(bt.popupRef,[Dt])}Dt.annotationEditorType>0&&t(this,gt).set(Dt.data.id,Dt);const Ft=Dt.render();bt.hidden&&(Ft.style.visibility="hidden"),Y(this,wt,js).call(this,Ft,bt.id)}Y(this,wt,ns).call(this),await this.l10n.translate(z)}update({viewport:D}){const T=this.div;this.viewport=D,(0,_.setLayerDimensions)(T,{rotation:D.rotation}),Y(this,wt,ns).call(this),T.hidden=!1}getEditableAnnotations(){return Array.from(t(this,gt).values())}getEditableAnnotation(D){return t(this,gt).get(D)}}Wt=new WeakMap,O=new WeakMap,gt=new WeakMap,wt=new WeakSet,js=function(D,T){var ht;const z=D.firstChild||D;z.id=`${n.AnnotationPrefix}${T}`,this.div.append(D),(ht=t(this,Wt))==null||ht.moveElementInDOM(this.div,D,z,!1)},ns=function(){if(!t(this,O))return;const D=this.div;for(const[T,z]of t(this,O)){const ht=D.querySelector(`[data-annotation-id="${T}"]`);if(!ht)continue;const{firstChild:pt}=ht;pt?pt.nodeName==="CANVAS"?pt.replaceWith(z):pt.before(z):ht.append(z)}t(this,O).clear()},a.AnnotationLayer=e},(H,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorConverters=void 0;function G(q){return Math.floor(Math.max(0,Math.min(1,q))*255).toString(16).padStart(2,"0")}function n(q){return Math.max(0,Math.min(255,255*q))}class _{static CMYK_G([B,tt,L,v]){return["G",1-Math.min(1,.3*B+.59*L+.11*tt+v)]}static G_CMYK([B]){return["CMYK",0,0,0,1-B]}static G_RGB([B]){return["RGB",B,B,B]}static G_rgb([B]){return B=n(B),[B,B,B]}static G_HTML([B]){const tt=G(B);return`#${tt}${tt}${tt}`}static RGB_G([B,tt,L]){return["G",.3*B+.59*tt+.11*L]}static RGB_rgb(B){return B.map(n)}static RGB_HTML(B){return`#${B.map(G).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([B,tt,L,v]){return["RGB",1-Math.min(1,B+v),1-Math.min(1,L+v),1-Math.min(1,tt+v)]}static CMYK_rgb([B,tt,L,v]){return[n(1-Math.min(1,B+v)),n(1-Math.min(1,L+v)),n(1-Math.min(1,tt+v))]}static CMYK_HTML(B){const tt=this.CMYK_RGB(B).slice(1);return this.RGB_HTML(tt)}static RGB_CMYK([B,tt,L]){const v=1-B,l=1-tt,P=1-L,R=Math.min(v,l,P);return["CMYK",v,l,P,R]}}a.ColorConverters=_},(H,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NullL10n=void 0,a.getL10nFallback=n;const G={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};G.print_progress_percent="{{progress}}%";function n(B,tt){switch(B){case"find_match_count":B=`find_match_count[${tt.total===1?"one":"other"}]`;break;case"find_match_count_limit":B=`find_match_count_limit[${tt.limit===1?"one":"other"}]`;break}return G[B]||""}function _(B,tt){return tt?B.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(L,v)=>v in tt?tt[v]:"{{"+v+"}}"):B}const q={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(B,tt=null,L=n(B,tt)){return _(L,tt)},async translate(B){}};a.NullL10n=q},(H,a,G)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaLayer=void 0;var n=G(25);class _{static setupStorage(B,tt,L,v,l){const P=v.getValue(tt,{value:null});switch(L.name){case"textarea":if(P.value!==null&&(B.textContent=P.value),l==="print")break;B.addEventListener("input",R=>{v.setValue(tt,{value:R.target.value})});break;case"input":if(L.attributes.type==="radio"||L.attributes.type==="checkbox"){if(P.value===L.attributes.xfaOn?B.setAttribute("checked",!0):P.value===L.attributes.xfaOff&&B.removeAttribute("checked"),l==="print")break;B.addEventListener("change",R=>{v.setValue(tt,{value:R.target.checked?R.target.getAttribute("xfaOn"):R.target.getAttribute("xfaOff")})})}else{if(P.value!==null&&B.setAttribute("value",P.value),l==="print")break;B.addEventListener("input",R=>{v.setValue(tt,{value:R.target.value})})}break;case"select":if(P.value!==null){B.setAttribute("value",P.value);for(const R of L.children)R.attributes.value===P.value?R.attributes.selected=!0:R.attributes.hasOwnProperty("selected")&&delete R.attributes.selected}B.addEventListener("input",R=>{const m=R.target.options,g=m.selectedIndex===-1?"":m[m.selectedIndex].value;v.setValue(tt,{value:g})});break}}static setAttributes({html:B,element:tt,storage:L=null,intent:v,linkService:l}){const{attributes:P}=tt,R=B instanceof HTMLAnchorElement;P.type==="radio"&&(P.name=`${P.name}-${v}`);for(const[m,g]of Object.entries(P))if(g!=null)switch(m){case"class":g.length&&B.setAttribute(m,g.join(" "));break;case"dataId":break;case"id":B.setAttribute("data-element-id",g);break;case"style":Object.assign(B.style,g);break;case"textContent":B.textContent=g;break;default:(!R||m!=="href"&&m!=="newWindow")&&B.setAttribute(m,g)}R&&l.addLinkAttributes(B,P.href,P.newWindow),L&&P.dataId&&this.setupStorage(B,P.dataId,tt,L)}static render(B){var A;const tt=B.annotationStorage,L=B.linkService,v=B.xfaHtml,l=B.intent||"display",P=document.createElement(v.name);v.attributes&&this.setAttributes({html:P,element:v,intent:l,linkService:L});const R=[[v,-1,P]],m=B.div;if(m.append(P),B.viewport){const f=`matrix(${B.viewport.transform.join(",")})`;m.style.transform=f}l!=="richText"&&m.setAttribute("class","xfaLayer xfaFont");const g=[];for(;R.length>0;){const[f,h,x]=R.at(-1);if(h+1===f.children.length){R.pop();continue}const M=f.children[++R.at(-1)[1]];if(M===null)continue;const{name:E}=M;if(E==="#text"){const u=document.createTextNode(M.value);g.push(u),x.append(u);continue}const c=(A=M==null?void 0:M.attributes)!=null&&A.xmlns?document.createElementNS(M.attributes.xmlns,E):document.createElement(E);if(x.append(c),M.attributes&&this.setAttributes({html:c,element:M,storage:tt,intent:l,linkService:L}),M.children&&M.children.length>0)R.push([M,-1,c]);else if(M.value){const u=document.createTextNode(M.value);n.XfaText.shouldBuildText(E)&&g.push(u),c.append(u)}}for(const f of m.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:g}}static update(B){const tt=`matrix(${B.viewport.transform.join(",")})`;B.div.style.transform=tt,B.div.hidden=!1}}a.XfaLayer=_},(H,a,G)=>{var v,l,P,R,m,g,A,f,h,x,M,E,c,u,r,Ms,Ds,Is,Ls,rs,Ns,as,Os,Bs,Us,Hs,$s,ee,os,Ce,Re,le,ls,Te,j,Ws,cs,Gs,zs,hs,Pe,ce;Object.defineProperty(a,"__esModule",{value:!0}),a.InkEditor=void 0;var n=G(1),_=G(4),q=G(29),B=G(6),tt=G(5);const At=class At extends _.AnnotationEditor{constructor(y){super({...y,name:"inkEditor"});rt(this,r);rt(this,v,0);rt(this,l,0);rt(this,P,this.canvasPointermove.bind(this));rt(this,R,this.canvasPointerleave.bind(this));rt(this,m,this.canvasPointerup.bind(this));rt(this,g,this.canvasPointerdown.bind(this));rt(this,A,new Path2D);rt(this,f,!1);rt(this,h,!1);rt(this,x,!1);rt(this,M,null);rt(this,E,0);rt(this,c,0);rt(this,u,null);this.color=y.color||null,this.thickness=y.thickness||null,this.opacity=y.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(y){_.AnnotationEditor.initialize(y,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(y,N){switch(y){case n.AnnotationEditorParamsType.INK_THICKNESS:At._defaultThickness=N;break;case n.AnnotationEditorParamsType.INK_COLOR:At._defaultColor=N;break;case n.AnnotationEditorParamsType.INK_OPACITY:At._defaultOpacity=N/100;break}}updateParams(y,N){switch(y){case n.AnnotationEditorParamsType.INK_THICKNESS:Y(this,r,Ms).call(this,N);break;case n.AnnotationEditorParamsType.INK_COLOR:Y(this,r,Ds).call(this,N);break;case n.AnnotationEditorParamsType.INK_OPACITY:Y(this,r,Is).call(this,N);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,At._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,At._defaultColor||_.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(At._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||At._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||At._defaultColor||_.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??At._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,r,Ce).call(this),Y(this,r,Re).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,r,le).call(this)),Y(this,r,ce).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,M).disconnect(),lt(this,M,null),super.remove())}setParent(y){!this.parent&&y?this._uiManager.removeShouldRescale(this):this.parent&&y===null&&this._uiManager.addShouldRescale(this),super.setParent(y)}onScaleChanging(){const[y,N]=this.parentDimensions,J=this.width*y,nt=this.height*N;this.setDimensions(J,nt)}enableEditMode(){t(this,f)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,g)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,g)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,f)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),lt(this,f,!0),this.div.classList.add("disabled"),Y(this,r,ce).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(y){this._focusEventsAllowed&&(super.focusin(y),this.enableEditMode())}canvasPointerdown(y){y.button!==0||!this.isInEditMode()||t(this,f)||(this.setInForeground(),y.preventDefault(),y.type!=="mouse"&&this.div.focus(),Y(this,r,Ns).call(this,y.offsetX,y.offsetY))}canvasPointermove(y){y.preventDefault(),Y(this,r,as).call(this,y.offsetX,y.offsetY)}canvasPointerup(y){y.preventDefault(),Y(this,r,os).call(this,y)}canvasPointerleave(y){Y(this,r,os).call(this,y)}get isResizable(){return!this.isEmpty()&&t(this,f)}render(){if(this.div)return this.div;let y,N;this.width&&(y=this.x,N=this.y),super.render(),_.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(_t=>{var Q;return(Q=this.div)==null?void 0:Q.setAttribute("aria-label",_t)});const[J,nt,ft,vt]=Y(this,r,Ls).call(this);if(this.setAt(J,nt,0,0),this.setDims(ft,vt),Y(this,r,Ce).call(this),this.width){const[_t,Q]=this.parentDimensions;this.setAspectRatio(this.width*_t,this.height*Q),this.setAt(y*_t,N*Q,this.width*_t,this.height*Q),lt(this,x,!0),Y(this,r,le).call(this),this.setDims(this.width*_t,this.height*Q),Y(this,r,ee).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,r,Re).call(this),this.div}setDimensions(y,N){const J=Math.round(y),nt=Math.round(N);if(t(this,E)===J&&t(this,c)===nt)return;lt(this,E,J),lt(this,c,nt),this.canvas.style.visibility="hidden";const[ft,vt]=this.parentDimensions;this.width=y/ft,this.height=N/vt,this.fixAndSetPosition(),t(this,f)&&Y(this,r,ls).call(this,y,N),Y(this,r,le).call(this),Y(this,r,ee).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(y,N,J){var Nt,Vt,Xt;if(y instanceof q.InkAnnotationElement)return null;const nt=super.deserialize(y,N,J);nt.thickness=y.thickness,nt.color=n.Util.makeHexColor(...y.color),nt.opacity=y.opacity;const[ft,vt]=nt.pageDimensions,_t=nt.width*ft,Q=nt.height*vt,Ct=nt.parentScale,St=y.thickness/2;lt(nt,f,!0),lt(nt,E,Math.round(_t)),lt(nt,c,Math.round(Q));const{paths:Ut,rect:Ot,rotation:zt}=y;for(let{bezier:yt}of Ut){yt=Y(Nt=At,j,Gs).call(Nt,yt,Ot,zt);const ot=[];nt.paths.push(ot);let ct=Ct*(yt[0]-St),Pt=Ct*(yt[1]-St);for(let Wt=2,O=yt.length;Wt<O;Wt+=6){const gt=Ct*(yt[Wt]-St),wt=Ct*(yt[Wt+1]-St),Mt=Ct*(yt[Wt+2]-St),Lt=Ct*(yt[Wt+3]-St),Tt=Ct*(yt[Wt+4]-St),D=Ct*(yt[Wt+5]-St);ot.push([[ct,Pt],[gt,wt],[Mt,Lt],[Tt,D]]),ct=Tt,Pt=D}const Gt=Y(this,j,Ws).call(this,ot);nt.bezierPath2D.push(Gt)}const kt=Y(Vt=nt,r,hs).call(Vt);return lt(nt,l,Math.max(_.AnnotationEditor.MIN_SIZE,kt[2]-kt[0])),lt(nt,v,Math.max(_.AnnotationEditor.MIN_SIZE,kt[3]-kt[1])),Y(Xt=nt,r,ls).call(Xt,_t,Q),nt}serialize(){if(this.isEmpty())return null;const y=this.getRect(0,0),N=_.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:N,thickness:this.thickness,opacity:this.opacity,paths:Y(this,r,zs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,y),pageIndex:this.pageIndex,rect:y,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};v=new WeakMap,l=new WeakMap,P=new WeakMap,R=new WeakMap,m=new WeakMap,g=new WeakMap,A=new WeakMap,f=new WeakMap,h=new WeakMap,x=new WeakMap,M=new WeakMap,E=new WeakMap,c=new WeakMap,u=new WeakMap,r=new WeakSet,Ms=function(y){const N=this.thickness;this.addCommands({cmd:()=>{this.thickness=y,Y(this,r,ce).call(this)},undo:()=>{this.thickness=N,Y(this,r,ce).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Ds=function(y){const N=this.color;this.addCommands({cmd:()=>{this.color=y,Y(this,r,ee).call(this)},undo:()=>{this.color=N,Y(this,r,ee).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Is=function(y){y/=100;const N=this.opacity;this.addCommands({cmd:()=>{this.opacity=y,Y(this,r,ee).call(this)},undo:()=>{this.opacity=N,Y(this,r,ee).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Ls=function(){const{parentRotation:y,parentDimensions:[N,J]}=this;switch(y){case 90:return[0,J,J,N];case 180:return[N,J,N,J];case 270:return[N,0,J,N];default:return[0,0,N,J]}},rs=function(){const{ctx:y,color:N,opacity:J,thickness:nt,parentScale:ft,scaleFactor:vt}=this;y.lineWidth=nt*ft/vt,y.lineCap="round",y.lineJoin="round",y.miterLimit=10,y.strokeStyle=`${N}${(0,tt.opacityToHex)(J)}`},Ns=function(y,N){this.canvas.addEventListener("contextmenu",B.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,R)),this.canvas.addEventListener("pointermove",t(this,P)),this.canvas.addEventListener("pointerup",t(this,m)),this.canvas.removeEventListener("pointerdown",t(this,g)),this.isEditing=!0,t(this,x)||(lt(this,x,!0),Y(this,r,le).call(this),this.thickness||(this.thickness=At._defaultThickness),this.color||(this.color=At._defaultColor||_.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=At._defaultOpacity)),this.currentPath.push([y,N]),lt(this,h,!1),Y(this,r,rs).call(this),lt(this,u,()=>{Y(this,r,Us).call(this),t(this,u)&&window.requestAnimationFrame(t(this,u))}),window.requestAnimationFrame(t(this,u))},as=function(y,N){const[J,nt]=this.currentPath.at(-1);if(this.currentPath.length>1&&y===J&&N===nt)return;const ft=this.currentPath;let vt=t(this,A);if(ft.push([y,N]),lt(this,h,!0),ft.length<=2){vt.moveTo(...ft[0]),vt.lineTo(y,N);return}ft.length===3&&(lt(this,A,vt=new Path2D),vt.moveTo(...ft[0])),Y(this,r,Hs).call(this,vt,...ft.at(-3),...ft.at(-2),y,N)},Os=function(){if(this.currentPath.length===0)return;const y=this.currentPath.at(-1);t(this,A).lineTo(...y)},Bs=function(y,N){lt(this,u,null),y=Math.min(Math.max(y,0),this.canvas.width),N=Math.min(Math.max(N,0),this.canvas.height),Y(this,r,as).call(this,y,N),Y(this,r,Os).call(this);let J;if(this.currentPath.length!==1)J=Y(this,r,$s).call(this);else{const Q=[y,N];J=[[Q,Q.slice(),Q.slice(),Q]]}const nt=t(this,A),ft=this.currentPath;this.currentPath=[],lt(this,A,new Path2D);const vt=()=>{this.allRawPaths.push(ft),this.paths.push(J),this.bezierPath2D.push(nt),this.rebuild()},_t=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,r,Ce).call(this),Y(this,r,Re).call(this)),Y(this,r,ce).call(this))};this.addCommands({cmd:vt,undo:_t,mustExec:!0})},Us=function(){if(!t(this,h))return;lt(this,h,!1);const y=Math.ceil(this.thickness*this.parentScale),N=this.currentPath.slice(-3),J=N.map(vt=>vt[0]),nt=N.map(vt=>vt[1]);Math.min(...J)-y,Math.max(...J)+y,Math.min(...nt)-y,Math.max(...nt)+y;const{ctx:ft}=this;ft.save(),ft.clearRect(0,0,this.canvas.width,this.canvas.height);for(const vt of this.bezierPath2D)ft.stroke(vt);ft.stroke(t(this,A)),ft.restore()},Hs=function(y,N,J,nt,ft,vt,_t){const Q=(N+nt)/2,Ct=(J+ft)/2,St=(nt+vt)/2,Ut=(ft+_t)/2;y.bezierCurveTo(Q+2*(nt-Q)/3,Ct+2*(ft-Ct)/3,St+2*(nt-St)/3,Ut+2*(ft-Ut)/3,St,Ut)},$s=function(){const y=this.currentPath;if(y.length<=2)return[[y[0],y[0],y.at(-1),y.at(-1)]];const N=[];let J,[nt,ft]=y[0];for(J=1;J<y.length-2;J++){const[Ot,zt]=y[J],[kt,Nt]=y[J+1],Vt=(Ot+kt)/2,Xt=(zt+Nt)/2,yt=[nt+2*(Ot-nt)/3,ft+2*(zt-ft)/3],ot=[Vt+2*(Ot-Vt)/3,Xt+2*(zt-Xt)/3];N.push([[nt,ft],yt,ot,[Vt,Xt]]),[nt,ft]=[Vt,Xt]}const[vt,_t]=y[J],[Q,Ct]=y[J+1],St=[nt+2*(vt-nt)/3,ft+2*(_t-ft)/3],Ut=[Q+2*(vt-Q)/3,Ct+2*(_t-Ct)/3];return N.push([[nt,ft],St,Ut,[Q,Ct]]),N},ee=function(){if(this.isEmpty()){Y(this,r,Te).call(this);return}Y(this,r,rs).call(this);const{canvas:y,ctx:N}=this;N.setTransform(1,0,0,1,0,0),N.clearRect(0,0,y.width,y.height),Y(this,r,Te).call(this);for(const J of this.bezierPath2D)N.stroke(J)},os=function(y){this.canvas.removeEventListener("pointerleave",t(this,R)),this.canvas.removeEventListener("pointermove",t(this,P)),this.canvas.removeEventListener("pointerup",t(this,m)),this.canvas.addEventListener("pointerdown",t(this,g)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",B.noContextMenu)},10),Y(this,r,Bs).call(this,y.offsetX,y.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Ce=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",_.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(y=>{var N;return(N=this.canvas)==null?void 0:N.setAttribute("aria-label",y)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Re=function(){lt(this,M,new ResizeObserver(y=>{const N=y[0].contentRect;N.width&&N.height&&this.setDimensions(N.width,N.height)})),t(this,M).observe(this.div)},le=function(){if(!t(this,x))return;const[y,N]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*y),this.canvas.height=Math.ceil(this.height*N),Y(this,r,Te).call(this)},ls=function(y,N){const J=Y(this,r,Pe).call(this),nt=(y-J)/t(this,l),ft=(N-J)/t(this,v);this.scaleFactor=Math.min(nt,ft)},Te=function(){const y=Y(this,r,Pe).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+y,this.translationY*this.scaleFactor+y)},j=new WeakSet,Ws=function(y){const N=new Path2D;for(let J=0,nt=y.length;J<nt;J++){const[ft,vt,_t,Q]=y[J];J===0&&N.moveTo(...ft),N.bezierCurveTo(vt[0],vt[1],_t[0],_t[1],Q[0],Q[1])}return N},cs=function(y,N,J){const[nt,ft,vt,_t]=N;switch(J){case 0:for(let Q=0,Ct=y.length;Q<Ct;Q+=2)y[Q]+=nt,y[Q+1]=_t-y[Q+1];break;case 90:for(let Q=0,Ct=y.length;Q<Ct;Q+=2){const St=y[Q];y[Q]=y[Q+1]+nt,y[Q+1]=St+ft}break;case 180:for(let Q=0,Ct=y.length;Q<Ct;Q+=2)y[Q]=vt-y[Q],y[Q+1]+=ft;break;case 270:for(let Q=0,Ct=y.length;Q<Ct;Q+=2){const St=y[Q];y[Q]=vt-y[Q+1],y[Q+1]=_t-St}break;default:throw new Error("Invalid rotation")}return y},Gs=function(y,N,J){const[nt,ft,vt,_t]=N;switch(J){case 0:for(let Q=0,Ct=y.length;Q<Ct;Q+=2)y[Q]-=nt,y[Q+1]=_t-y[Q+1];break;case 90:for(let Q=0,Ct=y.length;Q<Ct;Q+=2){const St=y[Q];y[Q]=y[Q+1]-ft,y[Q+1]=St-nt}break;case 180:for(let Q=0,Ct=y.length;Q<Ct;Q+=2)y[Q]=vt-y[Q],y[Q+1]-=ft;break;case 270:for(let Q=0,Ct=y.length;Q<Ct;Q+=2){const St=y[Q];y[Q]=_t-y[Q+1],y[Q+1]=vt-St}break;default:throw new Error("Invalid rotation")}return y},zs=function(y,N,J,nt){var Ct,St;const ft=[],vt=this.thickness/2,_t=y*N+vt,Q=y*J+vt;for(const Ut of this.paths){const Ot=[],zt=[];for(let kt=0,Nt=Ut.length;kt<Nt;kt++){const[Vt,Xt,yt,ot]=Ut[kt],ct=y*Vt[0]+_t,Pt=y*Vt[1]+Q,Gt=y*Xt[0]+_t,Wt=y*Xt[1]+Q,O=y*yt[0]+_t,gt=y*yt[1]+Q,wt=y*ot[0]+_t,Mt=y*ot[1]+Q;kt===0&&(Ot.push(ct,Pt),zt.push(ct,Pt)),Ot.push(Gt,Wt,O,gt,wt,Mt),zt.push(Gt,Wt),kt===Nt-1&&zt.push(wt,Mt)}ft.push({bezier:Y(Ct=At,j,cs).call(Ct,Ot,nt,this.rotation),points:Y(St=At,j,cs).call(St,zt,nt,this.rotation)})}return ft},hs=function(){let y=1/0,N=-1/0,J=1/0,nt=-1/0;for(const ft of this.paths)for(const[vt,_t,Q,Ct]of ft){const St=n.Util.bezierBoundingBox(...vt,..._t,...Q,...Ct);y=Math.min(y,St[0]),J=Math.min(J,St[1]),N=Math.max(N,St[2]),nt=Math.max(nt,St[3])}return[y,J,N,nt]},Pe=function(){return t(this,f)?Math.ceil(this.thickness*this.parentScale):0},ce=function(y=!1){if(this.isEmpty())return;if(!t(this,f)){Y(this,r,ee).call(this);return}const N=Y(this,r,hs).call(this),J=Y(this,r,Pe).call(this);lt(this,l,Math.max(_.AnnotationEditor.MIN_SIZE,N[2]-N[0])),lt(this,v,Math.max(_.AnnotationEditor.MIN_SIZE,N[3]-N[1]));const nt=Math.ceil(J+t(this,l)*this.scaleFactor),ft=Math.ceil(J+t(this,v)*this.scaleFactor),[vt,_t]=this.parentDimensions;this.width=nt/vt,this.height=ft/_t,this.setAspectRatio(nt,ft);const Q=this.translationX,Ct=this.translationY;this.translationX=-N[0],this.translationY=-N[1],Y(this,r,le).call(this),Y(this,r,ee).call(this),lt(this,E,nt),lt(this,c,ft),this.setDims(nt,ft);const St=y?J/this.scaleFactor/2:0;this.translate(Q-this.translationX-St,Ct-this.translationY-St)},rt(At,j),Kt(At,"_defaultColor",null),Kt(At,"_defaultOpacity",1),Kt(At,"_defaultThickness",1),Kt(At,"_type","ink");let L=At;a.InkEditor=L},(H,a,G)=>{var L,v,l,P,R,m,g,A,f,h,x,ge,be,ke,ds,Vs,qs,us,Fe,Xs;Object.defineProperty(a,"__esModule",{value:!0}),a.StampEditor=void 0;var n=G(1),_=G(4),q=G(6),B=G(29);const b=class b extends _.AnnotationEditor{constructor(U){super({...U,name:"stampEditor"});rt(this,x);rt(this,L,null);rt(this,v,null);rt(this,l,null);rt(this,P,null);rt(this,R,null);rt(this,m,null);rt(this,g,null);rt(this,A,null);rt(this,f,!1);rt(this,h,!1);lt(this,P,U.bitmapUrl),lt(this,R,U.bitmapFile)}static initialize(U){_.AnnotationEditor.initialize(U)}static get supportedTypes(){const U=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",U.map(X=>`image/${X}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(U){return this.supportedTypes.includes(U)}static paste(U,X){X.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:U.getAsFile()})}remove(){var U,X;t(this,v)&&(lt(this,L,null),this._uiManager.imageManager.deleteId(t(this,v)),(U=t(this,m))==null||U.remove(),lt(this,m,null),(X=t(this,g))==null||X.disconnect(),lt(this,g,null)),super.remove()}rebuild(){if(!this.parent){t(this,v)&&Y(this,x,ke).call(this);return}super.rebuild(),this.div!==null&&(t(this,v)&&Y(this,x,ke).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,l)||t(this,L)||t(this,P)||t(this,R))}get isResizable(){return!0}render(){if(this.div)return this.div;let U,X;if(this.width&&(U=this.x,X=this.y),super.render(),this.div.hidden=!0,t(this,L)?Y(this,x,ds).call(this):Y(this,x,ke).call(this),this.width){const[$,at]=this.parentDimensions;this.setAt(U*$,X*at,this.width*$,this.height*at)}return this.div}static deserialize(U,X,$){if(U instanceof B.StampAnnotationElement)return null;const at=super.deserialize(U,X,$),{rect:F,bitmapUrl:W,bitmapId:Z,isSvg:w,accessibilityData:s}=U;Z&&$.imageManager.isValidId(Z)?lt(at,v,Z):lt(at,P,W),lt(at,f,w);const[e,p]=at.pageDimensions;return at.width=(F[2]-F[0])/e,at.height=(F[3]-F[1])/p,s&&(at.altTextData=s),at}serialize(U=!1,X=null){if(this.isEmpty())return null;const $={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,v),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,f),structTreeParentId:this._structTreeParentId};if(U)return $.bitmapUrl=Y(this,x,Fe).call(this,!0),$.accessibilityData=this.altTextData,$;const{decorative:at,altText:F}=this.altTextData;if(!at&&F&&($.accessibilityData={type:"Figure",alt:F}),X===null)return $;X.stamps||(X.stamps=new Map);const W=t(this,f)?($.rect[2]-$.rect[0])*($.rect[3]-$.rect[1]):null;if(!X.stamps.has(t(this,v)))X.stamps.set(t(this,v),{area:W,serialized:$}),$.bitmap=Y(this,x,Fe).call(this,!1);else if(t(this,f)){const Z=X.stamps.get(t(this,v));W>Z.area&&(Z.area=W,Z.serialized.bitmap.close(),Z.serialized.bitmap=Y(this,x,Fe).call(this,!1))}return $}};L=new WeakMap,v=new WeakMap,l=new WeakMap,P=new WeakMap,R=new WeakMap,m=new WeakMap,g=new WeakMap,A=new WeakMap,f=new WeakMap,h=new WeakMap,x=new WeakSet,ge=function(U,X=!1){if(!U){this.remove();return}lt(this,L,U.bitmap),X||(lt(this,v,U.id),lt(this,f,U.isSvg)),Y(this,x,ds).call(this)},be=function(){lt(this,l,null),this._uiManager.enableWaiting(!1),t(this,m)&&this.div.focus()},ke=function(){if(t(this,v)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,v)).then(X=>Y(this,x,ge).call(this,X,!0)).finally(()=>Y(this,x,be).call(this));return}if(t(this,P)){const X=t(this,P);lt(this,P,null),this._uiManager.enableWaiting(!0),lt(this,l,this._uiManager.imageManager.getFromUrl(X).then($=>Y(this,x,ge).call(this,$)).finally(()=>Y(this,x,be).call(this)));return}if(t(this,R)){const X=t(this,R);lt(this,R,null),this._uiManager.enableWaiting(!0),lt(this,l,this._uiManager.imageManager.getFromFile(X).then($=>Y(this,x,ge).call(this,$)).finally(()=>Y(this,x,be).call(this)));return}const U=document.createElement("input");U.type="file",U.accept=b.supportedTypesStr,lt(this,l,new Promise(X=>{U.addEventListener("change",async()=>{if(!U.files||U.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const $=await this._uiManager.imageManager.getFromFile(U.files[0]);Y(this,x,ge).call(this,$)}X()}),U.addEventListener("cancel",()=>{this.remove(),X()})}).finally(()=>Y(this,x,be).call(this))),U.click()},ds=function(){const{div:U}=this;let{width:X,height:$}=t(this,L);const[at,F]=this.pageDimensions,W=.75;if(this.width)X=this.width*at,$=this.height*F;else if(X>W*at||$>W*F){const e=Math.min(W*at/X,W*F/$);X*=e,$*=e}const[Z,w]=this.parentDimensions;this.setDims(X*Z/at,$*w/F),this._uiManager.enableWaiting(!1);const s=lt(this,m,document.createElement("canvas"));U.append(s),U.hidden=!1,Y(this,x,us).call(this,X,$),Y(this,x,Xs).call(this),t(this,h)||(this.parent.addUndoableEditor(this),lt(this,h,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Vs=function(U,X){var W;const[$,at]=this.parentDimensions;this.width=U/$,this.height=X/at,this.setDims(U,X),(W=this._initialOptions)!=null&&W.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,A)!==null&&clearTimeout(t(this,A)),lt(this,A,setTimeout(()=>{lt(this,A,null),Y(this,x,us).call(this,U,X)},200))},qs=function(U,X){const{width:$,height:at}=t(this,L);let F=$,W=at,Z=t(this,L);for(;F>2*U||W>2*X;){const w=F,s=W;F>2*U&&(F=F>=16384?Math.floor(F/2)-1:Math.ceil(F/2)),W>2*X&&(W=W>=16384?Math.floor(W/2)-1:Math.ceil(W/2));const e=new OffscreenCanvas(F,W);e.getContext("2d").drawImage(Z,0,0,w,s,0,0,F,W),Z=e.transferToImageBitmap()}return Z},us=function(U,X){U=Math.ceil(U),X=Math.ceil(X);const $=t(this,m);if(!$||$.width===U&&$.height===X)return;$.width=U,$.height=X;const at=t(this,f)?t(this,L):Y(this,x,qs).call(this,U,X),F=$.getContext("2d");F.filter=this._uiManager.hcmFilter,F.drawImage(at,0,0,at.width,at.height,0,0,U,X)},Fe=function(U){if(U){if(t(this,f)){const at=this._uiManager.imageManager.getSvgUrl(t(this,v));if(at)return at}const X=document.createElement("canvas");return{width:X.width,height:X.height}=t(this,L),X.getContext("2d").drawImage(t(this,L),0,0),X.toDataURL()}if(t(this,f)){const[X,$]=this.pageDimensions,at=Math.round(this.width*X*q.PixelsPerInch.PDF_TO_CSS_UNITS),F=Math.round(this.height*$*q.PixelsPerInch.PDF_TO_CSS_UNITS),W=new OffscreenCanvas(at,F);return W.getContext("2d").drawImage(t(this,L),0,0,t(this,L).width,t(this,L).height,0,0,at,F),W.transferToImageBitmap()}return structuredClone(t(this,L))},Xs=function(){lt(this,g,new ResizeObserver(U=>{const X=U[0].contentRect;X.width&&X.height&&Y(this,x,Vs).call(this,X.width,X.height)})),t(this,g).observe(this.div)},Kt(b,"_type","stamp");let tt=b;a.StampEditor=tt}],__webpack_module_cache__={};function __w_pdfjs_require__(H){var a=__webpack_module_cache__[H];if(a!==void 0)return a.exports;var G=__webpack_module_cache__[H]={exports:{}};return __webpack_modules__[H](G,G.exports,__w_pdfjs_require__),G.exports}var __webpack_exports__={};return(()=>{var H=__webpack_exports__;Object.defineProperty(H,"__esModule",{value:!0}),Object.defineProperty(H,"AbortException",{enumerable:!0,get:function(){return a.AbortException}}),Object.defineProperty(H,"AnnotationEditorLayer",{enumerable:!0,get:function(){return q.AnnotationEditorLayer}}),Object.defineProperty(H,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return a.AnnotationEditorParamsType}}),Object.defineProperty(H,"AnnotationEditorType",{enumerable:!0,get:function(){return a.AnnotationEditorType}}),Object.defineProperty(H,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return B.AnnotationEditorUIManager}}),Object.defineProperty(H,"AnnotationLayer",{enumerable:!0,get:function(){return tt.AnnotationLayer}}),Object.defineProperty(H,"AnnotationMode",{enumerable:!0,get:function(){return a.AnnotationMode}}),Object.defineProperty(H,"CMapCompressionType",{enumerable:!0,get:function(){return a.CMapCompressionType}}),Object.defineProperty(H,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(H,"FeatureTest",{enumerable:!0,get:function(){return a.FeatureTest}}),Object.defineProperty(H,"GlobalWorkerOptions",{enumerable:!0,get:function(){return L.GlobalWorkerOptions}}),Object.defineProperty(H,"ImageKind",{enumerable:!0,get:function(){return a.ImageKind}}),Object.defineProperty(H,"InvalidPDFException",{enumerable:!0,get:function(){return a.InvalidPDFException}}),Object.defineProperty(H,"MissingPDFException",{enumerable:!0,get:function(){return a.MissingPDFException}}),Object.defineProperty(H,"OPS",{enumerable:!0,get:function(){return a.OPS}}),Object.defineProperty(H,"PDFDataRangeTransport",{enumerable:!0,get:function(){return G.PDFDataRangeTransport}}),Object.defineProperty(H,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(H,"PDFWorker",{enumerable:!0,get:function(){return G.PDFWorker}}),Object.defineProperty(H,"PasswordResponses",{enumerable:!0,get:function(){return a.PasswordResponses}}),Object.defineProperty(H,"PermissionFlag",{enumerable:!0,get:function(){return a.PermissionFlag}}),Object.defineProperty(H,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(H,"PromiseCapability",{enumerable:!0,get:function(){return a.PromiseCapability}}),Object.defineProperty(H,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(H,"SVGGraphics",{enumerable:!0,get:function(){return G.SVGGraphics}}),Object.defineProperty(H,"UnexpectedResponseException",{enumerable:!0,get:function(){return a.UnexpectedResponseException}}),Object.defineProperty(H,"Util",{enumerable:!0,get:function(){return a.Util}}),Object.defineProperty(H,"VerbosityLevel",{enumerable:!0,get:function(){return a.VerbosityLevel}}),Object.defineProperty(H,"XfaLayer",{enumerable:!0,get:function(){return v.XfaLayer}}),Object.defineProperty(H,"build",{enumerable:!0,get:function(){return G.build}}),Object.defineProperty(H,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return a.createValidAbsoluteUrl}}),Object.defineProperty(H,"getDocument",{enumerable:!0,get:function(){return G.getDocument}}),Object.defineProperty(H,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(H,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(H,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(H,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(H,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(H,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(H,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(H,"normalizeUnicode",{enumerable:!0,get:function(){return a.normalizeUnicode}}),Object.defineProperty(H,"renderTextLayer",{enumerable:!0,get:function(){return _.renderTextLayer}}),Object.defineProperty(H,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(H,"shadow",{enumerable:!0,get:function(){return a.shadow}}),Object.defineProperty(H,"updateTextLayer",{enumerable:!0,get:function(){return _.updateTextLayer}}),Object.defineProperty(H,"version",{enumerable:!0,get:function(){return G.version}});var a=__w_pdfjs_require__(1),G=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),_=__w_pdfjs_require__(26),q=__w_pdfjs_require__(27),B=__w_pdfjs_require__(5),tt=__w_pdfjs_require__(29),L=__w_pdfjs_require__(14),v=__w_pdfjs_require__(32)})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();pdfExports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;function ReportForm(){const[H,a]=reactExports.useState({name:"",description:"",date:new Date().toISOString().slice(0,16)}),[G,n]=reactExports.useState(null),[_,q]=reactExports.useState(null),[B,tt]=reactExports.useState(null),[L,v]=reactExports.useState(""),[l,P]=reactExports.useState(!1),[R,m]=reactExports.useState({type:"",text:""}),[g,A]=reactExports.useState({}),[f,h]=reactExports.useState(!1),[x,M]=reactExports.useState(!1),E=reactExports.useRef(null),c=reactExports.useRef(null),[u,r]=reactExports.useState(""),[d,o]=reactExports.useState(!1),C={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/reports/",basePdfPath:"public/reports/",token:localStorage.getItem("githubToken")||""},i=e=>{const{name:p,value:k}=e.target;a({...H,[p]:k}),g[p]&&A({...g,[p]:""})},[b,S]=reactExports.useState(!1),K=async e=>{try{m({type:"",text:""});const p=await e.arrayBuffer();try{const j=await pdfExports.getDocument({data:p}).promise;if(j.numPages===0)throw new Error("PDF has no pages");const I=await j.getPage(1),V=I.getViewport({scale:3}),et=document.createElement("canvas"),ut=et.getContext("2d");et.height=V.height,et.width=V.width;const dt={canvasContext:ut,viewport:V};await I.render(dt).promise;const mt=document.createElement("canvas"),xt=mt.getContext("2d");mt.width=175,mt.height=250,xt.drawImage(et,0,0,et.width,et.height,0,0,175,250);const At=await new Promise(y=>{mt.toBlob(N=>y(N),"image/webp",.99)});if(!At)throw new Error("Failed to create webp image");const st=new File([At],`${e.name.split(".")[0]}_cover.webp`,{type:"image/webp"}),it=URL.createObjectURL(At);return{coverImageFile:st,previewUrl:it}}catch(k){throw console.error("PDF.js error:",k),new Error("Failed to process PDF. Please upload a cover image manually.")}}catch(p){return console.error("Error generating cover from PDF:",p),m({type:"error",text:"Failed to generate cover image from PDF. Please upload a cover image manually."}),M(!0),S(!0),null}},U=e=>{if(!b)return;const p=e.target.files[0];if(p){q(p),M(!0),h(!1);const k=new FileReader;k.onload=()=>{tt(k.result)},k.readAsDataURL(p),g.coverImage&&A({...g,coverImage:""})}},X=async e=>{const p=e.target.files[0];if(p)if(n(p),v(p.name),S(!0),a({...H,name:p.name.replace(".pdf","")}),g.pdf&&A({...g,pdf:""}),p.type==="application/pdf")try{P(!0),m({type:"",text:""});const k=await K(p);k?(q(k.coverImageFile),tt(k.previewUrl),h(!0),M(!1),g.coverImage&&A({...g,coverImage:""})):(M(!0),h(!1))}catch(k){console.error("Failed to generate cover image:",k),M(!0),h(!1)}finally{P(!1)}else M(!0),h(!1),m({type:"info",text:"Non-PDF file detected. Please upload a cover image manually."})},$=()=>{const e={};return H.name.trim()||(e.name="Report name is required"),H.description.trim()||(e.description="Description is required"),_||(e.coverImage="Cover image is required"),G||(e.pdf="PDF file is required"),A(e),Object.keys(e).length===0},at=()=>{M(!0),f&&B&&URL.revokeObjectURL(B)},F=e=>new Promise((p,k)=>{const j=new FileReader;j.readAsDataURL(e),j.onload=()=>{const I=j.result.split(",")[1];p(I)},j.onerror=I=>k(I)}),W=async(e,p,k)=>{if(!e||!C.token)throw new Error("Missing file or GitHub token");try{const j=await F(e);let I=null;try{const dt=await fetch(`https://api.github.com/repos/${C.owner}/${C.repo}/contents/${p}?ref=${C.branch}`,{headers:{Authorization:`token ${C.token}`,Accept:"application/vnd.github.v3+json"}});dt.status===200&&(I=(await dt.json()).sha)}catch{console.log(`File does not exist yet: ${p}`)}const V={message:k,content:j,branch:C.branch};I&&(V.sha=I);const et=await fetch(`https://api.github.com/repos/${C.owner}/${C.repo}/contents/${p}`,{method:"PUT",headers:{Authorization:`token ${C.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(V)}),ut=await et.json();if(et.status===200||et.status===201)return ut;throw new Error(`GitHub API Error: ${ut.message}`)}catch(j){throw console.error("Error committing to GitHub:",j),j}},Z=async e=>{if(e.preventDefault(),!!$())try{if(P(!0),!C.token){const mt=prompt("Please enter your GitHub token to commit files:");if(!mt){m({type:"error",text:"GitHub token is required to commit files."}),P(!1);return}localStorage.setItem("githubToken",mt),C.token=mt}const p=v4().replace(/-/g,"").substring(0,24),k=Date.now(),j=G.name.replace(/[^a-zA-Z0-9.]/g,"_"),I=`${C.basePdfPath}${p}_${j}`,V=_.name.split(".").pop(),et=`${p}-cover.${V}`,ut=f?`public/reports/${et}`:`${C.baseImagePath}${et}`;o(!0);try{r("Committing cover image to GitHub..."),await W(_,ut,`Add report cover image for: ${H.name}`),r("Committing PDF file to GitHub..."),await W(G,I,`Add report PDF: ${H.name}`),r("Files successfully committed to GitHub!")}catch(mt){throw r(`Error committing files: ${mt.message}`),mt}const dt={_id:p,name:H.name,description:H.description,date:H.date,coverImage:f?`/reports/${et}`:`/images/reports/${et}`,pdfPath:`/reports/${p}_${j}`,createdAt:serverTimestamp(),updatedAt:serverTimestamp()};await addDoc(collection(db,"reports"),dt),a({name:"",description:"",date:new Date().toISOString().slice(0,16)}),n(null),v(""),q(null),tt(null),h(!1),M(!1),E.current&&(E.current.value=""),c.current&&(c.current.value=""),m({type:"success",text:"Report added successfully!"}),setTimeout(()=>{r(""),o(!1)},3e3),setTimeout(()=>{m({type:"",text:""})},5e3)}catch(p){console.error("Error adding report:",p),m({type:"error",text:`Error adding report: ${p.message}`}),o(!1)}finally{P(!1)}},w=()=>{if(!b){m({type:"info",text:"Please upload a report file first before selecting a cover image."});return}f?at():E.current.click()},s=()=>{c.current.click()};return reactExports.useEffect(()=>()=>{B&&f&&URL.revokeObjectURL(B)},[B,f]),reactExports.useEffect(()=>{G||S(!1)},[G]),jsxRuntimeExports.jsxs("div",{className:"reports-form-container",children:[jsxRuntimeExports.jsxs("div",{className:"report-form-header",children:[jsxRuntimeExports.jsx("h1",{className:"report-form-title",children:"Add New Report"}),jsxRuntimeExports.jsx("p",{className:"report-form-subtitle",children:"Upload documents, reports, and presentations to showcase your work"})]}),R.text&&jsxRuntimeExports.jsx("div",{className:`report-message ${R.type}`,children:R.text}),jsxRuntimeExports.jsxs("form",{onSubmit:Z,className:"report-form",children:[jsxRuntimeExports.jsxs("div",{className:"report-form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"report-form-fields",children:[jsxRuntimeExports.jsxs("div",{className:"report-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",children:"Report Name*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",name:"name",value:H.name,onChange:i,className:g.name?"error":"",placeholder:"e.g., Business Proposal Q1 2024"}),g.name&&jsxRuntimeExports.jsx("div",{className:"error-text",children:g.name})]}),jsxRuntimeExports.jsxs("div",{className:"report-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",children:"Description*"}),jsxRuntimeExports.jsx("textarea",{id:"description",name:"description",value:H.description,onChange:i,className:g.description?"error":"",placeholder:"Briefly describe what this report contains...",rows:4}),g.description&&jsxRuntimeExports.jsx("div",{className:"error-text",children:g.description})]}),jsxRuntimeExports.jsxs("div",{className:"report-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"date",children:"Date*"}),jsxRuntimeExports.jsx("input",{type:"datetime-local",id:"date",name:"date",value:H.date,onChange:i,className:"date-picker"}),jsxRuntimeExports.jsx("small",{className:"form-help-text",children:"Select the date and time of the report"})]}),jsxRuntimeExports.jsxs("div",{className:"report-form-group",children:[jsxRuntimeExports.jsx("label",{children:"PDF File*"}),jsxRuntimeExports.jsxs("div",{className:`report-pdf-selector ${g.pdf?"error-border":""} ${G?"has-file":""}`,onClick:s,children:[G?jsxRuntimeExports.jsxs("div",{className:"selected-file",children:[jsxRuntimeExports.jsx("div",{className:"file-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),jsxRuntimeExports.jsx("polyline",{points:"14 2 14 8 20 8"}),jsxRuntimeExports.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),jsxRuntimeExports.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),jsxRuntimeExports.jsx("polyline",{points:"10 9 9 9 8 9"})]})}),jsxRuntimeExports.jsxs("div",{className:"file-details",children:[jsxRuntimeExports.jsx("span",{className:"file-name",children:L}),jsxRuntimeExports.jsx("span",{className:"file-type",children:"PDF Document"})]})]}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder pdf-placeholder",children:[jsxRuntimeExports.jsx("div",{className:"upload-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),jsxRuntimeExports.jsx("polyline",{points:"14 2 14 8 20 8"}),jsxRuntimeExports.jsx("path",{d:"M12 18v-6"}),jsxRuntimeExports.jsx("path",{d:"M8 15l4 4 4-4"})]})}),jsxRuntimeExports.jsx("p",{children:"Click to upload PDF document"}),jsxRuntimeExports.jsx("span",{children:"PDF files only (Max 20MB)"})]}),jsxRuntimeExports.jsx("input",{ref:c,type:"file",accept:".pdf",onChange:X,style:{display:"none"}})]}),g.pdf&&jsxRuntimeExports.jsx("div",{className:"error-text",children:g.pdf}),l&&!d&&jsxRuntimeExports.jsxs("div",{className:"processing-message",children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("span",{children:"Generating cover image..."})]}),!G&&jsxRuntimeExports.jsx("div",{className:"form-help-text",children:"Upload a report file first, then you can add or generate a cover image"})]})]}),jsxRuntimeExports.jsxs("div",{className:"report-image-upload",children:[jsxRuntimeExports.jsxs("label",{className:"cover-image-label",children:["Cover Image*",f&&!x&&jsxRuntimeExports.jsx("span",{className:"auto-generated-badge",children:"Auto-generated"})]}),jsxRuntimeExports.jsxs("div",{className:`report-image-preview 
                ${g.coverImage?"error-border":""} 
                ${B?"has-image":""} 
                ${f&&!x?"auto-generated":""} 
                ${b?"":"disabled"}`,onClick:w,children:[B?jsxRuntimeExports.jsx("img",{src:B,alt:"Cover preview"}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder",children:[jsxRuntimeExports.jsx("div",{className:"upload-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),jsxRuntimeExports.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),jsxRuntimeExports.jsx("polyline",{points:"21 15 16 10 5 21"})]})}),jsxRuntimeExports.jsx("p",{children:b?"Click to upload cover image":"Upload report file first"}),jsxRuntimeExports.jsx("span",{children:b?"PNG, JPG or WEBP (Min: 800x600px)":"Cover image will be available after report upload"})]}),jsxRuntimeExports.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:U,style:{display:"none"},disabled:!b})]}),g.coverImage&&jsxRuntimeExports.jsx("div",{className:"error-text",children:g.coverImage}),f&&!x&&jsxRuntimeExports.jsxs("div",{className:"auto-cover-message",children:["Cover image automatically generated from PDF."," ",jsxRuntimeExports.jsx("button",{type:"button",className:"change-cover-btn",onClick:at,children:"Upload manually instead"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"report-form-actions",children:jsxRuntimeExports.jsx("button",{type:"submit",className:"report-submit-button",disabled:l||d,children:l||d?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("span",{children:d?"Committing...":"Uploading..."})]}):"Add Report"})}),(d||u)&&jsxRuntimeExports.jsxs("div",{className:`commit-status ${u.includes("Error")?"error":u.includes("success")?"success":"info"}`,children:[u,d&&!u.includes("success")&&jsxRuntimeExports.jsx("div",{className:"spinner"})]})]})]})}function LoginPage({setAuthenticated:H}){const[a,G]=reactExports.useState(!1),[n,_]=reactExports.useState(null),[q,B]=reactExports.useState(!1),tt="abdobella977@gmail.com";reactExports.useEffect(()=>{_(null),B(!1)},[]),reactExports.useEffect(()=>{if(n&&!q){const v=setTimeout(()=>{_(null)},5e3);return()=>clearTimeout(v)}},[n,q]);const L=async()=>{G(!0),_(null),B(!1);const v=getAuth(),l=new GithubAuthProvider;try{const P=await signInWithPopup(v,l),R=P.user,g=GithubAuthProvider.credentialFromResult(P).accessToken;if(console.log("User email:",R.email),console.log("Authorized email:",tt),R.email!==tt){console.log("Unauthorized access attempt"),await signOut(v),B(!0),_("You are not my owner! Get the hell out of here!"),localStorage.removeItem("firebaseAuthUser"),H(!1);return}localStorage.setItem("firebaseAuthUser",JSON.stringify({uid:R.uid,displayName:R.displayName,email:R.email,photoURL:R.photoURL})),H(!0)}catch(P){P.code;const R=P.message;console.error("Login error:",P),_(`Login failed: ${R}`)}finally{G(!1)}};return jsxRuntimeExports.jsx("div",{className:"login-container",children:jsxRuntimeExports.jsxs("div",{className:"login-form",children:[jsxRuntimeExports.jsx("h1",{className:"login-title",children:"Admin Access"}),jsxRuntimeExports.jsx("p",{className:"login-subtitle",children:"Sign in with your GitHub account to access the admin panel"}),jsxRuntimeExports.jsxs("button",{className:"github-login-btn",onClick:L,disabled:a,children:[jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,className:"github-icon"}),a?"Connecting...":"Sign in with GitHub"]}),n&&jsxRuntimeExports.jsxs("div",{className:`login-error ${q?"unauthorized":""}`,children:[q&&jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faExclamationTriangle,className:"error-icon"}),n]})]})})}function ArrangeProjects(){const[H,a]=reactExports.useState([]),[G,n]=reactExports.useState([]);reactExports.useEffect(()=>{(async()=>{try{const tt=collection(db,"projects"),v=(await getDocs(tt)).docs.map(l=>({id:l.id,...l.data()}));a(v),console.log(v)}catch(tt){console.error("Error fetching projects:",tt)}})()},[]);const _=Math.ceil(H.length/3),q=async()=>{try{const B=collection(db,"projects"),L=(await getDocs(B)).docs.map(async P=>{const R=doc(db,"projects",P.id);await updateDoc(R,{showInOverview:!1})});await Promise.all(L);const l=G.map(P=>P.id).map(async P=>{const R=doc(db,"projects",P);await updateDoc(R,{showInOverview:!0})});await Promise.all(l),alert("Featured projects updated successfully!")}catch(B){console.error("Error updating featured projects:",B),alert("Failed to update featured projects. See console for details.")}};return jsxRuntimeExports.jsxs("div",{className:"arrange-projects-form filldb-form",children:[jsxRuntimeExports.jsx("div",{className:"highlighted-projects",children:G.length>0&&G.filter((B,tt)=>tt<3).map(B=>jsxRuntimeExports.jsx("div",{className:"highlighted-project",onClick:()=>{n(G.filter(tt=>tt!==B))},children:jsxRuntimeExports.jsx("h3",{children:B.title})},B.id||B.title))}),jsxRuntimeExports.jsx("div",{className:"scrollable-grid",children:jsxRuntimeExports.jsx("div",{style:{display:"flex",flexWrap:"wrap"},children:H.length>0&&H.map(B=>jsxRuntimeExports.jsx("div",{style:{flex:`1 0 ${100/_}%`},className:"project",onClick:()=>{if(G.includes(B))n(G.filter(tt=>tt!==B));else{if(G.length===3)return;n([...G,B])}},children:jsxRuntimeExports.jsx("h3",{children:B.title})},B.id||B.title))})}),jsxRuntimeExports.jsx("button",{className:"validate-btn",onClick:()=>q(),children:"Validate"})]})}function CertificatesForm(){const[H,a]=reactExports.useState({certificateTitle:"",issuer:"",link:"",downloadPath:""}),[G,n]=reactExports.useState(null),[_,q]=reactExports.useState(null),[B,tt]=reactExports.useState(!1),[L,v]=reactExports.useState({type:"",text:""}),[l,P]=reactExports.useState({}),R=reactExports.useRef(null),[m,g]=reactExports.useState(""),[A,f]=reactExports.useState(!1),h={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/certificates/",token:localStorage.getItem("githubToken")||""},x=o=>{const{name:C,value:i}=o.target;a({...H,[C]:i}),l[C]&&P({...l,[C]:""})},M=o=>{const C=o.target.files[0];if(C){n(C);const i=new FileReader;i.onload=()=>{q(i.result)},i.readAsDataURL(C),l.image&&P({...l,image:""})}},E=()=>{const o={};return H.certificateTitle.trim()||(o.certificateTitle="Title is required"),H.issuer.trim()||(o.issuer="Issuer is required"),H.link.trim()||(o.link="Link is required"),H.downloadPath.trim()||(o.downloadPath="Download path is required"),G||(o.image="Certificate image is required"),P(o),Object.keys(o).length===0},c=o=>new Promise((C,i)=>{const b=new FileReader;b.readAsDataURL(o),b.onload=()=>{const S=b.result.split(",")[1];C(S)},b.onerror=S=>i(S)}),u=async(o,C,i)=>{if(!o||!h.token)throw new Error("Missing file or GitHub token");try{const b=await c(o);let S=null;try{const $=await fetch(`https://api.github.com/repos/${h.owner}/${h.repo}/contents/${C}?ref=${h.branch}`,{headers:{Authorization:`token ${h.token}`,Accept:"application/vnd.github.v3+json"}});$.status===200&&(S=(await $.json()).sha)}catch{console.log(`File does not exist yet: ${C}`)}const K={message:i,content:b,branch:h.branch};S&&(K.sha=S);const U=await fetch(`https://api.github.com/repos/${h.owner}/${h.repo}/contents/${C}`,{method:"PUT",headers:{Authorization:`token ${h.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(K)}),X=await U.json();if(U.status===200||U.status===201)return X;throw new Error(`GitHub API Error: ${X.message}`)}catch(b){throw console.error("Error committing to GitHub:",b),b}},r=async o=>{if(o.preventDefault(),!!E())try{if(tt(!0),!h.token){const X=prompt("Please enter your GitHub token to commit images:");if(!X){v({type:"error",text:"GitHub token is required to commit images."}),tt(!1);return}localStorage.setItem("githubToken",X),h.token=X}const C=v4().replace(/-/g,"").substring(0,24),i=Date.now(),b=G.name.split(".").pop(),S=`${C}.${b}`,K=`${h.baseImagePath}${S}`;f(!0),g("Committing certificate image to GitHub...");try{await u(G,K,`Add certificate image: ${H.certificateTitle}`),g("Image successfully committed to GitHub!")}catch(X){throw g(`Error committing image: ${X.message}`),X}const U={_id:C,certificateTitle:H.certificateTitle,issuer:H.issuer,link:H.link,downloadPath:H.downloadPath,image:`/images/certificates/${S}`,createdAt:serverTimestamp(),updatedAt:serverTimestamp(),__v:0};await addDoc(collection(db,"certificates"),U),a({certificateTitle:"",issuer:"",link:"",downloadPath:""}),n(null),q(null),R.current&&(R.current.value=""),v({type:"success",text:"Certificate added successfully!"}),setTimeout(()=>{g(""),f(!1)},3e3),setTimeout(()=>{v({type:"",text:""})},5e3)}catch(C){console.error("Error adding certificate:",C),v({type:"error",text:`Error adding certificate: ${C.message}`}),f(!1)}finally{tt(!1)}},d=()=>{R.current.click()};return jsxRuntimeExports.jsxs("div",{className:"certificates-form-container",children:[jsxRuntimeExports.jsxs("div",{className:"certificate-form-header",children:[jsxRuntimeExports.jsx("h1",{className:"certificate-form-title",children:"Add New Certificate"}),jsxRuntimeExports.jsx("p",{className:"certificate-form-subtitle",children:"Add your professional certificates and achievements to showcase your expertise"})]}),L.text&&jsxRuntimeExports.jsx("div",{className:`certificate-message ${L.type}`,children:L.text}),jsxRuntimeExports.jsxs("form",{onSubmit:r,className:"certificate-form",children:[jsxRuntimeExports.jsxs("div",{className:"certificate-form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"certificate-form-fields",children:[jsxRuntimeExports.jsxs("div",{className:"certificate-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"title",children:"Certificate Title*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"title",name:"certificateTitle",value:H.certificateTitle,onChange:x,className:l.certificateTitle?"error":"",placeholder:"e.g., AWS Certified Solutions Architect"}),l.certificateTitle&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.certificateTitle})]}),jsxRuntimeExports.jsxs("div",{className:"certificate-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"issuer",children:"Issuing Organization*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"issuer",name:"issuer",value:H.issuer,onChange:x,className:l.issuer?"error":"",placeholder:"e.g., Amazon Web Services"}),l.issuer&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.issuer})]}),jsxRuntimeExports.jsxs("div",{className:"certificate-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"link",children:"Certificate Link*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"link",name:"link",value:H.link,onChange:x,className:l.link?"error":"",placeholder:"https://verify.example.com/cert/123"}),l.link&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.link})]}),jsxRuntimeExports.jsxs("div",{className:"certificate-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"downloadPath",children:"Download Link*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"downloadPath",name:"downloadPath",value:H.downloadPath,onChange:x,className:l.downloadPath?"error":"",placeholder:"https://example.com/download/certificate.pdf"}),l.downloadPath&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.downloadPath})]})]}),jsxRuntimeExports.jsxs("div",{className:"certificate-image-upload",children:[jsxRuntimeExports.jsxs("div",{className:`certificate-image-preview ${l.image?"error-border":""} ${_?"has-image":""}`,onClick:d,children:[_?jsxRuntimeExports.jsx("img",{src:_,alt:"Certificate preview"}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder",children:[jsxRuntimeExports.jsx("div",{className:"upload-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports.jsx("polyline",{points:"17 8 12 3 7 8"}),jsxRuntimeExports.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),jsxRuntimeExports.jsx("p",{children:"Click to upload certificate image"}),jsxRuntimeExports.jsx("span",{children:"PNG, JPG or WEBP (Max 5MB)"})]}),jsxRuntimeExports.jsx("input",{ref:R,type:"file",accept:"image/*",onChange:M,style:{display:"none"}})]}),l.image&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.image})]})]}),jsxRuntimeExports.jsx("div",{className:"certificate-form-actions",children:jsxRuntimeExports.jsx("button",{type:"submit",className:"certificate-submit-button",disabled:B||A,children:B||A?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("span",{children:A?"Committing...":"Uploading..."})]}):"Add Certificate"})}),(A||m)&&jsxRuntimeExports.jsxs("div",{className:`commit-status ${m.includes("Error")?"error":m.includes("success")?"success":"info"}`,children:[m,A&&!m.includes("success")&&jsxRuntimeExports.jsx("div",{className:"spinner"})]})]})]})}function Clients(){const[H,a]=reactExports.useState({name:"",description:"",profession:"",company:""}),[G,n]=reactExports.useState(null),[_,q]=reactExports.useState(null),[B,tt]=reactExports.useState(!1),[L,v]=reactExports.useState({type:"",text:""}),[l,P]=reactExports.useState({}),R=reactExports.useRef(null),[m,g]=reactExports.useState(""),[A,f]=reactExports.useState(!1),h={owner:"bellaabdelouahab",repo:"portfolio",branch:"master",baseImagePath:"public/images/clients/",token:localStorage.getItem("githubToken")||""},x=o=>{const{name:C,value:i}=o.target;a({...H,[C]:i}),l[C]&&P({...l,[C]:""})},M=o=>{const C=o.target.files[0];if(C){n(C);const i=new FileReader;i.onload=()=>{q(i.result)},i.readAsDataURL(C),l.image&&P({...l,image:""})}},E=()=>{const o={};return H.name.trim()||(o.name="Client name is required"),H.description.trim()||(o.description="Description is required"),H.profession.trim()||(o.profession="Profession is required"),H.company.trim()||(o.company="Company name is required"),G||(o.image="Client image is required"),P(o),Object.keys(o).length===0},c=o=>new Promise((C,i)=>{const b=new FileReader;b.readAsDataURL(o),b.onload=()=>{const S=b.result.split(",")[1];C(S)},b.onerror=S=>i(S)}),u=async(o,C,i)=>{if(!o||!h.token)throw new Error("Missing file or GitHub token");try{const b=await c(o);let S=null;try{const $=await fetch(`https://api.github.com/repos/${h.owner}/${h.repo}/contents/${C}?ref=${h.branch}`,{headers:{Authorization:`token ${h.token}`,Accept:"application/vnd.github.v3+json"}});$.status===200&&(S=(await $.json()).sha)}catch{console.log(`File does not exist yet: ${C}`)}const K={message:i,content:b,branch:h.branch};S&&(K.sha=S);const U=await fetch(`https://api.github.com/repos/${h.owner}/${h.repo}/contents/${C}`,{method:"PUT",headers:{Authorization:`token ${h.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(K)}),X=await U.json();if(U.status===200||U.status===201)return X;throw new Error(`GitHub API Error: ${X.message}`)}catch(b){throw console.error("Error committing to GitHub:",b),b}},r=async o=>{if(o.preventDefault(),!!E())try{if(tt(!0),!h.token){const U=prompt("Please enter your GitHub token to commit images:");if(!U){v({type:"error",text:"GitHub token is required to commit images."}),tt(!1);return}localStorage.setItem("githubToken",U),h.token=U}const C=v4().replace(/-/g,"").substring(0,24),i=G.name.split(".").pop(),b=`${C}.${i}`,S=`${h.baseImagePath}${b}`;f(!0),g("Committing client image to GitHub...");try{await u(G,S,`Add client image: ${H.name}`),g("Image successfully committed to GitHub!")}catch(U){throw g(`Error committing image: ${U.message}`),U}const K={_id:C,name:H.name,description:H.description,profession:H.profession,company:H.company,image:`/images/clients/${b}`,createdAt:serverTimestamp(),updatedAt:serverTimestamp()};await addDoc(collection(db,"clients"),K),a({name:"",description:"",profession:"",company:""}),n(null),q(null),R.current&&(R.current.value=""),v({type:"success",text:"Client added successfully!"}),setTimeout(()=>{g(""),f(!1)},3e3),setTimeout(()=>{v({type:"",text:""})},5e3)}catch(C){console.error("Error adding client:",C),v({type:"error",text:`Error adding client: ${C.message}`}),f(!1)}finally{tt(!1)}},d=()=>{R.current.click()};return jsxRuntimeExports.jsxs("div",{className:"clients-form-container",children:[jsxRuntimeExports.jsxs("div",{className:"client-form-header",children:[jsxRuntimeExports.jsx("h1",{className:"client-form-title",children:"Add New Client"}),jsxRuntimeExports.jsx("p",{className:"client-form-subtitle",children:"Add clients and testimonials to showcase your professional connections"})]}),L.text&&jsxRuntimeExports.jsx("div",{className:`client-message ${L.type}`,children:L.text}),jsxRuntimeExports.jsxs("form",{onSubmit:r,className:"client-form",children:[jsxRuntimeExports.jsxs("div",{className:"client-form-grid",children:[jsxRuntimeExports.jsxs("div",{className:"client-form-fields",children:[jsxRuntimeExports.jsxs("div",{className:"client-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",children:"Client Name*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",name:"name",value:H.name,onChange:x,className:l.name?"error":"",placeholder:"e.g., John Smith"}),l.name&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.name})]}),jsxRuntimeExports.jsxs("div",{className:"client-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"profession",children:"Client Profession*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"profession",name:"profession",value:H.profession,onChange:x,className:l.profession?"error":"",placeholder:"e.g., Marketing Director"}),l.profession&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.profession})]}),jsxRuntimeExports.jsxs("div",{className:"client-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"company",children:"Company/Organization*"}),jsxRuntimeExports.jsx("input",{type:"text",id:"company",name:"company",value:H.company,onChange:x,className:l.company?"error":"",placeholder:"e.g., Acme Inc."}),l.company&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.company})]}),jsxRuntimeExports.jsxs("div",{className:"client-form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",children:"Client Testimonial/Description*"}),jsxRuntimeExports.jsx("textarea",{id:"description",name:"description",value:H.description,onChange:x,className:l.description?"error":"",placeholder:"What they said about your work...",rows:5}),l.description&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.description})]})]}),jsxRuntimeExports.jsxs("div",{className:"client-image-upload",children:[jsxRuntimeExports.jsxs("div",{className:`client-image-preview ${l.image?"error-border":""} ${_?"has-image":""}`,onClick:d,children:[_?jsxRuntimeExports.jsx("img",{src:_,alt:"Client preview"}):jsxRuntimeExports.jsxs("div",{className:"upload-placeholder",children:[jsxRuntimeExports.jsx("div",{className:"upload-icon",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[jsxRuntimeExports.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports.jsx("polyline",{points:"17 8 12 3 7 8"}),jsxRuntimeExports.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),jsxRuntimeExports.jsx("p",{children:"Click to upload client photo"}),jsxRuntimeExports.jsx("span",{children:"Square image recommended (1:1)"})]}),jsxRuntimeExports.jsx("input",{ref:R,type:"file",accept:"image/*",onChange:M,style:{display:"none"}})]}),l.image&&jsxRuntimeExports.jsx("div",{className:"error-text",children:l.image})]})]}),jsxRuntimeExports.jsx("div",{className:"client-form-actions",children:jsxRuntimeExports.jsx("button",{type:"submit",className:"client-submit-button",disabled:B||A,children:B||A?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"spinner"}),jsxRuntimeExports.jsx("span",{children:A?"Committing...":"Uploading..."})]}):"Add Client"})}),(A||m)&&jsxRuntimeExports.jsxs("div",{className:`commit-status ${m.includes("Error")?"error":m.includes("success")?"success":"info"}`,children:[m,A&&!m.includes("success")&&jsxRuntimeExports.jsx("div",{className:"spinner"})]})]})]})}function VisitorStats(){const[H,a]=reactExports.useState({totalVisitors:0,recentVisitors:[],topPages:[],loading:!0,error:null});return reactExports.useEffect(()=>{(async()=>{try{const n=collection(db,"visitors"),_=await getDocs(n),q=query(n,orderBy("timestamp","desc"),limit(10)),tt=(await getDocs(q)).docs.map(R=>{var m,g;return{id:R.id,...R.data(),timestamp:((g=(m=R.data().timestamp)==null?void 0:m.toDate)==null?void 0:g.call(m))||new Date}}),L=collection(db,"pageViews"),v=await getDocs(L),l={};v.docs.forEach(R=>{const m=R.data().path;m&&(l[m]=(l[m]||0)+1)});const P=Object.entries(l).map(([R,m])=>({path:R,count:m})).sort((R,m)=>m.count-R.count).slice(0,5);a({totalVisitors:_.size,recentVisitors:tt,topPages:P,loading:!1,error:null})}catch(n){console.error("Error fetching visitor stats:",n),a(_=>({..._,loading:!1,error:"Failed to load visitor statistics"}))}})()},[]),H.loading?jsxRuntimeExports.jsx("div",{className:"loading",children:"Loading visitor statistics..."}):H.error?jsxRuntimeExports.jsx("div",{className:"error",children:H.error}):jsxRuntimeExports.jsxs("div",{className:"visitor-stats",children:[jsxRuntimeExports.jsx("h2",{children:"Visitor Statistics"}),jsxRuntimeExports.jsxs("div",{className:"stats-card",children:[jsxRuntimeExports.jsx("h3",{children:"Total Unique Visitors"}),jsxRuntimeExports.jsx("div",{className:"stat-number",children:H.totalVisitors})]}),jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Top Pages"}),jsxRuntimeExports.jsx("ul",{className:"top-pages",children:H.topPages.map((G,n)=>jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("span",{className:"page-path",children:G.path||"/"}),jsxRuntimeExports.jsxs("span",{className:"page-count",children:[G.count," views"]})]},n))})]}),jsxRuntimeExports.jsxs("div",{className:"stats-section",children:[jsxRuntimeExports.jsx("h3",{children:"Recent Visitors"}),jsxRuntimeExports.jsxs("table",{className:"visitors-table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"IP Address"}),jsxRuntimeExports.jsx("th",{children:"Browser"}),jsxRuntimeExports.jsx("th",{children:"OS"}),jsxRuntimeExports.jsx("th",{children:"Time"})]})}),jsxRuntimeExports.jsx("tbody",{children:H.recentVisitors.map((G,n)=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:G.ip}),jsxRuntimeExports.jsx("td",{children:G.browser}),jsxRuntimeExports.jsx("td",{children:G.operatingSystem}),jsxRuntimeExports.jsx("td",{children:G.timestamp.toLocaleString()})]},n))})]})]})]})}const tabs=[{id:0,label:"Project",component:jsxRuntimeExports.jsx(ProjectForm,{})},{id:1,label:"Arrange Projects",component:jsxRuntimeExports.jsx(ArrangeProjects,{})},{id:2,label:"Certificate",component:jsxRuntimeExports.jsx(CertificatesForm,{})},{id:4,label:"Report",component:jsxRuntimeExports.jsx(ReportForm,{})},{id:5,label:"Clients",component:jsxRuntimeExports.jsx(Clients,{})},{id:6,label:"Visitor Stats",component:jsxRuntimeExports.jsx(VisitorStats,{})}];function FillDB(){const[H,a]=reactExports.useState(!1),[G,n]=reactExports.useState(tabs[0].id),[_,q]=reactExports.useState(null),[B,tt]=reactExports.useState(!1);reactExports.useEffect(()=>{const v=getAuth(),l=onAuthStateChanged(v,P=>{if(P)P.email==="abdobella977@gmail.com"?(q(P),a(!0),localStorage.setItem("firebaseAuthUser",JSON.stringify({uid:P.uid,displayName:P.displayName,email:P.email,photoURL:P.photoURL}))):signOut(v).then(()=>{q(null),a(!1),localStorage.removeItem("firebaseAuthUser")});else{q(null);const R=localStorage.getItem("firebaseAuthUser");if(R){const m=JSON.parse(R);m.email==="abdobella977@gmail.com"?(a(!0),q(m)):(localStorage.removeItem("firebaseAuthUser"),a(!1))}else a(!1)}tt(!0)});return()=>l()},[]),reactExports.useEffect(()=>{var v;H&&console.log(`Tab changed to: ${(v=tabs[G])==null?void 0:v.label}`)},[G,H]);const L=async()=>{const v=getAuth();try{await signOut(v),localStorage.removeItem("firebaseAuthUser"),localStorage.removeItem("githubToken"),a(!1),q(null)}catch(l){console.error("Error signing out: ",l)}};return B?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:H?jsxRuntimeExports.jsxs("div",{className:"filldb-container",children:[jsxRuntimeExports.jsxs("div",{className:"sidebar",children:[_&&jsxRuntimeExports.jsxs("div",{className:"user-profile",children:[jsxRuntimeExports.jsx("img",{src:_.photoURL,alt:_.displayName,className:"user-avatar",onError:v=>{v.target.onerror=null,v.target.src="https://via.placeholder.com/30"}}),jsxRuntimeExports.jsx("span",{className:"user-name",children:_.displayName})]}),jsxRuntimeExports.jsx("div",{className:"nav-buttons",children:tabs.map(v=>jsxRuntimeExports.jsx("button",{className:`filldb-nav__btn ${G===v.id?"active":""}`,onClick:()=>n(v.id),children:v.label},v.id))}),jsxRuntimeExports.jsx("button",{className:"filldb-nav__btn logout-btn",onClick:L,children:"Logout"})]}),jsxRuntimeExports.jsx("div",{className:"main-content",children:tabs.map(v=>G===v.id&&v.component)})]}):jsxRuntimeExports.jsx(LoginPage,{setAuthenticated:a})}):jsxRuntimeExports.jsx("div",{className:"loading-auth",children:"Checking authentication..."})}export{FillDB as default};
